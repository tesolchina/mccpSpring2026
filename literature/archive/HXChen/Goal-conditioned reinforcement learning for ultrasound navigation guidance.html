<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Goal-conditioned reinforcement learning for ultrasound navigation guidance</title>
<!--Generated on Thu Aug  1 08:57:09 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Ultrasound Echocardiography Deep reinforcement learning Goal-conditioned reinforcement learning" lang="en" name="keywords"/>
<base href="/html/2405.01409v3/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#S1" title="In Goal-conditioned reinforcement learning for ultrasound navigation guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#S2" title="In Goal-conditioned reinforcement learning for ultrasound navigation guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#S2.SS1" title="In 2 Methodology â€£ Goal-conditioned reinforcement learning for ultrasound navigation guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Simulation environment</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#S2.SS2" title="In 2 Methodology â€£ Goal-conditioned reinforcement learning for ultrasound navigation guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Goal-Conditioned Reinforcement Learning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#S3" title="In Goal-conditioned reinforcement learning for ultrasound navigation guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiments and results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#S4" title="In Goal-conditioned reinforcement learning for ultrasound navigation guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Discussion and conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span class="ltx_note ltx_role_institutetext" id="id1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>Kingâ€™s College London, School of Biomedical Engineering &amp; Imaging Sciences, London, United Kingdom 
<br class="ltx_break"/><span class="ltx_note ltx_role_email" id="id1.1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>abdoul.a.amadou@kcl.ac.uk</span></span></span>
<br class="ltx_break"/></span></span></span><span class="ltx_note ltx_role_institutetext" id="id2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">institutetext: </span>Siemens Healthcare Limited, Camberley, United Kingdom
<br class="ltx_break"/></span></span></span><span class="ltx_note ltx_role_institutetext" id="id3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_note_type">institutetext: </span>Siemens Healthineers, Digital Technology and Innovation, Princeton, NJ, USA 
<br class="ltx_break"/></span></span></span><span class="ltx_note ltx_role_institutetext" id="id4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_note_type">institutetext: </span>Siemens Healthineers AG, Digital Technology and Innovation, Erlangen, Germany 
<br class="ltx_break"/></span></span></span><span class="ltx_note ltx_role_institutetext" id="id5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_note_type">institutetext: </span>Carol Davila University of Medicine and Pharmacy Bucharest, Romania 
<br class="ltx_break"/></span></span></span><span class="ltx_note ltx_role_institutetext" id="id6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_note_type">institutetext: </span>Siemens Healthineers, Sonographer , Bangalore, Karnataka </span></span></span><span class="ltx_note ltx_role_institutetext" id="id7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_note_type">institutetext: </span>Fortis Institute of Medical Sciences, Affiliated by Rajiv Gandhi University of Medical Sciences, Department of Cardiology, Bangalore, Karnataka </span></span></span><span class="ltx_note ltx_role_institutetext" id="id8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_note_type">institutetext: </span>Guyâ€™s and St Thomasâ€™ NHS Foundation Trust, London, United Kingdom
<br class="ltx_break"/></span></span></span>
<h1 class="ltx_title ltx_title_document">Goal-conditioned reinforcement learning for ultrasound navigation guidance</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Abdoul Aziz Amadou
</span><span class="ltx_author_notes">1122</span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Vivek Singh
</span><span class="ltx_author_notes">33</span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Florin C. Ghesu
</span><span class="ltx_author_notes">44</span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Young-Ho Kim
</span><span class="ltx_author_notes">33</span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Laura Stanciulescu
</span><span class="ltx_author_notes">3355</span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Harshitha P. Sai
</span><span class="ltx_author_notes">6677</span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Puneet Sharma
</span><span class="ltx_author_notes">33</span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Alistair Young
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ronak Rajani
</span><span class="ltx_author_notes">1188</span></span>
<span class="ltx_author_before">â€ƒâ€ƒ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kawal Rhode
</span><span class="ltx_author_notes">11</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Transesophageal echocardiography (TEE) plays a pivotal role in cardiology for diagnostic and interventional procedures. However, using it effectively requires extensive training due to the intricate nature of image acquisition and interpretation. To enhance the efficiency of novice sonographers and reduce variability in scan acquisitions, we propose a novel ultrasound (US) navigation assistance method based on contrastive learning as goal-conditioned reinforcement learning (GCRL). We augment the previous framework using a novel contrastive patient batching method (CPB) and a data-augmented contrastive loss, both of which we demonstrate are essential to ensure generalization to anatomical variations across patients. The proposed framework enables navigation to both standard diagnostic as well as intricate interventional views with a single model. Our method was developed with a large dataset of 789 patients and obtained an average error of 6.56 mm in position and 9.36 degrees in angle on a testing dataset of 140 patients, which is competitive or superior to models trained on individual views. Furthermore, we quantitatively validate our methodâ€™s ability to navigate to interventional views such as the Left Atrial Appendage (LAA) view used in LAA closure. Our approach holds promise in providing valuable guidance during transesophageal ultrasound examinations, contributing to the advancement of skill acquisition for cardiac ultrasound practitioners.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Ultrasound Echocardiography Deep reinforcement learning Goal-conditioned reinforcement learning
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Echocardiography is a key imaging modality in the diagnosis and treatment of cardiovascular diseases. While several US modalities are used in practice, in TEE, the transducer images the heart from the oesophagus, often yielding better scan quality and helping circumvent issues caused by acoustic windows in other modalities such as transthoracic echocardiography (TTE). Training operators for TEE is time-consuming due to complex controls and image interpretation, with an added risk of patient injury due to incorrect transducer manipulation. Additionally, in structural heart procedures where TEE is coupled with fluoroscopy, health issues arise for catheterization lab staff due to orthopaedic strain and radiation exposure <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib1" title="">1</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">AI-assisted guidance for transducer manipulation has been proven to benefit operator training, lower the learning curve, and reduce intra and inter-user variability <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib3" title="">3</a>]</cite>. Additional advantages include shortening of TEE examinations, enhancing patient comfort and reducing radiation exposure during interventional procedures.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Various deep reinforcement learning (DRL) approaches for ultrasound autonomous navigation have been proposed, primarily focusing on extracorporeal scanning of anatomies like the spine <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib5" title="">5</a>]</cite> and neck <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib6" title="">6</a>]</cite>. However, Li et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib4" title="">4</a>]</cite> suffer from a lack of generalization to unseen patient datasets, and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib5" title="">5</a>]</cite> employs simplified state and action spaces that do not capture the real-world scanning conditions well. While previous works rely on simulation environments, both <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib8" title="">8</a>]</cite> use additional hardware attached to the transducers to acquire datasets for imitation learning. However, the scalability of the data acquisition (time and cost) is reported as one of the limitations of such approaches <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib8" title="">8</a>]</cite>. TEE imaging has been less explored, with Wang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib9" title="">9</a>]</cite> using a simulation environment based on segmented pre-operative scans to find robotic poses corresponding to desired views pre-operatively. However, this approach requires a manual intervention to define the views. Finally, authors in Li et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib10" title="">10</a>]</cite> use a simulation environment to train models to navigate to standard TEE views. However, their approach involves training one model for each target view, which does not scale well to support additional views or supporting manoeuvres to visualize specific structures more clearly. Furthermore, they only control 3 out of 5 transducer degrees of freedom and test on a limited dataset of 5 patients.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">This paper introduces a novel approach to training a navigation model using goal-conditioned reinforcement learning. We build upon Contrastive RL (CRL) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib11" title="">11</a>]</cite>, a state-of-the-art goal-conditioned method which showed promising results in image-based robotic tasks. We train our model using random goal views, enabling navigation to arbitrary views given a user-defined goal. We make use of a simulation environment <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib12" title="">12</a>]</cite>, where we leverage a large dataset of chest and cardiac CTs to train our model and enable generalization to unseen patients. An overview of the proposed workflow is shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#S1.F1" title="Figure 1 â€£ 1 Introduction â€£ Goal-conditioned reinforcement learning for ultrasound navigation guidance"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">The contributions of this work are the following:
<span class="ltx_text ltx_font_bold" id="S1.p5.1.1">1)</span> We propose a novel methodology for TEE imaging guidance to arbitrary views using goal-conditioned reinforcement learning. This not only enables navigation to standard views but also to alternative views showing specific structures. <span class="ltx_text ltx_font_bold" id="S1.p5.1.2">2)</span> We enable the generalization of the CRL framework by introducing: <span class="ltx_text ltx_font_italic" id="S1.p5.1.3">(i)</span> Contrastive patient batching, a simple yet effective method to sample hard contrastive pairs and improve performance; <span class="ltx_text ltx_font_italic" id="S1.p5.1.4">(ii)</span> A novel contrastive data augmentation loss to improve both robustness and the quality of learnt representations. <span class="ltx_text ltx_font_bold" id="S1.p5.1.5">3)</span> We demonstrate the effectiveness of our approach by performing two experiments on a dataset of 140 patients: <span class="ltx_text ltx_font_italic" id="S1.p5.1.6">(i)</span> By navigating to standard views, including views that were not explicitly sampled during training. Our method achieves competitive performance to RL methods trained to reach individual views; <span class="ltx_text ltx_font_italic" id="S1.p5.1.7">(ii)</span> By navigating to a non-standard view used to monitor the deployment of devices in LAA closure. This showcases the usability of our method both for diagnostic and interventional cases. To the best of our knowledge, this work is the first attempt to develop an ultrasound navigation model capable of navigating to arbitrary views given a goal.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="244" id="S1.F1.g1" src="x1.png" width="788"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.3.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text ltx_font_italic" id="S1.F1.4.2" style="font-size:90%;">System overview of Goal-conditioned RL for Ultrasound Navigation<span class="ltx_text ltx_font_upright" id="S1.F1.4.2.1">. We first segment CTs and generate ultrasound volume reconstructions for rapid sampling during training. The model is trained to reach randomly selected goal views by employing the contrastive patient batching (CPB) mechanism to create a contrastive batch from the collected experience. When deployed, the trained model can navigate to arbitrary views, including standard and interventional views.</span></span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methodology</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Simulation environment</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Acquiring real datasets for navigation is a cumbersome, expensive and time-consuming task, as reported in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib8" title="">8</a>]</cite>. Hence, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#S1.F1" title="Figure 1 â€£ 1 Introduction â€£ Goal-conditioned reinforcement learning for ultrasound navigation guidance"><span class="ltx_text ltx_ref_tag">1</span></a>, we employ a physics-based Computed Tomography (CT) to ultrasound simulation pipeline to train our model. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib12" title="">12</a>]</cite>. The pipeline takes as input chest and cardiac CTs and automatically segments them to obtain masks of the organs of interest, namely the oesophagus, heart chambers, aorta, lungs and pulmonary artery. A Monte Carlo path tracing algorithm is then used to simulate ultrasound wave propagation in tissue. The pipeline was extensively validated with phantom experiments, where US image properties were assessed, and a view classification experiment, in which we demonstrated the usefulness of the pipeline in generating data for model training. More details on the pre-processing and US simulation pipeline are provided in the anonymized submission in the supplementary material.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">As simulating ultrasound images on the fly from the CT is computationally expensive and would significantly slow down the training, we followed Li et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib10" title="">10</a>]</cite> and generated simulated US images by translating the transducer down the oesophagus, rotating it by 360 degrees at every position. Simulation and volume reconstruction were done offline on the GPU.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="336" id="S2.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.9.4.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text ltx_font_italic" id="S2.F2.6.3" style="font-size:90%;">Contrastive critic training:<span class="ltx_text ltx_font_upright" id="S2.F2.6.3.3"> We build a contrastive batch using trajectories from two patients with CPB and pass (observation, action) pairs and goal images to the state-action and goal encoders respectively. Goal and observations are augmented <math alttext="K" class="ltx_Math" display="inline" id="S2.F2.4.1.1.m1.1"><semantics id="S2.F2.4.1.1.m1.1b"><mi id="S2.F2.4.1.1.m1.1.1" xref="S2.F2.4.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.F2.4.1.1.m1.1c"><ci id="S2.F2.4.1.1.m1.1.1.cmml" xref="S2.F2.4.1.1.m1.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.4.1.1.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S2.F2.4.1.1.m1.1e">italic_K</annotation></semantics></math> times and we build <math alttext="K^{2}" class="ltx_Math" display="inline" id="S2.F2.5.2.2.m2.1"><semantics id="S2.F2.5.2.2.m2.1b"><msup id="S2.F2.5.2.2.m2.1.1" xref="S2.F2.5.2.2.m2.1.1.cmml"><mi id="S2.F2.5.2.2.m2.1.1.2" xref="S2.F2.5.2.2.m2.1.1.2.cmml">K</mi><mn id="S2.F2.5.2.2.m2.1.1.3" xref="S2.F2.5.2.2.m2.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.F2.5.2.2.m2.1c"><apply id="S2.F2.5.2.2.m2.1.1.cmml" xref="S2.F2.5.2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.F2.5.2.2.m2.1.1.1.cmml" xref="S2.F2.5.2.2.m2.1.1">superscript</csymbol><ci id="S2.F2.5.2.2.m2.1.1.2.cmml" xref="S2.F2.5.2.2.m2.1.1.2">ğ¾</ci><cn id="S2.F2.5.2.2.m2.1.1.3.cmml" type="integer" xref="S2.F2.5.2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.5.2.2.m2.1d">K^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.5.2.2.m2.1e">italic_K start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> intermediate matrices (not shown) from the inner product between all the encoded representations, with <math alttext="Q_{M}^{Aug}" class="ltx_Math" display="inline" id="S2.F2.6.3.3.m3.1"><semantics id="S2.F2.6.3.3.m3.1b"><msubsup id="S2.F2.6.3.3.m3.1.1" xref="S2.F2.6.3.3.m3.1.1.cmml"><mi id="S2.F2.6.3.3.m3.1.1.2.2" xref="S2.F2.6.3.3.m3.1.1.2.2.cmml">Q</mi><mi id="S2.F2.6.3.3.m3.1.1.2.3" xref="S2.F2.6.3.3.m3.1.1.2.3.cmml">M</mi><mrow id="S2.F2.6.3.3.m3.1.1.3" xref="S2.F2.6.3.3.m3.1.1.3.cmml"><mi id="S2.F2.6.3.3.m3.1.1.3.2" xref="S2.F2.6.3.3.m3.1.1.3.2.cmml">A</mi><mo id="S2.F2.6.3.3.m3.1.1.3.1" xref="S2.F2.6.3.3.m3.1.1.3.1.cmml">â¢</mo><mi id="S2.F2.6.3.3.m3.1.1.3.3" xref="S2.F2.6.3.3.m3.1.1.3.3.cmml">u</mi><mo id="S2.F2.6.3.3.m3.1.1.3.1b" xref="S2.F2.6.3.3.m3.1.1.3.1.cmml">â¢</mo><mi id="S2.F2.6.3.3.m3.1.1.3.4" xref="S2.F2.6.3.3.m3.1.1.3.4.cmml">g</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.F2.6.3.3.m3.1c"><apply id="S2.F2.6.3.3.m3.1.1.cmml" xref="S2.F2.6.3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.F2.6.3.3.m3.1.1.1.cmml" xref="S2.F2.6.3.3.m3.1.1">superscript</csymbol><apply id="S2.F2.6.3.3.m3.1.1.2.cmml" xref="S2.F2.6.3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.F2.6.3.3.m3.1.1.2.1.cmml" xref="S2.F2.6.3.3.m3.1.1">subscript</csymbol><ci id="S2.F2.6.3.3.m3.1.1.2.2.cmml" xref="S2.F2.6.3.3.m3.1.1.2.2">ğ‘„</ci><ci id="S2.F2.6.3.3.m3.1.1.2.3.cmml" xref="S2.F2.6.3.3.m3.1.1.2.3">ğ‘€</ci></apply><apply id="S2.F2.6.3.3.m3.1.1.3.cmml" xref="S2.F2.6.3.3.m3.1.1.3"><times id="S2.F2.6.3.3.m3.1.1.3.1.cmml" xref="S2.F2.6.3.3.m3.1.1.3.1"></times><ci id="S2.F2.6.3.3.m3.1.1.3.2.cmml" xref="S2.F2.6.3.3.m3.1.1.3.2">ğ´</ci><ci id="S2.F2.6.3.3.m3.1.1.3.3.cmml" xref="S2.F2.6.3.3.m3.1.1.3.3">ğ‘¢</ci><ci id="S2.F2.6.3.3.m3.1.1.3.4.cmml" xref="S2.F2.6.3.3.m3.1.1.3.4">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.6.3.3.m3.1d">Q_{M}^{Aug}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.6.3.3.m3.1e">italic_Q start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_A italic_u italic_g end_POSTSUPERSCRIPT</annotation></semantics></math> as their average. The critic is trained to maximize the similarity between state-action and goal representations of the same trajectories, which corresponds to the diagonal of the matrices.</span></span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Goal-Conditioned Reinforcement Learning</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.12">The goal-conditioned navigation task is defined by: <math alttext="S" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">ğ‘†</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_S</annotation></semantics></math>, which represents the environmentâ€™s state, defined by the transducerâ€™s pose in the CT coordinate system; <math alttext="A" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">ğ´</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">A</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_A</annotation></semantics></math> is the set of TEE transducer movements, i.e. translation along the oesophagus, transducer rotation, the electronic rotation of the scanning plane and the left/right and retro/ante flexions; <math alttext="p(s_{t+1}|s_{t},a_{t})" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><mrow id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml">p</mi><mo id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml">â¢</mo><mrow id="S2.SS2.p1.3.m3.1.1.1.1" xref="S2.SS2.p1.3.m3.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.3.m3.1.1.1.1.1" xref="S2.SS2.p1.3.m3.1.1.1.1.1.cmml"><msub id="S2.SS2.p1.3.m3.1.1.1.1.1.4" xref="S2.SS2.p1.3.m3.1.1.1.1.1.4.cmml"><mi id="S2.SS2.p1.3.m3.1.1.1.1.1.4.2" xref="S2.SS2.p1.3.m3.1.1.1.1.1.4.2.cmml">s</mi><mrow id="S2.SS2.p1.3.m3.1.1.1.1.1.4.3" xref="S2.SS2.p1.3.m3.1.1.1.1.1.4.3.cmml"><mi id="S2.SS2.p1.3.m3.1.1.1.1.1.4.3.2" xref="S2.SS2.p1.3.m3.1.1.1.1.1.4.3.2.cmml">t</mi><mo id="S2.SS2.p1.3.m3.1.1.1.1.1.4.3.1" xref="S2.SS2.p1.3.m3.1.1.1.1.1.4.3.1.cmml">+</mo><mn id="S2.SS2.p1.3.m3.1.1.1.1.1.4.3.3" xref="S2.SS2.p1.3.m3.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S2.SS2.p1.3.m3.1.1.1.1.1.3" xref="S2.SS2.p1.3.m3.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.SS2.p1.3.m3.1.1.1.1.1.2.2" xref="S2.SS2.p1.3.m3.1.1.1.1.1.2.3.cmml"><msub id="S2.SS2.p1.3.m3.1.1.1.1.1.1.1.1" xref="S2.SS2.p1.3.m3.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p1.3.m3.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.SS2.p1.3.m3.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p1.3.m3.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p1.3.m3.1.1.1.1.1.2.2.3" xref="S2.SS2.p1.3.m3.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.SS2.p1.3.m3.1.1.1.1.1.2.2.2" xref="S2.SS2.p1.3.m3.1.1.1.1.1.2.2.2.cmml"><mi id="S2.SS2.p1.3.m3.1.1.1.1.1.2.2.2.2" xref="S2.SS2.p1.3.m3.1.1.1.1.1.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p1.3.m3.1.1.1.1.1.2.2.2.3" xref="S2.SS2.p1.3.m3.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S2.SS2.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><times id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2"></times><ci id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3">ğ‘</ci><apply id="S2.SS2.p1.3.m3.1.1.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.3">conditional</csymbol><apply id="S2.SS2.p1.3.m3.1.1.1.1.1.4.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.1.1.4.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.4">subscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.1.1.1.4.2.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.4.2">ğ‘ </ci><apply id="S2.SS2.p1.3.m3.1.1.1.1.1.4.3.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.4.3"><plus id="S2.SS2.p1.3.m3.1.1.1.1.1.4.3.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.4.3.1"></plus><ci id="S2.SS2.p1.3.m3.1.1.1.1.1.4.3.2.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.4.3.2">ğ‘¡</ci><cn id="S2.SS2.p1.3.m3.1.1.1.1.1.4.3.3.cmml" type="integer" xref="S2.SS2.p1.3.m3.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="S2.SS2.p1.3.m3.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.2.2"><apply id="S2.SS2.p1.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.1.1.1.2">ğ‘ </ci><ci id="S2.SS2.p1.3.m3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.1.1.1.3">ğ‘¡</ci></apply><apply id="S2.SS2.p1.3.m3.1.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.2.2.2.2">ğ‘</ci><ci id="S2.SS2.p1.3.m3.1.1.1.1.1.2.2.2.3.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.2.2.2.3">ğ‘¡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">p(s_{t+1}|s_{t},a_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">italic_p ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> are the transition probabilities between <math alttext="s_{t+1}" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.1"><semantics id="S2.SS2.p1.4.m4.1a"><msub id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml"><mi id="S2.SS2.p1.4.m4.1.1.2" xref="S2.SS2.p1.4.m4.1.1.2.cmml">s</mi><mrow id="S2.SS2.p1.4.m4.1.1.3" xref="S2.SS2.p1.4.m4.1.1.3.cmml"><mi id="S2.SS2.p1.4.m4.1.1.3.2" xref="S2.SS2.p1.4.m4.1.1.3.2.cmml">t</mi><mo id="S2.SS2.p1.4.m4.1.1.3.1" xref="S2.SS2.p1.4.m4.1.1.3.1.cmml">+</mo><mn id="S2.SS2.p1.4.m4.1.1.3.3" xref="S2.SS2.p1.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><apply id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p1.4.m4.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2">ğ‘ </ci><apply id="S2.SS2.p1.4.m4.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3"><plus id="S2.SS2.p1.4.m4.1.1.3.1.cmml" xref="S2.SS2.p1.4.m4.1.1.3.1"></plus><ci id="S2.SS2.p1.4.m4.1.1.3.2.cmml" xref="S2.SS2.p1.4.m4.1.1.3.2">ğ‘¡</ci><cn id="S2.SS2.p1.4.m4.1.1.3.3.cmml" type="integer" xref="S2.SS2.p1.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">s_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.1"><semantics id="S2.SS2.p1.5.m5.1a"><msub id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml"><mi id="S2.SS2.p1.5.m5.1.1.2" xref="S2.SS2.p1.5.m5.1.1.2.cmml">s</mi><mi id="S2.SS2.p1.5.m5.1.1.3" xref="S2.SS2.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><apply id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2">ğ‘ </ci><ci id="S2.SS2.p1.5.m5.1.1.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> after taking action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S2.SS2.p1.6.m6.1"><semantics id="S2.SS2.p1.6.m6.1a"><msub id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml"><mi id="S2.SS2.p1.6.m6.1.1.2" xref="S2.SS2.p1.6.m6.1.1.2.cmml">a</mi><mi id="S2.SS2.p1.6.m6.1.1.3" xref="S2.SS2.p1.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><apply id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m6.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.p1.6.m6.1.1.2.cmml" xref="S2.SS2.p1.6.m6.1.1.2">ğ‘</ci><ci id="S2.SS2.p1.6.m6.1.1.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.m6.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>; <math alttext="r_{g}(s,a)=(1-\gamma)p(s_{t+1}=s_{g}|s_{t},a_{t})" class="ltx_Math" display="inline" id="S2.SS2.p1.7.m7.4"><semantics id="S2.SS2.p1.7.m7.4a"><mrow id="S2.SS2.p1.7.m7.4.4" xref="S2.SS2.p1.7.m7.4.4.cmml"><mrow id="S2.SS2.p1.7.m7.4.4.4" xref="S2.SS2.p1.7.m7.4.4.4.cmml"><msub id="S2.SS2.p1.7.m7.4.4.4.2" xref="S2.SS2.p1.7.m7.4.4.4.2.cmml"><mi id="S2.SS2.p1.7.m7.4.4.4.2.2" xref="S2.SS2.p1.7.m7.4.4.4.2.2.cmml">r</mi><mi id="S2.SS2.p1.7.m7.4.4.4.2.3" xref="S2.SS2.p1.7.m7.4.4.4.2.3.cmml">g</mi></msub><mo id="S2.SS2.p1.7.m7.4.4.4.1" xref="S2.SS2.p1.7.m7.4.4.4.1.cmml">â¢</mo><mrow id="S2.SS2.p1.7.m7.4.4.4.3.2" xref="S2.SS2.p1.7.m7.4.4.4.3.1.cmml"><mo id="S2.SS2.p1.7.m7.4.4.4.3.2.1" stretchy="false" xref="S2.SS2.p1.7.m7.4.4.4.3.1.cmml">(</mo><mi id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml">s</mi><mo id="S2.SS2.p1.7.m7.4.4.4.3.2.2" xref="S2.SS2.p1.7.m7.4.4.4.3.1.cmml">,</mo><mi id="S2.SS2.p1.7.m7.2.2" xref="S2.SS2.p1.7.m7.2.2.cmml">a</mi><mo id="S2.SS2.p1.7.m7.4.4.4.3.2.3" stretchy="false" xref="S2.SS2.p1.7.m7.4.4.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.7.m7.4.4.3" xref="S2.SS2.p1.7.m7.4.4.3.cmml">=</mo><mrow id="S2.SS2.p1.7.m7.4.4.2" xref="S2.SS2.p1.7.m7.4.4.2.cmml"><mrow id="S2.SS2.p1.7.m7.3.3.1.1.1" xref="S2.SS2.p1.7.m7.3.3.1.1.1.1.cmml"><mo id="S2.SS2.p1.7.m7.3.3.1.1.1.2" stretchy="false" xref="S2.SS2.p1.7.m7.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.7.m7.3.3.1.1.1.1" xref="S2.SS2.p1.7.m7.3.3.1.1.1.1.cmml"><mn id="S2.SS2.p1.7.m7.3.3.1.1.1.1.2" xref="S2.SS2.p1.7.m7.3.3.1.1.1.1.2.cmml">1</mn><mo id="S2.SS2.p1.7.m7.3.3.1.1.1.1.1" xref="S2.SS2.p1.7.m7.3.3.1.1.1.1.1.cmml">âˆ’</mo><mi id="S2.SS2.p1.7.m7.3.3.1.1.1.1.3" xref="S2.SS2.p1.7.m7.3.3.1.1.1.1.3.cmml">Î³</mi></mrow><mo id="S2.SS2.p1.7.m7.3.3.1.1.1.3" stretchy="false" xref="S2.SS2.p1.7.m7.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS2.p1.7.m7.4.4.2.3" xref="S2.SS2.p1.7.m7.4.4.2.3.cmml">â¢</mo><mi id="S2.SS2.p1.7.m7.4.4.2.4" xref="S2.SS2.p1.7.m7.4.4.2.4.cmml">p</mi><mo id="S2.SS2.p1.7.m7.4.4.2.3a" xref="S2.SS2.p1.7.m7.4.4.2.3.cmml">â¢</mo><mrow id="S2.SS2.p1.7.m7.4.4.2.2.1" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.cmml"><mo id="S2.SS2.p1.7.m7.4.4.2.2.1.2" stretchy="false" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.cmml">(</mo><mrow id="S2.SS2.p1.7.m7.4.4.2.2.1.1" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.cmml"><msub id="S2.SS2.p1.7.m7.4.4.2.2.1.1.4" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.cmml"><mi id="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.2" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.2.cmml">s</mi><mrow id="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.3" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.3.cmml"><mi id="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.3.2" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.3.2.cmml">t</mi><mo id="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.3.1" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.3.1.cmml">+</mo><mn id="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.3.3" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS2.p1.7.m7.4.4.2.2.1.1.3" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.3.cmml">=</mo><mrow id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.cmml"><msub id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.4" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.4.cmml"><mi id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.4.2" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.4.2.cmml">s</mi><mi id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.4.3" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.4.3.cmml">g</mi></msub><mo fence="false" id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.3" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.3.cmml">|</mo><mrow id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.3.cmml"><msub id="S2.SS2.p1.7.m7.4.4.2.2.1.1.1.1.1.1" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.7.m7.4.4.2.2.1.1.1.1.1.1.2" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.SS2.p1.7.m7.4.4.2.2.1.1.1.1.1.1.3" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2.3" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.3.cmml">,</mo><msub id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2.2" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2.2.cmml"><mi id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2.2.2" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2.2.3" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2.2.3.cmml">t</mi></msub></mrow></mrow></mrow><mo id="S2.SS2.p1.7.m7.4.4.2.2.1.3" stretchy="false" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.4b"><apply id="S2.SS2.p1.7.m7.4.4.cmml" xref="S2.SS2.p1.7.m7.4.4"><eq id="S2.SS2.p1.7.m7.4.4.3.cmml" xref="S2.SS2.p1.7.m7.4.4.3"></eq><apply id="S2.SS2.p1.7.m7.4.4.4.cmml" xref="S2.SS2.p1.7.m7.4.4.4"><times id="S2.SS2.p1.7.m7.4.4.4.1.cmml" xref="S2.SS2.p1.7.m7.4.4.4.1"></times><apply id="S2.SS2.p1.7.m7.4.4.4.2.cmml" xref="S2.SS2.p1.7.m7.4.4.4.2"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.4.4.4.2.1.cmml" xref="S2.SS2.p1.7.m7.4.4.4.2">subscript</csymbol><ci id="S2.SS2.p1.7.m7.4.4.4.2.2.cmml" xref="S2.SS2.p1.7.m7.4.4.4.2.2">ğ‘Ÿ</ci><ci id="S2.SS2.p1.7.m7.4.4.4.2.3.cmml" xref="S2.SS2.p1.7.m7.4.4.4.2.3">ğ‘”</ci></apply><interval closure="open" id="S2.SS2.p1.7.m7.4.4.4.3.1.cmml" xref="S2.SS2.p1.7.m7.4.4.4.3.2"><ci id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">ğ‘ </ci><ci id="S2.SS2.p1.7.m7.2.2.cmml" xref="S2.SS2.p1.7.m7.2.2">ğ‘</ci></interval></apply><apply id="S2.SS2.p1.7.m7.4.4.2.cmml" xref="S2.SS2.p1.7.m7.4.4.2"><times id="S2.SS2.p1.7.m7.4.4.2.3.cmml" xref="S2.SS2.p1.7.m7.4.4.2.3"></times><apply id="S2.SS2.p1.7.m7.3.3.1.1.1.1.cmml" xref="S2.SS2.p1.7.m7.3.3.1.1.1"><minus id="S2.SS2.p1.7.m7.3.3.1.1.1.1.1.cmml" xref="S2.SS2.p1.7.m7.3.3.1.1.1.1.1"></minus><cn id="S2.SS2.p1.7.m7.3.3.1.1.1.1.2.cmml" type="integer" xref="S2.SS2.p1.7.m7.3.3.1.1.1.1.2">1</cn><ci id="S2.SS2.p1.7.m7.3.3.1.1.1.1.3.cmml" xref="S2.SS2.p1.7.m7.3.3.1.1.1.1.3">ğ›¾</ci></apply><ci id="S2.SS2.p1.7.m7.4.4.2.4.cmml" xref="S2.SS2.p1.7.m7.4.4.2.4">ğ‘</ci><apply id="S2.SS2.p1.7.m7.4.4.2.2.1.1.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1"><eq id="S2.SS2.p1.7.m7.4.4.2.2.1.1.3.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.3"></eq><apply id="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.1.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.4">subscript</csymbol><ci id="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.2.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.2">ğ‘ </ci><apply id="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.3.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.3"><plus id="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.3.1.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.3.1"></plus><ci id="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.3.2.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.3.2">ğ‘¡</ci><cn id="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.3.3.cmml" type="integer" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.4.3.3">1</cn></apply></apply><apply id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2"><csymbol cd="latexml" id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.3.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.3">conditional</csymbol><apply id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.4.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.4"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.4.1.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.4">subscript</csymbol><ci id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.4.2.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.4.2">ğ‘ </ci><ci id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.4.3.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.4.3">ğ‘”</ci></apply><list id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.3.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2"><apply id="S2.SS2.p1.7.m7.4.4.2.2.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.4.4.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.7.m7.4.4.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.1.1.1.1.2">ğ‘ </ci><ci id="S2.SS2.p1.7.m7.4.4.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.1.1.1.1.3">ğ‘¡</ci></apply><apply id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2.2.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2.2.1.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2.2.2.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2.2.2">ğ‘</ci><ci id="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2.2.3.cmml" xref="S2.SS2.p1.7.m7.4.4.2.2.1.1.2.2.2.2.3">ğ‘¡</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.4c">r_{g}(s,a)=(1-\gamma)p(s_{t+1}=s_{g}|s_{t},a_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.7.m7.4d">italic_r start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ( italic_s , italic_a ) = ( 1 - italic_Î³ ) italic_p ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = italic_s start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> is the goal-conditioned reward function, defined as the probability density of reaching the goal <math alttext="s_{g}" class="ltx_Math" display="inline" id="S2.SS2.p1.8.m8.1"><semantics id="S2.SS2.p1.8.m8.1a"><msub id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml"><mi id="S2.SS2.p1.8.m8.1.1.2" xref="S2.SS2.p1.8.m8.1.1.2.cmml">s</mi><mi id="S2.SS2.p1.8.m8.1.1.3" xref="S2.SS2.p1.8.m8.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.1b"><apply id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.1.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS2.p1.8.m8.1.1.2.cmml" xref="S2.SS2.p1.8.m8.1.1.2">ğ‘ </ci><ci id="S2.SS2.p1.8.m8.1.1.3.cmml" xref="S2.SS2.p1.8.m8.1.1.3">ğ‘”</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.1c">s_{g}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.8.m8.1d">italic_s start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> at the next step; <math alttext="\Omega" class="ltx_Math" display="inline" id="S2.SS2.p1.9.m9.1"><semantics id="S2.SS2.p1.9.m9.1a"><mi id="S2.SS2.p1.9.m9.1.1" mathvariant="normal" xref="S2.SS2.p1.9.m9.1.1.cmml">Î©</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m9.1b"><ci id="S2.SS2.p1.9.m9.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1">Î©</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m9.1c">\Omega</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.9.m9.1d">roman_Î©</annotation></semantics></math> is the set of observations <math alttext="o" class="ltx_Math" display="inline" id="S2.SS2.p1.10.m10.1"><semantics id="S2.SS2.p1.10.m10.1a"><mi id="S2.SS2.p1.10.m10.1.1" xref="S2.SS2.p1.10.m10.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m10.1b"><ci id="S2.SS2.p1.10.m10.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1">ğ‘œ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m10.1c">o</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.10.m10.1d">italic_o</annotation></semantics></math>, which correspond to ultrasound images acquired from the transducer in a given state <math alttext="s" class="ltx_Math" display="inline" id="S2.SS2.p1.11.m11.1"><semantics id="S2.SS2.p1.11.m11.1a"><mi id="S2.SS2.p1.11.m11.1.1" xref="S2.SS2.p1.11.m11.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m11.1b"><ci id="S2.SS2.p1.11.m11.1.1.cmml" xref="S2.SS2.p1.11.m11.1.1">ğ‘ </ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m11.1c">s</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.11.m11.1d">italic_s</annotation></semantics></math>; <math alttext="\gamma\in[0,1]" class="ltx_Math" display="inline" id="S2.SS2.p1.12.m12.2"><semantics id="S2.SS2.p1.12.m12.2a"><mrow id="S2.SS2.p1.12.m12.2.3" xref="S2.SS2.p1.12.m12.2.3.cmml"><mi id="S2.SS2.p1.12.m12.2.3.2" xref="S2.SS2.p1.12.m12.2.3.2.cmml">Î³</mi><mo id="S2.SS2.p1.12.m12.2.3.1" xref="S2.SS2.p1.12.m12.2.3.1.cmml">âˆˆ</mo><mrow id="S2.SS2.p1.12.m12.2.3.3.2" xref="S2.SS2.p1.12.m12.2.3.3.1.cmml"><mo id="S2.SS2.p1.12.m12.2.3.3.2.1" stretchy="false" xref="S2.SS2.p1.12.m12.2.3.3.1.cmml">[</mo><mn id="S2.SS2.p1.12.m12.1.1" xref="S2.SS2.p1.12.m12.1.1.cmml">0</mn><mo id="S2.SS2.p1.12.m12.2.3.3.2.2" xref="S2.SS2.p1.12.m12.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p1.12.m12.2.2" xref="S2.SS2.p1.12.m12.2.2.cmml">1</mn><mo id="S2.SS2.p1.12.m12.2.3.3.2.3" stretchy="false" xref="S2.SS2.p1.12.m12.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.m12.2b"><apply id="S2.SS2.p1.12.m12.2.3.cmml" xref="S2.SS2.p1.12.m12.2.3"><in id="S2.SS2.p1.12.m12.2.3.1.cmml" xref="S2.SS2.p1.12.m12.2.3.1"></in><ci id="S2.SS2.p1.12.m12.2.3.2.cmml" xref="S2.SS2.p1.12.m12.2.3.2">ğ›¾</ci><interval closure="closed" id="S2.SS2.p1.12.m12.2.3.3.1.cmml" xref="S2.SS2.p1.12.m12.2.3.3.2"><cn id="S2.SS2.p1.12.m12.1.1.cmml" type="integer" xref="S2.SS2.p1.12.m12.1.1">0</cn><cn id="S2.SS2.p1.12.m12.2.2.cmml" type="integer" xref="S2.SS2.p1.12.m12.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.12.m12.2c">\gamma\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.12.m12.2d">italic_Î³ âˆˆ [ 0 , 1 ]</annotation></semantics></math> the discount factor.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.6">Our goal-conditioned framework follows the actor-critic architecture, where the critic takes as input a triplet of (observation, action, goal) <math alttext="(o_{t},a_{t},o_{g})" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.3"><semantics id="S2.SS2.p2.1.m1.3a"><mrow id="S2.SS2.p2.1.m1.3.3.3" xref="S2.SS2.p2.1.m1.3.3.4.cmml"><mo id="S2.SS2.p2.1.m1.3.3.3.4" stretchy="false" xref="S2.SS2.p2.1.m1.3.3.4.cmml">(</mo><msub id="S2.SS2.p2.1.m1.1.1.1.1" xref="S2.SS2.p2.1.m1.1.1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.1.1.2.cmml">o</mi><mi id="S2.SS2.p2.1.m1.1.1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p2.1.m1.3.3.3.5" xref="S2.SS2.p2.1.m1.3.3.4.cmml">,</mo><msub id="S2.SS2.p2.1.m1.2.2.2.2" xref="S2.SS2.p2.1.m1.2.2.2.2.cmml"><mi id="S2.SS2.p2.1.m1.2.2.2.2.2" xref="S2.SS2.p2.1.m1.2.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p2.1.m1.2.2.2.2.3" xref="S2.SS2.p2.1.m1.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS2.p2.1.m1.3.3.3.6" xref="S2.SS2.p2.1.m1.3.3.4.cmml">,</mo><msub id="S2.SS2.p2.1.m1.3.3.3.3" xref="S2.SS2.p2.1.m1.3.3.3.3.cmml"><mi id="S2.SS2.p2.1.m1.3.3.3.3.2" xref="S2.SS2.p2.1.m1.3.3.3.3.2.cmml">o</mi><mi id="S2.SS2.p2.1.m1.3.3.3.3.3" xref="S2.SS2.p2.1.m1.3.3.3.3.3.cmml">g</mi></msub><mo id="S2.SS2.p2.1.m1.3.3.3.7" stretchy="false" xref="S2.SS2.p2.1.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.3b"><vector id="S2.SS2.p2.1.m1.3.3.4.cmml" xref="S2.SS2.p2.1.m1.3.3.3"><apply id="S2.SS2.p2.1.m1.1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p2.1.m1.1.1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.3">ğ‘¡</ci></apply><apply id="S2.SS2.p2.1.m1.2.2.2.2.cmml" xref="S2.SS2.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.2.2.2.2.1.cmml" xref="S2.SS2.p2.1.m1.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.1.m1.2.2.2.2.2.cmml" xref="S2.SS2.p2.1.m1.2.2.2.2.2">ğ‘</ci><ci id="S2.SS2.p2.1.m1.2.2.2.2.3.cmml" xref="S2.SS2.p2.1.m1.2.2.2.2.3">ğ‘¡</ci></apply><apply id="S2.SS2.p2.1.m1.3.3.3.3.cmml" xref="S2.SS2.p2.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.3.3.3.3.1.cmml" xref="S2.SS2.p2.1.m1.3.3.3.3">subscript</csymbol><ci id="S2.SS2.p2.1.m1.3.3.3.3.2.cmml" xref="S2.SS2.p2.1.m1.3.3.3.3.2">ğ‘œ</ci><ci id="S2.SS2.p2.1.m1.3.3.3.3.3.cmml" xref="S2.SS2.p2.1.m1.3.3.3.3.3">ğ‘”</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.3c">(o_{t},a_{t},o_{g})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.3d">( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT )</annotation></semantics></math> and returns the probability (density) of reaching goal <math alttext="o_{g}" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><msub id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">o</mi><mi id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">ğ‘”</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">o_{g}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> when taking action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m3.1"><semantics id="S2.SS2.p2.3.m3.1a"><msub id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mi id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml">a</mi><mi id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2">ğ‘</ci><ci id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> when given an observation <math alttext="o_{t}" class="ltx_Math" display="inline" id="S2.SS2.p2.4.m4.1"><semantics id="S2.SS2.p2.4.m4.1a"><msub id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">o</mi><mi id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m4.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. The actor takes as input a pair <math alttext="(o_{t},o_{g})" class="ltx_Math" display="inline" id="S2.SS2.p2.5.m5.2"><semantics id="S2.SS2.p2.5.m5.2a"><mrow id="S2.SS2.p2.5.m5.2.2.2" xref="S2.SS2.p2.5.m5.2.2.3.cmml"><mo id="S2.SS2.p2.5.m5.2.2.2.3" stretchy="false" xref="S2.SS2.p2.5.m5.2.2.3.cmml">(</mo><msub id="S2.SS2.p2.5.m5.1.1.1.1" xref="S2.SS2.p2.5.m5.1.1.1.1.cmml"><mi id="S2.SS2.p2.5.m5.1.1.1.1.2" xref="S2.SS2.p2.5.m5.1.1.1.1.2.cmml">o</mi><mi id="S2.SS2.p2.5.m5.1.1.1.1.3" xref="S2.SS2.p2.5.m5.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p2.5.m5.2.2.2.4" xref="S2.SS2.p2.5.m5.2.2.3.cmml">,</mo><msub id="S2.SS2.p2.5.m5.2.2.2.2" xref="S2.SS2.p2.5.m5.2.2.2.2.cmml"><mi id="S2.SS2.p2.5.m5.2.2.2.2.2" xref="S2.SS2.p2.5.m5.2.2.2.2.2.cmml">o</mi><mi id="S2.SS2.p2.5.m5.2.2.2.2.3" xref="S2.SS2.p2.5.m5.2.2.2.2.3.cmml">g</mi></msub><mo id="S2.SS2.p2.5.m5.2.2.2.5" stretchy="false" xref="S2.SS2.p2.5.m5.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.2b"><interval closure="open" id="S2.SS2.p2.5.m5.2.2.3.cmml" xref="S2.SS2.p2.5.m5.2.2.2"><apply id="S2.SS2.p2.5.m5.1.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.1.1.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.5.m5.1.1.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p2.5.m5.1.1.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.3">ğ‘¡</ci></apply><apply id="S2.SS2.p2.5.m5.2.2.2.2.cmml" xref="S2.SS2.p2.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.2.2.2.2.1.cmml" xref="S2.SS2.p2.5.m5.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.5.m5.2.2.2.2.2.cmml" xref="S2.SS2.p2.5.m5.2.2.2.2.2">ğ‘œ</ci><ci id="S2.SS2.p2.5.m5.2.2.2.2.3.cmml" xref="S2.SS2.p2.5.m5.2.2.2.2.3">ğ‘”</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.2c">(o_{t},o_{g})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.5.m5.2d">( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT )</annotation></semantics></math> and returns the action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S2.SS2.p2.6.m6.1"><semantics id="S2.SS2.p2.6.m6.1a"><msub id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml"><mi id="S2.SS2.p2.6.m6.1.1.2" xref="S2.SS2.p2.6.m6.1.1.2.cmml">a</mi><mi id="S2.SS2.p2.6.m6.1.1.3" xref="S2.SS2.p2.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.1b"><apply id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m6.1.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.p2.6.m6.1.1.2.cmml" xref="S2.SS2.p2.6.m6.1.1.2">ğ‘</ci><ci id="S2.SS2.p2.6.m6.1.1.3.cmml" xref="S2.SS2.p2.6.m6.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.6.m6.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to take to reach the goal. The critic is trained to correctly predict which actions lead to a goal, and the actor learns to output correct actions by maximizing the criticâ€™s output.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.6">Similarly to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib11" title="">11</a>]</cite>, contrastive learning is used to train a critic function by making use of two models <math alttext="\phi" class="ltx_Math" display="inline" id="S2.SS2.p3.1.m1.1"><semantics id="S2.SS2.p3.1.m1.1a"><mi id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><ci id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.1.m1.1d">italic_Ï•</annotation></semantics></math> and <math alttext="\psi" class="ltx_Math" display="inline" id="S2.SS2.p3.2.m2.1"><semantics id="S2.SS2.p3.2.m2.1a"><mi id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">Ïˆ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">ğœ“</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.2.m2.1d">italic_Ïˆ</annotation></semantics></math> which encode state-action (SA) pairs <math alttext="(o_{t},a_{t})" class="ltx_Math" display="inline" id="S2.SS2.p3.3.m3.2"><semantics id="S2.SS2.p3.3.m3.2a"><mrow id="S2.SS2.p3.3.m3.2.2.2" xref="S2.SS2.p3.3.m3.2.2.3.cmml"><mo id="S2.SS2.p3.3.m3.2.2.2.3" stretchy="false" xref="S2.SS2.p3.3.m3.2.2.3.cmml">(</mo><msub id="S2.SS2.p3.3.m3.1.1.1.1" xref="S2.SS2.p3.3.m3.1.1.1.1.cmml"><mi id="S2.SS2.p3.3.m3.1.1.1.1.2" xref="S2.SS2.p3.3.m3.1.1.1.1.2.cmml">o</mi><mi id="S2.SS2.p3.3.m3.1.1.1.1.3" xref="S2.SS2.p3.3.m3.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p3.3.m3.2.2.2.4" xref="S2.SS2.p3.3.m3.2.2.3.cmml">,</mo><msub id="S2.SS2.p3.3.m3.2.2.2.2" xref="S2.SS2.p3.3.m3.2.2.2.2.cmml"><mi id="S2.SS2.p3.3.m3.2.2.2.2.2" xref="S2.SS2.p3.3.m3.2.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p3.3.m3.2.2.2.2.3" xref="S2.SS2.p3.3.m3.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS2.p3.3.m3.2.2.2.5" stretchy="false" xref="S2.SS2.p3.3.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.2b"><interval closure="open" id="S2.SS2.p3.3.m3.2.2.3.cmml" xref="S2.SS2.p3.3.m3.2.2.2"><apply id="S2.SS2.p3.3.m3.1.1.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.1.1.1.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p3.3.m3.1.1.1.1.2.cmml" xref="S2.SS2.p3.3.m3.1.1.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p3.3.m3.1.1.1.1.3.cmml" xref="S2.SS2.p3.3.m3.1.1.1.1.3">ğ‘¡</ci></apply><apply id="S2.SS2.p3.3.m3.2.2.2.2.cmml" xref="S2.SS2.p3.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.2.2.2.2.1.cmml" xref="S2.SS2.p3.3.m3.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p3.3.m3.2.2.2.2.2.cmml" xref="S2.SS2.p3.3.m3.2.2.2.2.2">ğ‘</ci><ci id="S2.SS2.p3.3.m3.2.2.2.2.3.cmml" xref="S2.SS2.p3.3.m3.2.2.2.2.3">ğ‘¡</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.2c">(o_{t},a_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.3.m3.2d">( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> and goals <math alttext="o_{g}" class="ltx_Math" display="inline" id="S2.SS2.p3.4.m4.1"><semantics id="S2.SS2.p3.4.m4.1a"><msub id="S2.SS2.p3.4.m4.1.1" xref="S2.SS2.p3.4.m4.1.1.cmml"><mi id="S2.SS2.p3.4.m4.1.1.2" xref="S2.SS2.p3.4.m4.1.1.2.cmml">o</mi><mi id="S2.SS2.p3.4.m4.1.1.3" xref="S2.SS2.p3.4.m4.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m4.1b"><apply id="S2.SS2.p3.4.m4.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.4.m4.1.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p3.4.m4.1.1.2.cmml" xref="S2.SS2.p3.4.m4.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p3.4.m4.1.1.3.cmml" xref="S2.SS2.p3.4.m4.1.1.3">ğ‘”</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m4.1c">o_{g}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.4.m4.1d">italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> respectively. The critic function measures the similarity of the latent representations of dimension <math alttext="H" class="ltx_Math" display="inline" id="S2.SS2.p3.5.m5.1"><semantics id="S2.SS2.p3.5.m5.1a"><mi id="S2.SS2.p3.5.m5.1.1" xref="S2.SS2.p3.5.m5.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.5.m5.1b"><ci id="S2.SS2.p3.5.m5.1.1.cmml" xref="S2.SS2.p3.5.m5.1.1">ğ»</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.5.m5.1c">H</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.5.m5.1d">italic_H</annotation></semantics></math> via inner-product <math alttext="f(o_{t},a_{t},o_{g})=\langle\phi(o_{t},a_{t}),\psi(o_{g})\rangle" class="ltx_Math" display="inline" id="S2.SS2.p3.6.m6.5"><semantics id="S2.SS2.p3.6.m6.5a"><mrow id="S2.SS2.p3.6.m6.5.5" xref="S2.SS2.p3.6.m6.5.5.cmml"><mrow id="S2.SS2.p3.6.m6.3.3.3" xref="S2.SS2.p3.6.m6.3.3.3.cmml"><mi id="S2.SS2.p3.6.m6.3.3.3.5" xref="S2.SS2.p3.6.m6.3.3.3.5.cmml">f</mi><mo id="S2.SS2.p3.6.m6.3.3.3.4" xref="S2.SS2.p3.6.m6.3.3.3.4.cmml">â¢</mo><mrow id="S2.SS2.p3.6.m6.3.3.3.3.3" xref="S2.SS2.p3.6.m6.3.3.3.3.4.cmml"><mo id="S2.SS2.p3.6.m6.3.3.3.3.3.4" stretchy="false" xref="S2.SS2.p3.6.m6.3.3.3.3.4.cmml">(</mo><msub id="S2.SS2.p3.6.m6.1.1.1.1.1.1" xref="S2.SS2.p3.6.m6.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p3.6.m6.1.1.1.1.1.1.2" xref="S2.SS2.p3.6.m6.1.1.1.1.1.1.2.cmml">o</mi><mi id="S2.SS2.p3.6.m6.1.1.1.1.1.1.3" xref="S2.SS2.p3.6.m6.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p3.6.m6.3.3.3.3.3.5" xref="S2.SS2.p3.6.m6.3.3.3.3.4.cmml">,</mo><msub id="S2.SS2.p3.6.m6.2.2.2.2.2.2" xref="S2.SS2.p3.6.m6.2.2.2.2.2.2.cmml"><mi id="S2.SS2.p3.6.m6.2.2.2.2.2.2.2" xref="S2.SS2.p3.6.m6.2.2.2.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p3.6.m6.2.2.2.2.2.2.3" xref="S2.SS2.p3.6.m6.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS2.p3.6.m6.3.3.3.3.3.6" xref="S2.SS2.p3.6.m6.3.3.3.3.4.cmml">,</mo><msub id="S2.SS2.p3.6.m6.3.3.3.3.3.3" xref="S2.SS2.p3.6.m6.3.3.3.3.3.3.cmml"><mi id="S2.SS2.p3.6.m6.3.3.3.3.3.3.2" xref="S2.SS2.p3.6.m6.3.3.3.3.3.3.2.cmml">o</mi><mi id="S2.SS2.p3.6.m6.3.3.3.3.3.3.3" xref="S2.SS2.p3.6.m6.3.3.3.3.3.3.3.cmml">g</mi></msub><mo id="S2.SS2.p3.6.m6.3.3.3.3.3.7" stretchy="false" xref="S2.SS2.p3.6.m6.3.3.3.3.4.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p3.6.m6.5.5.6" xref="S2.SS2.p3.6.m6.5.5.6.cmml">=</mo><mrow id="S2.SS2.p3.6.m6.5.5.5.2" xref="S2.SS2.p3.6.m6.5.5.5.3.cmml"><mo id="S2.SS2.p3.6.m6.5.5.5.2.3" stretchy="false" xref="S2.SS2.p3.6.m6.5.5.5.3.cmml">âŸ¨</mo><mrow id="S2.SS2.p3.6.m6.4.4.4.1.1" xref="S2.SS2.p3.6.m6.4.4.4.1.1.cmml"><mi id="S2.SS2.p3.6.m6.4.4.4.1.1.4" xref="S2.SS2.p3.6.m6.4.4.4.1.1.4.cmml">Ï•</mi><mo id="S2.SS2.p3.6.m6.4.4.4.1.1.3" xref="S2.SS2.p3.6.m6.4.4.4.1.1.3.cmml">â¢</mo><mrow id="S2.SS2.p3.6.m6.4.4.4.1.1.2.2" xref="S2.SS2.p3.6.m6.4.4.4.1.1.2.3.cmml"><mo id="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.3" stretchy="false" xref="S2.SS2.p3.6.m6.4.4.4.1.1.2.3.cmml">(</mo><msub id="S2.SS2.p3.6.m6.4.4.4.1.1.1.1.1" xref="S2.SS2.p3.6.m6.4.4.4.1.1.1.1.1.cmml"><mi id="S2.SS2.p3.6.m6.4.4.4.1.1.1.1.1.2" xref="S2.SS2.p3.6.m6.4.4.4.1.1.1.1.1.2.cmml">o</mi><mi id="S2.SS2.p3.6.m6.4.4.4.1.1.1.1.1.3" xref="S2.SS2.p3.6.m6.4.4.4.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.4" xref="S2.SS2.p3.6.m6.4.4.4.1.1.2.3.cmml">,</mo><msub id="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.2" xref="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.2.cmml"><mi id="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.2.2" xref="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.2.3" xref="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.5" stretchy="false" xref="S2.SS2.p3.6.m6.4.4.4.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p3.6.m6.5.5.5.2.4" xref="S2.SS2.p3.6.m6.5.5.5.3.cmml">,</mo><mrow id="S2.SS2.p3.6.m6.5.5.5.2.2" xref="S2.SS2.p3.6.m6.5.5.5.2.2.cmml"><mi id="S2.SS2.p3.6.m6.5.5.5.2.2.3" xref="S2.SS2.p3.6.m6.5.5.5.2.2.3.cmml">Ïˆ</mi><mo id="S2.SS2.p3.6.m6.5.5.5.2.2.2" xref="S2.SS2.p3.6.m6.5.5.5.2.2.2.cmml">â¢</mo><mrow id="S2.SS2.p3.6.m6.5.5.5.2.2.1.1" xref="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.1.cmml"><mo id="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.2" stretchy="false" xref="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.1.cmml">(</mo><msub id="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.1" xref="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.1.cmml"><mi id="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.1.2" xref="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.1.2.cmml">o</mi><mi id="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.1.3" xref="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.1.3.cmml">g</mi></msub><mo id="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.3" stretchy="false" xref="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p3.6.m6.5.5.5.2.5" stretchy="false" xref="S2.SS2.p3.6.m6.5.5.5.3.cmml">âŸ©</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.6.m6.5b"><apply id="S2.SS2.p3.6.m6.5.5.cmml" xref="S2.SS2.p3.6.m6.5.5"><eq id="S2.SS2.p3.6.m6.5.5.6.cmml" xref="S2.SS2.p3.6.m6.5.5.6"></eq><apply id="S2.SS2.p3.6.m6.3.3.3.cmml" xref="S2.SS2.p3.6.m6.3.3.3"><times id="S2.SS2.p3.6.m6.3.3.3.4.cmml" xref="S2.SS2.p3.6.m6.3.3.3.4"></times><ci id="S2.SS2.p3.6.m6.3.3.3.5.cmml" xref="S2.SS2.p3.6.m6.3.3.3.5">ğ‘“</ci><vector id="S2.SS2.p3.6.m6.3.3.3.3.4.cmml" xref="S2.SS2.p3.6.m6.3.3.3.3.3"><apply id="S2.SS2.p3.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.6.m6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m6.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.6.m6.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p3.6.m6.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p3.6.m6.1.1.1.1.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p3.6.m6.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p3.6.m6.1.1.1.1.1.1.3">ğ‘¡</ci></apply><apply id="S2.SS2.p3.6.m6.2.2.2.2.2.2.cmml" xref="S2.SS2.p3.6.m6.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m6.2.2.2.2.2.2.1.cmml" xref="S2.SS2.p3.6.m6.2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p3.6.m6.2.2.2.2.2.2.2.cmml" xref="S2.SS2.p3.6.m6.2.2.2.2.2.2.2">ğ‘</ci><ci id="S2.SS2.p3.6.m6.2.2.2.2.2.2.3.cmml" xref="S2.SS2.p3.6.m6.2.2.2.2.2.2.3">ğ‘¡</ci></apply><apply id="S2.SS2.p3.6.m6.3.3.3.3.3.3.cmml" xref="S2.SS2.p3.6.m6.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m6.3.3.3.3.3.3.1.cmml" xref="S2.SS2.p3.6.m6.3.3.3.3.3.3">subscript</csymbol><ci id="S2.SS2.p3.6.m6.3.3.3.3.3.3.2.cmml" xref="S2.SS2.p3.6.m6.3.3.3.3.3.3.2">ğ‘œ</ci><ci id="S2.SS2.p3.6.m6.3.3.3.3.3.3.3.cmml" xref="S2.SS2.p3.6.m6.3.3.3.3.3.3.3">ğ‘”</ci></apply></vector></apply><list id="S2.SS2.p3.6.m6.5.5.5.3.cmml" xref="S2.SS2.p3.6.m6.5.5.5.2"><apply id="S2.SS2.p3.6.m6.4.4.4.1.1.cmml" xref="S2.SS2.p3.6.m6.4.4.4.1.1"><times id="S2.SS2.p3.6.m6.4.4.4.1.1.3.cmml" xref="S2.SS2.p3.6.m6.4.4.4.1.1.3"></times><ci id="S2.SS2.p3.6.m6.4.4.4.1.1.4.cmml" xref="S2.SS2.p3.6.m6.4.4.4.1.1.4">italic-Ï•</ci><interval closure="open" id="S2.SS2.p3.6.m6.4.4.4.1.1.2.3.cmml" xref="S2.SS2.p3.6.m6.4.4.4.1.1.2.2"><apply id="S2.SS2.p3.6.m6.4.4.4.1.1.1.1.1.cmml" xref="S2.SS2.p3.6.m6.4.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m6.4.4.4.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.6.m6.4.4.4.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p3.6.m6.4.4.4.1.1.1.1.1.2.cmml" xref="S2.SS2.p3.6.m6.4.4.4.1.1.1.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p3.6.m6.4.4.4.1.1.1.1.1.3.cmml" xref="S2.SS2.p3.6.m6.4.4.4.1.1.1.1.1.3">ğ‘¡</ci></apply><apply id="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.2.cmml" xref="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.2.1.cmml" xref="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.2">subscript</csymbol><ci id="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.2.2.cmml" xref="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.2.2">ğ‘</ci><ci id="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.2.3.cmml" xref="S2.SS2.p3.6.m6.4.4.4.1.1.2.2.2.3">ğ‘¡</ci></apply></interval></apply><apply id="S2.SS2.p3.6.m6.5.5.5.2.2.cmml" xref="S2.SS2.p3.6.m6.5.5.5.2.2"><times id="S2.SS2.p3.6.m6.5.5.5.2.2.2.cmml" xref="S2.SS2.p3.6.m6.5.5.5.2.2.2"></times><ci id="S2.SS2.p3.6.m6.5.5.5.2.2.3.cmml" xref="S2.SS2.p3.6.m6.5.5.5.2.2.3">ğœ“</ci><apply id="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.1.cmml" xref="S2.SS2.p3.6.m6.5.5.5.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.1.1.cmml" xref="S2.SS2.p3.6.m6.5.5.5.2.2.1.1">subscript</csymbol><ci id="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.1.2.cmml" xref="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.1.3.cmml" xref="S2.SS2.p3.6.m6.5.5.5.2.2.1.1.1.3">ğ‘”</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.6.m6.5c">f(o_{t},a_{t},o_{g})=\langle\phi(o_{t},a_{t}),\psi(o_{g})\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.6.m6.5d">italic_f ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ) = âŸ¨ italic_Ï• ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) , italic_Ïˆ ( italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ) âŸ©</annotation></semantics></math>, as illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#S2.F2" title="Figure 2 â€£ 2.1 Simulation environment â€£ 2 Methodology â€£ Goal-conditioned reinforcement learning for ultrasound navigation guidance"><span class="ltx_text ltx_ref_tag">2</span></a>. When an action likely leads to a goal from a given pose, the inner product will have a high value, indicating the probability (density) of reaching the goal is high.</p>
</div>
<div class="ltx_para" id="S2.SS2.p4">
<p class="ltx_p" id="S2.SS2.p4.4">During training, the transducer is initialized at a given pose <math alttext="s_{0}" class="ltx_Math" display="inline" id="S2.SS2.p4.1.m1.1"><semantics id="S2.SS2.p4.1.m1.1a"><msub id="S2.SS2.p4.1.m1.1.1" xref="S2.SS2.p4.1.m1.1.1.cmml"><mi id="S2.SS2.p4.1.m1.1.1.2" xref="S2.SS2.p4.1.m1.1.1.2.cmml">s</mi><mn id="S2.SS2.p4.1.m1.1.1.3" xref="S2.SS2.p4.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.m1.1b"><apply id="S2.SS2.p4.1.m1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.1.m1.1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p4.1.m1.1.1.2.cmml" xref="S2.SS2.p4.1.m1.1.1.2">ğ‘ </ci><cn id="S2.SS2.p4.1.m1.1.1.3.cmml" type="integer" xref="S2.SS2.p4.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.m1.1c">s_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p4.1.m1.1d">italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> (yielding observation <math alttext="o_{0}" class="ltx_Math" display="inline" id="S2.SS2.p4.2.m2.1"><semantics id="S2.SS2.p4.2.m2.1a"><msub id="S2.SS2.p4.2.m2.1.1" xref="S2.SS2.p4.2.m2.1.1.cmml"><mi id="S2.SS2.p4.2.m2.1.1.2" xref="S2.SS2.p4.2.m2.1.1.2.cmml">o</mi><mn id="S2.SS2.p4.2.m2.1.1.3" xref="S2.SS2.p4.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.2.m2.1b"><apply id="S2.SS2.p4.2.m2.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.1.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p4.2.m2.1.1.2.cmml" xref="S2.SS2.p4.2.m2.1.1.2">ğ‘œ</ci><cn id="S2.SS2.p4.2.m2.1.1.3.cmml" type="integer" xref="S2.SS2.p4.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.2.m2.1c">o_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p4.2.m2.1d">italic_o start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>) and is given a goal observation <math alttext="o_{g}" class="ltx_Math" display="inline" id="S2.SS2.p4.3.m3.1"><semantics id="S2.SS2.p4.3.m3.1a"><msub id="S2.SS2.p4.3.m3.1.1" xref="S2.SS2.p4.3.m3.1.1.cmml"><mi id="S2.SS2.p4.3.m3.1.1.2" xref="S2.SS2.p4.3.m3.1.1.2.cmml">o</mi><mi id="S2.SS2.p4.3.m3.1.1.3" xref="S2.SS2.p4.3.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.3.m3.1b"><apply id="S2.SS2.p4.3.m3.1.1.cmml" xref="S2.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.3.m3.1.1.1.cmml" xref="S2.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p4.3.m3.1.1.2.cmml" xref="S2.SS2.p4.3.m3.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p4.3.m3.1.1.3.cmml" xref="S2.SS2.p4.3.m3.1.1.3">ğ‘”</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.3.m3.1c">o_{g}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p4.3.m3.1d">italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>. The sequence of observations/actions until the last timestep gives a trajectory <math alttext="\tau_{i}=(o_{0}^{i},a_{0}^{i},o_{1}^{i},...,o_{n}^{i})" class="ltx_Math" display="inline" id="S2.SS2.p4.4.m4.5"><semantics id="S2.SS2.p4.4.m4.5a"><mrow id="S2.SS2.p4.4.m4.5.5" xref="S2.SS2.p4.4.m4.5.5.cmml"><msub id="S2.SS2.p4.4.m4.5.5.6" xref="S2.SS2.p4.4.m4.5.5.6.cmml"><mi id="S2.SS2.p4.4.m4.5.5.6.2" xref="S2.SS2.p4.4.m4.5.5.6.2.cmml">Ï„</mi><mi id="S2.SS2.p4.4.m4.5.5.6.3" xref="S2.SS2.p4.4.m4.5.5.6.3.cmml">i</mi></msub><mo id="S2.SS2.p4.4.m4.5.5.5" xref="S2.SS2.p4.4.m4.5.5.5.cmml">=</mo><mrow id="S2.SS2.p4.4.m4.5.5.4.4" xref="S2.SS2.p4.4.m4.5.5.4.5.cmml"><mo id="S2.SS2.p4.4.m4.5.5.4.4.5" stretchy="false" xref="S2.SS2.p4.4.m4.5.5.4.5.cmml">(</mo><msubsup id="S2.SS2.p4.4.m4.2.2.1.1.1" xref="S2.SS2.p4.4.m4.2.2.1.1.1.cmml"><mi id="S2.SS2.p4.4.m4.2.2.1.1.1.2.2" xref="S2.SS2.p4.4.m4.2.2.1.1.1.2.2.cmml">o</mi><mn id="S2.SS2.p4.4.m4.2.2.1.1.1.2.3" xref="S2.SS2.p4.4.m4.2.2.1.1.1.2.3.cmml">0</mn><mi id="S2.SS2.p4.4.m4.2.2.1.1.1.3" xref="S2.SS2.p4.4.m4.2.2.1.1.1.3.cmml">i</mi></msubsup><mo id="S2.SS2.p4.4.m4.5.5.4.4.6" xref="S2.SS2.p4.4.m4.5.5.4.5.cmml">,</mo><msubsup id="S2.SS2.p4.4.m4.3.3.2.2.2" xref="S2.SS2.p4.4.m4.3.3.2.2.2.cmml"><mi id="S2.SS2.p4.4.m4.3.3.2.2.2.2.2" xref="S2.SS2.p4.4.m4.3.3.2.2.2.2.2.cmml">a</mi><mn id="S2.SS2.p4.4.m4.3.3.2.2.2.2.3" xref="S2.SS2.p4.4.m4.3.3.2.2.2.2.3.cmml">0</mn><mi id="S2.SS2.p4.4.m4.3.3.2.2.2.3" xref="S2.SS2.p4.4.m4.3.3.2.2.2.3.cmml">i</mi></msubsup><mo id="S2.SS2.p4.4.m4.5.5.4.4.7" xref="S2.SS2.p4.4.m4.5.5.4.5.cmml">,</mo><msubsup id="S2.SS2.p4.4.m4.4.4.3.3.3" xref="S2.SS2.p4.4.m4.4.4.3.3.3.cmml"><mi id="S2.SS2.p4.4.m4.4.4.3.3.3.2.2" xref="S2.SS2.p4.4.m4.4.4.3.3.3.2.2.cmml">o</mi><mn id="S2.SS2.p4.4.m4.4.4.3.3.3.2.3" xref="S2.SS2.p4.4.m4.4.4.3.3.3.2.3.cmml">1</mn><mi id="S2.SS2.p4.4.m4.4.4.3.3.3.3" xref="S2.SS2.p4.4.m4.4.4.3.3.3.3.cmml">i</mi></msubsup><mo id="S2.SS2.p4.4.m4.5.5.4.4.8" xref="S2.SS2.p4.4.m4.5.5.4.5.cmml">,</mo><mi id="S2.SS2.p4.4.m4.1.1" mathvariant="normal" xref="S2.SS2.p4.4.m4.1.1.cmml">â€¦</mi><mo id="S2.SS2.p4.4.m4.5.5.4.4.9" xref="S2.SS2.p4.4.m4.5.5.4.5.cmml">,</mo><msubsup id="S2.SS2.p4.4.m4.5.5.4.4.4" xref="S2.SS2.p4.4.m4.5.5.4.4.4.cmml"><mi id="S2.SS2.p4.4.m4.5.5.4.4.4.2.2" xref="S2.SS2.p4.4.m4.5.5.4.4.4.2.2.cmml">o</mi><mi id="S2.SS2.p4.4.m4.5.5.4.4.4.2.3" xref="S2.SS2.p4.4.m4.5.5.4.4.4.2.3.cmml">n</mi><mi id="S2.SS2.p4.4.m4.5.5.4.4.4.3" xref="S2.SS2.p4.4.m4.5.5.4.4.4.3.cmml">i</mi></msubsup><mo id="S2.SS2.p4.4.m4.5.5.4.4.10" stretchy="false" xref="S2.SS2.p4.4.m4.5.5.4.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.4.m4.5b"><apply id="S2.SS2.p4.4.m4.5.5.cmml" xref="S2.SS2.p4.4.m4.5.5"><eq id="S2.SS2.p4.4.m4.5.5.5.cmml" xref="S2.SS2.p4.4.m4.5.5.5"></eq><apply id="S2.SS2.p4.4.m4.5.5.6.cmml" xref="S2.SS2.p4.4.m4.5.5.6"><csymbol cd="ambiguous" id="S2.SS2.p4.4.m4.5.5.6.1.cmml" xref="S2.SS2.p4.4.m4.5.5.6">subscript</csymbol><ci id="S2.SS2.p4.4.m4.5.5.6.2.cmml" xref="S2.SS2.p4.4.m4.5.5.6.2">ğœ</ci><ci id="S2.SS2.p4.4.m4.5.5.6.3.cmml" xref="S2.SS2.p4.4.m4.5.5.6.3">ğ‘–</ci></apply><vector id="S2.SS2.p4.4.m4.5.5.4.5.cmml" xref="S2.SS2.p4.4.m4.5.5.4.4"><apply id="S2.SS2.p4.4.m4.2.2.1.1.1.cmml" xref="S2.SS2.p4.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS2.p4.4.m4.2.2.1.1.1">superscript</csymbol><apply id="S2.SS2.p4.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS2.p4.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.4.m4.2.2.1.1.1.2.1.cmml" xref="S2.SS2.p4.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p4.4.m4.2.2.1.1.1.2.2.cmml" xref="S2.SS2.p4.4.m4.2.2.1.1.1.2.2">ğ‘œ</ci><cn id="S2.SS2.p4.4.m4.2.2.1.1.1.2.3.cmml" type="integer" xref="S2.SS2.p4.4.m4.2.2.1.1.1.2.3">0</cn></apply><ci id="S2.SS2.p4.4.m4.2.2.1.1.1.3.cmml" xref="S2.SS2.p4.4.m4.2.2.1.1.1.3">ğ‘–</ci></apply><apply id="S2.SS2.p4.4.m4.3.3.2.2.2.cmml" xref="S2.SS2.p4.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p4.4.m4.3.3.2.2.2.1.cmml" xref="S2.SS2.p4.4.m4.3.3.2.2.2">superscript</csymbol><apply id="S2.SS2.p4.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS2.p4.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p4.4.m4.3.3.2.2.2.2.1.cmml" xref="S2.SS2.p4.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p4.4.m4.3.3.2.2.2.2.2.cmml" xref="S2.SS2.p4.4.m4.3.3.2.2.2.2.2">ğ‘</ci><cn id="S2.SS2.p4.4.m4.3.3.2.2.2.2.3.cmml" type="integer" xref="S2.SS2.p4.4.m4.3.3.2.2.2.2.3">0</cn></apply><ci id="S2.SS2.p4.4.m4.3.3.2.2.2.3.cmml" xref="S2.SS2.p4.4.m4.3.3.2.2.2.3">ğ‘–</ci></apply><apply id="S2.SS2.p4.4.m4.4.4.3.3.3.cmml" xref="S2.SS2.p4.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p4.4.m4.4.4.3.3.3.1.cmml" xref="S2.SS2.p4.4.m4.4.4.3.3.3">superscript</csymbol><apply id="S2.SS2.p4.4.m4.4.4.3.3.3.2.cmml" xref="S2.SS2.p4.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p4.4.m4.4.4.3.3.3.2.1.cmml" xref="S2.SS2.p4.4.m4.4.4.3.3.3">subscript</csymbol><ci id="S2.SS2.p4.4.m4.4.4.3.3.3.2.2.cmml" xref="S2.SS2.p4.4.m4.4.4.3.3.3.2.2">ğ‘œ</ci><cn id="S2.SS2.p4.4.m4.4.4.3.3.3.2.3.cmml" type="integer" xref="S2.SS2.p4.4.m4.4.4.3.3.3.2.3">1</cn></apply><ci id="S2.SS2.p4.4.m4.4.4.3.3.3.3.cmml" xref="S2.SS2.p4.4.m4.4.4.3.3.3.3">ğ‘–</ci></apply><ci id="S2.SS2.p4.4.m4.1.1.cmml" xref="S2.SS2.p4.4.m4.1.1">â€¦</ci><apply id="S2.SS2.p4.4.m4.5.5.4.4.4.cmml" xref="S2.SS2.p4.4.m4.5.5.4.4.4"><csymbol cd="ambiguous" id="S2.SS2.p4.4.m4.5.5.4.4.4.1.cmml" xref="S2.SS2.p4.4.m4.5.5.4.4.4">superscript</csymbol><apply id="S2.SS2.p4.4.m4.5.5.4.4.4.2.cmml" xref="S2.SS2.p4.4.m4.5.5.4.4.4"><csymbol cd="ambiguous" id="S2.SS2.p4.4.m4.5.5.4.4.4.2.1.cmml" xref="S2.SS2.p4.4.m4.5.5.4.4.4">subscript</csymbol><ci id="S2.SS2.p4.4.m4.5.5.4.4.4.2.2.cmml" xref="S2.SS2.p4.4.m4.5.5.4.4.4.2.2">ğ‘œ</ci><ci id="S2.SS2.p4.4.m4.5.5.4.4.4.2.3.cmml" xref="S2.SS2.p4.4.m4.5.5.4.4.4.2.3">ğ‘›</ci></apply><ci id="S2.SS2.p4.4.m4.5.5.4.4.4.3.cmml" xref="S2.SS2.p4.4.m4.5.5.4.4.4.3">ğ‘–</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.4.m4.5c">\tau_{i}=(o_{0}^{i},a_{0}^{i},o_{1}^{i},...,o_{n}^{i})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p4.4.m4.5d">italic_Ï„ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ( italic_o start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_a start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_o start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , â€¦ , italic_o start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p5">
<p class="ltx_p" id="S2.SS2.p5.6"><span class="ltx_text ltx_font_bold" id="S2.SS2.p5.6.1">Critic loss:</span> To train the critic, as illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#S2.F2" title="Figure 2 â€£ 2.1 Simulation environment â€£ 2 Methodology â€£ Goal-conditioned reinforcement learning for ultrasound navigation guidance"><span class="ltx_text ltx_ref_tag">2</span></a>, we sampled the input triplet from a trajectory <math alttext="(o_{t}^{i},a_{t}^{i},o_{g}^{i})\sim\tau_{i}" class="ltx_Math" display="inline" id="S2.SS2.p5.1.m1.3"><semantics id="S2.SS2.p5.1.m1.3a"><mrow id="S2.SS2.p5.1.m1.3.3" xref="S2.SS2.p5.1.m1.3.3.cmml"><mrow id="S2.SS2.p5.1.m1.3.3.3.3" xref="S2.SS2.p5.1.m1.3.3.3.4.cmml"><mo id="S2.SS2.p5.1.m1.3.3.3.3.4" stretchy="false" xref="S2.SS2.p5.1.m1.3.3.3.4.cmml">(</mo><msubsup id="S2.SS2.p5.1.m1.1.1.1.1.1" xref="S2.SS2.p5.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS2.p5.1.m1.1.1.1.1.1.2.2" xref="S2.SS2.p5.1.m1.1.1.1.1.1.2.2.cmml">o</mi><mi id="S2.SS2.p5.1.m1.1.1.1.1.1.2.3" xref="S2.SS2.p5.1.m1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S2.SS2.p5.1.m1.1.1.1.1.1.3" xref="S2.SS2.p5.1.m1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S2.SS2.p5.1.m1.3.3.3.3.5" xref="S2.SS2.p5.1.m1.3.3.3.4.cmml">,</mo><msubsup id="S2.SS2.p5.1.m1.2.2.2.2.2" xref="S2.SS2.p5.1.m1.2.2.2.2.2.cmml"><mi id="S2.SS2.p5.1.m1.2.2.2.2.2.2.2" xref="S2.SS2.p5.1.m1.2.2.2.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p5.1.m1.2.2.2.2.2.2.3" xref="S2.SS2.p5.1.m1.2.2.2.2.2.2.3.cmml">t</mi><mi id="S2.SS2.p5.1.m1.2.2.2.2.2.3" xref="S2.SS2.p5.1.m1.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S2.SS2.p5.1.m1.3.3.3.3.6" xref="S2.SS2.p5.1.m1.3.3.3.4.cmml">,</mo><msubsup id="S2.SS2.p5.1.m1.3.3.3.3.3" xref="S2.SS2.p5.1.m1.3.3.3.3.3.cmml"><mi id="S2.SS2.p5.1.m1.3.3.3.3.3.2.2" xref="S2.SS2.p5.1.m1.3.3.3.3.3.2.2.cmml">o</mi><mi id="S2.SS2.p5.1.m1.3.3.3.3.3.2.3" xref="S2.SS2.p5.1.m1.3.3.3.3.3.2.3.cmml">g</mi><mi id="S2.SS2.p5.1.m1.3.3.3.3.3.3" xref="S2.SS2.p5.1.m1.3.3.3.3.3.3.cmml">i</mi></msubsup><mo id="S2.SS2.p5.1.m1.3.3.3.3.7" stretchy="false" xref="S2.SS2.p5.1.m1.3.3.3.4.cmml">)</mo></mrow><mo id="S2.SS2.p5.1.m1.3.3.4" xref="S2.SS2.p5.1.m1.3.3.4.cmml">âˆ¼</mo><msub id="S2.SS2.p5.1.m1.3.3.5" xref="S2.SS2.p5.1.m1.3.3.5.cmml"><mi id="S2.SS2.p5.1.m1.3.3.5.2" xref="S2.SS2.p5.1.m1.3.3.5.2.cmml">Ï„</mi><mi id="S2.SS2.p5.1.m1.3.3.5.3" xref="S2.SS2.p5.1.m1.3.3.5.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.1.m1.3b"><apply id="S2.SS2.p5.1.m1.3.3.cmml" xref="S2.SS2.p5.1.m1.3.3"><csymbol cd="latexml" id="S2.SS2.p5.1.m1.3.3.4.cmml" xref="S2.SS2.p5.1.m1.3.3.4">similar-to</csymbol><vector id="S2.SS2.p5.1.m1.3.3.3.4.cmml" xref="S2.SS2.p5.1.m1.3.3.3.3"><apply id="S2.SS2.p5.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p5.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p5.1.m1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS2.p5.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p5.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p5.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p5.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p5.1.m1.1.1.1.1.1.2.2">ğ‘œ</ci><ci id="S2.SS2.p5.1.m1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p5.1.m1.1.1.1.1.1.2.3">ğ‘¡</ci></apply><ci id="S2.SS2.p5.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p5.1.m1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="S2.SS2.p5.1.m1.2.2.2.2.2.cmml" xref="S2.SS2.p5.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.1.m1.2.2.2.2.2.1.cmml" xref="S2.SS2.p5.1.m1.2.2.2.2.2">superscript</csymbol><apply id="S2.SS2.p5.1.m1.2.2.2.2.2.2.cmml" xref="S2.SS2.p5.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.1.m1.2.2.2.2.2.2.1.cmml" xref="S2.SS2.p5.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p5.1.m1.2.2.2.2.2.2.2.cmml" xref="S2.SS2.p5.1.m1.2.2.2.2.2.2.2">ğ‘</ci><ci id="S2.SS2.p5.1.m1.2.2.2.2.2.2.3.cmml" xref="S2.SS2.p5.1.m1.2.2.2.2.2.2.3">ğ‘¡</ci></apply><ci id="S2.SS2.p5.1.m1.2.2.2.2.2.3.cmml" xref="S2.SS2.p5.1.m1.2.2.2.2.2.3">ğ‘–</ci></apply><apply id="S2.SS2.p5.1.m1.3.3.3.3.3.cmml" xref="S2.SS2.p5.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p5.1.m1.3.3.3.3.3.1.cmml" xref="S2.SS2.p5.1.m1.3.3.3.3.3">superscript</csymbol><apply id="S2.SS2.p5.1.m1.3.3.3.3.3.2.cmml" xref="S2.SS2.p5.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p5.1.m1.3.3.3.3.3.2.1.cmml" xref="S2.SS2.p5.1.m1.3.3.3.3.3">subscript</csymbol><ci id="S2.SS2.p5.1.m1.3.3.3.3.3.2.2.cmml" xref="S2.SS2.p5.1.m1.3.3.3.3.3.2.2">ğ‘œ</ci><ci id="S2.SS2.p5.1.m1.3.3.3.3.3.2.3.cmml" xref="S2.SS2.p5.1.m1.3.3.3.3.3.2.3">ğ‘”</ci></apply><ci id="S2.SS2.p5.1.m1.3.3.3.3.3.3.cmml" xref="S2.SS2.p5.1.m1.3.3.3.3.3.3">ğ‘–</ci></apply></vector><apply id="S2.SS2.p5.1.m1.3.3.5.cmml" xref="S2.SS2.p5.1.m1.3.3.5"><csymbol cd="ambiguous" id="S2.SS2.p5.1.m1.3.3.5.1.cmml" xref="S2.SS2.p5.1.m1.3.3.5">subscript</csymbol><ci id="S2.SS2.p5.1.m1.3.3.5.2.cmml" xref="S2.SS2.p5.1.m1.3.3.5.2">ğœ</ci><ci id="S2.SS2.p5.1.m1.3.3.5.3.cmml" xref="S2.SS2.p5.1.m1.3.3.5.3">ğ‘–</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.1.m1.3c">(o_{t}^{i},a_{t}^{i},o_{g}^{i})\sim\tau_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p5.1.m1.3d">( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) âˆ¼ italic_Ï„ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, where the positive goal timestep <math alttext="T" class="ltx_Math" display="inline" id="S2.SS2.p5.2.m2.1"><semantics id="S2.SS2.p5.2.m2.1a"><mi id="S2.SS2.p5.2.m2.1.1" xref="S2.SS2.p5.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.2.m2.1b"><ci id="S2.SS2.p5.2.m2.1.1.cmml" xref="S2.SS2.p5.2.m2.1.1">ğ‘‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p5.2.m2.1d">italic_T</annotation></semantics></math> is a future timestep (<math alttext="T&gt;t" class="ltx_Math" display="inline" id="S2.SS2.p5.3.m3.1"><semantics id="S2.SS2.p5.3.m3.1a"><mrow id="S2.SS2.p5.3.m3.1.1" xref="S2.SS2.p5.3.m3.1.1.cmml"><mi id="S2.SS2.p5.3.m3.1.1.2" xref="S2.SS2.p5.3.m3.1.1.2.cmml">T</mi><mo id="S2.SS2.p5.3.m3.1.1.1" xref="S2.SS2.p5.3.m3.1.1.1.cmml">&gt;</mo><mi id="S2.SS2.p5.3.m3.1.1.3" xref="S2.SS2.p5.3.m3.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.3.m3.1b"><apply id="S2.SS2.p5.3.m3.1.1.cmml" xref="S2.SS2.p5.3.m3.1.1"><gt id="S2.SS2.p5.3.m3.1.1.1.cmml" xref="S2.SS2.p5.3.m3.1.1.1"></gt><ci id="S2.SS2.p5.3.m3.1.1.2.cmml" xref="S2.SS2.p5.3.m3.1.1.2">ğ‘‡</ci><ci id="S2.SS2.p5.3.m3.1.1.3.cmml" xref="S2.SS2.p5.3.m3.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.3.m3.1c">T&gt;t</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p5.3.m3.1d">italic_T &gt; italic_t</annotation></semantics></math>) sampled from a geometric distribution <math alttext="T\sim Geom(1-\gamma)" class="ltx_Math" display="inline" id="S2.SS2.p5.4.m4.1"><semantics id="S2.SS2.p5.4.m4.1a"><mrow id="S2.SS2.p5.4.m4.1.1" xref="S2.SS2.p5.4.m4.1.1.cmml"><mi id="S2.SS2.p5.4.m4.1.1.3" xref="S2.SS2.p5.4.m4.1.1.3.cmml">T</mi><mo id="S2.SS2.p5.4.m4.1.1.2" xref="S2.SS2.p5.4.m4.1.1.2.cmml">âˆ¼</mo><mrow id="S2.SS2.p5.4.m4.1.1.1" xref="S2.SS2.p5.4.m4.1.1.1.cmml"><mi id="S2.SS2.p5.4.m4.1.1.1.3" xref="S2.SS2.p5.4.m4.1.1.1.3.cmml">G</mi><mo id="S2.SS2.p5.4.m4.1.1.1.2" xref="S2.SS2.p5.4.m4.1.1.1.2.cmml">â¢</mo><mi id="S2.SS2.p5.4.m4.1.1.1.4" xref="S2.SS2.p5.4.m4.1.1.1.4.cmml">e</mi><mo id="S2.SS2.p5.4.m4.1.1.1.2a" xref="S2.SS2.p5.4.m4.1.1.1.2.cmml">â¢</mo><mi id="S2.SS2.p5.4.m4.1.1.1.5" xref="S2.SS2.p5.4.m4.1.1.1.5.cmml">o</mi><mo id="S2.SS2.p5.4.m4.1.1.1.2b" xref="S2.SS2.p5.4.m4.1.1.1.2.cmml">â¢</mo><mi id="S2.SS2.p5.4.m4.1.1.1.6" xref="S2.SS2.p5.4.m4.1.1.1.6.cmml">m</mi><mo id="S2.SS2.p5.4.m4.1.1.1.2c" xref="S2.SS2.p5.4.m4.1.1.1.2.cmml">â¢</mo><mrow id="S2.SS2.p5.4.m4.1.1.1.1.1" xref="S2.SS2.p5.4.m4.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p5.4.m4.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p5.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p5.4.m4.1.1.1.1.1.1" xref="S2.SS2.p5.4.m4.1.1.1.1.1.1.cmml"><mn id="S2.SS2.p5.4.m4.1.1.1.1.1.1.2" xref="S2.SS2.p5.4.m4.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.SS2.p5.4.m4.1.1.1.1.1.1.1" xref="S2.SS2.p5.4.m4.1.1.1.1.1.1.1.cmml">âˆ’</mo><mi id="S2.SS2.p5.4.m4.1.1.1.1.1.1.3" xref="S2.SS2.p5.4.m4.1.1.1.1.1.1.3.cmml">Î³</mi></mrow><mo id="S2.SS2.p5.4.m4.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p5.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.4.m4.1b"><apply id="S2.SS2.p5.4.m4.1.1.cmml" xref="S2.SS2.p5.4.m4.1.1"><csymbol cd="latexml" id="S2.SS2.p5.4.m4.1.1.2.cmml" xref="S2.SS2.p5.4.m4.1.1.2">similar-to</csymbol><ci id="S2.SS2.p5.4.m4.1.1.3.cmml" xref="S2.SS2.p5.4.m4.1.1.3">ğ‘‡</ci><apply id="S2.SS2.p5.4.m4.1.1.1.cmml" xref="S2.SS2.p5.4.m4.1.1.1"><times id="S2.SS2.p5.4.m4.1.1.1.2.cmml" xref="S2.SS2.p5.4.m4.1.1.1.2"></times><ci id="S2.SS2.p5.4.m4.1.1.1.3.cmml" xref="S2.SS2.p5.4.m4.1.1.1.3">ğº</ci><ci id="S2.SS2.p5.4.m4.1.1.1.4.cmml" xref="S2.SS2.p5.4.m4.1.1.1.4">ğ‘’</ci><ci id="S2.SS2.p5.4.m4.1.1.1.5.cmml" xref="S2.SS2.p5.4.m4.1.1.1.5">ğ‘œ</ci><ci id="S2.SS2.p5.4.m4.1.1.1.6.cmml" xref="S2.SS2.p5.4.m4.1.1.1.6">ğ‘š</ci><apply id="S2.SS2.p5.4.m4.1.1.1.1.1.1.cmml" xref="S2.SS2.p5.4.m4.1.1.1.1.1"><minus id="S2.SS2.p5.4.m4.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p5.4.m4.1.1.1.1.1.1.1"></minus><cn id="S2.SS2.p5.4.m4.1.1.1.1.1.1.2.cmml" type="integer" xref="S2.SS2.p5.4.m4.1.1.1.1.1.1.2">1</cn><ci id="S2.SS2.p5.4.m4.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p5.4.m4.1.1.1.1.1.1.3">ğ›¾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.4.m4.1c">T\sim Geom(1-\gamma)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p5.4.m4.1d">italic_T âˆ¼ italic_G italic_e italic_o italic_m ( 1 - italic_Î³ )</annotation></semantics></math>. The negative goal <math alttext="o_{g^{\prime}}^{j}" class="ltx_Math" display="inline" id="S2.SS2.p5.5.m5.1"><semantics id="S2.SS2.p5.5.m5.1a"><msubsup id="S2.SS2.p5.5.m5.1.1" xref="S2.SS2.p5.5.m5.1.1.cmml"><mi id="S2.SS2.p5.5.m5.1.1.2.2" xref="S2.SS2.p5.5.m5.1.1.2.2.cmml">o</mi><msup id="S2.SS2.p5.5.m5.1.1.2.3" xref="S2.SS2.p5.5.m5.1.1.2.3.cmml"><mi id="S2.SS2.p5.5.m5.1.1.2.3.2" xref="S2.SS2.p5.5.m5.1.1.2.3.2.cmml">g</mi><mo id="S2.SS2.p5.5.m5.1.1.2.3.3" xref="S2.SS2.p5.5.m5.1.1.2.3.3.cmml">â€²</mo></msup><mi id="S2.SS2.p5.5.m5.1.1.3" xref="S2.SS2.p5.5.m5.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.5.m5.1b"><apply id="S2.SS2.p5.5.m5.1.1.cmml" xref="S2.SS2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.5.m5.1.1.1.cmml" xref="S2.SS2.p5.5.m5.1.1">superscript</csymbol><apply id="S2.SS2.p5.5.m5.1.1.2.cmml" xref="S2.SS2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.5.m5.1.1.2.1.cmml" xref="S2.SS2.p5.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p5.5.m5.1.1.2.2.cmml" xref="S2.SS2.p5.5.m5.1.1.2.2">ğ‘œ</ci><apply id="S2.SS2.p5.5.m5.1.1.2.3.cmml" xref="S2.SS2.p5.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.p5.5.m5.1.1.2.3.1.cmml" xref="S2.SS2.p5.5.m5.1.1.2.3">superscript</csymbol><ci id="S2.SS2.p5.5.m5.1.1.2.3.2.cmml" xref="S2.SS2.p5.5.m5.1.1.2.3.2">ğ‘”</ci><ci id="S2.SS2.p5.5.m5.1.1.2.3.3.cmml" xref="S2.SS2.p5.5.m5.1.1.2.3.3">â€²</ci></apply></apply><ci id="S2.SS2.p5.5.m5.1.1.3.cmml" xref="S2.SS2.p5.5.m5.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.5.m5.1c">o_{g^{\prime}}^{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p5.5.m5.1d">italic_o start_POSTSUBSCRIPT italic_g start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> is sampled randomly from another trajectory <math alttext="\tau_{j}" class="ltx_Math" display="inline" id="S2.SS2.p5.6.m6.1"><semantics id="S2.SS2.p5.6.m6.1a"><msub id="S2.SS2.p5.6.m6.1.1" xref="S2.SS2.p5.6.m6.1.1.cmml"><mi id="S2.SS2.p5.6.m6.1.1.2" xref="S2.SS2.p5.6.m6.1.1.2.cmml">Ï„</mi><mi id="S2.SS2.p5.6.m6.1.1.3" xref="S2.SS2.p5.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.6.m6.1b"><apply id="S2.SS2.p5.6.m6.1.1.cmml" xref="S2.SS2.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.6.m6.1.1.1.cmml" xref="S2.SS2.p5.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.p5.6.m6.1.1.2.cmml" xref="S2.SS2.p5.6.m6.1.1.2">ğœ</ci><ci id="S2.SS2.p5.6.m6.1.1.3.cmml" xref="S2.SS2.p5.6.m6.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.6.m6.1c">\tau_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p5.6.m6.1d">italic_Ï„ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. The critic loss is based on the infoNCE loss <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib13" title="">13</a>]</cite> and computed as:</p>
</div>
<div class="ltx_para" id="S2.SS2.p6">
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{f}\mathbb{E}_{\begin{subarray}{c}(o_{t}^{i},a_{t}^{i},o_{g}^{i})\sim\tau%
_{i}\\
o_{g^{\prime}}\sim\tau_{j}\end{subarray}}log\big{[}\frac{e^{f(o_{t}^{i},a_{t}^%
{i},o_{g}^{i})^{+}}}{e^{f(o_{t}^{i},a_{t}^{i},o_{g}^{i})^{+}}+\sum_{j}e^{f(o_{%
t}^{i},a_{t}^{i},o_{g^{\prime}}^{j})^{-}}}\big{]}" class="ltx_Math" display="block" id="S2.E1.m1.10"><semantics id="S2.E1.m1.10a"><mrow id="S2.E1.m1.10.11" xref="S2.E1.m1.10.11.cmml"><mrow id="S2.E1.m1.10.11.2" xref="S2.E1.m1.10.11.2.cmml"><munder id="S2.E1.m1.10.11.2.1" xref="S2.E1.m1.10.11.2.1.cmml"><mi id="S2.E1.m1.10.11.2.1.2" xref="S2.E1.m1.10.11.2.1.2.cmml">max</mi><mi id="S2.E1.m1.10.11.2.1.3" xref="S2.E1.m1.10.11.2.1.3.cmml">f</mi></munder><mo id="S2.E1.m1.10.11.2a" lspace="0.167em" xref="S2.E1.m1.10.11.2.cmml">â¡</mo><mrow id="S2.E1.m1.10.11.2.2" xref="S2.E1.m1.10.11.2.2.cmml"><msub id="S2.E1.m1.10.11.2.2.2" xref="S2.E1.m1.10.11.2.2.2.cmml"><mi id="S2.E1.m1.10.11.2.2.2.2" xref="S2.E1.m1.10.11.2.2.2.2.cmml">ğ”¼</mi><mtable id="S2.E1.m1.1.1.1.1.1.1" rowspacing="0pt" xref="S2.E1.m1.1.1.1.2.cmml"><mtr id="S2.E1.m1.1.1.1.1.1.1a" xref="S2.E1.m1.1.1.1.2.cmml"><mtd id="S2.E1.m1.1.1.1.1.1.1b" xref="S2.E1.m1.1.1.1.2.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.4.cmml"><mo id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.4" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.4.cmml">(</mo><msubsup id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">o</mi><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.5" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.4.cmml">,</mo><msubsup id="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2" xref="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.2" xref="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.2.cmml">a</mi><mi id="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.3" xref="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.3.cmml">t</mi><mi id="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.3" xref="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.6" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.4.cmml">,</mo><msubsup id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.2.2" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.2.2.cmml">o</mi><mi id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.2.3" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.2.3.cmml">g</mi><mi id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.3" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.3.cmml">i</mi></msubsup><mo id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.7" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.4.cmml">)</mo></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.4" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.4.cmml">âˆ¼</mo><msub id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.5" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.5.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.5.2" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.5.2.cmml">Ï„</mi><mi id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.5.3" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.5.3.cmml">i</mi></msub></mrow></mtd></mtr><mtr id="S2.E1.m1.1.1.1.1.1.1c" xref="S2.E1.m1.1.1.1.2.cmml"><mtd id="S2.E1.m1.1.1.1.1.1.1d" xref="S2.E1.m1.1.1.1.2.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1.4.1.1" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.cmml"><msub id="S2.E1.m1.1.1.1.1.1.1.4.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.2" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.2.cmml">o</mi><msup id="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.3" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.3.2" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.3.2.cmml">g</mi><mo id="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.3.3" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.3.3.cmml">â€²</mo></msup></msub><mo id="S2.E1.m1.1.1.1.1.1.1.4.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.1.cmml">âˆ¼</mo><msub id="S2.E1.m1.1.1.1.1.1.1.4.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.4.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.3.2.cmml">Ï„</mi><mi id="S2.E1.m1.1.1.1.1.1.1.4.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.3.3.cmml">j</mi></msub></mrow></mtd></mtr></mtable></msub><mo id="S2.E1.m1.10.11.2.2.1" xref="S2.E1.m1.10.11.2.2.1.cmml">â¢</mo><mi id="S2.E1.m1.10.11.2.2.3" xref="S2.E1.m1.10.11.2.2.3.cmml">l</mi><mo id="S2.E1.m1.10.11.2.2.1a" xref="S2.E1.m1.10.11.2.2.1.cmml">â¢</mo><mi id="S2.E1.m1.10.11.2.2.4" xref="S2.E1.m1.10.11.2.2.4.cmml">o</mi><mo id="S2.E1.m1.10.11.2.2.1b" xref="S2.E1.m1.10.11.2.2.1.cmml">â¢</mo><mi id="S2.E1.m1.10.11.2.2.5" xref="S2.E1.m1.10.11.2.2.5.cmml">g</mi></mrow></mrow><mo id="S2.E1.m1.10.11.1" xref="S2.E1.m1.10.11.1.cmml">â¢</mo><mrow id="S2.E1.m1.10.11.3.2" xref="S2.E1.m1.10.11.3.1.cmml"><mo id="S2.E1.m1.10.11.3.2.1" maxsize="120%" minsize="120%" xref="S2.E1.m1.10.11.3.1.1.cmml">[</mo><mfrac id="S2.E1.m1.10.10" xref="S2.E1.m1.10.10.cmml"><msup id="S2.E1.m1.4.4.3" xref="S2.E1.m1.4.4.3.cmml"><mi id="S2.E1.m1.4.4.3.5" xref="S2.E1.m1.4.4.3.5.cmml">e</mi><mrow id="S2.E1.m1.4.4.3.3.3" xref="S2.E1.m1.4.4.3.3.3.cmml"><mi id="S2.E1.m1.4.4.3.3.3.5" xref="S2.E1.m1.4.4.3.3.3.5.cmml">f</mi><mo id="S2.E1.m1.4.4.3.3.3.4" xref="S2.E1.m1.4.4.3.3.3.4.cmml">â¢</mo><msup id="S2.E1.m1.4.4.3.3.3.3" xref="S2.E1.m1.4.4.3.3.3.3.cmml"><mrow id="S2.E1.m1.4.4.3.3.3.3.3.3" xref="S2.E1.m1.4.4.3.3.3.3.3.4.cmml"><mo id="S2.E1.m1.4.4.3.3.3.3.3.3.4" stretchy="false" xref="S2.E1.m1.4.4.3.3.3.3.3.4.cmml">(</mo><msubsup id="S2.E1.m1.2.2.1.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">o</mi><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S2.E1.m1.4.4.3.3.3.3.3.3.5" xref="S2.E1.m1.4.4.3.3.3.3.3.4.cmml">,</mo><msubsup id="S2.E1.m1.3.3.2.2.2.2.2.2.2" xref="S2.E1.m1.3.3.2.2.2.2.2.2.2.cmml"><mi id="S2.E1.m1.3.3.2.2.2.2.2.2.2.2.2" xref="S2.E1.m1.3.3.2.2.2.2.2.2.2.2.2.cmml">a</mi><mi id="S2.E1.m1.3.3.2.2.2.2.2.2.2.2.3" xref="S2.E1.m1.3.3.2.2.2.2.2.2.2.2.3.cmml">t</mi><mi id="S2.E1.m1.3.3.2.2.2.2.2.2.2.3" xref="S2.E1.m1.3.3.2.2.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S2.E1.m1.4.4.3.3.3.3.3.3.6" xref="S2.E1.m1.4.4.3.3.3.3.3.4.cmml">,</mo><msubsup id="S2.E1.m1.4.4.3.3.3.3.3.3.3" xref="S2.E1.m1.4.4.3.3.3.3.3.3.3.cmml"><mi id="S2.E1.m1.4.4.3.3.3.3.3.3.3.2.2" xref="S2.E1.m1.4.4.3.3.3.3.3.3.3.2.2.cmml">o</mi><mi id="S2.E1.m1.4.4.3.3.3.3.3.3.3.2.3" xref="S2.E1.m1.4.4.3.3.3.3.3.3.3.2.3.cmml">g</mi><mi id="S2.E1.m1.4.4.3.3.3.3.3.3.3.3" xref="S2.E1.m1.4.4.3.3.3.3.3.3.3.3.cmml">i</mi></msubsup><mo id="S2.E1.m1.4.4.3.3.3.3.3.3.7" stretchy="false" xref="S2.E1.m1.4.4.3.3.3.3.3.4.cmml">)</mo></mrow><mo id="S2.E1.m1.4.4.3.3.3.3.5" xref="S2.E1.m1.4.4.3.3.3.3.5.cmml">+</mo></msup></mrow></msup><mrow id="S2.E1.m1.10.10.9" xref="S2.E1.m1.10.10.9.cmml"><msup id="S2.E1.m1.10.10.9.8" xref="S2.E1.m1.10.10.9.8.cmml"><mi id="S2.E1.m1.10.10.9.8.2" xref="S2.E1.m1.10.10.9.8.2.cmml">e</mi><mrow id="S2.E1.m1.7.7.6.3.3" xref="S2.E1.m1.7.7.6.3.3.cmml"><mi id="S2.E1.m1.7.7.6.3.3.5" xref="S2.E1.m1.7.7.6.3.3.5.cmml">f</mi><mo id="S2.E1.m1.7.7.6.3.3.4" xref="S2.E1.m1.7.7.6.3.3.4.cmml">â¢</mo><msup id="S2.E1.m1.7.7.6.3.3.3" xref="S2.E1.m1.7.7.6.3.3.3.cmml"><mrow id="S2.E1.m1.7.7.6.3.3.3.3.3" xref="S2.E1.m1.7.7.6.3.3.3.3.4.cmml"><mo id="S2.E1.m1.7.7.6.3.3.3.3.3.4" stretchy="false" xref="S2.E1.m1.7.7.6.3.3.3.3.4.cmml">(</mo><msubsup id="S2.E1.m1.5.5.4.1.1.1.1.1.1" xref="S2.E1.m1.5.5.4.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.5.5.4.1.1.1.1.1.1.2.2" xref="S2.E1.m1.5.5.4.1.1.1.1.1.1.2.2.cmml">o</mi><mi id="S2.E1.m1.5.5.4.1.1.1.1.1.1.2.3" xref="S2.E1.m1.5.5.4.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S2.E1.m1.5.5.4.1.1.1.1.1.1.3" xref="S2.E1.m1.5.5.4.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S2.E1.m1.7.7.6.3.3.3.3.3.5" xref="S2.E1.m1.7.7.6.3.3.3.3.4.cmml">,</mo><msubsup id="S2.E1.m1.6.6.5.2.2.2.2.2.2" xref="S2.E1.m1.6.6.5.2.2.2.2.2.2.cmml"><mi id="S2.E1.m1.6.6.5.2.2.2.2.2.2.2.2" xref="S2.E1.m1.6.6.5.2.2.2.2.2.2.2.2.cmml">a</mi><mi id="S2.E1.m1.6.6.5.2.2.2.2.2.2.2.3" xref="S2.E1.m1.6.6.5.2.2.2.2.2.2.2.3.cmml">t</mi><mi id="S2.E1.m1.6.6.5.2.2.2.2.2.2.3" xref="S2.E1.m1.6.6.5.2.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S2.E1.m1.7.7.6.3.3.3.3.3.6" xref="S2.E1.m1.7.7.6.3.3.3.3.4.cmml">,</mo><msubsup id="S2.E1.m1.7.7.6.3.3.3.3.3.3" xref="S2.E1.m1.7.7.6.3.3.3.3.3.3.cmml"><mi id="S2.E1.m1.7.7.6.3.3.3.3.3.3.2.2" xref="S2.E1.m1.7.7.6.3.3.3.3.3.3.2.2.cmml">o</mi><mi id="S2.E1.m1.7.7.6.3.3.3.3.3.3.2.3" xref="S2.E1.m1.7.7.6.3.3.3.3.3.3.2.3.cmml">g</mi><mi id="S2.E1.m1.7.7.6.3.3.3.3.3.3.3" xref="S2.E1.m1.7.7.6.3.3.3.3.3.3.3.cmml">i</mi></msubsup><mo id="S2.E1.m1.7.7.6.3.3.3.3.3.7" stretchy="false" xref="S2.E1.m1.7.7.6.3.3.3.3.4.cmml">)</mo></mrow><mo id="S2.E1.m1.7.7.6.3.3.3.5" xref="S2.E1.m1.7.7.6.3.3.3.5.cmml">+</mo></msup></mrow></msup><mo id="S2.E1.m1.10.10.9.7" rspace="0.055em" xref="S2.E1.m1.10.10.9.7.cmml">+</mo><mrow id="S2.E1.m1.10.10.9.9" xref="S2.E1.m1.10.10.9.9.cmml"><msub id="S2.E1.m1.10.10.9.9.1" xref="S2.E1.m1.10.10.9.9.1.cmml"><mo id="S2.E1.m1.10.10.9.9.1.2" xref="S2.E1.m1.10.10.9.9.1.2.cmml">âˆ‘</mo><mi id="S2.E1.m1.10.10.9.9.1.3" xref="S2.E1.m1.10.10.9.9.1.3.cmml">j</mi></msub><msup id="S2.E1.m1.10.10.9.9.2" xref="S2.E1.m1.10.10.9.9.2.cmml"><mi id="S2.E1.m1.10.10.9.9.2.2" xref="S2.E1.m1.10.10.9.9.2.2.cmml">e</mi><mrow id="S2.E1.m1.10.10.9.6.3" xref="S2.E1.m1.10.10.9.6.3.cmml"><mi id="S2.E1.m1.10.10.9.6.3.5" xref="S2.E1.m1.10.10.9.6.3.5.cmml">f</mi><mo id="S2.E1.m1.10.10.9.6.3.4" xref="S2.E1.m1.10.10.9.6.3.4.cmml">â¢</mo><msup id="S2.E1.m1.10.10.9.6.3.3" xref="S2.E1.m1.10.10.9.6.3.3.cmml"><mrow id="S2.E1.m1.10.10.9.6.3.3.3.3" xref="S2.E1.m1.10.10.9.6.3.3.3.4.cmml"><mo id="S2.E1.m1.10.10.9.6.3.3.3.3.4" stretchy="false" xref="S2.E1.m1.10.10.9.6.3.3.3.4.cmml">(</mo><msubsup id="S2.E1.m1.8.8.7.4.1.1.1.1.1" xref="S2.E1.m1.8.8.7.4.1.1.1.1.1.cmml"><mi id="S2.E1.m1.8.8.7.4.1.1.1.1.1.2.2" xref="S2.E1.m1.8.8.7.4.1.1.1.1.1.2.2.cmml">o</mi><mi id="S2.E1.m1.8.8.7.4.1.1.1.1.1.2.3" xref="S2.E1.m1.8.8.7.4.1.1.1.1.1.2.3.cmml">t</mi><mi id="S2.E1.m1.8.8.7.4.1.1.1.1.1.3" xref="S2.E1.m1.8.8.7.4.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S2.E1.m1.10.10.9.6.3.3.3.3.5" xref="S2.E1.m1.10.10.9.6.3.3.3.4.cmml">,</mo><msubsup id="S2.E1.m1.9.9.8.5.2.2.2.2.2" xref="S2.E1.m1.9.9.8.5.2.2.2.2.2.cmml"><mi id="S2.E1.m1.9.9.8.5.2.2.2.2.2.2.2" xref="S2.E1.m1.9.9.8.5.2.2.2.2.2.2.2.cmml">a</mi><mi id="S2.E1.m1.9.9.8.5.2.2.2.2.2.2.3" xref="S2.E1.m1.9.9.8.5.2.2.2.2.2.2.3.cmml">t</mi><mi id="S2.E1.m1.9.9.8.5.2.2.2.2.2.3" xref="S2.E1.m1.9.9.8.5.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S2.E1.m1.10.10.9.6.3.3.3.3.6" xref="S2.E1.m1.10.10.9.6.3.3.3.4.cmml">,</mo><msubsup id="S2.E1.m1.10.10.9.6.3.3.3.3.3" xref="S2.E1.m1.10.10.9.6.3.3.3.3.3.cmml"><mi id="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.2" xref="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.2.cmml">o</mi><msup id="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.3" xref="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.3.cmml"><mi id="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.3.2" xref="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.3.2.cmml">g</mi><mo id="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.3.3" xref="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.3.3.cmml">â€²</mo></msup><mi id="S2.E1.m1.10.10.9.6.3.3.3.3.3.3" xref="S2.E1.m1.10.10.9.6.3.3.3.3.3.3.cmml">j</mi></msubsup><mo id="S2.E1.m1.10.10.9.6.3.3.3.3.7" stretchy="false" xref="S2.E1.m1.10.10.9.6.3.3.3.4.cmml">)</mo></mrow><mo id="S2.E1.m1.10.10.9.6.3.3.5" xref="S2.E1.m1.10.10.9.6.3.3.5.cmml">âˆ’</mo></msup></mrow></msup></mrow></mrow></mfrac><mo id="S2.E1.m1.10.11.3.2.2" maxsize="120%" minsize="120%" xref="S2.E1.m1.10.11.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.10b"><apply id="S2.E1.m1.10.11.cmml" xref="S2.E1.m1.10.11"><times id="S2.E1.m1.10.11.1.cmml" xref="S2.E1.m1.10.11.1"></times><apply id="S2.E1.m1.10.11.2.cmml" xref="S2.E1.m1.10.11.2"><apply id="S2.E1.m1.10.11.2.1.cmml" xref="S2.E1.m1.10.11.2.1"><csymbol cd="ambiguous" id="S2.E1.m1.10.11.2.1.1.cmml" xref="S2.E1.m1.10.11.2.1">subscript</csymbol><max id="S2.E1.m1.10.11.2.1.2.cmml" xref="S2.E1.m1.10.11.2.1.2"></max><ci id="S2.E1.m1.10.11.2.1.3.cmml" xref="S2.E1.m1.10.11.2.1.3">ğ‘“</ci></apply><apply id="S2.E1.m1.10.11.2.2.cmml" xref="S2.E1.m1.10.11.2.2"><times id="S2.E1.m1.10.11.2.2.1.cmml" xref="S2.E1.m1.10.11.2.2.1"></times><apply id="S2.E1.m1.10.11.2.2.2.cmml" xref="S2.E1.m1.10.11.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.10.11.2.2.2.1.cmml" xref="S2.E1.m1.10.11.2.2.2">subscript</csymbol><ci id="S2.E1.m1.10.11.2.2.2.2.cmml" xref="S2.E1.m1.10.11.2.2.2.2">ğ”¼</ci><list id="S2.E1.m1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1"><matrix id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1"><matrixrow id="S2.E1.m1.1.1.1.1.1.1a.cmml" xref="S2.E1.m1.1.1.1.1.1.1"><apply id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3"><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.4.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.4">similar-to</csymbol><vector id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.4.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3"><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">ğ‘œ</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">ğ‘¡</ci></apply><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2">superscript</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.2">ğ‘</ci><ci id="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.3">ğ‘¡</ci></apply><ci id="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.3">ğ‘–</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3">superscript</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.2.2">ğ‘œ</ci><ci id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.2.3">ğ‘”</ci></apply><ci id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.3.3.3.3">ğ‘–</ci></apply></vector><apply id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.5.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.5"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.5.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.5">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.5.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.5.2">ğœ</ci><ci id="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.5.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.3.3.3.5.3">ğ‘–</ci></apply></apply></matrixrow><matrixrow id="S2.E1.m1.1.1.1.1.1.1b.cmml" xref="S2.E1.m1.1.1.1.1.1.1"><apply id="S2.E1.m1.1.1.1.1.1.1.4.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1"><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.1.1.4.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.1">similar-to</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.2">ğ‘œ</ci><apply id="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.3">superscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.3.2">ğ‘”</ci><ci id="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.2.3.3">â€²</ci></apply></apply><apply id="S2.E1.m1.1.1.1.1.1.1.4.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.4.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.4.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.3.2">ğœ</ci><ci id="S2.E1.m1.1.1.1.1.1.1.4.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.4.1.1.3.3">ğ‘—</ci></apply></apply></matrixrow></matrix></list></apply><ci id="S2.E1.m1.10.11.2.2.3.cmml" xref="S2.E1.m1.10.11.2.2.3">ğ‘™</ci><ci id="S2.E1.m1.10.11.2.2.4.cmml" xref="S2.E1.m1.10.11.2.2.4">ğ‘œ</ci><ci id="S2.E1.m1.10.11.2.2.5.cmml" xref="S2.E1.m1.10.11.2.2.5">ğ‘”</ci></apply></apply><apply id="S2.E1.m1.10.11.3.1.cmml" xref="S2.E1.m1.10.11.3.2"><csymbol cd="latexml" id="S2.E1.m1.10.11.3.1.1.cmml" xref="S2.E1.m1.10.11.3.2.1">delimited-[]</csymbol><apply id="S2.E1.m1.10.10.cmml" xref="S2.E1.m1.10.10"><divide id="S2.E1.m1.10.10.10.cmml" xref="S2.E1.m1.10.10"></divide><apply id="S2.E1.m1.4.4.3.cmml" xref="S2.E1.m1.4.4.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.3.4.cmml" xref="S2.E1.m1.4.4.3">superscript</csymbol><ci id="S2.E1.m1.4.4.3.5.cmml" xref="S2.E1.m1.4.4.3.5">ğ‘’</ci><apply id="S2.E1.m1.4.4.3.3.3.cmml" xref="S2.E1.m1.4.4.3.3.3"><times id="S2.E1.m1.4.4.3.3.3.4.cmml" xref="S2.E1.m1.4.4.3.3.3.4"></times><ci id="S2.E1.m1.4.4.3.3.3.5.cmml" xref="S2.E1.m1.4.4.3.3.3.5">ğ‘“</ci><apply id="S2.E1.m1.4.4.3.3.3.3.cmml" xref="S2.E1.m1.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.3.3.3.3.4.cmml" xref="S2.E1.m1.4.4.3.3.3.3">superscript</csymbol><vector id="S2.E1.m1.4.4.3.3.3.3.3.4.cmml" xref="S2.E1.m1.4.4.3.3.3.3.3.3"><apply id="S2.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.2.2">ğ‘œ</ci><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.2.3">ğ‘¡</ci></apply><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="S2.E1.m1.3.3.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.3.3.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.2.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.3.3.2.2.2.2.2.2.2">superscript</csymbol><apply id="S2.E1.m1.3.3.2.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.3.3.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.3.3.2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.3.3.2.2.2.2.2.2.2.2.2">ğ‘</ci><ci id="S2.E1.m1.3.3.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.3.3.2.2.2.2.2.2.2.2.3">ğ‘¡</ci></apply><ci id="S2.E1.m1.3.3.2.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.3.3.2.2.2.2.2.2.2.3">ğ‘–</ci></apply><apply id="S2.E1.m1.4.4.3.3.3.3.3.3.3.cmml" xref="S2.E1.m1.4.4.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.3.3.3.3.3.3.3.1.cmml" xref="S2.E1.m1.4.4.3.3.3.3.3.3.3">superscript</csymbol><apply id="S2.E1.m1.4.4.3.3.3.3.3.3.3.2.cmml" xref="S2.E1.m1.4.4.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.3.3.3.3.3.3.3.2.1.cmml" xref="S2.E1.m1.4.4.3.3.3.3.3.3.3">subscript</csymbol><ci id="S2.E1.m1.4.4.3.3.3.3.3.3.3.2.2.cmml" xref="S2.E1.m1.4.4.3.3.3.3.3.3.3.2.2">ğ‘œ</ci><ci id="S2.E1.m1.4.4.3.3.3.3.3.3.3.2.3.cmml" xref="S2.E1.m1.4.4.3.3.3.3.3.3.3.2.3">ğ‘”</ci></apply><ci id="S2.E1.m1.4.4.3.3.3.3.3.3.3.3.cmml" xref="S2.E1.m1.4.4.3.3.3.3.3.3.3.3">ğ‘–</ci></apply></vector><plus id="S2.E1.m1.4.4.3.3.3.3.5.cmml" xref="S2.E1.m1.4.4.3.3.3.3.5"></plus></apply></apply></apply><apply id="S2.E1.m1.10.10.9.cmml" xref="S2.E1.m1.10.10.9"><plus id="S2.E1.m1.10.10.9.7.cmml" xref="S2.E1.m1.10.10.9.7"></plus><apply id="S2.E1.m1.10.10.9.8.cmml" xref="S2.E1.m1.10.10.9.8"><csymbol cd="ambiguous" id="S2.E1.m1.10.10.9.8.1.cmml" xref="S2.E1.m1.10.10.9.8">superscript</csymbol><ci id="S2.E1.m1.10.10.9.8.2.cmml" xref="S2.E1.m1.10.10.9.8.2">ğ‘’</ci><apply id="S2.E1.m1.7.7.6.3.3.cmml" xref="S2.E1.m1.7.7.6.3.3"><times id="S2.E1.m1.7.7.6.3.3.4.cmml" xref="S2.E1.m1.7.7.6.3.3.4"></times><ci id="S2.E1.m1.7.7.6.3.3.5.cmml" xref="S2.E1.m1.7.7.6.3.3.5">ğ‘“</ci><apply id="S2.E1.m1.7.7.6.3.3.3.cmml" xref="S2.E1.m1.7.7.6.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.6.3.3.3.4.cmml" xref="S2.E1.m1.7.7.6.3.3.3">superscript</csymbol><vector id="S2.E1.m1.7.7.6.3.3.3.3.4.cmml" xref="S2.E1.m1.7.7.6.3.3.3.3.3"><apply id="S2.E1.m1.5.5.4.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.4.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.4.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.5.5.4.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.4.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.5.5.4.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.5.5.4.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.5.5.4.1.1.1.1.1.1.2.2">ğ‘œ</ci><ci id="S2.E1.m1.5.5.4.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.5.5.4.1.1.1.1.1.1.2.3">ğ‘¡</ci></apply><ci id="S2.E1.m1.5.5.4.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.4.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="S2.E1.m1.6.6.5.2.2.2.2.2.2.cmml" xref="S2.E1.m1.6.6.5.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.5.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.6.6.5.2.2.2.2.2.2">superscript</csymbol><apply id="S2.E1.m1.6.6.5.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.6.6.5.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.5.2.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.6.6.5.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.6.6.5.2.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.6.6.5.2.2.2.2.2.2.2.2">ğ‘</ci><ci id="S2.E1.m1.6.6.5.2.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.6.6.5.2.2.2.2.2.2.2.3">ğ‘¡</ci></apply><ci id="S2.E1.m1.6.6.5.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.6.6.5.2.2.2.2.2.2.3">ğ‘–</ci></apply><apply id="S2.E1.m1.7.7.6.3.3.3.3.3.3.cmml" xref="S2.E1.m1.7.7.6.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.6.3.3.3.3.3.3.1.cmml" xref="S2.E1.m1.7.7.6.3.3.3.3.3.3">superscript</csymbol><apply id="S2.E1.m1.7.7.6.3.3.3.3.3.3.2.cmml" xref="S2.E1.m1.7.7.6.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.6.3.3.3.3.3.3.2.1.cmml" xref="S2.E1.m1.7.7.6.3.3.3.3.3.3">subscript</csymbol><ci id="S2.E1.m1.7.7.6.3.3.3.3.3.3.2.2.cmml" xref="S2.E1.m1.7.7.6.3.3.3.3.3.3.2.2">ğ‘œ</ci><ci id="S2.E1.m1.7.7.6.3.3.3.3.3.3.2.3.cmml" xref="S2.E1.m1.7.7.6.3.3.3.3.3.3.2.3">ğ‘”</ci></apply><ci id="S2.E1.m1.7.7.6.3.3.3.3.3.3.3.cmml" xref="S2.E1.m1.7.7.6.3.3.3.3.3.3.3">ğ‘–</ci></apply></vector><plus id="S2.E1.m1.7.7.6.3.3.3.5.cmml" xref="S2.E1.m1.7.7.6.3.3.3.5"></plus></apply></apply></apply><apply id="S2.E1.m1.10.10.9.9.cmml" xref="S2.E1.m1.10.10.9.9"><apply id="S2.E1.m1.10.10.9.9.1.cmml" xref="S2.E1.m1.10.10.9.9.1"><csymbol cd="ambiguous" id="S2.E1.m1.10.10.9.9.1.1.cmml" xref="S2.E1.m1.10.10.9.9.1">subscript</csymbol><sum id="S2.E1.m1.10.10.9.9.1.2.cmml" xref="S2.E1.m1.10.10.9.9.1.2"></sum><ci id="S2.E1.m1.10.10.9.9.1.3.cmml" xref="S2.E1.m1.10.10.9.9.1.3">ğ‘—</ci></apply><apply id="S2.E1.m1.10.10.9.9.2.cmml" xref="S2.E1.m1.10.10.9.9.2"><csymbol cd="ambiguous" id="S2.E1.m1.10.10.9.9.2.1.cmml" xref="S2.E1.m1.10.10.9.9.2">superscript</csymbol><ci id="S2.E1.m1.10.10.9.9.2.2.cmml" xref="S2.E1.m1.10.10.9.9.2.2">ğ‘’</ci><apply id="S2.E1.m1.10.10.9.6.3.cmml" xref="S2.E1.m1.10.10.9.6.3"><times id="S2.E1.m1.10.10.9.6.3.4.cmml" xref="S2.E1.m1.10.10.9.6.3.4"></times><ci id="S2.E1.m1.10.10.9.6.3.5.cmml" xref="S2.E1.m1.10.10.9.6.3.5">ğ‘“</ci><apply id="S2.E1.m1.10.10.9.6.3.3.cmml" xref="S2.E1.m1.10.10.9.6.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.10.10.9.6.3.3.4.cmml" xref="S2.E1.m1.10.10.9.6.3.3">superscript</csymbol><vector id="S2.E1.m1.10.10.9.6.3.3.3.4.cmml" xref="S2.E1.m1.10.10.9.6.3.3.3.3"><apply id="S2.E1.m1.8.8.7.4.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.7.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.7.4.1.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.7.4.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.8.8.7.4.1.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.7.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.7.4.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.8.8.7.4.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.8.8.7.4.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.8.8.7.4.1.1.1.1.1.2.2">ğ‘œ</ci><ci id="S2.E1.m1.8.8.7.4.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.8.8.7.4.1.1.1.1.1.2.3">ğ‘¡</ci></apply><ci id="S2.E1.m1.8.8.7.4.1.1.1.1.1.3.cmml" xref="S2.E1.m1.8.8.7.4.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="S2.E1.m1.9.9.8.5.2.2.2.2.2.cmml" xref="S2.E1.m1.9.9.8.5.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.9.9.8.5.2.2.2.2.2.1.cmml" xref="S2.E1.m1.9.9.8.5.2.2.2.2.2">superscript</csymbol><apply id="S2.E1.m1.9.9.8.5.2.2.2.2.2.2.cmml" xref="S2.E1.m1.9.9.8.5.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.9.9.8.5.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.9.9.8.5.2.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.9.9.8.5.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.9.9.8.5.2.2.2.2.2.2.2">ğ‘</ci><ci id="S2.E1.m1.9.9.8.5.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.9.9.8.5.2.2.2.2.2.2.3">ğ‘¡</ci></apply><ci id="S2.E1.m1.9.9.8.5.2.2.2.2.2.3.cmml" xref="S2.E1.m1.9.9.8.5.2.2.2.2.2.3">ğ‘–</ci></apply><apply id="S2.E1.m1.10.10.9.6.3.3.3.3.3.cmml" xref="S2.E1.m1.10.10.9.6.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.10.10.9.6.3.3.3.3.3.1.cmml" xref="S2.E1.m1.10.10.9.6.3.3.3.3.3">superscript</csymbol><apply id="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.cmml" xref="S2.E1.m1.10.10.9.6.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.1.cmml" xref="S2.E1.m1.10.10.9.6.3.3.3.3.3">subscript</csymbol><ci id="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.2.cmml" xref="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.2">ğ‘œ</ci><apply id="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.3.cmml" xref="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.3.1.cmml" xref="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.3">superscript</csymbol><ci id="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.3.2.cmml" xref="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.3.2">ğ‘”</ci><ci id="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.3.3.cmml" xref="S2.E1.m1.10.10.9.6.3.3.3.3.3.2.3.3">â€²</ci></apply></apply><ci id="S2.E1.m1.10.10.9.6.3.3.3.3.3.3.cmml" xref="S2.E1.m1.10.10.9.6.3.3.3.3.3.3">ğ‘—</ci></apply></vector><minus id="S2.E1.m1.10.10.9.6.3.3.5.cmml" xref="S2.E1.m1.10.10.9.6.3.3.5"></minus></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.10c">\max_{f}\mathbb{E}_{\begin{subarray}{c}(o_{t}^{i},a_{t}^{i},o_{g}^{i})\sim\tau%
_{i}\\
o_{g^{\prime}}\sim\tau_{j}\end{subarray}}log\big{[}\frac{e^{f(o_{t}^{i},a_{t}^%
{i},o_{g}^{i})^{+}}}{e^{f(o_{t}^{i},a_{t}^{i},o_{g}^{i})^{+}}+\sum_{j}e^{f(o_{%
t}^{i},a_{t}^{i},o_{g^{\prime}}^{j})^{-}}}\big{]}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.10d">roman_max start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT start_ARG start_ROW start_CELL ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) âˆ¼ italic_Ï„ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL italic_o start_POSTSUBSCRIPT italic_g start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT âˆ¼ italic_Ï„ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_CELL end_ROW end_ARG end_POSTSUBSCRIPT italic_l italic_o italic_g [ divide start_ARG italic_e start_POSTSUPERSCRIPT italic_f ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_ARG start_ARG italic_e start_POSTSUPERSCRIPT italic_f ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT + âˆ‘ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT italic_f ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_o start_POSTSUBSCRIPT italic_g start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS2.p7">
<p class="ltx_p" id="S2.SS2.p7.5">Where <math alttext="f(o_{t},a_{t},o_{g})^{+}" class="ltx_Math" display="inline" id="S2.SS2.p7.1.m1.3"><semantics id="S2.SS2.p7.1.m1.3a"><mrow id="S2.SS2.p7.1.m1.3.3" xref="S2.SS2.p7.1.m1.3.3.cmml"><mi id="S2.SS2.p7.1.m1.3.3.5" xref="S2.SS2.p7.1.m1.3.3.5.cmml">f</mi><mo id="S2.SS2.p7.1.m1.3.3.4" xref="S2.SS2.p7.1.m1.3.3.4.cmml">â¢</mo><msup id="S2.SS2.p7.1.m1.3.3.3" xref="S2.SS2.p7.1.m1.3.3.3.cmml"><mrow id="S2.SS2.p7.1.m1.3.3.3.3.3" xref="S2.SS2.p7.1.m1.3.3.3.3.4.cmml"><mo id="S2.SS2.p7.1.m1.3.3.3.3.3.4" stretchy="false" xref="S2.SS2.p7.1.m1.3.3.3.3.4.cmml">(</mo><msub id="S2.SS2.p7.1.m1.1.1.1.1.1.1" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p7.1.m1.1.1.1.1.1.1.2" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.2.cmml">o</mi><mi id="S2.SS2.p7.1.m1.1.1.1.1.1.1.3" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p7.1.m1.3.3.3.3.3.5" xref="S2.SS2.p7.1.m1.3.3.3.3.4.cmml">,</mo><msub id="S2.SS2.p7.1.m1.2.2.2.2.2.2" xref="S2.SS2.p7.1.m1.2.2.2.2.2.2.cmml"><mi id="S2.SS2.p7.1.m1.2.2.2.2.2.2.2" xref="S2.SS2.p7.1.m1.2.2.2.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p7.1.m1.2.2.2.2.2.2.3" xref="S2.SS2.p7.1.m1.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS2.p7.1.m1.3.3.3.3.3.6" xref="S2.SS2.p7.1.m1.3.3.3.3.4.cmml">,</mo><msub id="S2.SS2.p7.1.m1.3.3.3.3.3.3" xref="S2.SS2.p7.1.m1.3.3.3.3.3.3.cmml"><mi id="S2.SS2.p7.1.m1.3.3.3.3.3.3.2" xref="S2.SS2.p7.1.m1.3.3.3.3.3.3.2.cmml">o</mi><mi id="S2.SS2.p7.1.m1.3.3.3.3.3.3.3" xref="S2.SS2.p7.1.m1.3.3.3.3.3.3.3.cmml">g</mi></msub><mo id="S2.SS2.p7.1.m1.3.3.3.3.3.7" stretchy="false" xref="S2.SS2.p7.1.m1.3.3.3.3.4.cmml">)</mo></mrow><mo id="S2.SS2.p7.1.m1.3.3.3.5" xref="S2.SS2.p7.1.m1.3.3.3.5.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.1.m1.3b"><apply id="S2.SS2.p7.1.m1.3.3.cmml" xref="S2.SS2.p7.1.m1.3.3"><times id="S2.SS2.p7.1.m1.3.3.4.cmml" xref="S2.SS2.p7.1.m1.3.3.4"></times><ci id="S2.SS2.p7.1.m1.3.3.5.cmml" xref="S2.SS2.p7.1.m1.3.3.5">ğ‘“</ci><apply id="S2.SS2.p7.1.m1.3.3.3.cmml" xref="S2.SS2.p7.1.m1.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p7.1.m1.3.3.3.4.cmml" xref="S2.SS2.p7.1.m1.3.3.3">superscript</csymbol><vector id="S2.SS2.p7.1.m1.3.3.3.3.4.cmml" xref="S2.SS2.p7.1.m1.3.3.3.3.3"><apply id="S2.SS2.p7.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p7.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p7.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p7.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1.1.1.3">ğ‘¡</ci></apply><apply id="S2.SS2.p7.1.m1.2.2.2.2.2.2.cmml" xref="S2.SS2.p7.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p7.1.m1.2.2.2.2.2.2.1.cmml" xref="S2.SS2.p7.1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p7.1.m1.2.2.2.2.2.2.2.cmml" xref="S2.SS2.p7.1.m1.2.2.2.2.2.2.2">ğ‘</ci><ci id="S2.SS2.p7.1.m1.2.2.2.2.2.2.3.cmml" xref="S2.SS2.p7.1.m1.2.2.2.2.2.2.3">ğ‘¡</ci></apply><apply id="S2.SS2.p7.1.m1.3.3.3.3.3.3.cmml" xref="S2.SS2.p7.1.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p7.1.m1.3.3.3.3.3.3.1.cmml" xref="S2.SS2.p7.1.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S2.SS2.p7.1.m1.3.3.3.3.3.3.2.cmml" xref="S2.SS2.p7.1.m1.3.3.3.3.3.3.2">ğ‘œ</ci><ci id="S2.SS2.p7.1.m1.3.3.3.3.3.3.3.cmml" xref="S2.SS2.p7.1.m1.3.3.3.3.3.3.3">ğ‘”</ci></apply></vector><plus id="S2.SS2.p7.1.m1.3.3.3.5.cmml" xref="S2.SS2.p7.1.m1.3.3.3.5"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.1.m1.3c">f(o_{t},a_{t},o_{g})^{+}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p7.1.m1.3d">italic_f ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> and, <math alttext="f(o_{t},a_{t},o_{g})^{-}" class="ltx_Math" display="inline" id="S2.SS2.p7.2.m2.3"><semantics id="S2.SS2.p7.2.m2.3a"><mrow id="S2.SS2.p7.2.m2.3.3" xref="S2.SS2.p7.2.m2.3.3.cmml"><mi id="S2.SS2.p7.2.m2.3.3.5" xref="S2.SS2.p7.2.m2.3.3.5.cmml">f</mi><mo id="S2.SS2.p7.2.m2.3.3.4" xref="S2.SS2.p7.2.m2.3.3.4.cmml">â¢</mo><msup id="S2.SS2.p7.2.m2.3.3.3" xref="S2.SS2.p7.2.m2.3.3.3.cmml"><mrow id="S2.SS2.p7.2.m2.3.3.3.3.3" xref="S2.SS2.p7.2.m2.3.3.3.3.4.cmml"><mo id="S2.SS2.p7.2.m2.3.3.3.3.3.4" stretchy="false" xref="S2.SS2.p7.2.m2.3.3.3.3.4.cmml">(</mo><msub id="S2.SS2.p7.2.m2.1.1.1.1.1.1" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p7.2.m2.1.1.1.1.1.1.2" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.2.cmml">o</mi><mi id="S2.SS2.p7.2.m2.1.1.1.1.1.1.3" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p7.2.m2.3.3.3.3.3.5" xref="S2.SS2.p7.2.m2.3.3.3.3.4.cmml">,</mo><msub id="S2.SS2.p7.2.m2.2.2.2.2.2.2" xref="S2.SS2.p7.2.m2.2.2.2.2.2.2.cmml"><mi id="S2.SS2.p7.2.m2.2.2.2.2.2.2.2" xref="S2.SS2.p7.2.m2.2.2.2.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p7.2.m2.2.2.2.2.2.2.3" xref="S2.SS2.p7.2.m2.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS2.p7.2.m2.3.3.3.3.3.6" xref="S2.SS2.p7.2.m2.3.3.3.3.4.cmml">,</mo><msub id="S2.SS2.p7.2.m2.3.3.3.3.3.3" xref="S2.SS2.p7.2.m2.3.3.3.3.3.3.cmml"><mi id="S2.SS2.p7.2.m2.3.3.3.3.3.3.2" xref="S2.SS2.p7.2.m2.3.3.3.3.3.3.2.cmml">o</mi><mi id="S2.SS2.p7.2.m2.3.3.3.3.3.3.3" xref="S2.SS2.p7.2.m2.3.3.3.3.3.3.3.cmml">g</mi></msub><mo id="S2.SS2.p7.2.m2.3.3.3.3.3.7" stretchy="false" xref="S2.SS2.p7.2.m2.3.3.3.3.4.cmml">)</mo></mrow><mo id="S2.SS2.p7.2.m2.3.3.3.5" xref="S2.SS2.p7.2.m2.3.3.3.5.cmml">âˆ’</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.2.m2.3b"><apply id="S2.SS2.p7.2.m2.3.3.cmml" xref="S2.SS2.p7.2.m2.3.3"><times id="S2.SS2.p7.2.m2.3.3.4.cmml" xref="S2.SS2.p7.2.m2.3.3.4"></times><ci id="S2.SS2.p7.2.m2.3.3.5.cmml" xref="S2.SS2.p7.2.m2.3.3.5">ğ‘“</ci><apply id="S2.SS2.p7.2.m2.3.3.3.cmml" xref="S2.SS2.p7.2.m2.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p7.2.m2.3.3.3.4.cmml" xref="S2.SS2.p7.2.m2.3.3.3">superscript</csymbol><vector id="S2.SS2.p7.2.m2.3.3.3.3.4.cmml" xref="S2.SS2.p7.2.m2.3.3.3.3.3"><apply id="S2.SS2.p7.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p7.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p7.2.m2.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p7.2.m2.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p7.2.m2.1.1.1.1.1.1.3">ğ‘¡</ci></apply><apply id="S2.SS2.p7.2.m2.2.2.2.2.2.2.cmml" xref="S2.SS2.p7.2.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p7.2.m2.2.2.2.2.2.2.1.cmml" xref="S2.SS2.p7.2.m2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p7.2.m2.2.2.2.2.2.2.2.cmml" xref="S2.SS2.p7.2.m2.2.2.2.2.2.2.2">ğ‘</ci><ci id="S2.SS2.p7.2.m2.2.2.2.2.2.2.3.cmml" xref="S2.SS2.p7.2.m2.2.2.2.2.2.2.3">ğ‘¡</ci></apply><apply id="S2.SS2.p7.2.m2.3.3.3.3.3.3.cmml" xref="S2.SS2.p7.2.m2.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p7.2.m2.3.3.3.3.3.3.1.cmml" xref="S2.SS2.p7.2.m2.3.3.3.3.3.3">subscript</csymbol><ci id="S2.SS2.p7.2.m2.3.3.3.3.3.3.2.cmml" xref="S2.SS2.p7.2.m2.3.3.3.3.3.3.2">ğ‘œ</ci><ci id="S2.SS2.p7.2.m2.3.3.3.3.3.3.3.cmml" xref="S2.SS2.p7.2.m2.3.3.3.3.3.3.3">ğ‘”</ci></apply></vector><minus id="S2.SS2.p7.2.m2.3.3.3.5.cmml" xref="S2.SS2.p7.2.m2.3.3.3.5"></minus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.2.m2.3c">f(o_{t},a_{t},o_{g})^{-}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p7.2.m2.3d">italic_f ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math> denote the critic output for positive and negative examples respectively. The inner product between all SA and goal representations in a batch of size <math alttext="N" class="ltx_Math" display="inline" id="S2.SS2.p7.3.m3.1"><semantics id="S2.SS2.p7.3.m3.1a"><mi id="S2.SS2.p7.3.m3.1.1" xref="S2.SS2.p7.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.3.m3.1b"><ci id="S2.SS2.p7.3.m3.1.1.cmml" xref="S2.SS2.p7.3.m3.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p7.3.m3.1d">italic_N</annotation></semantics></math> gives a matrix <math alttext="Q_{M}" class="ltx_Math" display="inline" id="S2.SS2.p7.4.m4.1"><semantics id="S2.SS2.p7.4.m4.1a"><msub id="S2.SS2.p7.4.m4.1.1" xref="S2.SS2.p7.4.m4.1.1.cmml"><mi id="S2.SS2.p7.4.m4.1.1.2" xref="S2.SS2.p7.4.m4.1.1.2.cmml">Q</mi><mi id="S2.SS2.p7.4.m4.1.1.3" xref="S2.SS2.p7.4.m4.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.4.m4.1b"><apply id="S2.SS2.p7.4.m4.1.1.cmml" xref="S2.SS2.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p7.4.m4.1.1.1.cmml" xref="S2.SS2.p7.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p7.4.m4.1.1.2.cmml" xref="S2.SS2.p7.4.m4.1.1.2">ğ‘„</ci><ci id="S2.SS2.p7.4.m4.1.1.3.cmml" xref="S2.SS2.p7.4.m4.1.1.3">ğ‘€</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.4.m4.1c">Q_{M}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p7.4.m4.1d">italic_Q start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> of size <math alttext="(N,N)" class="ltx_Math" display="inline" id="S2.SS2.p7.5.m5.2"><semantics id="S2.SS2.p7.5.m5.2a"><mrow id="S2.SS2.p7.5.m5.2.3.2" xref="S2.SS2.p7.5.m5.2.3.1.cmml"><mo id="S2.SS2.p7.5.m5.2.3.2.1" stretchy="false" xref="S2.SS2.p7.5.m5.2.3.1.cmml">(</mo><mi id="S2.SS2.p7.5.m5.1.1" xref="S2.SS2.p7.5.m5.1.1.cmml">N</mi><mo id="S2.SS2.p7.5.m5.2.3.2.2" xref="S2.SS2.p7.5.m5.2.3.1.cmml">,</mo><mi id="S2.SS2.p7.5.m5.2.2" xref="S2.SS2.p7.5.m5.2.2.cmml">N</mi><mo id="S2.SS2.p7.5.m5.2.3.2.3" stretchy="false" xref="S2.SS2.p7.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.5.m5.2b"><interval closure="open" id="S2.SS2.p7.5.m5.2.3.1.cmml" xref="S2.SS2.p7.5.m5.2.3.2"><ci id="S2.SS2.p7.5.m5.1.1.cmml" xref="S2.SS2.p7.5.m5.1.1">ğ‘</ci><ci id="S2.SS2.p7.5.m5.2.2.cmml" xref="S2.SS2.p7.5.m5.2.2">ğ‘</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.5.m5.2c">(N,N)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p7.5.m5.2d">( italic_N , italic_N )</annotation></semantics></math> on which we apply a cross-entropy loss row and column-wise, with the true labels being on the diagonal. In order to stabilize the critic training, we observed that the normalization of the goal representations was necessary. Furthermore, the use of a temperature scaling parameter of state-action representations, combined with L2 regularization was necessary. Hyperparameters are listed in the supplementary material.</p>
</div>
<div class="ltx_para" id="S2.SS2.p8">
<p class="ltx_p" id="S2.SS2.p8.2"><span class="ltx_text ltx_font_bold" id="S2.SS2.p8.2.1">Actor loss:</span> The actor takes as input observation and goal pairs <math alttext="(o_{t},o_{g})" class="ltx_Math" display="inline" id="S2.SS2.p8.1.m1.2"><semantics id="S2.SS2.p8.1.m1.2a"><mrow id="S2.SS2.p8.1.m1.2.2.2" xref="S2.SS2.p8.1.m1.2.2.3.cmml"><mo id="S2.SS2.p8.1.m1.2.2.2.3" stretchy="false" xref="S2.SS2.p8.1.m1.2.2.3.cmml">(</mo><msub id="S2.SS2.p8.1.m1.1.1.1.1" xref="S2.SS2.p8.1.m1.1.1.1.1.cmml"><mi id="S2.SS2.p8.1.m1.1.1.1.1.2" xref="S2.SS2.p8.1.m1.1.1.1.1.2.cmml">o</mi><mi id="S2.SS2.p8.1.m1.1.1.1.1.3" xref="S2.SS2.p8.1.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p8.1.m1.2.2.2.4" xref="S2.SS2.p8.1.m1.2.2.3.cmml">,</mo><msub id="S2.SS2.p8.1.m1.2.2.2.2" xref="S2.SS2.p8.1.m1.2.2.2.2.cmml"><mi id="S2.SS2.p8.1.m1.2.2.2.2.2" xref="S2.SS2.p8.1.m1.2.2.2.2.2.cmml">o</mi><mi id="S2.SS2.p8.1.m1.2.2.2.2.3" xref="S2.SS2.p8.1.m1.2.2.2.2.3.cmml">g</mi></msub><mo id="S2.SS2.p8.1.m1.2.2.2.5" stretchy="false" xref="S2.SS2.p8.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.1.m1.2b"><interval closure="open" id="S2.SS2.p8.1.m1.2.2.3.cmml" xref="S2.SS2.p8.1.m1.2.2.2"><apply id="S2.SS2.p8.1.m1.1.1.1.1.cmml" xref="S2.SS2.p8.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p8.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p8.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p8.1.m1.1.1.1.1.2.cmml" xref="S2.SS2.p8.1.m1.1.1.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p8.1.m1.1.1.1.1.3.cmml" xref="S2.SS2.p8.1.m1.1.1.1.1.3">ğ‘¡</ci></apply><apply id="S2.SS2.p8.1.m1.2.2.2.2.cmml" xref="S2.SS2.p8.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p8.1.m1.2.2.2.2.1.cmml" xref="S2.SS2.p8.1.m1.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p8.1.m1.2.2.2.2.2.cmml" xref="S2.SS2.p8.1.m1.2.2.2.2.2">ğ‘œ</ci><ci id="S2.SS2.p8.1.m1.2.2.2.2.3.cmml" xref="S2.SS2.p8.1.m1.2.2.2.2.3">ğ‘”</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.1.m1.2c">(o_{t},o_{g})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p8.1.m1.2d">( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT )</annotation></semantics></math> and returns an action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S2.SS2.p8.2.m2.1"><semantics id="S2.SS2.p8.2.m2.1a"><msub id="S2.SS2.p8.2.m2.1.1" xref="S2.SS2.p8.2.m2.1.1.cmml"><mi id="S2.SS2.p8.2.m2.1.1.2" xref="S2.SS2.p8.2.m2.1.1.2.cmml">a</mi><mi id="S2.SS2.p8.2.m2.1.1.3" xref="S2.SS2.p8.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.2.m2.1b"><apply id="S2.SS2.p8.2.m2.1.1.cmml" xref="S2.SS2.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p8.2.m2.1.1.1.cmml" xref="S2.SS2.p8.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p8.2.m2.1.1.2.cmml" xref="S2.SS2.p8.2.m2.1.1.2">ğ‘</ci><ci id="S2.SS2.p8.2.m2.1.1.3.cmml" xref="S2.SS2.p8.2.m2.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.2.m2.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p8.2.m2.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to reach the goal. The actor simply aims at maximizing the critic output such that:</p>
</div>
<div class="ltx_para" id="S2.SS2.p9">
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{\pi}\mathbb{E}_{\begin{subarray}{c}a_{t}\sim\pi(o_{t},o_{g})\end{%
subarray}}f(o_{t},a_{t},o_{g})" class="ltx_Math" display="block" id="S2.E2.m1.4"><semantics id="S2.E2.m1.4a"><mrow id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml"><mrow id="S2.E2.m1.4.4.5" xref="S2.E2.m1.4.4.5.cmml"><munder id="S2.E2.m1.4.4.5.1" xref="S2.E2.m1.4.4.5.1.cmml"><mi id="S2.E2.m1.4.4.5.1.2" xref="S2.E2.m1.4.4.5.1.2.cmml">max</mi><mi id="S2.E2.m1.4.4.5.1.3" xref="S2.E2.m1.4.4.5.1.3.cmml">Ï€</mi></munder><mo id="S2.E2.m1.4.4.5a" lspace="0.167em" xref="S2.E2.m1.4.4.5.cmml">â¡</mo><mrow id="S2.E2.m1.4.4.5.2" xref="S2.E2.m1.4.4.5.2.cmml"><msub id="S2.E2.m1.4.4.5.2.2" xref="S2.E2.m1.4.4.5.2.2.cmml"><mi id="S2.E2.m1.4.4.5.2.2.2" xref="S2.E2.m1.4.4.5.2.2.2.cmml">ğ”¼</mi><mtable id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.2.cmml"><mtr id="S2.E2.m1.1.1.1.1.1.1a" xref="S2.E2.m1.1.1.1.2.cmml"><mtd id="S2.E2.m1.1.1.1.1.1.1b" xref="S2.E2.m1.1.1.1.2.cmml"><mrow id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.cmml"><msub id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.4" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.4.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.4.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.4.2.cmml">a</mi><mi id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.4.3" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.4.3.cmml">t</mi></msub><mo id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.3.cmml">âˆ¼</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.4" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.4.cmml">Ï€</mi><mo id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.3.cmml">â¢</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml"><mo id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.3" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml">(</mo><msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">o</mi><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.4" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml">,</mo><msub id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.2.cmml">o</mi><mi id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.3.cmml">g</mi></msub><mo id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.5" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable></msub><mo id="S2.E2.m1.4.4.5.2.1" xref="S2.E2.m1.4.4.5.2.1.cmml">â¢</mo><mi id="S2.E2.m1.4.4.5.2.3" xref="S2.E2.m1.4.4.5.2.3.cmml">f</mi></mrow></mrow><mo id="S2.E2.m1.4.4.4" xref="S2.E2.m1.4.4.4.cmml">â¢</mo><mrow id="S2.E2.m1.4.4.3.3" xref="S2.E2.m1.4.4.3.4.cmml"><mo id="S2.E2.m1.4.4.3.3.4" stretchy="false" xref="S2.E2.m1.4.4.3.4.cmml">(</mo><msub id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.2.cmml">o</mi><mi id="S2.E2.m1.2.2.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S2.E2.m1.4.4.3.3.5" xref="S2.E2.m1.4.4.3.4.cmml">,</mo><msub id="S2.E2.m1.3.3.2.2.2" xref="S2.E2.m1.3.3.2.2.2.cmml"><mi id="S2.E2.m1.3.3.2.2.2.2" xref="S2.E2.m1.3.3.2.2.2.2.cmml">a</mi><mi id="S2.E2.m1.3.3.2.2.2.3" xref="S2.E2.m1.3.3.2.2.2.3.cmml">t</mi></msub><mo id="S2.E2.m1.4.4.3.3.6" xref="S2.E2.m1.4.4.3.4.cmml">,</mo><msub id="S2.E2.m1.4.4.3.3.3" xref="S2.E2.m1.4.4.3.3.3.cmml"><mi id="S2.E2.m1.4.4.3.3.3.2" xref="S2.E2.m1.4.4.3.3.3.2.cmml">o</mi><mi id="S2.E2.m1.4.4.3.3.3.3" xref="S2.E2.m1.4.4.3.3.3.3.cmml">g</mi></msub><mo id="S2.E2.m1.4.4.3.3.7" stretchy="false" xref="S2.E2.m1.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.4b"><apply id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4"><times id="S2.E2.m1.4.4.4.cmml" xref="S2.E2.m1.4.4.4"></times><apply id="S2.E2.m1.4.4.5.cmml" xref="S2.E2.m1.4.4.5"><apply id="S2.E2.m1.4.4.5.1.cmml" xref="S2.E2.m1.4.4.5.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.5.1.1.cmml" xref="S2.E2.m1.4.4.5.1">subscript</csymbol><max id="S2.E2.m1.4.4.5.1.2.cmml" xref="S2.E2.m1.4.4.5.1.2"></max><ci id="S2.E2.m1.4.4.5.1.3.cmml" xref="S2.E2.m1.4.4.5.1.3">ğœ‹</ci></apply><apply id="S2.E2.m1.4.4.5.2.cmml" xref="S2.E2.m1.4.4.5.2"><times id="S2.E2.m1.4.4.5.2.1.cmml" xref="S2.E2.m1.4.4.5.2.1"></times><apply id="S2.E2.m1.4.4.5.2.2.cmml" xref="S2.E2.m1.4.4.5.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.5.2.2.1.cmml" xref="S2.E2.m1.4.4.5.2.2">subscript</csymbol><ci id="S2.E2.m1.4.4.5.2.2.2.cmml" xref="S2.E2.m1.4.4.5.2.2.2">ğ”¼</ci><list id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1"><matrix id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1"><matrixrow id="S2.E2.m1.1.1.1.1.1.1a.cmml" xref="S2.E2.m1.1.1.1.1.1.1"><apply id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.3">similar-to</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.4.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.4"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.4.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.4">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.4.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.4.2">ğ‘</ci><ci id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.4.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.4.3">ğ‘¡</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2"><times id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.3"></times><ci id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.4.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.4">ğœ‹</ci><interval closure="open" id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2"><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">ğ‘œ</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">ğ‘¡</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.2">ğ‘œ</ci><ci id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2.3">ğ‘”</ci></apply></interval></apply></apply></matrixrow></matrix></list></apply><ci id="S2.E2.m1.4.4.5.2.3.cmml" xref="S2.E2.m1.4.4.5.2.3">ğ‘“</ci></apply></apply><vector id="S2.E2.m1.4.4.3.4.cmml" xref="S2.E2.m1.4.4.3.3"><apply id="S2.E2.m1.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.2">ğ‘œ</ci><ci id="S2.E2.m1.2.2.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.3">ğ‘¡</ci></apply><apply id="S2.E2.m1.3.3.2.2.2.cmml" xref="S2.E2.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.2.2.2.1.cmml" xref="S2.E2.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.E2.m1.3.3.2.2.2.2.cmml" xref="S2.E2.m1.3.3.2.2.2.2">ğ‘</ci><ci id="S2.E2.m1.3.3.2.2.2.3.cmml" xref="S2.E2.m1.3.3.2.2.2.3">ğ‘¡</ci></apply><apply id="S2.E2.m1.4.4.3.3.3.cmml" xref="S2.E2.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.3.3.3.1.cmml" xref="S2.E2.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.E2.m1.4.4.3.3.3.2.cmml" xref="S2.E2.m1.4.4.3.3.3.2">ğ‘œ</ci><ci id="S2.E2.m1.4.4.3.3.3.3.cmml" xref="S2.E2.m1.4.4.3.3.3.3">ğ‘”</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.4c">\max_{\pi}\mathbb{E}_{\begin{subarray}{c}a_{t}\sim\pi(o_{t},o_{g})\end{%
subarray}}f(o_{t},a_{t},o_{g})</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.4d">roman_max start_POSTSUBSCRIPT italic_Ï€ end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT start_ARG start_ROW start_CELL italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ¼ italic_Ï€ ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ) end_CELL end_ROW end_ARG end_POSTSUBSCRIPT italic_f ( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS2.p10">
<p class="ltx_p" id="S2.SS2.p10.1">In practice, the actor outputs the mean and standard deviation of a multivariate Gaussian from which we sample and apply tanh squashing to obtain the bounded actions.
During training, we noticed that using random goals sampled from other trajectories rather than goals from the same trajectory as <math alttext="o_{t}" class="ltx_Math" display="inline" id="S2.SS2.p10.1.m1.1"><semantics id="S2.SS2.p10.1.m1.1a"><msub id="S2.SS2.p10.1.m1.1.1" xref="S2.SS2.p10.1.m1.1.1.cmml"><mi id="S2.SS2.p10.1.m1.1.1.2" xref="S2.SS2.p10.1.m1.1.1.2.cmml">o</mi><mi id="S2.SS2.p10.1.m1.1.1.3" xref="S2.SS2.p10.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p10.1.m1.1b"><apply id="S2.SS2.p10.1.m1.1.1.cmml" xref="S2.SS2.p10.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p10.1.m1.1.1.1.cmml" xref="S2.SS2.p10.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p10.1.m1.1.1.2.cmml" xref="S2.SS2.p10.1.m1.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p10.1.m1.1.1.3.cmml" xref="S2.SS2.p10.1.m1.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p10.1.m1.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p10.1.m1.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> led to better actor performance, as also reported in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib11" title="">11</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p11">
<p class="ltx_p" id="S2.SS2.p11.8"><span class="ltx_text ltx_font_bold" id="S2.SS2.p11.8.1">Data augmented contrastive loss:</span> Given a triplet <math alttext="(o_{t},a_{t},o_{g})" class="ltx_Math" display="inline" id="S2.SS2.p11.1.m1.3"><semantics id="S2.SS2.p11.1.m1.3a"><mrow id="S2.SS2.p11.1.m1.3.3.3" xref="S2.SS2.p11.1.m1.3.3.4.cmml"><mo id="S2.SS2.p11.1.m1.3.3.3.4" stretchy="false" xref="S2.SS2.p11.1.m1.3.3.4.cmml">(</mo><msub id="S2.SS2.p11.1.m1.1.1.1.1" xref="S2.SS2.p11.1.m1.1.1.1.1.cmml"><mi id="S2.SS2.p11.1.m1.1.1.1.1.2" xref="S2.SS2.p11.1.m1.1.1.1.1.2.cmml">o</mi><mi id="S2.SS2.p11.1.m1.1.1.1.1.3" xref="S2.SS2.p11.1.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p11.1.m1.3.3.3.5" xref="S2.SS2.p11.1.m1.3.3.4.cmml">,</mo><msub id="S2.SS2.p11.1.m1.2.2.2.2" xref="S2.SS2.p11.1.m1.2.2.2.2.cmml"><mi id="S2.SS2.p11.1.m1.2.2.2.2.2" xref="S2.SS2.p11.1.m1.2.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p11.1.m1.2.2.2.2.3" xref="S2.SS2.p11.1.m1.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS2.p11.1.m1.3.3.3.6" xref="S2.SS2.p11.1.m1.3.3.4.cmml">,</mo><msub id="S2.SS2.p11.1.m1.3.3.3.3" xref="S2.SS2.p11.1.m1.3.3.3.3.cmml"><mi id="S2.SS2.p11.1.m1.3.3.3.3.2" xref="S2.SS2.p11.1.m1.3.3.3.3.2.cmml">o</mi><mi id="S2.SS2.p11.1.m1.3.3.3.3.3" xref="S2.SS2.p11.1.m1.3.3.3.3.3.cmml">g</mi></msub><mo id="S2.SS2.p11.1.m1.3.3.3.7" stretchy="false" xref="S2.SS2.p11.1.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p11.1.m1.3b"><vector id="S2.SS2.p11.1.m1.3.3.4.cmml" xref="S2.SS2.p11.1.m1.3.3.3"><apply id="S2.SS2.p11.1.m1.1.1.1.1.cmml" xref="S2.SS2.p11.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p11.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p11.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p11.1.m1.1.1.1.1.2.cmml" xref="S2.SS2.p11.1.m1.1.1.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p11.1.m1.1.1.1.1.3.cmml" xref="S2.SS2.p11.1.m1.1.1.1.1.3">ğ‘¡</ci></apply><apply id="S2.SS2.p11.1.m1.2.2.2.2.cmml" xref="S2.SS2.p11.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p11.1.m1.2.2.2.2.1.cmml" xref="S2.SS2.p11.1.m1.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p11.1.m1.2.2.2.2.2.cmml" xref="S2.SS2.p11.1.m1.2.2.2.2.2">ğ‘</ci><ci id="S2.SS2.p11.1.m1.2.2.2.2.3.cmml" xref="S2.SS2.p11.1.m1.2.2.2.2.3">ğ‘¡</ci></apply><apply id="S2.SS2.p11.1.m1.3.3.3.3.cmml" xref="S2.SS2.p11.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p11.1.m1.3.3.3.3.1.cmml" xref="S2.SS2.p11.1.m1.3.3.3.3">subscript</csymbol><ci id="S2.SS2.p11.1.m1.3.3.3.3.2.cmml" xref="S2.SS2.p11.1.m1.3.3.3.3.2">ğ‘œ</ci><ci id="S2.SS2.p11.1.m1.3.3.3.3.3.cmml" xref="S2.SS2.p11.1.m1.3.3.3.3.3">ğ‘”</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p11.1.m1.3c">(o_{t},a_{t},o_{g})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p11.1.m1.3d">( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT )</annotation></semantics></math>, the critic output should be similar to the data augmented triplet <math alttext="(o^{\prime}_{t},a_{t},o^{\prime}_{g})" class="ltx_Math" display="inline" id="S2.SS2.p11.2.m2.3"><semantics id="S2.SS2.p11.2.m2.3a"><mrow id="S2.SS2.p11.2.m2.3.3.3" xref="S2.SS2.p11.2.m2.3.3.4.cmml"><mo id="S2.SS2.p11.2.m2.3.3.3.4" stretchy="false" xref="S2.SS2.p11.2.m2.3.3.4.cmml">(</mo><msubsup id="S2.SS2.p11.2.m2.1.1.1.1" xref="S2.SS2.p11.2.m2.1.1.1.1.cmml"><mi id="S2.SS2.p11.2.m2.1.1.1.1.2.2" xref="S2.SS2.p11.2.m2.1.1.1.1.2.2.cmml">o</mi><mi id="S2.SS2.p11.2.m2.1.1.1.1.3" xref="S2.SS2.p11.2.m2.1.1.1.1.3.cmml">t</mi><mo id="S2.SS2.p11.2.m2.1.1.1.1.2.3" xref="S2.SS2.p11.2.m2.1.1.1.1.2.3.cmml">â€²</mo></msubsup><mo id="S2.SS2.p11.2.m2.3.3.3.5" xref="S2.SS2.p11.2.m2.3.3.4.cmml">,</mo><msub id="S2.SS2.p11.2.m2.2.2.2.2" xref="S2.SS2.p11.2.m2.2.2.2.2.cmml"><mi id="S2.SS2.p11.2.m2.2.2.2.2.2" xref="S2.SS2.p11.2.m2.2.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p11.2.m2.2.2.2.2.3" xref="S2.SS2.p11.2.m2.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS2.p11.2.m2.3.3.3.6" xref="S2.SS2.p11.2.m2.3.3.4.cmml">,</mo><msubsup id="S2.SS2.p11.2.m2.3.3.3.3" xref="S2.SS2.p11.2.m2.3.3.3.3.cmml"><mi id="S2.SS2.p11.2.m2.3.3.3.3.2.2" xref="S2.SS2.p11.2.m2.3.3.3.3.2.2.cmml">o</mi><mi id="S2.SS2.p11.2.m2.3.3.3.3.3" xref="S2.SS2.p11.2.m2.3.3.3.3.3.cmml">g</mi><mo id="S2.SS2.p11.2.m2.3.3.3.3.2.3" xref="S2.SS2.p11.2.m2.3.3.3.3.2.3.cmml">â€²</mo></msubsup><mo id="S2.SS2.p11.2.m2.3.3.3.7" stretchy="false" xref="S2.SS2.p11.2.m2.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p11.2.m2.3b"><vector id="S2.SS2.p11.2.m2.3.3.4.cmml" xref="S2.SS2.p11.2.m2.3.3.3"><apply id="S2.SS2.p11.2.m2.1.1.1.1.cmml" xref="S2.SS2.p11.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p11.2.m2.1.1.1.1.1.cmml" xref="S2.SS2.p11.2.m2.1.1.1.1">subscript</csymbol><apply id="S2.SS2.p11.2.m2.1.1.1.1.2.cmml" xref="S2.SS2.p11.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p11.2.m2.1.1.1.1.2.1.cmml" xref="S2.SS2.p11.2.m2.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p11.2.m2.1.1.1.1.2.2.cmml" xref="S2.SS2.p11.2.m2.1.1.1.1.2.2">ğ‘œ</ci><ci id="S2.SS2.p11.2.m2.1.1.1.1.2.3.cmml" xref="S2.SS2.p11.2.m2.1.1.1.1.2.3">â€²</ci></apply><ci id="S2.SS2.p11.2.m2.1.1.1.1.3.cmml" xref="S2.SS2.p11.2.m2.1.1.1.1.3">ğ‘¡</ci></apply><apply id="S2.SS2.p11.2.m2.2.2.2.2.cmml" xref="S2.SS2.p11.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p11.2.m2.2.2.2.2.1.cmml" xref="S2.SS2.p11.2.m2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p11.2.m2.2.2.2.2.2.cmml" xref="S2.SS2.p11.2.m2.2.2.2.2.2">ğ‘</ci><ci id="S2.SS2.p11.2.m2.2.2.2.2.3.cmml" xref="S2.SS2.p11.2.m2.2.2.2.2.3">ğ‘¡</ci></apply><apply id="S2.SS2.p11.2.m2.3.3.3.3.cmml" xref="S2.SS2.p11.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p11.2.m2.3.3.3.3.1.cmml" xref="S2.SS2.p11.2.m2.3.3.3.3">subscript</csymbol><apply id="S2.SS2.p11.2.m2.3.3.3.3.2.cmml" xref="S2.SS2.p11.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p11.2.m2.3.3.3.3.2.1.cmml" xref="S2.SS2.p11.2.m2.3.3.3.3">superscript</csymbol><ci id="S2.SS2.p11.2.m2.3.3.3.3.2.2.cmml" xref="S2.SS2.p11.2.m2.3.3.3.3.2.2">ğ‘œ</ci><ci id="S2.SS2.p11.2.m2.3.3.3.3.2.3.cmml" xref="S2.SS2.p11.2.m2.3.3.3.3.2.3">â€²</ci></apply><ci id="S2.SS2.p11.2.m2.3.3.3.3.3.cmml" xref="S2.SS2.p11.2.m2.3.3.3.3.3">ğ‘”</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p11.2.m2.3c">(o^{\prime}_{t},a_{t},o^{\prime}_{g})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p11.2.m2.3d">( italic_o start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="o^{\prime}_{t}" class="ltx_Math" display="inline" id="S2.SS2.p11.3.m3.1"><semantics id="S2.SS2.p11.3.m3.1a"><msubsup id="S2.SS2.p11.3.m3.1.1" xref="S2.SS2.p11.3.m3.1.1.cmml"><mi id="S2.SS2.p11.3.m3.1.1.2.2" xref="S2.SS2.p11.3.m3.1.1.2.2.cmml">o</mi><mi id="S2.SS2.p11.3.m3.1.1.3" xref="S2.SS2.p11.3.m3.1.1.3.cmml">t</mi><mo id="S2.SS2.p11.3.m3.1.1.2.3" xref="S2.SS2.p11.3.m3.1.1.2.3.cmml">â€²</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p11.3.m3.1b"><apply id="S2.SS2.p11.3.m3.1.1.cmml" xref="S2.SS2.p11.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p11.3.m3.1.1.1.cmml" xref="S2.SS2.p11.3.m3.1.1">subscript</csymbol><apply id="S2.SS2.p11.3.m3.1.1.2.cmml" xref="S2.SS2.p11.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p11.3.m3.1.1.2.1.cmml" xref="S2.SS2.p11.3.m3.1.1">superscript</csymbol><ci id="S2.SS2.p11.3.m3.1.1.2.2.cmml" xref="S2.SS2.p11.3.m3.1.1.2.2">ğ‘œ</ci><ci id="S2.SS2.p11.3.m3.1.1.2.3.cmml" xref="S2.SS2.p11.3.m3.1.1.2.3">â€²</ci></apply><ci id="S2.SS2.p11.3.m3.1.1.3.cmml" xref="S2.SS2.p11.3.m3.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p11.3.m3.1c">o^{\prime}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p11.3.m3.1d">italic_o start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is a randomly shifted version of <math alttext="o_{t}" class="ltx_Math" display="inline" id="S2.SS2.p11.4.m4.1"><semantics id="S2.SS2.p11.4.m4.1a"><msub id="S2.SS2.p11.4.m4.1.1" xref="S2.SS2.p11.4.m4.1.1.cmml"><mi id="S2.SS2.p11.4.m4.1.1.2" xref="S2.SS2.p11.4.m4.1.1.2.cmml">o</mi><mi id="S2.SS2.p11.4.m4.1.1.3" xref="S2.SS2.p11.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p11.4.m4.1b"><apply id="S2.SS2.p11.4.m4.1.1.cmml" xref="S2.SS2.p11.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p11.4.m4.1.1.1.cmml" xref="S2.SS2.p11.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p11.4.m4.1.1.2.cmml" xref="S2.SS2.p11.4.m4.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p11.4.m4.1.1.3.cmml" xref="S2.SS2.p11.4.m4.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p11.4.m4.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p11.4.m4.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. We apply <math alttext="K" class="ltx_Math" display="inline" id="S2.SS2.p11.5.m5.1"><semantics id="S2.SS2.p11.5.m5.1a"><mi id="S2.SS2.p11.5.m5.1.1" xref="S2.SS2.p11.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p11.5.m5.1b"><ci id="S2.SS2.p11.5.m5.1.1.cmml" xref="S2.SS2.p11.5.m5.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p11.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p11.5.m5.1d">italic_K</annotation></semantics></math> random shifts to the observations and goal images, where the k-th augmentation is denoted as <math alttext="o_{t,k}" class="ltx_Math" display="inline" id="S2.SS2.p11.6.m6.2"><semantics id="S2.SS2.p11.6.m6.2a"><msub id="S2.SS2.p11.6.m6.2.3" xref="S2.SS2.p11.6.m6.2.3.cmml"><mi id="S2.SS2.p11.6.m6.2.3.2" xref="S2.SS2.p11.6.m6.2.3.2.cmml">o</mi><mrow id="S2.SS2.p11.6.m6.2.2.2.4" xref="S2.SS2.p11.6.m6.2.2.2.3.cmml"><mi id="S2.SS2.p11.6.m6.1.1.1.1" xref="S2.SS2.p11.6.m6.1.1.1.1.cmml">t</mi><mo id="S2.SS2.p11.6.m6.2.2.2.4.1" xref="S2.SS2.p11.6.m6.2.2.2.3.cmml">,</mo><mi id="S2.SS2.p11.6.m6.2.2.2.2" xref="S2.SS2.p11.6.m6.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p11.6.m6.2b"><apply id="S2.SS2.p11.6.m6.2.3.cmml" xref="S2.SS2.p11.6.m6.2.3"><csymbol cd="ambiguous" id="S2.SS2.p11.6.m6.2.3.1.cmml" xref="S2.SS2.p11.6.m6.2.3">subscript</csymbol><ci id="S2.SS2.p11.6.m6.2.3.2.cmml" xref="S2.SS2.p11.6.m6.2.3.2">ğ‘œ</ci><list id="S2.SS2.p11.6.m6.2.2.2.3.cmml" xref="S2.SS2.p11.6.m6.2.2.2.4"><ci id="S2.SS2.p11.6.m6.1.1.1.1.cmml" xref="S2.SS2.p11.6.m6.1.1.1.1">ğ‘¡</ci><ci id="S2.SS2.p11.6.m6.2.2.2.2.cmml" xref="S2.SS2.p11.6.m6.2.2.2.2">ğ‘˜</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p11.6.m6.2c">o_{t,k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p11.6.m6.2d">italic_o start_POSTSUBSCRIPT italic_t , italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. The critic loss is then computed on the average of the <math alttext="K^{2}" class="ltx_Math" display="inline" id="S2.SS2.p11.7.m7.1"><semantics id="S2.SS2.p11.7.m7.1a"><msup id="S2.SS2.p11.7.m7.1.1" xref="S2.SS2.p11.7.m7.1.1.cmml"><mi id="S2.SS2.p11.7.m7.1.1.2" xref="S2.SS2.p11.7.m7.1.1.2.cmml">K</mi><mn id="S2.SS2.p11.7.m7.1.1.3" xref="S2.SS2.p11.7.m7.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p11.7.m7.1b"><apply id="S2.SS2.p11.7.m7.1.1.cmml" xref="S2.SS2.p11.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p11.7.m7.1.1.1.cmml" xref="S2.SS2.p11.7.m7.1.1">superscript</csymbol><ci id="S2.SS2.p11.7.m7.1.1.2.cmml" xref="S2.SS2.p11.7.m7.1.1.2">ğ¾</ci><cn id="S2.SS2.p11.7.m7.1.1.3.cmml" type="integer" xref="S2.SS2.p11.7.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p11.7.m7.1c">K^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p11.7.m7.1d">italic_K start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> matrices <math alttext="Q_{M}^{i}" class="ltx_Math" display="inline" id="S2.SS2.p11.8.m8.1"><semantics id="S2.SS2.p11.8.m8.1a"><msubsup id="S2.SS2.p11.8.m8.1.1" xref="S2.SS2.p11.8.m8.1.1.cmml"><mi id="S2.SS2.p11.8.m8.1.1.2.2" xref="S2.SS2.p11.8.m8.1.1.2.2.cmml">Q</mi><mi id="S2.SS2.p11.8.m8.1.1.2.3" xref="S2.SS2.p11.8.m8.1.1.2.3.cmml">M</mi><mi id="S2.SS2.p11.8.m8.1.1.3" xref="S2.SS2.p11.8.m8.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p11.8.m8.1b"><apply id="S2.SS2.p11.8.m8.1.1.cmml" xref="S2.SS2.p11.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.p11.8.m8.1.1.1.cmml" xref="S2.SS2.p11.8.m8.1.1">superscript</csymbol><apply id="S2.SS2.p11.8.m8.1.1.2.cmml" xref="S2.SS2.p11.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.p11.8.m8.1.1.2.1.cmml" xref="S2.SS2.p11.8.m8.1.1">subscript</csymbol><ci id="S2.SS2.p11.8.m8.1.1.2.2.cmml" xref="S2.SS2.p11.8.m8.1.1.2.2">ğ‘„</ci><ci id="S2.SS2.p11.8.m8.1.1.2.3.cmml" xref="S2.SS2.p11.8.m8.1.1.2.3">ğ‘€</ci></apply><ci id="S2.SS2.p11.8.m8.1.1.3.cmml" xref="S2.SS2.p11.8.m8.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p11.8.m8.1c">Q_{M}^{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p11.8.m8.1d">italic_Q start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> resulting from the inner products of the augmented observations and goals.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q_{M}^{aug}=\mathbb{E}_{i}[Q^{i}_{M}]=\frac{1}{K^{2}}\sum_{k=1}^{K}\sum_{k^{%
\prime}=1}^{K}f(o_{t,k},a_{t},o_{g,k^{\prime}})" class="ltx_Math" display="block" id="S2.E3.m1.8"><semantics id="S2.E3.m1.8a"><mrow id="S2.E3.m1.8.8" xref="S2.E3.m1.8.8.cmml"><msubsup id="S2.E3.m1.8.8.6" xref="S2.E3.m1.8.8.6.cmml"><mi id="S2.E3.m1.8.8.6.2.2" xref="S2.E3.m1.8.8.6.2.2.cmml">Q</mi><mi id="S2.E3.m1.8.8.6.2.3" xref="S2.E3.m1.8.8.6.2.3.cmml">M</mi><mrow id="S2.E3.m1.8.8.6.3" xref="S2.E3.m1.8.8.6.3.cmml"><mi id="S2.E3.m1.8.8.6.3.2" xref="S2.E3.m1.8.8.6.3.2.cmml">a</mi><mo id="S2.E3.m1.8.8.6.3.1" xref="S2.E3.m1.8.8.6.3.1.cmml">â¢</mo><mi id="S2.E3.m1.8.8.6.3.3" xref="S2.E3.m1.8.8.6.3.3.cmml">u</mi><mo id="S2.E3.m1.8.8.6.3.1a" xref="S2.E3.m1.8.8.6.3.1.cmml">â¢</mo><mi id="S2.E3.m1.8.8.6.3.4" xref="S2.E3.m1.8.8.6.3.4.cmml">g</mi></mrow></msubsup><mo id="S2.E3.m1.8.8.7" xref="S2.E3.m1.8.8.7.cmml">=</mo><mrow id="S2.E3.m1.5.5.1" xref="S2.E3.m1.5.5.1.cmml"><msub id="S2.E3.m1.5.5.1.3" xref="S2.E3.m1.5.5.1.3.cmml"><mi id="S2.E3.m1.5.5.1.3.2" xref="S2.E3.m1.5.5.1.3.2.cmml">ğ”¼</mi><mi id="S2.E3.m1.5.5.1.3.3" xref="S2.E3.m1.5.5.1.3.3.cmml">i</mi></msub><mo id="S2.E3.m1.5.5.1.2" xref="S2.E3.m1.5.5.1.2.cmml">â¢</mo><mrow id="S2.E3.m1.5.5.1.1.1" xref="S2.E3.m1.5.5.1.1.2.cmml"><mo id="S2.E3.m1.5.5.1.1.1.2" stretchy="false" xref="S2.E3.m1.5.5.1.1.2.1.cmml">[</mo><msubsup id="S2.E3.m1.5.5.1.1.1.1" xref="S2.E3.m1.5.5.1.1.1.1.cmml"><mi id="S2.E3.m1.5.5.1.1.1.1.2.2" xref="S2.E3.m1.5.5.1.1.1.1.2.2.cmml">Q</mi><mi id="S2.E3.m1.5.5.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.1.1.3.cmml">M</mi><mi id="S2.E3.m1.5.5.1.1.1.1.2.3" xref="S2.E3.m1.5.5.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S2.E3.m1.5.5.1.1.1.3" stretchy="false" xref="S2.E3.m1.5.5.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E3.m1.8.8.8" xref="S2.E3.m1.8.8.8.cmml">=</mo><mrow id="S2.E3.m1.8.8.4" xref="S2.E3.m1.8.8.4.cmml"><mfrac id="S2.E3.m1.8.8.4.5" xref="S2.E3.m1.8.8.4.5.cmml"><mn id="S2.E3.m1.8.8.4.5.2" xref="S2.E3.m1.8.8.4.5.2.cmml">1</mn><msup id="S2.E3.m1.8.8.4.5.3" xref="S2.E3.m1.8.8.4.5.3.cmml"><mi id="S2.E3.m1.8.8.4.5.3.2" xref="S2.E3.m1.8.8.4.5.3.2.cmml">K</mi><mn id="S2.E3.m1.8.8.4.5.3.3" xref="S2.E3.m1.8.8.4.5.3.3.cmml">2</mn></msup></mfrac><mo id="S2.E3.m1.8.8.4.4" xref="S2.E3.m1.8.8.4.4.cmml">â¢</mo><mrow id="S2.E3.m1.8.8.4.3" xref="S2.E3.m1.8.8.4.3.cmml"><munderover id="S2.E3.m1.8.8.4.3.4" xref="S2.E3.m1.8.8.4.3.4.cmml"><mo id="S2.E3.m1.8.8.4.3.4.2.2" movablelimits="false" rspace="0em" xref="S2.E3.m1.8.8.4.3.4.2.2.cmml">âˆ‘</mo><mrow id="S2.E3.m1.8.8.4.3.4.2.3" xref="S2.E3.m1.8.8.4.3.4.2.3.cmml"><mi id="S2.E3.m1.8.8.4.3.4.2.3.2" xref="S2.E3.m1.8.8.4.3.4.2.3.2.cmml">k</mi><mo id="S2.E3.m1.8.8.4.3.4.2.3.1" xref="S2.E3.m1.8.8.4.3.4.2.3.1.cmml">=</mo><mn id="S2.E3.m1.8.8.4.3.4.2.3.3" xref="S2.E3.m1.8.8.4.3.4.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.8.8.4.3.4.3" xref="S2.E3.m1.8.8.4.3.4.3.cmml">K</mi></munderover><mrow id="S2.E3.m1.8.8.4.3.3" xref="S2.E3.m1.8.8.4.3.3.cmml"><munderover id="S2.E3.m1.8.8.4.3.3.4" xref="S2.E3.m1.8.8.4.3.3.4.cmml"><mo id="S2.E3.m1.8.8.4.3.3.4.2.2" movablelimits="false" xref="S2.E3.m1.8.8.4.3.3.4.2.2.cmml">âˆ‘</mo><mrow id="S2.E3.m1.8.8.4.3.3.4.2.3" xref="S2.E3.m1.8.8.4.3.3.4.2.3.cmml"><msup id="S2.E3.m1.8.8.4.3.3.4.2.3.2" xref="S2.E3.m1.8.8.4.3.3.4.2.3.2.cmml"><mi id="S2.E3.m1.8.8.4.3.3.4.2.3.2.2" xref="S2.E3.m1.8.8.4.3.3.4.2.3.2.2.cmml">k</mi><mo id="S2.E3.m1.8.8.4.3.3.4.2.3.2.3" xref="S2.E3.m1.8.8.4.3.3.4.2.3.2.3.cmml">â€²</mo></msup><mo id="S2.E3.m1.8.8.4.3.3.4.2.3.1" xref="S2.E3.m1.8.8.4.3.3.4.2.3.1.cmml">=</mo><mn id="S2.E3.m1.8.8.4.3.3.4.2.3.3" xref="S2.E3.m1.8.8.4.3.3.4.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.8.8.4.3.3.4.3" xref="S2.E3.m1.8.8.4.3.3.4.3.cmml">K</mi></munderover><mrow id="S2.E3.m1.8.8.4.3.3.3" xref="S2.E3.m1.8.8.4.3.3.3.cmml"><mi id="S2.E3.m1.8.8.4.3.3.3.5" xref="S2.E3.m1.8.8.4.3.3.3.5.cmml">f</mi><mo id="S2.E3.m1.8.8.4.3.3.3.4" xref="S2.E3.m1.8.8.4.3.3.3.4.cmml">â¢</mo><mrow id="S2.E3.m1.8.8.4.3.3.3.3.3" xref="S2.E3.m1.8.8.4.3.3.3.3.4.cmml"><mo id="S2.E3.m1.8.8.4.3.3.3.3.3.4" stretchy="false" xref="S2.E3.m1.8.8.4.3.3.3.3.4.cmml">(</mo><msub id="S2.E3.m1.6.6.2.1.1.1.1.1.1" xref="S2.E3.m1.6.6.2.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.6.6.2.1.1.1.1.1.1.2" xref="S2.E3.m1.6.6.2.1.1.1.1.1.1.2.cmml">o</mi><mrow id="S2.E3.m1.2.2.2.4" xref="S2.E3.m1.2.2.2.3.cmml"><mi id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml">t</mi><mo id="S2.E3.m1.2.2.2.4.1" xref="S2.E3.m1.2.2.2.3.cmml">,</mo><mi id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S2.E3.m1.8.8.4.3.3.3.3.3.5" xref="S2.E3.m1.8.8.4.3.3.3.3.4.cmml">,</mo><msub id="S2.E3.m1.7.7.3.2.2.2.2.2.2" xref="S2.E3.m1.7.7.3.2.2.2.2.2.2.cmml"><mi id="S2.E3.m1.7.7.3.2.2.2.2.2.2.2" xref="S2.E3.m1.7.7.3.2.2.2.2.2.2.2.cmml">a</mi><mi id="S2.E3.m1.7.7.3.2.2.2.2.2.2.3" xref="S2.E3.m1.7.7.3.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.E3.m1.8.8.4.3.3.3.3.3.6" xref="S2.E3.m1.8.8.4.3.3.3.3.4.cmml">,</mo><msub id="S2.E3.m1.8.8.4.3.3.3.3.3.3" xref="S2.E3.m1.8.8.4.3.3.3.3.3.3.cmml"><mi id="S2.E3.m1.8.8.4.3.3.3.3.3.3.2" xref="S2.E3.m1.8.8.4.3.3.3.3.3.3.2.cmml">o</mi><mrow id="S2.E3.m1.4.4.2.2" xref="S2.E3.m1.4.4.2.3.cmml"><mi id="S2.E3.m1.3.3.1.1" xref="S2.E3.m1.3.3.1.1.cmml">g</mi><mo id="S2.E3.m1.4.4.2.2.2" xref="S2.E3.m1.4.4.2.3.cmml">,</mo><msup id="S2.E3.m1.4.4.2.2.1" xref="S2.E3.m1.4.4.2.2.1.cmml"><mi id="S2.E3.m1.4.4.2.2.1.2" xref="S2.E3.m1.4.4.2.2.1.2.cmml">k</mi><mo id="S2.E3.m1.4.4.2.2.1.3" xref="S2.E3.m1.4.4.2.2.1.3.cmml">â€²</mo></msup></mrow></msub><mo id="S2.E3.m1.8.8.4.3.3.3.3.3.7" stretchy="false" xref="S2.E3.m1.8.8.4.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.8b"><apply id="S2.E3.m1.8.8.cmml" xref="S2.E3.m1.8.8"><and id="S2.E3.m1.8.8a.cmml" xref="S2.E3.m1.8.8"></and><apply id="S2.E3.m1.8.8b.cmml" xref="S2.E3.m1.8.8"><eq id="S2.E3.m1.8.8.7.cmml" xref="S2.E3.m1.8.8.7"></eq><apply id="S2.E3.m1.8.8.6.cmml" xref="S2.E3.m1.8.8.6"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.6.1.cmml" xref="S2.E3.m1.8.8.6">superscript</csymbol><apply id="S2.E3.m1.8.8.6.2.cmml" xref="S2.E3.m1.8.8.6"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.6.2.1.cmml" xref="S2.E3.m1.8.8.6">subscript</csymbol><ci id="S2.E3.m1.8.8.6.2.2.cmml" xref="S2.E3.m1.8.8.6.2.2">ğ‘„</ci><ci id="S2.E3.m1.8.8.6.2.3.cmml" xref="S2.E3.m1.8.8.6.2.3">ğ‘€</ci></apply><apply id="S2.E3.m1.8.8.6.3.cmml" xref="S2.E3.m1.8.8.6.3"><times id="S2.E3.m1.8.8.6.3.1.cmml" xref="S2.E3.m1.8.8.6.3.1"></times><ci id="S2.E3.m1.8.8.6.3.2.cmml" xref="S2.E3.m1.8.8.6.3.2">ğ‘</ci><ci id="S2.E3.m1.8.8.6.3.3.cmml" xref="S2.E3.m1.8.8.6.3.3">ğ‘¢</ci><ci id="S2.E3.m1.8.8.6.3.4.cmml" xref="S2.E3.m1.8.8.6.3.4">ğ‘”</ci></apply></apply><apply id="S2.E3.m1.5.5.1.cmml" xref="S2.E3.m1.5.5.1"><times id="S2.E3.m1.5.5.1.2.cmml" xref="S2.E3.m1.5.5.1.2"></times><apply id="S2.E3.m1.5.5.1.3.cmml" xref="S2.E3.m1.5.5.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.3.1.cmml" xref="S2.E3.m1.5.5.1.3">subscript</csymbol><ci id="S2.E3.m1.5.5.1.3.2.cmml" xref="S2.E3.m1.5.5.1.3.2">ğ”¼</ci><ci id="S2.E3.m1.5.5.1.3.3.cmml" xref="S2.E3.m1.5.5.1.3.3">ğ‘–</ci></apply><apply id="S2.E3.m1.5.5.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.5.5.1.1.2.1.cmml" xref="S2.E3.m1.5.5.1.1.1.2">delimited-[]</csymbol><apply id="S2.E3.m1.5.5.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1">subscript</csymbol><apply id="S2.E3.m1.5.5.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.1.1.2.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1">superscript</csymbol><ci id="S2.E3.m1.5.5.1.1.1.1.2.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.2.2">ğ‘„</ci><ci id="S2.E3.m1.5.5.1.1.1.1.2.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.2.3">ğ‘–</ci></apply><ci id="S2.E3.m1.5.5.1.1.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3">ğ‘€</ci></apply></apply></apply></apply><apply id="S2.E3.m1.8.8c.cmml" xref="S2.E3.m1.8.8"><eq id="S2.E3.m1.8.8.8.cmml" xref="S2.E3.m1.8.8.8"></eq><share href="https://arxiv.org/html/2405.01409v3#S2.E3.m1.5.5.1.cmml" id="S2.E3.m1.8.8d.cmml" xref="S2.E3.m1.8.8"></share><apply id="S2.E3.m1.8.8.4.cmml" xref="S2.E3.m1.8.8.4"><times id="S2.E3.m1.8.8.4.4.cmml" xref="S2.E3.m1.8.8.4.4"></times><apply id="S2.E3.m1.8.8.4.5.cmml" xref="S2.E3.m1.8.8.4.5"><divide id="S2.E3.m1.8.8.4.5.1.cmml" xref="S2.E3.m1.8.8.4.5"></divide><cn id="S2.E3.m1.8.8.4.5.2.cmml" type="integer" xref="S2.E3.m1.8.8.4.5.2">1</cn><apply id="S2.E3.m1.8.8.4.5.3.cmml" xref="S2.E3.m1.8.8.4.5.3"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.4.5.3.1.cmml" xref="S2.E3.m1.8.8.4.5.3">superscript</csymbol><ci id="S2.E3.m1.8.8.4.5.3.2.cmml" xref="S2.E3.m1.8.8.4.5.3.2">ğ¾</ci><cn id="S2.E3.m1.8.8.4.5.3.3.cmml" type="integer" xref="S2.E3.m1.8.8.4.5.3.3">2</cn></apply></apply><apply id="S2.E3.m1.8.8.4.3.cmml" xref="S2.E3.m1.8.8.4.3"><apply id="S2.E3.m1.8.8.4.3.4.cmml" xref="S2.E3.m1.8.8.4.3.4"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.4.3.4.1.cmml" xref="S2.E3.m1.8.8.4.3.4">superscript</csymbol><apply id="S2.E3.m1.8.8.4.3.4.2.cmml" xref="S2.E3.m1.8.8.4.3.4"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.4.3.4.2.1.cmml" xref="S2.E3.m1.8.8.4.3.4">subscript</csymbol><sum id="S2.E3.m1.8.8.4.3.4.2.2.cmml" xref="S2.E3.m1.8.8.4.3.4.2.2"></sum><apply id="S2.E3.m1.8.8.4.3.4.2.3.cmml" xref="S2.E3.m1.8.8.4.3.4.2.3"><eq id="S2.E3.m1.8.8.4.3.4.2.3.1.cmml" xref="S2.E3.m1.8.8.4.3.4.2.3.1"></eq><ci id="S2.E3.m1.8.8.4.3.4.2.3.2.cmml" xref="S2.E3.m1.8.8.4.3.4.2.3.2">ğ‘˜</ci><cn id="S2.E3.m1.8.8.4.3.4.2.3.3.cmml" type="integer" xref="S2.E3.m1.8.8.4.3.4.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.8.8.4.3.4.3.cmml" xref="S2.E3.m1.8.8.4.3.4.3">ğ¾</ci></apply><apply id="S2.E3.m1.8.8.4.3.3.cmml" xref="S2.E3.m1.8.8.4.3.3"><apply id="S2.E3.m1.8.8.4.3.3.4.cmml" xref="S2.E3.m1.8.8.4.3.3.4"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.4.3.3.4.1.cmml" xref="S2.E3.m1.8.8.4.3.3.4">superscript</csymbol><apply id="S2.E3.m1.8.8.4.3.3.4.2.cmml" xref="S2.E3.m1.8.8.4.3.3.4"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.4.3.3.4.2.1.cmml" xref="S2.E3.m1.8.8.4.3.3.4">subscript</csymbol><sum id="S2.E3.m1.8.8.4.3.3.4.2.2.cmml" xref="S2.E3.m1.8.8.4.3.3.4.2.2"></sum><apply id="S2.E3.m1.8.8.4.3.3.4.2.3.cmml" xref="S2.E3.m1.8.8.4.3.3.4.2.3"><eq id="S2.E3.m1.8.8.4.3.3.4.2.3.1.cmml" xref="S2.E3.m1.8.8.4.3.3.4.2.3.1"></eq><apply id="S2.E3.m1.8.8.4.3.3.4.2.3.2.cmml" xref="S2.E3.m1.8.8.4.3.3.4.2.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.4.3.3.4.2.3.2.1.cmml" xref="S2.E3.m1.8.8.4.3.3.4.2.3.2">superscript</csymbol><ci id="S2.E3.m1.8.8.4.3.3.4.2.3.2.2.cmml" xref="S2.E3.m1.8.8.4.3.3.4.2.3.2.2">ğ‘˜</ci><ci id="S2.E3.m1.8.8.4.3.3.4.2.3.2.3.cmml" xref="S2.E3.m1.8.8.4.3.3.4.2.3.2.3">â€²</ci></apply><cn id="S2.E3.m1.8.8.4.3.3.4.2.3.3.cmml" type="integer" xref="S2.E3.m1.8.8.4.3.3.4.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.8.8.4.3.3.4.3.cmml" xref="S2.E3.m1.8.8.4.3.3.4.3">ğ¾</ci></apply><apply id="S2.E3.m1.8.8.4.3.3.3.cmml" xref="S2.E3.m1.8.8.4.3.3.3"><times id="S2.E3.m1.8.8.4.3.3.3.4.cmml" xref="S2.E3.m1.8.8.4.3.3.3.4"></times><ci id="S2.E3.m1.8.8.4.3.3.3.5.cmml" xref="S2.E3.m1.8.8.4.3.3.3.5">ğ‘“</ci><vector id="S2.E3.m1.8.8.4.3.3.3.3.4.cmml" xref="S2.E3.m1.8.8.4.3.3.3.3.3"><apply id="S2.E3.m1.6.6.2.1.1.1.1.1.1.cmml" xref="S2.E3.m1.6.6.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.2.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.6.6.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.6.6.2.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.6.6.2.1.1.1.1.1.1.2">ğ‘œ</ci><list id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.4"><ci id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1">ğ‘¡</ci><ci id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2">ğ‘˜</ci></list></apply><apply id="S2.E3.m1.7.7.3.2.2.2.2.2.2.cmml" xref="S2.E3.m1.7.7.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.3.2.2.2.2.2.2.1.cmml" xref="S2.E3.m1.7.7.3.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E3.m1.7.7.3.2.2.2.2.2.2.2.cmml" xref="S2.E3.m1.7.7.3.2.2.2.2.2.2.2">ğ‘</ci><ci id="S2.E3.m1.7.7.3.2.2.2.2.2.2.3.cmml" xref="S2.E3.m1.7.7.3.2.2.2.2.2.2.3">ğ‘¡</ci></apply><apply id="S2.E3.m1.8.8.4.3.3.3.3.3.3.cmml" xref="S2.E3.m1.8.8.4.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.4.3.3.3.3.3.3.1.cmml" xref="S2.E3.m1.8.8.4.3.3.3.3.3.3">subscript</csymbol><ci id="S2.E3.m1.8.8.4.3.3.3.3.3.3.2.cmml" xref="S2.E3.m1.8.8.4.3.3.3.3.3.3.2">ğ‘œ</ci><list id="S2.E3.m1.4.4.2.3.cmml" xref="S2.E3.m1.4.4.2.2"><ci id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1.1">ğ‘”</ci><apply id="S2.E3.m1.4.4.2.2.1.cmml" xref="S2.E3.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.2.2.1.1.cmml" xref="S2.E3.m1.4.4.2.2.1">superscript</csymbol><ci id="S2.E3.m1.4.4.2.2.1.2.cmml" xref="S2.E3.m1.4.4.2.2.1.2">ğ‘˜</ci><ci id="S2.E3.m1.4.4.2.2.1.3.cmml" xref="S2.E3.m1.4.4.2.2.1.3">â€²</ci></apply></list></apply></vector></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.8c">Q_{M}^{aug}=\mathbb{E}_{i}[Q^{i}_{M}]=\frac{1}{K^{2}}\sum_{k=1}^{K}\sum_{k^{%
\prime}=1}^{K}f(o_{t,k},a_{t},o_{g,k^{\prime}})</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.8d">italic_Q start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_a italic_u italic_g end_POSTSUPERSCRIPT = blackboard_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_Q start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ] = divide start_ARG 1 end_ARG start_ARG italic_K start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG âˆ‘ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_k start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_f ( italic_o start_POSTSUBSCRIPT italic_t , italic_k end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_g , italic_k start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS2.p12">
<p class="ltx_p" id="S2.SS2.p12.3"><span class="ltx_text ltx_font_bold" id="S2.SS2.p12.3.1">Contrastive Patient Batching (CPB):</span> We observed empirically that the composition of the contrastive batch plays a significant role in the convergence of the critic. Following the strategy proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib11" title="">11</a>]</cite>, where samples are randomly chosen from the replay buffer yields poor results in our setting. A closer investigation revealed that a randomly sampled batch contains samples from different patients with different intermediate states, and the critic ends up learning features associated with anatomical differences between patients, rather than general anatomical features necessary for the control task. To address this, we tag the trajectories by the corresponding patient identifier during training. While creating a batch of size <math alttext="N" class="ltx_Math" display="inline" id="S2.SS2.p12.1.m1.1"><semantics id="S2.SS2.p12.1.m1.1a"><mi id="S2.SS2.p12.1.m1.1.1" xref="S2.SS2.p12.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p12.1.m1.1b"><ci id="S2.SS2.p12.1.m1.1.1.cmml" xref="S2.SS2.p12.1.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p12.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p12.1.m1.1d">italic_N</annotation></semantics></math>, we sample <math alttext="(o_{t},a_{t},o_{g})" class="ltx_Math" display="inline" id="S2.SS2.p12.2.m2.3"><semantics id="S2.SS2.p12.2.m2.3a"><mrow id="S2.SS2.p12.2.m2.3.3.3" xref="S2.SS2.p12.2.m2.3.3.4.cmml"><mo id="S2.SS2.p12.2.m2.3.3.3.4" stretchy="false" xref="S2.SS2.p12.2.m2.3.3.4.cmml">(</mo><msub id="S2.SS2.p12.2.m2.1.1.1.1" xref="S2.SS2.p12.2.m2.1.1.1.1.cmml"><mi id="S2.SS2.p12.2.m2.1.1.1.1.2" xref="S2.SS2.p12.2.m2.1.1.1.1.2.cmml">o</mi><mi id="S2.SS2.p12.2.m2.1.1.1.1.3" xref="S2.SS2.p12.2.m2.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p12.2.m2.3.3.3.5" xref="S2.SS2.p12.2.m2.3.3.4.cmml">,</mo><msub id="S2.SS2.p12.2.m2.2.2.2.2" xref="S2.SS2.p12.2.m2.2.2.2.2.cmml"><mi id="S2.SS2.p12.2.m2.2.2.2.2.2" xref="S2.SS2.p12.2.m2.2.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p12.2.m2.2.2.2.2.3" xref="S2.SS2.p12.2.m2.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS2.p12.2.m2.3.3.3.6" xref="S2.SS2.p12.2.m2.3.3.4.cmml">,</mo><msub id="S2.SS2.p12.2.m2.3.3.3.3" xref="S2.SS2.p12.2.m2.3.3.3.3.cmml"><mi id="S2.SS2.p12.2.m2.3.3.3.3.2" xref="S2.SS2.p12.2.m2.3.3.3.3.2.cmml">o</mi><mi id="S2.SS2.p12.2.m2.3.3.3.3.3" xref="S2.SS2.p12.2.m2.3.3.3.3.3.cmml">g</mi></msub><mo id="S2.SS2.p12.2.m2.3.3.3.7" stretchy="false" xref="S2.SS2.p12.2.m2.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p12.2.m2.3b"><vector id="S2.SS2.p12.2.m2.3.3.4.cmml" xref="S2.SS2.p12.2.m2.3.3.3"><apply id="S2.SS2.p12.2.m2.1.1.1.1.cmml" xref="S2.SS2.p12.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p12.2.m2.1.1.1.1.1.cmml" xref="S2.SS2.p12.2.m2.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p12.2.m2.1.1.1.1.2.cmml" xref="S2.SS2.p12.2.m2.1.1.1.1.2">ğ‘œ</ci><ci id="S2.SS2.p12.2.m2.1.1.1.1.3.cmml" xref="S2.SS2.p12.2.m2.1.1.1.1.3">ğ‘¡</ci></apply><apply id="S2.SS2.p12.2.m2.2.2.2.2.cmml" xref="S2.SS2.p12.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p12.2.m2.2.2.2.2.1.cmml" xref="S2.SS2.p12.2.m2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p12.2.m2.2.2.2.2.2.cmml" xref="S2.SS2.p12.2.m2.2.2.2.2.2">ğ‘</ci><ci id="S2.SS2.p12.2.m2.2.2.2.2.3.cmml" xref="S2.SS2.p12.2.m2.2.2.2.2.3">ğ‘¡</ci></apply><apply id="S2.SS2.p12.2.m2.3.3.3.3.cmml" xref="S2.SS2.p12.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p12.2.m2.3.3.3.3.1.cmml" xref="S2.SS2.p12.2.m2.3.3.3.3">subscript</csymbol><ci id="S2.SS2.p12.2.m2.3.3.3.3.2.cmml" xref="S2.SS2.p12.2.m2.3.3.3.3.2">ğ‘œ</ci><ci id="S2.SS2.p12.2.m2.3.3.3.3.3.cmml" xref="S2.SS2.p12.2.m2.3.3.3.3.3">ğ‘”</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p12.2.m2.3c">(o_{t},a_{t},o_{g})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p12.2.m2.3d">( italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT )</annotation></semantics></math> triplets from two patients, with <math alttext="\frac{N}{2}" class="ltx_Math" display="inline" id="S2.SS2.p12.3.m3.1"><semantics id="S2.SS2.p12.3.m3.1a"><mfrac id="S2.SS2.p12.3.m3.1.1" xref="S2.SS2.p12.3.m3.1.1.cmml"><mi id="S2.SS2.p12.3.m3.1.1.2" xref="S2.SS2.p12.3.m3.1.1.2.cmml">N</mi><mn id="S2.SS2.p12.3.m3.1.1.3" xref="S2.SS2.p12.3.m3.1.1.3.cmml">2</mn></mfrac><annotation-xml encoding="MathML-Content" id="S2.SS2.p12.3.m3.1b"><apply id="S2.SS2.p12.3.m3.1.1.cmml" xref="S2.SS2.p12.3.m3.1.1"><divide id="S2.SS2.p12.3.m3.1.1.1.cmml" xref="S2.SS2.p12.3.m3.1.1"></divide><ci id="S2.SS2.p12.3.m3.1.1.2.cmml" xref="S2.SS2.p12.3.m3.1.1.2">ğ‘</ci><cn id="S2.SS2.p12.3.m3.1.1.3.cmml" type="integer" xref="S2.SS2.p12.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p12.3.m3.1c">\frac{N}{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p12.3.m3.1d">divide start_ARG italic_N end_ARG start_ARG 2 end_ARG</annotation></semantics></math> samples per patient. Having a significant number of samples coming from the same patient creates harder negatives for the critic, which improves its effectiveness in discriminating trajectories. Ablation studies in the supplementary material show performance for different numbers of patients per batch.</p>
</div>
<figure class="ltx_table" id="S2.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S2.T1.27.2.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S2.T1.2.1" style="font-size:90%;">Quantitative results (mean <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.2.1.m1.1"><semantics id="S2.T1.2.1.m1.1b"><mo id="S2.T1.2.1.m1.1.1" xref="S2.T1.2.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.2.1.m1.1c"><csymbol cd="latexml" id="S2.T1.2.1.m1.1.1.cmml" xref="S2.T1.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.2.1.m1.1d">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.2.1.m1.1e">Â±</annotation></semantics></math> std) for the standard view navigation experiment. Goal type <span class="ltx_text ltx_font_italic" id="S2.T1.2.1.1">Patient/Template</span> indicates whether the input goal was generated from the same patient or from a template patient. Note that no perturbations were explicitly sampled around the ME 5CH view during training. (*) Results for RL-TEE and SAC are obtained from several models, each one trained separately on a view. CRL+B indicates CRL-D trained with CPB and CRL + BA is CRL+B with the data augmented contrastive loss.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S2.T1.24">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S2.T1.24.23.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S2.T1.24.23.1.1">Views</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.24.23.1.2">Goal type</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.24.23.1.3">Method</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.24.23.1.4">Angle Error (deg)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.24.23.1.5">Position error (mm)</td>
</tr>
<tr class="ltx_tr" id="S2.T1.4.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt" id="S2.T1.4.2.3" rowspan="5"><span class="ltx_text" id="S2.T1.4.2.3.1">ME AV SAX, 2CH, 4CH, LAX</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S2.T1.4.2.4" rowspan="2"><span class="ltx_text" id="S2.T1.4.2.4.1">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S2.T1.4.2.5">RL-TEE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib10" title="">10</a>]</cite>*</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S2.T1.3.1.1">9.90 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.3.1.1.m1.1"><semantics id="S2.T1.3.1.1.m1.1a"><mo id="S2.T1.3.1.1.m1.1.1" xref="S2.T1.3.1.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.3.1.1.m1.1b"><csymbol cd="latexml" id="S2.T1.3.1.1.m1.1.1.cmml" xref="S2.T1.3.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.3.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.3.1.1.m1.1d">Â±</annotation></semantics></math> 8.04</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S2.T1.4.2.2">9.17 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.4.2.2.m1.1"><semantics id="S2.T1.4.2.2.m1.1a"><mo id="S2.T1.4.2.2.m1.1.1" xref="S2.T1.4.2.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.4.2.2.m1.1b"><csymbol cd="latexml" id="S2.T1.4.2.2.m1.1.1.cmml" xref="S2.T1.4.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.4.2.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.4.2.2.m1.1d">Â±</annotation></semantics></math> 6.87</td>
</tr>
<tr class="ltx_tr" id="S2.T1.6.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.6.4.3">SAC* <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib14" title="">14</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.5.3.1">9.77 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.5.3.1.m1.1"><semantics id="S2.T1.5.3.1.m1.1a"><mo id="S2.T1.5.3.1.m1.1.1" xref="S2.T1.5.3.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.5.3.1.m1.1b"><csymbol cd="latexml" id="S2.T1.5.3.1.m1.1.1.cmml" xref="S2.T1.5.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.5.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.5.3.1.m1.1d">Â±</annotation></semantics></math> 10.89</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.6.4.2">7.92 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.6.4.2.m1.1"><semantics id="S2.T1.6.4.2.m1.1a"><mo id="S2.T1.6.4.2.m1.1.1" xref="S2.T1.6.4.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.6.4.2.m1.1b"><csymbol cd="latexml" id="S2.T1.6.4.2.m1.1.1.cmml" xref="S2.T1.6.4.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.6.4.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.6.4.2.m1.1d">Â±</annotation></semantics></math> 9.35</td>
</tr>
<tr class="ltx_tr" id="S2.T1.8.6">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.8.6.3" rowspan="3"><span class="ltx_text" id="S2.T1.8.6.3.1">Patient</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.8.6.4">CRL-D <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib11" title="">11</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.7.5.1">18.47 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.7.5.1.m1.1"><semantics id="S2.T1.7.5.1.m1.1a"><mo id="S2.T1.7.5.1.m1.1.1" xref="S2.T1.7.5.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.7.5.1.m1.1b"><csymbol cd="latexml" id="S2.T1.7.5.1.m1.1.1.cmml" xref="S2.T1.7.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.7.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.7.5.1.m1.1d">Â±</annotation></semantics></math> 19.89</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.8.6.2">13.27 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.8.6.2.m1.1"><semantics id="S2.T1.8.6.2.m1.1a"><mo id="S2.T1.8.6.2.m1.1.1" xref="S2.T1.8.6.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.8.6.2.m1.1b"><csymbol cd="latexml" id="S2.T1.8.6.2.m1.1.1.cmml" xref="S2.T1.8.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.8.6.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.8.6.2.m1.1d">Â±</annotation></semantics></math> 17.96</td>
</tr>
<tr class="ltx_tr" id="S2.T1.10.8">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.10.8.3">CRL+B</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.9.7.1"><span class="ltx_text ltx_font_bold" id="S2.T1.9.7.1.1">9.00 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.9.7.1.1.m1.1"><semantics id="S2.T1.9.7.1.1.m1.1a"><mo id="S2.T1.9.7.1.1.m1.1.1" xref="S2.T1.9.7.1.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.9.7.1.1.m1.1b"><csymbol cd="latexml" id="S2.T1.9.7.1.1.m1.1.1.cmml" xref="S2.T1.9.7.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.9.7.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.9.7.1.1.m1.1d">Â±</annotation></semantics></math> 12.37</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.10.8.2"><span class="ltx_text ltx_font_bold" id="S2.T1.10.8.2.1">5.93 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.10.8.2.1.m1.1"><semantics id="S2.T1.10.8.2.1.m1.1a"><mo id="S2.T1.10.8.2.1.m1.1.1" xref="S2.T1.10.8.2.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.10.8.2.1.m1.1b"><csymbol cd="latexml" id="S2.T1.10.8.2.1.m1.1.1.cmml" xref="S2.T1.10.8.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.10.8.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.10.8.2.1.m1.1d">Â±</annotation></semantics></math> 8.17</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.12.10">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.12.10.3">CRL+BA</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.11.9.1">9.36 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.11.9.1.m1.1"><semantics id="S2.T1.11.9.1.m1.1a"><mo id="S2.T1.11.9.1.m1.1.1" xref="S2.T1.11.9.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.11.9.1.m1.1b"><csymbol cd="latexml" id="S2.T1.11.9.1.m1.1.1.cmml" xref="S2.T1.11.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.11.9.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.11.9.1.m1.1d">Â±</annotation></semantics></math> 9.52</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.12.10.2">6.56 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.12.10.2.m1.1"><semantics id="S2.T1.12.10.2.m1.1a"><mo id="S2.T1.12.10.2.m1.1.1" xref="S2.T1.12.10.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.12.10.2.m1.1b"><csymbol cd="latexml" id="S2.T1.12.10.2.m1.1.1.cmml" xref="S2.T1.12.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.12.10.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.12.10.2.m1.1d">Â±</annotation></semantics></math> 6.46</td>
</tr>
<tr class="ltx_tr" id="S2.T1.14.12">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt" id="S2.T1.14.12.3" rowspan="3"><span class="ltx_text" id="S2.T1.14.12.3.1">ME 5CH</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S2.T1.14.12.4" rowspan="3"><span class="ltx_text" id="S2.T1.14.12.4.1">Patient</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S2.T1.14.12.5">CRL-D <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib11" title="">11</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S2.T1.13.11.1">35.24 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.13.11.1.m1.1"><semantics id="S2.T1.13.11.1.m1.1a"><mo id="S2.T1.13.11.1.m1.1.1" xref="S2.T1.13.11.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.13.11.1.m1.1b"><csymbol cd="latexml" id="S2.T1.13.11.1.m1.1.1.cmml" xref="S2.T1.13.11.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.13.11.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.13.11.1.m1.1d">Â±</annotation></semantics></math> 25.67</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S2.T1.14.12.2">15.23 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.14.12.2.m1.1"><semantics id="S2.T1.14.12.2.m1.1a"><mo id="S2.T1.14.12.2.m1.1.1" xref="S2.T1.14.12.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.14.12.2.m1.1b"><csymbol cd="latexml" id="S2.T1.14.12.2.m1.1.1.cmml" xref="S2.T1.14.12.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.14.12.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.14.12.2.m1.1d">Â±</annotation></semantics></math> 15.08</td>
</tr>
<tr class="ltx_tr" id="S2.T1.16.14">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.16.14.3">CRL+B</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.15.13.1">19.88 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.15.13.1.m1.1"><semantics id="S2.T1.15.13.1.m1.1a"><mo id="S2.T1.15.13.1.m1.1.1" xref="S2.T1.15.13.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.15.13.1.m1.1b"><csymbol cd="latexml" id="S2.T1.15.13.1.m1.1.1.cmml" xref="S2.T1.15.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.15.13.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.15.13.1.m1.1d">Â±</annotation></semantics></math> 35.91</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.16.14.2">8.88 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.16.14.2.m1.1"><semantics id="S2.T1.16.14.2.m1.1a"><mo id="S2.T1.16.14.2.m1.1.1" xref="S2.T1.16.14.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.16.14.2.m1.1b"><csymbol cd="latexml" id="S2.T1.16.14.2.m1.1.1.cmml" xref="S2.T1.16.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.16.14.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.16.14.2.m1.1d">Â±</annotation></semantics></math> 11.02</td>
</tr>
<tr class="ltx_tr" id="S2.T1.18.16">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.18.16.3">CRL+BA</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.17.15.1"><span class="ltx_text ltx_font_bold" id="S2.T1.17.15.1.1">11.40 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.17.15.1.1.m1.1"><semantics id="S2.T1.17.15.1.1.m1.1a"><mo id="S2.T1.17.15.1.1.m1.1.1" xref="S2.T1.17.15.1.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.17.15.1.1.m1.1b"><csymbol cd="latexml" id="S2.T1.17.15.1.1.m1.1.1.cmml" xref="S2.T1.17.15.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.17.15.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.17.15.1.1.m1.1d">Â±</annotation></semantics></math> 5.30</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.18.16.2"><span class="ltx_text ltx_font_bold" id="S2.T1.18.16.2.1">7.80 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.18.16.2.1.m1.1"><semantics id="S2.T1.18.16.2.1.m1.1a"><mo id="S2.T1.18.16.2.1.m1.1.1" xref="S2.T1.18.16.2.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.18.16.2.1.m1.1b"><csymbol cd="latexml" id="S2.T1.18.16.2.1.m1.1.1.cmml" xref="S2.T1.18.16.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.18.16.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.18.16.2.1.m1.1d">Â±</annotation></semantics></math> 4.11</span></td>
</tr>
<tr class="ltx_tr" id="S2.T1.20.18">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_tt" id="S2.T1.20.18.3" rowspan="3"><span class="ltx_text" id="S2.T1.20.18.3.1">ME 2CH,4CH</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_tt" id="S2.T1.20.18.4" rowspan="3"><span class="ltx_text" id="S2.T1.20.18.4.1">Template</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S2.T1.20.18.5">CRL-D <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib11" title="">11</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S2.T1.19.17.1">28.91 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.19.17.1.m1.1"><semantics id="S2.T1.19.17.1.m1.1a"><mo id="S2.T1.19.17.1.m1.1.1" xref="S2.T1.19.17.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.19.17.1.m1.1b"><csymbol cd="latexml" id="S2.T1.19.17.1.m1.1.1.cmml" xref="S2.T1.19.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.19.17.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.19.17.1.m1.1d">Â±</annotation></semantics></math> 21.86</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S2.T1.20.18.2">24.59 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.20.18.2.m1.1"><semantics id="S2.T1.20.18.2.m1.1a"><mo id="S2.T1.20.18.2.m1.1.1" xref="S2.T1.20.18.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.20.18.2.m1.1b"><csymbol cd="latexml" id="S2.T1.20.18.2.m1.1.1.cmml" xref="S2.T1.20.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.20.18.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.20.18.2.m1.1d">Â±</annotation></semantics></math> 24.63</td>
</tr>
<tr class="ltx_tr" id="S2.T1.22.20">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.22.20.3">CRL+B</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.21.19.1">13.39 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.21.19.1.m1.1"><semantics id="S2.T1.21.19.1.m1.1a"><mo id="S2.T1.21.19.1.m1.1.1" xref="S2.T1.21.19.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.21.19.1.m1.1b"><csymbol cd="latexml" id="S2.T1.21.19.1.m1.1.1.cmml" xref="S2.T1.21.19.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.21.19.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.21.19.1.m1.1d">Â±</annotation></semantics></math> 7.74</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T1.22.20.2">12.95 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.22.20.2.m1.1"><semantics id="S2.T1.22.20.2.m1.1a"><mo id="S2.T1.22.20.2.m1.1.1" xref="S2.T1.22.20.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.22.20.2.m1.1b"><csymbol cd="latexml" id="S2.T1.22.20.2.m1.1.1.cmml" xref="S2.T1.22.20.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.22.20.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.22.20.2.m1.1d">Â±</annotation></semantics></math> 7.32</td>
</tr>
<tr class="ltx_tr" id="S2.T1.24.22">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S2.T1.24.22.3">CRL+BA</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S2.T1.23.21.1"><span class="ltx_text ltx_font_bold" id="S2.T1.23.21.1.1">12.19 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.23.21.1.1.m1.1"><semantics id="S2.T1.23.21.1.1.m1.1a"><mo id="S2.T1.23.21.1.1.m1.1.1" xref="S2.T1.23.21.1.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.23.21.1.1.m1.1b"><csymbol cd="latexml" id="S2.T1.23.21.1.1.m1.1.1.cmml" xref="S2.T1.23.21.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.23.21.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.23.21.1.1.m1.1d">Â±</annotation></semantics></math> 6.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S2.T1.24.22.2"><span class="ltx_text ltx_font_bold" id="S2.T1.24.22.2.1">10.54 <math alttext="\pm" class="ltx_Math" display="inline" id="S2.T1.24.22.2.1.m1.1"><semantics id="S2.T1.24.22.2.1.m1.1a"><mo id="S2.T1.24.22.2.1.m1.1.1" xref="S2.T1.24.22.2.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S2.T1.24.22.2.1.m1.1b"><csymbol cd="latexml" id="S2.T1.24.22.2.1.m1.1.1.cmml" xref="S2.T1.24.22.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.24.22.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S2.T1.24.22.2.1.m1.1d">Â±</annotation></semantics></math> 6.34</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S2.SS2.p13">
<p class="ltx_p" id="S2.SS2.p13.3"><span class="ltx_text ltx_font_bold" id="S2.SS2.p13.3.1">Training loop:</span> We automatically find probe poses to obtain standard views using landmarks extracted from the automatic segmentations and by following clinical guidelines <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib15" title="">15</a>]</cite>. When applying actions, the transducer is translated along the oesophagus centerline and we constrain all motions to remain within its walls. At the start of each episode, we initialize the transducer at one of the standard view poses. Random perturbations are applied to obtain the starting pose <math alttext="s_{0}" class="ltx_Math" display="inline" id="S2.SS2.p13.1.m1.1"><semantics id="S2.SS2.p13.1.m1.1a"><msub id="S2.SS2.p13.1.m1.1.1" xref="S2.SS2.p13.1.m1.1.1.cmml"><mi id="S2.SS2.p13.1.m1.1.1.2" xref="S2.SS2.p13.1.m1.1.1.2.cmml">s</mi><mn id="S2.SS2.p13.1.m1.1.1.3" xref="S2.SS2.p13.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p13.1.m1.1b"><apply id="S2.SS2.p13.1.m1.1.1.cmml" xref="S2.SS2.p13.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p13.1.m1.1.1.1.cmml" xref="S2.SS2.p13.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p13.1.m1.1.1.2.cmml" xref="S2.SS2.p13.1.m1.1.1.2">ğ‘ </ci><cn id="S2.SS2.p13.1.m1.1.1.3.cmml" type="integer" xref="S2.SS2.p13.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p13.1.m1.1c">s_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p13.1.m1.1d">italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>. For CRL, we obtain a goal pose by applying additional random perturbations from <math alttext="s_{0}" class="ltx_Math" display="inline" id="S2.SS2.p13.2.m2.1"><semantics id="S2.SS2.p13.2.m2.1a"><msub id="S2.SS2.p13.2.m2.1.1" xref="S2.SS2.p13.2.m2.1.1.cmml"><mi id="S2.SS2.p13.2.m2.1.1.2" xref="S2.SS2.p13.2.m2.1.1.2.cmml">s</mi><mn id="S2.SS2.p13.2.m2.1.1.3" xref="S2.SS2.p13.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p13.2.m2.1b"><apply id="S2.SS2.p13.2.m2.1.1.cmml" xref="S2.SS2.p13.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p13.2.m2.1.1.1.cmml" xref="S2.SS2.p13.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p13.2.m2.1.1.2.cmml" xref="S2.SS2.p13.2.m2.1.1.2">ğ‘ </ci><cn id="S2.SS2.p13.2.m2.1.1.3.cmml" type="integer" xref="S2.SS2.p13.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p13.2.m2.1c">s_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p13.2.m2.1d">italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, yielding a goal pose <math alttext="s_{g}" class="ltx_Math" display="inline" id="S2.SS2.p13.3.m3.1"><semantics id="S2.SS2.p13.3.m3.1a"><msub id="S2.SS2.p13.3.m3.1.1" xref="S2.SS2.p13.3.m3.1.1.cmml"><mi id="S2.SS2.p13.3.m3.1.1.2" xref="S2.SS2.p13.3.m3.1.1.2.cmml">s</mi><mi id="S2.SS2.p13.3.m3.1.1.3" xref="S2.SS2.p13.3.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p13.3.m3.1b"><apply id="S2.SS2.p13.3.m3.1.1.cmml" xref="S2.SS2.p13.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p13.3.m3.1.1.1.cmml" xref="S2.SS2.p13.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p13.3.m3.1.1.2.cmml" xref="S2.SS2.p13.3.m3.1.1.2">ğ‘ </ci><ci id="S2.SS2.p13.3.m3.1.1.3.cmml" xref="S2.SS2.p13.3.m3.1.1.3">ğ‘”</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p13.3.m3.1c">s_{g}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p13.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>. Hence our model is always trained with random goals and never explicitly trained to navigate to a standard view. Perturbation ranges are listed in the supplementary material.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments and results</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.p1.1.1">Standard view navigation: </span> We first compare our approach with existing methods by examining their ability to reach standard views, a task essential in TEE examinations. We processed 929 patient CT datasets from the LIDC-IDRI dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib16" title="">16</a>]</cite>: 653 were used for training, 136 for validation and the rest 140 for testing. Goal images in the test dataset were reviewed and confirmed by a cardiologist. We evaluated our method in two scenarios based on how the goal is specified: Using the (synthetic) US view generated from the same patient as the goal or using a US view from another â€templateâ€ patient as a goal. The latter corresponds to a scenario where a user may not have access to prior scans of the patient and hence uses a similar view from another reference to specify the goal.
We report the position and angle error at the end of the episode w.r.t the ground truth pose. For each patient and goal pair, we ran 10 experiments with the transducer initialized at random positions. Results are reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#S2.T1" title="Table 1 â€£ 2.2 Goal-Conditioned Reinforcement Learning â€£ 2 Methodology â€£ Goal-conditioned reinforcement learning for ultrasound navigation guidance"><span class="ltx_text ltx_ref_tag">1</span></a> and a breakdown of the results per view is included in the supplementary material, alongside videos showing the navigation process.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">We compare the performance of our model with Li et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib10" title="">10</a>]</cite> (RL-TEE), Soft Actor-Critic (SAC) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib14" title="">14</a>]</cite> which is a state-of-the-art off-policy reinforcement learning algorithm and the default implementation of CRL (CRL-D)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib11" title="">11</a>]</cite>. For RL-TEE and SAC, we train one model per view as the algorithms are not goal-conditioned. SAC models are trained using the same rewards as in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib10" title="">10</a>]</cite>. We use four mid-oesophageal (ME) views for training: Two and four chambers (2CH, 4CH), long-axis (LAX) and aortic valve short-axis (AV SAX). Due to the similarity between ME AV SAX and ME Right Ventricle Inflow-Outflow views, samples resembling one or the other class were considered to be of the AV SAX class. We use templates from ME 2CH and 4CH views as they are better geometrically defined across patients.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.1">Finally, we showcase the versatility of our method by inputting ME five chambers (5CH) views as goals to the model during testing. ME 5CH views were not used as a starting point for random perturbations during training. In Table <a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#S2.T1" title="Table 1 â€£ 2.2 Goal-Conditioned Reinforcement Learning â€£ 2 Methodology â€£ Goal-conditioned reinforcement learning for ultrasound navigation guidance"><span class="ltx_text ltx_ref_tag">1</span></a>, CRL+B model corresponds to CRL + CPB, and CRL+BA is CRL + CPB + data augmented contrastive loss.</p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.1"><span class="ltx_text ltx_font_bold" id="S3.p4.1.1">Interventional view navigation:</span> In a second experiment, we showcase the usefulness of goal-conditioning by navigating to a non-standard view used in LAA closure procedures. We use the FUMPE dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib17" title="">17</a>]</cite> (train: 21 / test: 5) for which we have additional LAA segmentations, hence finetuning is required as the LAA was missing in the previous datasets. Previously trained CRL models are finetuned for 250K steps, without changing the training procedure or sampling trajectories near the LAA explicitly. Quantitative results are reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#S3.T2" title="Table 2 â€£ 3 Experiments and results â€£ Goal-conditioned reinforcement learning for ultrasound navigation guidance"><span class="ltx_text ltx_ref_tag">2</span></a>, where the performance is on par with standard view navigation. Qualitative results are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#S3.F3" title="Figure 3 â€£ 3 Experiments and results â€£ Goal-conditioned reinforcement learning for ultrasound navigation guidance"><span class="ltx_text ltx_ref_tag">3</span></a>.
<br class="ltx_break"/>For all experiments and models, we use a ResNet-18 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib18" title="">18</a>]</cite> as image an encoder, Adam optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib19" title="">19</a>]</cite> and train with A4500 GPUs. Detailed result tables and demonstration videos are included in the supplementary material.</p>
</div>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T2.8.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S3.T2.9.2" style="font-size:90%;">Quantitative results for the LAA view navigation experiment. The high-quality representations learnt by the model with the data augmented contrastive loss allow for better generalization and transfer.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T2.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.6.7.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.6.7.1.1">Views</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T2.6.7.1.2">Goal type</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T2.6.7.1.3">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T2.6.7.1.4">Angle Error (deg)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T2.6.7.1.5">Position error (mm)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.2.2">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_tt" id="S3.T2.2.2.3" rowspan="3"><span class="ltx_text" id="S3.T2.2.2.3.1">LAA</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_tt" id="S3.T2.2.2.4" rowspan="3"><span class="ltx_text" id="S3.T2.2.2.4.1">Patient</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T2.2.2.5">CRL-D <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib11" title="">11</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T2.1.1.1">37.70 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.1.1.1.m1.1"><semantics id="S3.T2.1.1.1.m1.1a"><mo id="S3.T2.1.1.1.m1.1.1" xref="S3.T2.1.1.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.m1.1b"><csymbol cd="latexml" id="S3.T2.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.1.1.1.m1.1d">Â±</annotation></semantics></math> 28.74</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T2.2.2.2">30.99 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.2.2.2.m1.1"><semantics id="S3.T2.2.2.2.m1.1a"><mo id="S3.T2.2.2.2.m1.1.1" xref="S3.T2.2.2.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.2.2.2.m1.1b"><csymbol cd="latexml" id="S3.T2.2.2.2.m1.1.1.cmml" xref="S3.T2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.2.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.2.2.2.m1.1d">Â±</annotation></semantics></math> 28.61</td>
</tr>
<tr class="ltx_tr" id="S3.T2.4.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.4.4.3">CRL+B</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.3.3.1">24.63 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.3.3.1.m1.1"><semantics id="S3.T2.3.3.1.m1.1a"><mo id="S3.T2.3.3.1.m1.1.1" xref="S3.T2.3.3.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.3.3.1.m1.1b"><csymbol cd="latexml" id="S3.T2.3.3.1.m1.1.1.cmml" xref="S3.T2.3.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.3.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.3.3.1.m1.1d">Â±</annotation></semantics></math> 23.69</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.4.4.2">17.54 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.4.4.2.m1.1"><semantics id="S3.T2.4.4.2.m1.1a"><mo id="S3.T2.4.4.2.m1.1.1" xref="S3.T2.4.4.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.4.4.2.m1.1b"><csymbol cd="latexml" id="S3.T2.4.4.2.m1.1.1.cmml" xref="S3.T2.4.4.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.4.4.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.4.4.2.m1.1d">Â±</annotation></semantics></math> 17.22</td>
</tr>
<tr class="ltx_tr" id="S3.T2.6.6">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T2.6.6.3">CRL+BA</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T2.5.5.1"><span class="ltx_text ltx_font_bold" id="S3.T2.5.5.1.1">10.18 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.5.5.1.1.m1.1"><semantics id="S3.T2.5.5.1.1.m1.1a"><mo id="S3.T2.5.5.1.1.m1.1.1" xref="S3.T2.5.5.1.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.5.5.1.1.m1.1b"><csymbol cd="latexml" id="S3.T2.5.5.1.1.m1.1.1.cmml" xref="S3.T2.5.5.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.5.5.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.5.5.1.1.m1.1d">Â±</annotation></semantics></math> 5.58</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T2.6.6.2"><span class="ltx_text ltx_font_bold" id="S3.T2.6.6.2.1">9.02 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.6.6.2.1.m1.1"><semantics id="S3.T2.6.6.2.1.m1.1a"><mo id="S3.T2.6.6.2.1.m1.1.1" xref="S3.T2.6.6.2.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.6.6.2.1.m1.1b"><csymbol cd="latexml" id="S3.T2.6.6.2.1.m1.1.1.cmml" xref="S3.T2.6.6.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.6.6.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.6.6.2.1.m1.1d">Â±</annotation></semantics></math> 4.33</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="272" id="S3.F3.g1" src="x3.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S3.F3.3.2" style="font-size:90%;">Example navigation to a view showing the LAA (orange box). The two rightmost pictures are projections showing the desired (green) and current (red) transducer positions.</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Discussion and conclusion</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.p1.1.1">Discussion:</span> Our generalist model achieves competitive performance to specialist models trained to navigate to single views, whether it is given goal images from the same or a template patient. Additionally, the model robustly navigates to arbitrary views without explicit sampling during training, as shown by the results on ME 5CH and LAA views, thus demonstrating the versatility of the goal-conditioned framework. Note that the performance in such scenarios is highly dependent on the agentâ€™s exploration of the environment during training. A drawback of CRL is the longer training time, as the contrastive critic needs many samples to converge. We alleviate this with an efficient asynchronous implementation using RLLib <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.01409v3#bib.bib20" title="">20</a>]</cite>, yielding a training time of two days for 200M steps. Finally, deployment in a real-world setting would potentially require fine-tuning using either real data and/or improved simulations with generative models to address any reality gap.
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.p1.1.2">Conclusion:</span> We have presented a novel approach for ultrasound navigation using goal-conditioned reinforcement learning. Given a goal image, our versatile model navigates robustly both to standard and arbitrary views showing specific structures. Using this method as a guidance system could help train sonographers, improve the acquisition quality and reduce variability among experienced users.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.1"><span class="ltx_text ltx_font_bold" id="S4.p2.1.1">Acknowledgements.</span> The authors acknowledge the National Cancer Institute and the Foundation for the National Institutes of Health, and their critical role in the creation of the free publicly available LIDC/IDRI Database used in this study.
For the purpose of open access, the author has applied a CC BY public copyright licence to any Author Accepted Manuscript version arising from this submission</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p3">
<p class="ltx_p" id="S4.p3.1"><span class="ltx_text ltx_font_bold" id="S4.p3.1.1">Disclaimer.</span> The concepts and information presented in this paper are based on research results that are not commercially available. Future commercial availability cannot be guaranteed.
<br class="ltx_break"/></p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Andreassi, M.G., Piccaluga, E., Guagliumi, G., Greco, M.D., Gaita, F., Picano, E.: Occupational health risks in cardiac catheterization laboratory workers. Circulation: Cardiovascular Interventions <span class="ltx_text ltx_font_bold" id="bib.bib1.1.1">9</span>, e003273 (2016)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Narang, A., Bae, R., Hong, H., Thomas, Y., Surette, S., Cadieu, C.F., Chaudhry, A.K., Martin, R.P., McCarthy, P.M., Rubenson, D., Goldstein, S.A., Little, S.H., Lang, R.M., Weissman, N., Thomas, J.D.: Utility of a deep-learning algorithm to guide novices to acquire echocardiograms for limited diagnostic use. JAMA Cardiology <span class="ltx_text ltx_font_bold" id="bib.bib2.1.1">6</span>, 1 â€“ 9 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Sabo, S., Pasdeloup, D., Pettersen, H.N., Smistad, E., Ã˜stvik, A., Olaisen, S.H., StÃ¸len, S.B., Grenne, B.L., Holte, E., Lovstakken, L., Dalen, H.: Real-time guidance by deep learning of experienced operators to improve the standardization of echocardiographic acquisitions. European Heart Journal - Imaging Methods and Practice <span class="ltx_text ltx_font_bold" id="bib.bib3.1.1">1</span>(2), qyad040 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Li, K., Wang, J., Xu, Y., Qin, H., Liu, D., Liu, L., Meng, M.Q.: Autonomous navigation of an ultrasound probe towards standard scan planes with deep reinforcement learning. 2021 IEEE International Conference on Robotics and Automation (ICRA) pp. 8302â€“8308 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Hase, H., Azampour, M.F., Tirindelli, M., Paschali, M., Simson, W., Fatemizadeh, E., Navab, N.: Ultrasound-guided robotic navigation with deep reinforcement learning. 2020 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS) pp. 5534â€“5541 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Bi, Y., Jiang, Z., Gao, Y., Wendler, T., Karlas, A., Navab, N.: Vesnet-rl: Simulation-based reinforcement learning for real-world us probe navigation. IEEE Robotics and Automation Letters <span class="ltx_text ltx_font_bold" id="bib.bib6.1.1">7</span>, 6638â€“6645 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Droste, R., Drukker, L., Papageorghiou, A.T., Noble, J.A.: Automatic probe movement guidance for freehand obstetric ultrasound. International Conference on Medical Image Computing and Computer-Assisted Intervention (MICCAI) <span class="ltx_text ltx_font_bold" id="bib.bib7.1.1">12263</span>, 583â€“592 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Milletari, F., Birodkar, V., Sofka, M.: Straight to the Point: Reinforcement Learning for User Guidance in Ultrasound. In: Smart Ultrasound Imaging and Perinatal, Preterm and Paediatric Image Analysis. pp. 3â€“10. Springer International Publishing, Cham (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Wang, S., Housden, J., Bai, T., Liu, H., Back, J., Singh, D., Rhode, K.S., Hou, Z.G., Wang, F.Y.: Robotic intra-operative ultrasound: Virtual environments and parallel systems. IEEE/CAA Journal of Automatica Sinica <span class="ltx_text ltx_font_bold" id="bib.bib9.1.1">8</span>, 1095â€“1106 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Li, K., Li, A., Xu, Y., Xiong, H., Meng, M.Q.H.: Rl-tee: Autonomous probe guidance for transesophageal echocardiography based on attention-augmented deep reinforcement learning. IEEE Transactions on Automation Science and Engineering (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Eysenbach, B., Zhang, T., Salakhutdinov, R., Levine, S.: Contrastive learning as goal-conditioned reinforcement learning. In: Neural Information Processing Systems (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Amadou, A.A., Peralta, L., Dryburgh, P., Klein, P., Petkov, K., Housden, R.J., Singh, V., Liao, R., Kim, Y.H., Ghesu, F.C., Mansi, T., Rajani, R., Young, A., Rhode, K.: Cardiac ultrasound simulation for autonomous ultrasound navigation. arXiv preprint arXiv:2402.06463 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
vanÂ den Oord, A., Li, Y., Vinyals, O.: Representation learning with contrastive predictive coding. CoRR <span class="ltx_text ltx_font_bold" id="bib.bib13.1.1">abs/1807.03748</span> (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Haarnoja, T., Zhou, A., Abbeel, P., Levine, S.: Soft actor-critic: Off-policy maximum entropy deep reinforcement learning with a stochastic actor. ICML (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Hahn, R.T., Abraham, T., Adams, M.S., Bruce, C.J., Glas, K.E., Lang, R.M., Reeves, S.T., Shanewise, J.S., Siu, S.C., Stewart, W., Picard, M.H.: Guidelines for performing a comprehensive transesophageal echocardiographic examination: Recommendations from the american society of echocardiography and the society of cardiovascular anesthesiologists. Journal of the American Society of Echocardiography <span class="ltx_text ltx_font_bold" id="bib.bib15.1.1">26</span>(9), 921â€“964 (2013)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Armato, S.G., McNitt-Gray, M.F.: The lung image database consortium (lidc) and image database resource initiative (idri): a completed reference database of lung nodules on ct scans. Medical physics <span class="ltx_text ltx_font_bold" id="bib.bib16.1.1">38 2</span>, 915â€“31 (2011). https://doi.org/10.1118/1.3528204

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Masoudi, M., Pourreza, H.R., Saadatmand-Tarzjan, M., Eftekhari, N., Zargar, F.S., Rad, M.P.: A new dataset of computed-tomography angiography images for computer-aided detection of pulmonary embolism. Scientific Data <span class="ltx_text ltx_font_bold" id="bib.bib17.1.1">5</span> (2018). https://doi.org/10.6084/m9.figshare.c.4107803.v1

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
He, K., Zhang, X., Ren, S., Sun, J.: Deep residual learning for image recognition. 2016 IEEE Conference on Computer Vision and Pattern Recognition (CVPR) pp. 770â€“778 (2015), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:206594692" title="">https://api.semanticscholar.org/CorpusID:206594692</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Kingma, D.P., Ba, J.: Adam: A method for stochastic optimization. CoRR <span class="ltx_text ltx_font_bold" id="bib.bib19.1.1">abs/1412.6980</span> (2014)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Liang, E., Liaw, R., Nishihara, R., Moritz, P., Fox, R., Gonzalez, J., Goldberg, K., Stoica, I.: Ray rllib: A composable and scalable reinforcement learning library. CoRR <span class="ltx_text ltx_font_bold" id="bib.bib20.1.1">abs/1712.09381</span> (2017)

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Aug  1 08:57:09 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
