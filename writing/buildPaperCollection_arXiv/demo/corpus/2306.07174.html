<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Augmenting Language Models with Long-Term Memory</title>
<!--Generated on Thu Jul 13 18:32:51 2023 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="css/ar5iv.min.css" rel="stylesheet" type="text/css"/>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" rel="stylesheet"/>
<script crossorigin="anonymous" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script defer="" src="https://services.dev.arxiv.org/html/addons.js"></script>
<script defer="" src="https://services.dev.arxiv.org/html/feedbackOverlay.js"></script>
<link href="https://services.dev.arxiv.org/html/styles.css" rel="stylesheet" type="text/css"/></head>
<body>
<div class="ltx_page_main" id="main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Augmenting Language Models with 
<br class="ltx_break"/>Long-Term Memory</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Weizhi Wang<math alttext="{}^{\dagger}" class="ltx_Math" display="inline" id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><msup id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml"><mi id="id1.1.m1.1.1a" xref="id1.1.m1.1.1.cmml"></mi><mo id="id1.1.m1.1.1.1" xref="id1.1.m1.1.1.1.cmml">‚Ä†</mo></msup><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><apply id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1"><ci id="id1.1.m1.1.1.1.cmml" xref="id1.1.m1.1.1.1">‚Ä†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">start_FLOATSUPERSCRIPT ‚Ä† end_FLOATSUPERSCRIPT</annotation></semantics></math>,¬†¬†Li Dong<math alttext="{}^{\ddagger}" class="ltx_Math" display="inline" id="id2.2.m2.1"><semantics id="id2.2.m2.1a"><msup id="id2.2.m2.1.1" xref="id2.2.m2.1.1.cmml"><mi id="id2.2.m2.1.1a" xref="id2.2.m2.1.1.cmml"></mi><mo id="id2.2.m2.1.1.1" xref="id2.2.m2.1.1.1.cmml">‚Ä°</mo></msup><annotation-xml encoding="MathML-Content" id="id2.2.m2.1b"><apply id="id2.2.m2.1.1.cmml" xref="id2.2.m2.1.1"><ci id="id2.2.m2.1.1.1.cmml" xref="id2.2.m2.1.1.1">‚Ä°</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m2.1c">{}^{\ddagger}</annotation><annotation encoding="application/x-llamapun" id="id2.2.m2.1d">start_FLOATSUPERSCRIPT ‚Ä° end_FLOATSUPERSCRIPT</annotation></semantics></math>,¬†¬†Hao Cheng<math alttext="{}^{\ddagger}" class="ltx_Math" display="inline" id="id3.3.m3.1"><semantics id="id3.3.m3.1a"><msup id="id3.3.m3.1.1" xref="id3.3.m3.1.1.cmml"><mi id="id3.3.m3.1.1a" xref="id3.3.m3.1.1.cmml"></mi><mo id="id3.3.m3.1.1.1" xref="id3.3.m3.1.1.1.cmml">‚Ä°</mo></msup><annotation-xml encoding="MathML-Content" id="id3.3.m3.1b"><apply id="id3.3.m3.1.1.cmml" xref="id3.3.m3.1.1"><ci id="id3.3.m3.1.1.1.cmml" xref="id3.3.m3.1.1.1">‚Ä°</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id3.3.m3.1c">{}^{\ddagger}</annotation><annotation encoding="application/x-llamapun" id="id3.3.m3.1d">start_FLOATSUPERSCRIPT ‚Ä° end_FLOATSUPERSCRIPT</annotation></semantics></math>,¬†¬†Xiaodong Liu<math alttext="{}^{\ddagger}" class="ltx_Math" display="inline" id="id4.4.m4.1"><semantics id="id4.4.m4.1a"><msup id="id4.4.m4.1.1" xref="id4.4.m4.1.1.cmml"><mi id="id4.4.m4.1.1a" xref="id4.4.m4.1.1.cmml"></mi><mo id="id4.4.m4.1.1.1" xref="id4.4.m4.1.1.1.cmml">‚Ä°</mo></msup><annotation-xml encoding="MathML-Content" id="id4.4.m4.1b"><apply id="id4.4.m4.1.1.cmml" xref="id4.4.m4.1.1"><ci id="id4.4.m4.1.1.1.cmml" xref="id4.4.m4.1.1.1">‚Ä°</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id4.4.m4.1c">{}^{\ddagger}</annotation><annotation encoding="application/x-llamapun" id="id4.4.m4.1d">start_FLOATSUPERSCRIPT ‚Ä° end_FLOATSUPERSCRIPT</annotation></semantics></math>,
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id7.7.3">Xifeng Yan<math alttext="{}^{\dagger}" class="ltx_Math" display="inline" id="id5.5.1.m1.1"><semantics id="id5.5.1.m1.1a"><msup id="id5.5.1.m1.1.1" xref="id5.5.1.m1.1.1.cmml"><mi id="id5.5.1.m1.1.1a" xref="id5.5.1.m1.1.1.cmml"></mi><mo id="id5.5.1.m1.1.1.1" mathvariant="normal" xref="id5.5.1.m1.1.1.1.cmml">‚Ä†</mo></msup><annotation-xml encoding="MathML-Content" id="id5.5.1.m1.1b"><apply id="id5.5.1.m1.1.1.cmml" xref="id5.5.1.m1.1.1"><ci id="id5.5.1.m1.1.1.1.cmml" xref="id5.5.1.m1.1.1.1">normal-‚Ä†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id5.5.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="id5.5.1.m1.1d">start_FLOATSUPERSCRIPT ‚Ä† end_FLOATSUPERSCRIPT</annotation></semantics></math>,¬†¬†Jianfeng Gao<math alttext="{}^{\ddagger}" class="ltx_Math" display="inline" id="id6.6.2.m2.1"><semantics id="id6.6.2.m2.1a"><msup id="id6.6.2.m2.1.1" xref="id6.6.2.m2.1.1.cmml"><mi id="id6.6.2.m2.1.1a" xref="id6.6.2.m2.1.1.cmml"></mi><mo id="id6.6.2.m2.1.1.1" mathvariant="normal" xref="id6.6.2.m2.1.1.1.cmml">‚Ä°</mo></msup><annotation-xml encoding="MathML-Content" id="id6.6.2.m2.1b"><apply id="id6.6.2.m2.1.1.cmml" xref="id6.6.2.m2.1.1"><ci id="id6.6.2.m2.1.1.1.cmml" xref="id6.6.2.m2.1.1.1">normal-‚Ä°</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id6.6.2.m2.1c">{}^{\ddagger}</annotation><annotation encoding="application/x-llamapun" id="id6.6.2.m2.1d">start_FLOATSUPERSCRIPT ‚Ä° end_FLOATSUPERSCRIPT</annotation></semantics></math>,¬†¬†Furu Wei<math alttext="{}^{\ddagger}" class="ltx_Math" display="inline" id="id7.7.3.m3.1"><semantics id="id7.7.3.m3.1a"><msup id="id7.7.3.m3.1.1" xref="id7.7.3.m3.1.1.cmml"><mi id="id7.7.3.m3.1.1a" xref="id7.7.3.m3.1.1.cmml"></mi><mo id="id7.7.3.m3.1.1.1" mathvariant="normal" xref="id7.7.3.m3.1.1.1.cmml">‚Ä°</mo></msup><annotation-xml encoding="MathML-Content" id="id7.7.3.m3.1b"><apply id="id7.7.3.m3.1.1.cmml" xref="id7.7.3.m3.1.1"><ci id="id7.7.3.m3.1.1.1.cmml" xref="id7.7.3.m3.1.1.1">normal-‚Ä°</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id7.7.3.m3.1c">{}^{\ddagger}</annotation><annotation encoding="application/x-llamapun" id="id7.7.3.m3.1d">start_FLOATSUPERSCRIPT ‚Ä° end_FLOATSUPERSCRIPT</annotation></semantics></math></span>
<br class="ltx_break"/><math alttext="{}^{\dagger}" class="ltx_Math" display="inline" id="id8.8.m5.1"><semantics id="id8.8.m5.1a"><msup id="id8.8.m5.1.1" xref="id8.8.m5.1.1.cmml"><mi id="id8.8.m5.1.1a" xref="id8.8.m5.1.1.cmml"></mi><mo id="id8.8.m5.1.1.1" xref="id8.8.m5.1.1.1.cmml">‚Ä†</mo></msup><annotation-xml encoding="MathML-Content" id="id8.8.m5.1b"><apply id="id8.8.m5.1.1.cmml" xref="id8.8.m5.1.1"><ci id="id8.8.m5.1.1.1.cmml" xref="id8.8.m5.1.1.1">‚Ä†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id8.8.m5.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="id8.8.m5.1d">start_FLOATSUPERSCRIPT ‚Ä† end_FLOATSUPERSCRIPT</annotation></semantics></math>University of California, Santa Barbara ¬†¬†<math alttext="{}^{\ddagger}" class="ltx_Math" display="inline" id="id9.9.m6.1"><semantics id="id9.9.m6.1a"><msup id="id9.9.m6.1.1" xref="id9.9.m6.1.1.cmml"><mi id="id9.9.m6.1.1a" xref="id9.9.m6.1.1.cmml"></mi><mo id="id9.9.m6.1.1.1" xref="id9.9.m6.1.1.1.cmml">‚Ä°</mo></msup><annotation-xml encoding="MathML-Content" id="id9.9.m6.1b"><apply id="id9.9.m6.1.1.cmml" xref="id9.9.m6.1.1"><ci id="id9.9.m6.1.1.1.cmml" xref="id9.9.m6.1.1.1">‚Ä°</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="id9.9.m6.1c">{}^{\ddagger}</annotation><annotation encoding="application/x-llamapun" id="id9.9.m6.1d">start_FLOATSUPERSCRIPT ‚Ä° end_FLOATSUPERSCRIPT</annotation></semantics></math>Microsoft Research 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id10.10.id1">weizhiwang@ucsb.edu,¬†{lidong1, haocheng}@microsoft.com
<br class="ltx_break"/></span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id11.id1">Existing large language models (LLMs) can only afford fix-sized inputs due to the input length limit, preventing them from utilizing rich long-context information from past inputs.
To address this, we propose a framework, Language Models Augmented with <span class="ltx_text ltx_font_bold" id="id11.id1.1">Long</span>-Term <span class="ltx_text ltx_font_bold" id="id11.id1.2">Mem</span>ory (<span class="ltx_text ltx_font_smallcaps" id="id11.id1.3">LongMem</span>), which enables LLMs to memorize long history. We design a novel decoupled network architecture with the original backbone LLM frozen as a memory encoder and an adaptive residual side-network as a memory retriever and reader. Such a decoupled memory design can easily cache and update long-term past contexts for memory retrieval without suffering from memory staleness.
Enhanced with memory-augmented adaptation training, <span class="ltx_text ltx_font_smallcaps" id="id11.id1.4">LongMem</span> can thus memorize long past context and use long-term memory for language modeling.
The proposed memory retrieval module can handle unlimited-length context in its memory bank to benefit various downstream tasks. Typically, <span class="ltx_text ltx_font_smallcaps" id="id11.id1.5">LongMem</span> can enlarge the long-form memory to 65k tokens and thus cache many-shot extra demonstration examples as long-form memory for in-context learning.
Experiments show that our method outperforms strong long-context models on ChapterBreak, a challenging long-context modeling benchmark, and achieves remarkable improvements on memory-augmented in-context learning over LLMs.
The results demonstrate that the proposed method is effective in helping language models to memorize and utilize long-form contents. Our code is open-sourced at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aka.ms/LongMem" title="">https://aka.ms/LongMem</a>.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Large language models (LLMs) have revolutionized natural language processing with great successes in advancing the state-of-the-art on various understanding and generation tasks <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib5" title=""><span class="ltx_text" style="font-size:90%;">5</span></a>, <a class="ltx_ref" href="#bib.bib18" title=""><span class="ltx_text" style="font-size:90%;">18</span></a>, <a class="ltx_ref" href="#bib.bib11" title=""><span class="ltx_text" style="font-size:90%;">11</span></a>, <a class="ltx_ref" href="#bib.bib32" title=""><span class="ltx_text" style="font-size:90%;">32</span></a>, <a class="ltx_ref" href="#bib.bib3" title=""><span class="ltx_text" style="font-size:90%;">3</span></a>, <a class="ltx_ref" href="#bib.bib16" title=""><span class="ltx_text" style="font-size:90%;">16</span></a>]</cite>.
Most LLMs benefit from self-supervised training over large corpora via harvesting knowledge from fix-sized local context, showing emergent abilities, <em class="ltx_emph ltx_font_italic" id="S1.p1.1.1">e.g.,</em>¬†zero-shot prompting¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib18" title=""><span class="ltx_text" style="font-size:90%;">18</span></a>]</cite>, in-context learning¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib3" title=""><span class="ltx_text" style="font-size:90%;">3</span></a>]</cite>, and Chain-of-Thought (CoT) reasoning¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib30" title=""><span class="ltx_text" style="font-size:90%;">30</span></a>]</cite>.
Nevertheless, the input length limit of existing LLMs prevents them from generalizing to real-world scenarios where the capability of processing long-form information beyond a fix-sized session is critical, <em class="ltx_emph ltx_font_italic" id="S1.p1.1.2">e.g.,</em>¬†long horizontal planning.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="316" id="S1.F1.g1" src="x1.png" width="581"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Overview of the memory caching and retrieval flow of <span class="ltx_text ltx_font_smallcaps" id="S1.F1.6.1">LongMem</span>. The long text sequence is split into fix-length segments, then each segment is forwarded through large language models and the attention key and value vectors of <math alttext="m" class="ltx_Math" display="inline" id="S1.F1.3.m1.1"><semantics id="S1.F1.3.m1.1b"><mi id="S1.F1.3.m1.1.1" xref="S1.F1.3.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S1.F1.3.m1.1c"><ci id="S1.F1.3.m1.1.1.cmml" xref="S1.F1.3.m1.1.1">ùëö</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.3.m1.1d">m</annotation><annotation encoding="application/x-llamapun" id="S1.F1.3.m1.1e">italic_m</annotation></semantics></math>-th layer are cached into the long-term memory bank. For future inputs, via attention query-key based retrieval, the top-<math alttext="k" class="ltx_Math" display="inline" id="S1.F1.4.m2.1"><semantics id="S1.F1.4.m2.1b"><mi id="S1.F1.4.m2.1.1" xref="S1.F1.4.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S1.F1.4.m2.1c"><ci id="S1.F1.4.m2.1.1.cmml" xref="S1.F1.4.m2.1.1">ùëò</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.4.m2.1d">k</annotation><annotation encoding="application/x-llamapun" id="S1.F1.4.m2.1e">italic_k</annotation></semantics></math> attention key-value pairs of long-term memory are retrieved and fused into language modeling.
</figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">To address the length limit issue, the most straightforward method is to simply scale up the input context length.
For instance, GPT-3¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib3" title=""><span class="ltx_text" style="font-size:90%;">3</span></a>]</cite> increases the input length from 1k of GPT-2¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib18" title=""><span class="ltx_text" style="font-size:90%;">18</span></a>]</cite> to 2k tokens for capturing better long-range dependencies.
However, this approach typically incurs computation-intensive training from scratch and the <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">in-context</span> dense attention is still heavily constrained by the quadratic computation complexity of Transformer self-attention¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib24" title=""><span class="ltx_text" style="font-size:90%;">24</span></a>]</cite>.
Another recent line of work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib.bib4" title=""><span class="ltx_text" style="font-size:90%;">4</span></a>, <a class="ltx_ref" href="#bib.bib33" title=""><span class="ltx_text" style="font-size:90%;">33</span></a>]</cite> instead focuses on developing in-context sparse attention to avoid the quadratic cost of self-attention, which still largely requires training from scratch.
In contrast, the prominent work, Memorizing Transformer (MemTRM)¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib27" title=""><span class="ltx_text" style="font-size:90%;">27</span></a>]</cite>, approximates in-context sparse attention via dense attention over both in-context tokens and memorized tokens retrieved from a non-differentiable memory for Transformers.
Thus, MemTRM scales up the resulting language model to handle up to 65k tokens and achieves substantial perplexity gains in modeling full-length books or long papers.
However, MemTRM faces the <span class="ltx_text ltx_font_italic" id="S1.p2.1.2">memory staleness</span> challenge during training due to its coupled memory design, which uses a single model for encoding memory and fusing memory for language modeling.
In other words, as the model parameters are updated, cached older representations in memory may have distributional shifts from those from the latest model, thereby limiting the effectiveness of the memory augmentation.
</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In this paper, we propose a framework for Language Models Augmented with <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">Long</span>-Term <span class="ltx_text ltx_font_bold" id="S1.p3.1.2">Mem</span>ory (<span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.3">LongMem</span>), which enables language models to cache long-form previous context or knowledge into the non-differentiable memory bank, and further take advantage of them via a decoupled memory module to address the memory staleness problem.
To achieve decoupled memory, we design a novel residual side-network (SideNet).
Paired attention keys and values of the previous context are extracted using a frozen backbone LLM into the memory bank.
In the memory-augmented layer of the SideNet, the generated attention query of the current input is used to retrieve cached (keys, values) of previous contexts from the memory, and the corresponding memory augmentations are then fused into learned hidden states via a joint-attention mechanism.
Furthermore, newly designed cross-network residual connections between the SideNet and the frozen backbone LLM enable better knowledge transfer from the pretrained backbone LLM.
By continually training the residual SideNet to retrieve and fuse memory-augmented long-context, the pre-trained LLM can be adapted to leverage long-contextual memory for improved modeling. The detailed memory cache, retrieval and fusion process is illustrated in Figure¬†<a class="ltx_ref" href="#S1.F1" title="Figure 1 ‚Ä£ 1 Introduction ‚Ä£ Augmenting Language Models with Long-Term Memory"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Our decoupled memory design leads to two main benefits.
First, our proposed architecture decouples the process of encoding previous inputs into memory and the process of memory retrieval and fusion by decoupled frozen backbone LLM and SideNet.
In this way, the backbone LLM only works as the long-context knowledge encoder, while the residual SideNet works as the memory retriever and reader, which effectively resolves the issue of memory staleness.
Second, directly adapting the entire LLM with memory augmentations is computationally inefficient, and also suffers from catastrophic forgetting.
As the backbone LLM is frozen during the efficient memory-augmented adaptation stage, <span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.1">LongMem</span> can not only tap into the pretrained knowledge but also avoid catastrophic forgetting.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1"><span class="ltx_text ltx_font_smallcaps" id="S1.p5.1.1">LongMem</span> is capable of taking various types of long-form text and knowledge into the memory bank based on downstream tasks.
Here, we consider two representative cases, language modeling with full-length book contexts, and memory-augmented in-context learning with thousands of task-relevant demonstration examples.
Specifically, we evaluate the effectiveness of the proposed <span class="ltx_text ltx_font_smallcaps" id="S1.p5.1.2">LongMem</span> on various long-text language modeling, and memory-augmented in-context learning for language understanding.
Experimental results demonstrate that our model consistently outperforms the strong baselines in terms of long-text modeling and in-context learning abilities.
Our method substantially improves LLM‚Äôs long-context language modeling capabilities by -1.38<math alttext="\sim" class="ltx_Math" display="inline" id="S1.p5.1.m1.1"><semantics id="S1.p5.1.m1.1a"><mo id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml">‚àº</mo><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><csymbol cd="latexml" id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S1.p5.1.m1.1d">‚àº</annotation></semantics></math>-1.62 perplexity over different length splits of Gutenberg-2022 corpus.
Remarkably, our model achieves the state-of-the-art performance of 40.5% identification accuracy on ChapterBreak, a challenging long-context modeling benchmark, significantly surpassing existing strong x-former baselines.
Lastly, with 2k demonstration examples in memory, <span class="ltx_text ltx_font_smallcaps" id="S1.p5.1.3">LongMem</span>
shows pronounced in-context learning improvements on popular NLU tasks, compared with MemTRM and non-memory-augmented baselines.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methods</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">To enable LLMs to harvest relevant information from the past long context in memory, we propose to augment the frozen backbone LLM with a decoupled memory module.
To fuse the memory context information, we design a novel lightweight residual SideNet, which can be continually trained in an efficient way.
In the following, we first discuss the problem formulation of language modeling with memory augmentations.
Then, we formally introduce our efficient residual SideNet for adapting the frozen pretrained LLM to jointly attend over local input context and retrieved memory context.
Lastly, we provide our designed processes of how past memory is encoded, stored, recalled and fused for language modeling.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="302" id="S2.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of <span class="ltx_text ltx_font_smallcaps" id="S2.F2.2.1">LongMem</span> architecture. ‚ÄúMemAug‚Äù represents Memory-Augmented Layer.
</figcaption>
</figure>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Language Models Augmented with Long-Term Memory</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Here, we focus on the high-level problem setup and defer more component details to later sections. Given its wide adoption for pretrained LLMs, our <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p1.1.1">LongMem</span> model is built on the Transformer architecture <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib.bib24" title=""><span class="ltx_text" style="font-size:90%;">24</span></a>]</cite>.
For <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p1.1.2">LongMem</span>, there are three key components: the frozen backbone LLM, SideNet, and Cache Memory Bank.
As most existing pretrained LLMs can only take a fix-sized input, only the input segment of a long sequence (<em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.1.3">e.g.,</em>¬†a book) that can fit in the length limit is denoted as the current input as done for most existing autoregressive language models.
Those previous segments that can not fit are denoted as previous inputs, which are used for memory augmentations.
To tap into the learned knowledge of the pretrained LLM, both previous and current inputs are encoded using the frozen backbone LLM but different representations are extracted.
For previous inputs, the key-value pairs from the Transformer self-attention at <math alttext="m" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">ùëö</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_m</annotation></semantics></math>-th layer are stored in Cache Memory Bank, whereas
the hidden states from each LLM decoder layer for the current inputs are retained and transferred to SideNet.
For each current input token, top relevant key-value vector pairs are retrieved as memory augmentations for language modeling.
The SideNet module can be viewed as an efficient adaption model that is trained to fuse the current input context and relevant cached previous contexts in the decoupled memory.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.7">Formally, for a fix-sized input text sequence <math alttext="\{\mathbf{x}_{i}\}_{i=1}^{|x|}" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.2"><semantics id="S2.SS1.p2.1.m1.2a"><msubsup id="S2.SS1.p2.1.m1.2.2" xref="S2.SS1.p2.1.m1.2.2.cmml"><mrow id="S2.SS1.p2.1.m1.2.2.1.1.1" xref="S2.SS1.p2.1.m1.2.2.1.1.2.cmml"><mo id="S2.SS1.p2.1.m1.2.2.1.1.1.2" stretchy="false" xref="S2.SS1.p2.1.m1.2.2.1.1.2.cmml">{</mo><msub id="S2.SS1.p2.1.m1.2.2.1.1.1.1" xref="S2.SS1.p2.1.m1.2.2.1.1.1.1.cmml"><mi id="S2.SS1.p2.1.m1.2.2.1.1.1.1.2" xref="S2.SS1.p2.1.m1.2.2.1.1.1.1.2.cmml">ùê±</mi><mi id="S2.SS1.p2.1.m1.2.2.1.1.1.1.3" xref="S2.SS1.p2.1.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS1.p2.1.m1.2.2.1.1.1.3" stretchy="false" xref="S2.SS1.p2.1.m1.2.2.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p2.1.m1.2.2.1.3" xref="S2.SS1.p2.1.m1.2.2.1.3.cmml"><mi id="S2.SS1.p2.1.m1.2.2.1.3.2" xref="S2.SS1.p2.1.m1.2.2.1.3.2.cmml">i</mi><mo id="S2.SS1.p2.1.m1.2.2.1.3.1" xref="S2.SS1.p2.1.m1.2.2.1.3.1.cmml">=</mo><mn id="S2.SS1.p2.1.m1.2.2.1.3.3" xref="S2.SS1.p2.1.m1.2.2.1.3.3.cmml">1</mn></mrow><mrow id="S2.SS1.p2.1.m1.1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.1.2.cmml"><mo id="S2.SS1.p2.1.m1.1.1.1.3.1" stretchy="false" xref="S2.SS1.p2.1.m1.1.1.1.2.1.cmml">|</mo><mi id="S2.SS1.p2.1.m1.1.1.1.1" xref="S2.SS1.p2.1.m1.1.1.1.1.cmml">x</mi><mo id="S2.SS1.p2.1.m1.1.1.1.3.2" stretchy="false" xref="S2.SS1.p2.1.m1.1.1.1.2.1.cmml">|</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.2b"><apply id="S2.SS1.p2.1.m1.2.2.cmml" xref="S2.SS1.p2.1.m1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.2.2.2.cmml" xref="S2.SS1.p2.1.m1.2.2">superscript</csymbol><apply id="S2.SS1.p2.1.m1.2.2.1.cmml" xref="S2.SS1.p2.1.m1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.2.2.1.2.cmml" xref="S2.SS1.p2.1.m1.2.2">subscript</csymbol><set id="S2.SS1.p2.1.m1.2.2.1.1.2.cmml" xref="S2.SS1.p2.1.m1.2.2.1.1.1"><apply id="S2.SS1.p2.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.2.2.1.1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.1.m1.2.2.1.1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.2.2.1.1.1.1.2">ùê±</ci><ci id="S2.SS1.p2.1.m1.2.2.1.1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.2.2.1.1.1.1.3">ùëñ</ci></apply></set><apply id="S2.SS1.p2.1.m1.2.2.1.3.cmml" xref="S2.SS1.p2.1.m1.2.2.1.3"><eq id="S2.SS1.p2.1.m1.2.2.1.3.1.cmml" xref="S2.SS1.p2.1.m1.2.2.1.3.1"></eq><ci id="S2.SS1.p2.1.m1.2.2.1.3.2.cmml" xref="S2.SS1.p2.1.m1.2.2.1.3.2">ùëñ</ci><cn id="S2.SS1.p2.1.m1.2.2.1.3.3.cmml" type="integer" xref="S2.SS1.p2.1.m1.2.2.1.3.3">1</cn></apply></apply><apply id="S2.SS1.p2.1.m1.1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.1.3"><abs id="S2.SS1.p2.1.m1.1.1.1.2.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1.3.1"></abs><ci id="S2.SS1.p2.1.m1.1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1.1">ùë•</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.2c">\{\mathbf{x}_{i}\}_{i=1}^{|x|}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.2d">{ bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_x | end_POSTSUPERSCRIPT</annotation></semantics></math> (the current input), <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p2.7.1">LongMem</span> first performs a forward pass using the backbone LLM (marked in Blue in Figure¬†<a class="ltx_ref" href="#S2.F2" title="Figure 2 ‚Ä£ 2 Methods ‚Ä£ Augmenting Language Models with Long-Term Memory"><span class="ltx_text ltx_ref_tag">2</span></a>) <span class="ltx_text ltx_font_bold" id="S2.SS1.p2.7.2">without any gradient calculation</span>.
The embedding layer of the backbone LLM first encodes the input <math alttext="\{\mathbf{x}_{i}\}_{i=1}^{|x|}" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.2"><semantics id="S2.SS1.p2.2.m2.2a"><msubsup id="S2.SS1.p2.2.m2.2.2" xref="S2.SS1.p2.2.m2.2.2.cmml"><mrow id="S2.SS1.p2.2.m2.2.2.1.1.1" xref="S2.SS1.p2.2.m2.2.2.1.1.2.cmml"><mo id="S2.SS1.p2.2.m2.2.2.1.1.1.2" stretchy="false" xref="S2.SS1.p2.2.m2.2.2.1.1.2.cmml">{</mo><msub id="S2.SS1.p2.2.m2.2.2.1.1.1.1" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1.cmml"><mi id="S2.SS1.p2.2.m2.2.2.1.1.1.1.2" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1.2.cmml">ùê±</mi><mi id="S2.SS1.p2.2.m2.2.2.1.1.1.1.3" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS1.p2.2.m2.2.2.1.1.1.3" stretchy="false" xref="S2.SS1.p2.2.m2.2.2.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p2.2.m2.2.2.1.3" xref="S2.SS1.p2.2.m2.2.2.1.3.cmml"><mi id="S2.SS1.p2.2.m2.2.2.1.3.2" xref="S2.SS1.p2.2.m2.2.2.1.3.2.cmml">i</mi><mo id="S2.SS1.p2.2.m2.2.2.1.3.1" xref="S2.SS1.p2.2.m2.2.2.1.3.1.cmml">=</mo><mn id="S2.SS1.p2.2.m2.2.2.1.3.3" xref="S2.SS1.p2.2.m2.2.2.1.3.3.cmml">1</mn></mrow><mrow id="S2.SS1.p2.2.m2.1.1.1.3" xref="S2.SS1.p2.2.m2.1.1.1.2.cmml"><mo id="S2.SS1.p2.2.m2.1.1.1.3.1" stretchy="false" xref="S2.SS1.p2.2.m2.1.1.1.2.1.cmml">|</mo><mi id="S2.SS1.p2.2.m2.1.1.1.1" xref="S2.SS1.p2.2.m2.1.1.1.1.cmml">x</mi><mo id="S2.SS1.p2.2.m2.1.1.1.3.2" stretchy="false" xref="S2.SS1.p2.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.2b"><apply id="S2.SS1.p2.2.m2.2.2.cmml" xref="S2.SS1.p2.2.m2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.2.2.2.cmml" xref="S2.SS1.p2.2.m2.2.2">superscript</csymbol><apply id="S2.SS1.p2.2.m2.2.2.1.cmml" xref="S2.SS1.p2.2.m2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.2.2.1.2.cmml" xref="S2.SS1.p2.2.m2.2.2">subscript</csymbol><set id="S2.SS1.p2.2.m2.2.2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.1"><apply id="S2.SS1.p2.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.2.2.1.1.1.1.1.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.2.m2.2.2.1.1.1.1.2.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1.2">ùê±</ci><ci id="S2.SS1.p2.2.m2.2.2.1.1.1.1.3.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1.3">ùëñ</ci></apply></set><apply id="S2.SS1.p2.2.m2.2.2.1.3.cmml" xref="S2.SS1.p2.2.m2.2.2.1.3"><eq id="S2.SS1.p2.2.m2.2.2.1.3.1.cmml" xref="S2.SS1.p2.2.m2.2.2.1.3.1"></eq><ci id="S2.SS1.p2.2.m2.2.2.1.3.2.cmml" xref="S2.SS1.p2.2.m2.2.2.1.3.2">ùëñ</ci><cn id="S2.SS1.p2.2.m2.2.2.1.3.3.cmml" type="integer" xref="S2.SS1.p2.2.m2.2.2.1.3.3">1</cn></apply></apply><apply id="S2.SS1.p2.2.m2.1.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1.1.3"><abs id="S2.SS1.p2.2.m2.1.1.1.2.1.cmml" xref="S2.SS1.p2.2.m2.1.1.1.3.1"></abs><ci id="S2.SS1.p2.2.m2.1.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1.1.1">ùë•</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.2c">\{\mathbf{x}_{i}\}_{i=1}^{|x|}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.2d">{ bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_x | end_POSTSUPERSCRIPT</annotation></semantics></math> into embedding space and outputs the initial hidden states, <math alttext="\mathbf{H}^{0}_{\text{LLM}}\in\mathbb{R}^{|x|\times E}" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><mrow id="S2.SS1.p2.3.m3.1.2" xref="S2.SS1.p2.3.m3.1.2.cmml"><msubsup id="S2.SS1.p2.3.m3.1.2.2" xref="S2.SS1.p2.3.m3.1.2.2.cmml"><mi id="S2.SS1.p2.3.m3.1.2.2.2.2" xref="S2.SS1.p2.3.m3.1.2.2.2.2.cmml">ùêá</mi><mtext id="S2.SS1.p2.3.m3.1.2.2.3" xref="S2.SS1.p2.3.m3.1.2.2.3a.cmml">LLM</mtext><mn id="S2.SS1.p2.3.m3.1.2.2.2.3" xref="S2.SS1.p2.3.m3.1.2.2.2.3.cmml">0</mn></msubsup><mo id="S2.SS1.p2.3.m3.1.2.1" xref="S2.SS1.p2.3.m3.1.2.1.cmml">‚àà</mo><msup id="S2.SS1.p2.3.m3.1.2.3" xref="S2.SS1.p2.3.m3.1.2.3.cmml"><mi id="S2.SS1.p2.3.m3.1.2.3.2" mathvariant="normal" xref="S2.SS1.p2.3.m3.1.2.3.2.cmml">‚Ñù</mi><mrow id="S2.SS1.p2.3.m3.1.1.1" xref="S2.SS1.p2.3.m3.1.1.1.cmml"><mrow id="S2.SS1.p2.3.m3.1.1.1.3.2" xref="S2.SS1.p2.3.m3.1.1.1.3.1.cmml"><mo id="S2.SS1.p2.3.m3.1.1.1.3.2.1" stretchy="false" xref="S2.SS1.p2.3.m3.1.1.1.3.1.1.cmml">|</mo><mi id="S2.SS1.p2.3.m3.1.1.1.1" xref="S2.SS1.p2.3.m3.1.1.1.1.cmml">x</mi><mo id="S2.SS1.p2.3.m3.1.1.1.3.2.2" rspace="0.055em" stretchy="false" xref="S2.SS1.p2.3.m3.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S2.SS1.p2.3.m3.1.1.1.2" rspace="0.222em" xref="S2.SS1.p2.3.m3.1.1.1.2.cmml">√ó</mo><mi id="S2.SS1.p2.3.m3.1.1.1.4" xref="S2.SS1.p2.3.m3.1.1.1.4.cmml">E</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><apply id="S2.SS1.p2.3.m3.1.2.cmml" xref="S2.SS1.p2.3.m3.1.2"><in id="S2.SS1.p2.3.m3.1.2.1.cmml" xref="S2.SS1.p2.3.m3.1.2.1"></in><apply id="S2.SS1.p2.3.m3.1.2.2.cmml" xref="S2.SS1.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.2.2.1.cmml" xref="S2.SS1.p2.3.m3.1.2.2">subscript</csymbol><apply id="S2.SS1.p2.3.m3.1.2.2.2.cmml" xref="S2.SS1.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.2.2.2.1.cmml" xref="S2.SS1.p2.3.m3.1.2.2">superscript</csymbol><ci id="S2.SS1.p2.3.m3.1.2.2.2.2.cmml" xref="S2.SS1.p2.3.m3.1.2.2.2.2">ùêá</ci><cn id="S2.SS1.p2.3.m3.1.2.2.2.3.cmml" type="integer" xref="S2.SS1.p2.3.m3.1.2.2.2.3">0</cn></apply><ci id="S2.SS1.p2.3.m3.1.2.2.3a.cmml" xref="S2.SS1.p2.3.m3.1.2.2.3"><mtext id="S2.SS1.p2.3.m3.1.2.2.3.cmml" mathsize="70%" xref="S2.SS1.p2.3.m3.1.2.2.3">LLM</mtext></ci></apply><apply id="S2.SS1.p2.3.m3.1.2.3.cmml" xref="S2.SS1.p2.3.m3.1.2.3"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.2.3.1.cmml" xref="S2.SS1.p2.3.m3.1.2.3">superscript</csymbol><ci id="S2.SS1.p2.3.m3.1.2.3.2.cmml" xref="S2.SS1.p2.3.m3.1.2.3.2">‚Ñù</ci><apply id="S2.SS1.p2.3.m3.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1.1"><times id="S2.SS1.p2.3.m3.1.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.1.2"></times><apply id="S2.SS1.p2.3.m3.1.1.1.3.1.cmml" xref="S2.SS1.p2.3.m3.1.1.1.3.2"><abs id="S2.SS1.p2.3.m3.1.1.1.3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1.1.3.2.1"></abs><ci id="S2.SS1.p2.3.m3.1.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1.1.1">ùë•</ci></apply><ci id="S2.SS1.p2.3.m3.1.1.1.4.cmml" xref="S2.SS1.p2.3.m3.1.1.1.4">ùê∏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">\mathbf{H}^{0}_{\text{LLM}}\in\mathbb{R}^{|x|\times E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">bold_H start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT LLM end_POSTSUBSCRIPT ‚àà roman_‚Ñù start_POSTSUPERSCRIPT | italic_x | √ó italic_E end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="E" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><mi id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><ci id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">ùê∏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">E</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">italic_E</annotation></semantics></math> is the hidden dimension.
Then each successive Transformer decoder layer of the frozen backbone LLM computes the new hidden states using the hidden states from the previous layer, <math alttext="\mathbf{H}_{\text{LLM}}^{l^{\prime}}=f_{\theta_{\textnormal{LLM}}^{l^{\prime}}%
}(\mathbf{H}_{\text{LLM}}^{l^{\prime}-1}),\forall l^{\prime}\in[1,{L^{\prime}}]" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.3"><semantics id="S2.SS1.p2.5.m5.3a"><mrow id="S2.SS1.p2.5.m5.3.3.2" xref="S2.SS1.p2.5.m5.3.3.3.cmml"><mrow id="S2.SS1.p2.5.m5.2.2.1.1" xref="S2.SS1.p2.5.m5.2.2.1.1.cmml"><msubsup id="S2.SS1.p2.5.m5.2.2.1.1.3" xref="S2.SS1.p2.5.m5.2.2.1.1.3.cmml"><mi id="S2.SS1.p2.5.m5.2.2.1.1.3.2.2" xref="S2.SS1.p2.5.m5.2.2.1.1.3.2.2.cmml">ùêá</mi><mtext id="S2.SS1.p2.5.m5.2.2.1.1.3.2.3" xref="S2.SS1.p2.5.m5.2.2.1.1.3.2.3a.cmml">LLM</mtext><msup id="S2.SS1.p2.5.m5.2.2.1.1.3.3" xref="S2.SS1.p2.5.m5.2.2.1.1.3.3.cmml"><mi id="S2.SS1.p2.5.m5.2.2.1.1.3.3.2" xref="S2.SS1.p2.5.m5.2.2.1.1.3.3.2.cmml">l</mi><mo id="S2.SS1.p2.5.m5.2.2.1.1.3.3.3" xref="S2.SS1.p2.5.m5.2.2.1.1.3.3.3.cmml">‚Ä≤</mo></msup></msubsup><mo id="S2.SS1.p2.5.m5.2.2.1.1.2" xref="S2.SS1.p2.5.m5.2.2.1.1.2.cmml">=</mo><mrow id="S2.SS1.p2.5.m5.2.2.1.1.1" xref="S2.SS1.p2.5.m5.2.2.1.1.1.cmml"><msub id="S2.SS1.p2.5.m5.2.2.1.1.1.3" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.cmml"><mi id="S2.SS1.p2.5.m5.2.2.1.1.1.3.2" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.2.cmml">f</mi><msubsup id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.cmml"><mi id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.2.2" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.2.2.cmml">Œ∏</mi><mtext id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.2.3" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.2.3a.cmml">LLM</mtext><msup id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.3" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.3.cmml"><mi id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.3.2" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.3.2.cmml">l</mi><mo id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.3.3" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.3.3.cmml">‚Ä≤</mo></msup></msubsup></msub><mo id="S2.SS1.p2.5.m5.2.2.1.1.1.2" xref="S2.SS1.p2.5.m5.2.2.1.1.1.2.cmml">‚Å¢</mo><mrow id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.cmml"><mo id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.2.2" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.2.2.cmml">ùêá</mi><mtext id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.2.3" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.2.3a.cmml">LLM</mtext><mrow id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.cmml"><msup id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.2" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.2.cmml"><mi id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.2.2" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.2.2.cmml">l</mi><mo id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.2.3" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.2.3.cmml">‚Ä≤</mo></msup><mo id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.1" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.1.cmml">‚àí</mo><mn id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.3" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.SS1.p2.5.m5.3.3.2.3" xref="S2.SS1.p2.5.m5.3.3.3a.cmml">,</mo><mrow id="S2.SS1.p2.5.m5.3.3.2.2" xref="S2.SS1.p2.5.m5.3.3.2.2.cmml"><mrow id="S2.SS1.p2.5.m5.3.3.2.2.3" xref="S2.SS1.p2.5.m5.3.3.2.2.3.cmml"><mo id="S2.SS1.p2.5.m5.3.3.2.2.3.1" rspace="0.167em" xref="S2.SS1.p2.5.m5.3.3.2.2.3.1.cmml">‚àÄ</mo><msup id="S2.SS1.p2.5.m5.3.3.2.2.3.2" xref="S2.SS1.p2.5.m5.3.3.2.2.3.2.cmml"><mi id="S2.SS1.p2.5.m5.3.3.2.2.3.2.2" xref="S2.SS1.p2.5.m5.3.3.2.2.3.2.2.cmml">l</mi><mo id="S2.SS1.p2.5.m5.3.3.2.2.3.2.3" xref="S2.SS1.p2.5.m5.3.3.2.2.3.2.3.cmml">‚Ä≤</mo></msup></mrow><mo id="S2.SS1.p2.5.m5.3.3.2.2.2" xref="S2.SS1.p2.5.m5.3.3.2.2.2.cmml">‚àà</mo><mrow id="S2.SS1.p2.5.m5.3.3.2.2.1.1" xref="S2.SS1.p2.5.m5.3.3.2.2.1.2.cmml"><mo id="S2.SS1.p2.5.m5.3.3.2.2.1.1.2" stretchy="false" xref="S2.SS1.p2.5.m5.3.3.2.2.1.2.cmml">[</mo><mn id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml">1</mn><mo id="S2.SS1.p2.5.m5.3.3.2.2.1.1.3" xref="S2.SS1.p2.5.m5.3.3.2.2.1.2.cmml">,</mo><msup id="S2.SS1.p2.5.m5.3.3.2.2.1.1.1" xref="S2.SS1.p2.5.m5.3.3.2.2.1.1.1.cmml"><mi id="S2.SS1.p2.5.m5.3.3.2.2.1.1.1.2" xref="S2.SS1.p2.5.m5.3.3.2.2.1.1.1.2.cmml">L</mi><mo id="S2.SS1.p2.5.m5.3.3.2.2.1.1.1.3" xref="S2.SS1.p2.5.m5.3.3.2.2.1.1.1.3.cmml">‚Ä≤</mo></msup><mo id="S2.SS1.p2.5.m5.3.3.2.2.1.1.4" stretchy="false" xref="S2.SS1.p2.5.m5.3.3.2.2.1.2.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.3b"><apply id="S2.SS1.p2.5.m5.3.3.3.cmml" xref="S2.SS1.p2.5.m5.3.3.2"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.3.3.3a.cmml" xref="S2.SS1.p2.5.m5.3.3.2.3">formulae-sequence</csymbol><apply id="S2.SS1.p2.5.m5.2.2.1.1.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1"><eq id="S2.SS1.p2.5.m5.2.2.1.1.2.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.2"></eq><apply id="S2.SS1.p2.5.m5.2.2.1.1.3.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.2.2.1.1.3.1.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.3">superscript</csymbol><apply id="S2.SS1.p2.5.m5.2.2.1.1.3.2.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.2.2.1.1.3.2.1.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.3">subscript</csymbol><ci id="S2.SS1.p2.5.m5.2.2.1.1.3.2.2.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.3.2.2">ùêá</ci><ci id="S2.SS1.p2.5.m5.2.2.1.1.3.2.3a.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.3.2.3"><mtext id="S2.SS1.p2.5.m5.2.2.1.1.3.2.3.cmml" mathsize="70%" xref="S2.SS1.p2.5.m5.2.2.1.1.3.2.3">LLM</mtext></ci></apply><apply id="S2.SS1.p2.5.m5.2.2.1.1.3.3.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.2.2.1.1.3.3.1.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.3.3">superscript</csymbol><ci id="S2.SS1.p2.5.m5.2.2.1.1.3.3.2.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.3.3.2">ùëô</ci><ci id="S2.SS1.p2.5.m5.2.2.1.1.3.3.3.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.3.3.3">‚Ä≤</ci></apply></apply><apply id="S2.SS1.p2.5.m5.2.2.1.1.1.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1"><times id="S2.SS1.p2.5.m5.2.2.1.1.1.2.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.2"></times><apply id="S2.SS1.p2.5.m5.2.2.1.1.1.3.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.2.2.1.1.1.3.1.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p2.5.m5.2.2.1.1.1.3.2.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.2">ùëì</ci><apply id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.1.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3">superscript</csymbol><apply id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.2.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.2.1.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3">subscript</csymbol><ci id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.2.2.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.2.2">ùúÉ</ci><ci id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.2.3a.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.2.3"><mtext id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.2.3.cmml" mathsize="50%" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.2.3">LLM</mtext></ci></apply><apply id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.3.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.3.1.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.3">superscript</csymbol><ci id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.3.2.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.3.2">ùëô</ci><ci id="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.3.3.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.3.3.3.3">‚Ä≤</ci></apply></apply></apply><apply id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1">superscript</csymbol><apply id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.2.2">ùêá</ci><ci id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.2.3a.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.2.3"><mtext id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.2.3">LLM</mtext></ci></apply><apply id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3"><minus id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.1"></minus><apply id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.2.2">ùëô</ci><ci id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.2.3">‚Ä≤</ci></apply><cn id="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS1.p2.5.m5.2.2.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="S2.SS1.p2.5.m5.3.3.2.2.cmml" xref="S2.SS1.p2.5.m5.3.3.2.2"><in id="S2.SS1.p2.5.m5.3.3.2.2.2.cmml" xref="S2.SS1.p2.5.m5.3.3.2.2.2"></in><apply id="S2.SS1.p2.5.m5.3.3.2.2.3.cmml" xref="S2.SS1.p2.5.m5.3.3.2.2.3"><csymbol cd="latexml" id="S2.SS1.p2.5.m5.3.3.2.2.3.1.cmml" xref="S2.SS1.p2.5.m5.3.3.2.2.3.1">for-all</csymbol><apply id="S2.SS1.p2.5.m5.3.3.2.2.3.2.cmml" xref="S2.SS1.p2.5.m5.3.3.2.2.3.2"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.3.3.2.2.3.2.1.cmml" xref="S2.SS1.p2.5.m5.3.3.2.2.3.2">superscript</csymbol><ci id="S2.SS1.p2.5.m5.3.3.2.2.3.2.2.cmml" xref="S2.SS1.p2.5.m5.3.3.2.2.3.2.2">ùëô</ci><ci id="S2.SS1.p2.5.m5.3.3.2.2.3.2.3.cmml" xref="S2.SS1.p2.5.m5.3.3.2.2.3.2.3">‚Ä≤</ci></apply></apply><interval closure="closed" id="S2.SS1.p2.5.m5.3.3.2.2.1.2.cmml" xref="S2.SS1.p2.5.m5.3.3.2.2.1.1"><cn id="S2.SS1.p2.5.m5.1.1.cmml" type="integer" xref="S2.SS1.p2.5.m5.1.1">1</cn><apply id="S2.SS1.p2.5.m5.3.3.2.2.1.1.1.cmml" xref="S2.SS1.p2.5.m5.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.3.3.2.2.1.1.1.1.cmml" xref="S2.SS1.p2.5.m5.3.3.2.2.1.1.1">superscript</csymbol><ci id="S2.SS1.p2.5.m5.3.3.2.2.1.1.1.2.cmml" xref="S2.SS1.p2.5.m5.3.3.2.2.1.1.1.2">ùêø</ci><ci id="S2.SS1.p2.5.m5.3.3.2.2.1.1.1.3.cmml" xref="S2.SS1.p2.5.m5.3.3.2.2.1.1.1.3">‚Ä≤</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.3c">\mathbf{H}_{\text{LLM}}^{l^{\prime}}=f_{\theta_{\textnormal{LLM}}^{l^{\prime}}%
}(\mathbf{H}_{\text{LLM}}^{l^{\prime}-1}),\forall l^{\prime}\in[1,{L^{\prime}}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.3d">bold_H start_POSTSUBSCRIPT LLM end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l start_POSTSUPERSCRIPT ‚Ä≤ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT = italic_f start_POSTSUBSCRIPT italic_Œ∏ start_POSTSUBSCRIPT LLM end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l start_POSTSUPERSCRIPT ‚Ä≤ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_H start_POSTSUBSCRIPT LLM end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l start_POSTSUPERSCRIPT ‚Ä≤ end_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) , ‚àÄ italic_l start_POSTSUPERSCRIPT ‚Ä≤ end_POSTSUPERSCRIPT ‚àà [ 1 , italic_L start_POSTSUPERSCRIPT ‚Ä≤ end_POSTSUPERSCRIPT ]</annotation></semantics></math> and <math alttext="{L^{\prime}}" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m6.1"><semantics id="S2.SS1.p2.6.m6.1a"><msup id="S2.SS1.p2.6.m6.1.1" xref="S2.SS1.p2.6.m6.1.1.cmml"><mi id="S2.SS1.p2.6.m6.1.1.2" xref="S2.SS1.p2.6.m6.1.1.2.cmml">L</mi><mo id="S2.SS1.p2.6.m6.1.1.3" xref="S2.SS1.p2.6.m6.1.1.3.cmml">‚Ä≤</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.1b"><apply id="S2.SS1.p2.6.m6.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.1.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1">superscript</csymbol><ci id="S2.SS1.p2.6.m6.1.1.2.cmml" xref="S2.SS1.p2.6.m6.1.1.2">ùêø</ci><ci id="S2.SS1.p2.6.m6.1.1.3.cmml" xref="S2.SS1.p2.6.m6.1.1.3">‚Ä≤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.1c">{L^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m6.1d">italic_L start_POSTSUPERSCRIPT ‚Ä≤ end_POSTSUPERSCRIPT</annotation></semantics></math> is the total # layers for the backbone LLM.
During the forward pass with the backbone LLM for all previous inputs, the key-value pairs used for self-attention at the <math alttext="m" class="ltx_Math" display="inline" id="S2.SS1.p2.7.m7.1"><semantics id="S2.SS1.p2.7.m7.1a"><mi id="S2.SS1.p2.7.m7.1.1" xref="S2.SS1.p2.7.m7.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m7.1b"><ci id="S2.SS1.p2.7.m7.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1">ùëö</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m7.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.7.m7.1d">italic_m</annotation></semantics></math>-th Transformer decoder layer are stored in <span class="ltx_text ltx_font_bold" id="S2.SS1.p2.7.3">Cached Memory Bank</span> (marked in Orange in Upper-Left corner of Figure<a class="ltx_ref" href="#S2.F2" title="Figure 2 ‚Ä£ 2 Methods ‚Ä£ Augmenting Language Models with Long-Term Memory"><span class="ltx_text ltx_ref_tag">2</span></a>), which are later recalled as memory augmentations for future inputs.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.4"><span class="ltx_text ltx_font_bold" id="S2.SS1.p3.4.1">Cached Memory Bank</span> is a cached head-wise vector queue <math alttext="\mathcal{Z}_{k},\mathcal{Z}_{v}\in\mathbb{R}^{H\times M\times d}" class="ltx_Math" display="inline" id="S2.SS1.p3.1.m1.2"><semantics id="S2.SS1.p3.1.m1.2a"><mrow id="S2.SS1.p3.1.m1.2.2" xref="S2.SS1.p3.1.m1.2.2.cmml"><mrow id="S2.SS1.p3.1.m1.2.2.2.2" xref="S2.SS1.p3.1.m1.2.2.2.3.cmml"><msub id="S2.SS1.p3.1.m1.1.1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.1.m1.1.1.1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.1.1.1.2.cmml">ùíµ</mi><mi id="S2.SS1.p3.1.m1.1.1.1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S2.SS1.p3.1.m1.2.2.2.2.3" xref="S2.SS1.p3.1.m1.2.2.2.3.cmml">,</mo><msub id="S2.SS1.p3.1.m1.2.2.2.2.2" xref="S2.SS1.p3.1.m1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.1.m1.2.2.2.2.2.2" xref="S2.SS1.p3.1.m1.2.2.2.2.2.2.cmml">ùíµ</mi><mi id="S2.SS1.p3.1.m1.2.2.2.2.2.3" xref="S2.SS1.p3.1.m1.2.2.2.2.2.3.cmml">v</mi></msub></mrow><mo id="S2.SS1.p3.1.m1.2.2.3" xref="S2.SS1.p3.1.m1.2.2.3.cmml">‚àà</mo><msup id="S2.SS1.p3.1.m1.2.2.4" xref="S2.SS1.p3.1.m1.2.2.4.cmml"><mi id="S2.SS1.p3.1.m1.2.2.4.2" mathvariant="normal" xref="S2.SS1.p3.1.m1.2.2.4.2.cmml">‚Ñù</mi><mrow id="S2.SS1.p3.1.m1.2.2.4.3" xref="S2.SS1.p3.1.m1.2.2.4.3.cmml"><mi id="S2.SS1.p3.1.m1.2.2.4.3.2" xref="S2.SS1.p3.1.m1.2.2.4.3.2.cmml">H</mi><mo id="S2.SS1.p3.1.m1.2.2.4.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p3.1.m1.2.2.4.3.1.cmml">√ó</mo><mi id="S2.SS1.p3.1.m1.2.2.4.3.3" xref="S2.SS1.p3.1.m1.2.2.4.3.3.cmml">M</mi><mo id="S2.SS1.p3.1.m1.2.2.4.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p3.1.m1.2.2.4.3.1.cmml">√ó</mo><mi id="S2.SS1.p3.1.m1.2.2.4.3.4" xref="S2.SS1.p3.1.m1.2.2.4.3.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.2b"><apply id="S2.SS1.p3.1.m1.2.2.cmml" xref="S2.SS1.p3.1.m1.2.2"><in id="S2.SS1.p3.1.m1.2.2.3.cmml" xref="S2.SS1.p3.1.m1.2.2.3"></in><list id="S2.SS1.p3.1.m1.2.2.2.3.cmml" xref="S2.SS1.p3.1.m1.2.2.2.2"><apply id="S2.SS1.p3.1.m1.1.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.2">ùíµ</ci><ci id="S2.SS1.p3.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.3">ùëò</ci></apply><apply id="S2.SS1.p3.1.m1.2.2.2.2.2.cmml" xref="S2.SS1.p3.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.2.2.2.2.2.1.cmml" xref="S2.SS1.p3.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p3.1.m1.2.2.2.2.2.2.cmml" xref="S2.SS1.p3.1.m1.2.2.2.2.2.2">ùíµ</ci><ci id="S2.SS1.p3.1.m1.2.2.2.2.2.3.cmml" xref="S2.SS1.p3.1.m1.2.2.2.2.2.3">ùë£</ci></apply></list><apply id="S2.SS1.p3.1.m1.2.2.4.cmml" xref="S2.SS1.p3.1.m1.2.2.4"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.2.2.4.1.cmml" xref="S2.SS1.p3.1.m1.2.2.4">superscript</csymbol><ci id="S2.SS1.p3.1.m1.2.2.4.2.cmml" xref="S2.SS1.p3.1.m1.2.2.4.2">‚Ñù</ci><apply id="S2.SS1.p3.1.m1.2.2.4.3.cmml" xref="S2.SS1.p3.1.m1.2.2.4.3"><times id="S2.SS1.p3.1.m1.2.2.4.3.1.cmml" xref="S2.SS1.p3.1.m1.2.2.4.3.1"></times><ci id="S2.SS1.p3.1.m1.2.2.4.3.2.cmml" xref="S2.SS1.p3.1.m1.2.2.4.3.2">ùêª</ci><ci id="S2.SS1.p3.1.m1.2.2.4.3.3.cmml" xref="S2.SS1.p3.1.m1.2.2.4.3.3">ùëÄ</ci><ci id="S2.SS1.p3.1.m1.2.2.4.3.4.cmml" xref="S2.SS1.p3.1.m1.2.2.4.3.4">ùëë</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.2c">\mathcal{Z}_{k},\mathcal{Z}_{v}\in\mathbb{R}^{H\times M\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.1.m1.2d">caligraphic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , caligraphic_Z start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ‚àà roman_‚Ñù start_POSTSUPERSCRIPT italic_H √ó italic_M √ó italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, which maintains attention key-value pairs of latest <math alttext="M" class="ltx_Math" display="inline" id="S2.SS1.p3.2.m2.1"><semantics id="S2.SS1.p3.2.m2.1a"><mi id="S2.SS1.p3.2.m2.1.1" xref="S2.SS1.p3.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.1b"><ci id="S2.SS1.p3.2.m2.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1">ùëÄ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.2.m2.1d">italic_M</annotation></semantics></math> previous inputs <math alttext="\widetilde{\mathbf{K}},\widetilde{\mathbf{V}}\in\mathbb{R}^{H\times|x|\times d}" class="ltx_Math" display="inline" id="S2.SS1.p3.3.m3.3"><semantics id="S2.SS1.p3.3.m3.3a"><mrow id="S2.SS1.p3.3.m3.3.4" xref="S2.SS1.p3.3.m3.3.4.cmml"><mrow id="S2.SS1.p3.3.m3.3.4.2.2" xref="S2.SS1.p3.3.m3.3.4.2.1.cmml"><mover accent="true" id="S2.SS1.p3.3.m3.2.2" xref="S2.SS1.p3.3.m3.2.2.cmml"><mi id="S2.SS1.p3.3.m3.2.2.2" xref="S2.SS1.p3.3.m3.2.2.2.cmml">ùêä</mi><mo id="S2.SS1.p3.3.m3.2.2.1" xref="S2.SS1.p3.3.m3.2.2.1.cmml">~</mo></mover><mo id="S2.SS1.p3.3.m3.3.4.2.2.1" xref="S2.SS1.p3.3.m3.3.4.2.1.cmml">,</mo><mover accent="true" id="S2.SS1.p3.3.m3.3.3" xref="S2.SS1.p3.3.m3.3.3.cmml"><mi id="S2.SS1.p3.3.m3.3.3.2" xref="S2.SS1.p3.3.m3.3.3.2.cmml">ùêï</mi><mo id="S2.SS1.p3.3.m3.3.3.1" xref="S2.SS1.p3.3.m3.3.3.1.cmml">~</mo></mover></mrow><mo id="S2.SS1.p3.3.m3.3.4.1" xref="S2.SS1.p3.3.m3.3.4.1.cmml">‚àà</mo><msup id="S2.SS1.p3.3.m3.3.4.3" xref="S2.SS1.p3.3.m3.3.4.3.cmml"><mi id="S2.SS1.p3.3.m3.3.4.3.2" mathvariant="normal" xref="S2.SS1.p3.3.m3.3.4.3.2.cmml">‚Ñù</mi><mrow id="S2.SS1.p3.3.m3.1.1.1" xref="S2.SS1.p3.3.m3.1.1.1.cmml"><mi id="S2.SS1.p3.3.m3.1.1.1.3" xref="S2.SS1.p3.3.m3.1.1.1.3.cmml">H</mi><mo id="S2.SS1.p3.3.m3.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p3.3.m3.1.1.1.2.cmml">√ó</mo><mrow id="S2.SS1.p3.3.m3.1.1.1.4.2" xref="S2.SS1.p3.3.m3.1.1.1.4.1.cmml"><mo id="S2.SS1.p3.3.m3.1.1.1.4.2.1" stretchy="false" xref="S2.SS1.p3.3.m3.1.1.1.4.1.1.cmml">|</mo><mi id="S2.SS1.p3.3.m3.1.1.1.1" xref="S2.SS1.p3.3.m3.1.1.1.1.cmml">x</mi><mo id="S2.SS1.p3.3.m3.1.1.1.4.2.2" rspace="0.055em" stretchy="false" xref="S2.SS1.p3.3.m3.1.1.1.4.1.1.cmml">|</mo></mrow><mo id="S2.SS1.p3.3.m3.1.1.1.2a" rspace="0.222em" xref="S2.SS1.p3.3.m3.1.1.1.2.cmml">√ó</mo><mi id="S2.SS1.p3.3.m3.1.1.1.5" xref="S2.SS1.p3.3.m3.1.1.1.5.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.3b"><apply id="S2.SS1.p3.3.m3.3.4.cmml" xref="S2.SS1.p3.3.m3.3.4"><in id="S2.SS1.p3.3.m3.3.4.1.cmml" xref="S2.SS1.p3.3.m3.3.4.1"></in><list id="S2.SS1.p3.3.m3.3.4.2.1.cmml" xref="S2.SS1.p3.3.m3.3.4.2.2"><apply id="S2.SS1.p3.3.m3.2.2.cmml" xref="S2.SS1.p3.3.m3.2.2"><ci id="S2.SS1.p3.3.m3.2.2.1.cmml" xref="S2.SS1.p3.3.m3.2.2.1">~</ci><ci id="S2.SS1.p3.3.m3.2.2.2.cmml" xref="S2.SS1.p3.3.m3.2.2.2">ùêä</ci></apply><apply id="S2.SS1.p3.3.m3.3.3.cmml" xref="S2.SS1.p3.3.m3.3.3"><ci id="S2.SS1.p3.3.m3.3.3.1.cmml" xref="S2.SS1.p3.3.m3.3.3.1">~</ci><ci id="S2.SS1.p3.3.m3.3.3.2.cmml" xref="S2.SS1.p3.3.m3.3.3.2">ùêï</ci></apply></list><apply id="S2.SS1.p3.3.m3.3.4.3.cmml" xref="S2.SS1.p3.3.m3.3.4.3"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.3.4.3.1.cmml" xref="S2.SS1.p3.3.m3.3.4.3">superscript</csymbol><ci id="S2.SS1.p3.3.m3.3.4.3.2.cmml" xref="S2.SS1.p3.3.m3.3.4.3.2">‚Ñù</ci><apply id="S2.SS1.p3.3.m3.1.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1"><times id="S2.SS1.p3.3.m3.1.1.1.2.cmml" xref="S2.SS1.p3.3.m3.1.1.1.2"></times><ci id="S2.SS1.p3.3.m3.1.1.1.3.cmml" xref="S2.SS1.p3.3.m3.1.1.1.3">ùêª</ci><apply id="S2.SS1.p3.3.m3.1.1.1.4.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1.4.2"><abs id="S2.SS1.p3.3.m3.1.1.1.4.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1.4.2.1"></abs><ci id="S2.SS1.p3.3.m3.1.1.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1">ùë•</ci></apply><ci id="S2.SS1.p3.3.m3.1.1.1.5.cmml" xref="S2.SS1.p3.3.m3.1.1.1.5">ùëë</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.3c">\widetilde{\mathbf{K}},\widetilde{\mathbf{V}}\in\mathbb{R}^{H\times|x|\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.3.m3.3d">over~ start_ARG bold_K end_ARG , over~ start_ARG bold_V end_ARG ‚àà roman_‚Ñù start_POSTSUPERSCRIPT italic_H √ó | italic_x | √ó italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="H,d" class="ltx_Math" display="inline" id="S2.SS1.p3.4.m4.2"><semantics id="S2.SS1.p3.4.m4.2a"><mrow id="S2.SS1.p3.4.m4.2.3.2" xref="S2.SS1.p3.4.m4.2.3.1.cmml"><mi id="S2.SS1.p3.4.m4.1.1" xref="S2.SS1.p3.4.m4.1.1.cmml">H</mi><mo id="S2.SS1.p3.4.m4.2.3.2.1" xref="S2.SS1.p3.4.m4.2.3.1.cmml">,</mo><mi id="S2.SS1.p3.4.m4.2.2" xref="S2.SS1.p3.4.m4.2.2.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.4.m4.2b"><list id="S2.SS1.p3.4.m4.2.3.1.cmml" xref="S2.SS1.p3.4.m4.2.3.2"><ci id="S2.SS1.p3.4.m4.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1">ùêª</ci><ci id="S2.SS1.p3.4.m4.2.2.cmml" xref="S2.SS1.p3.4.m4.2.2">ùëë</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.4.m4.2c">H,d</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.4.m4.2d">italic_H , italic_d</annotation></semantics></math> denotes the number of attention heads and per-head dimension respectively. After memory retrieval and fusion (¬ß<a class="ltx_ref" href="#S2.SS3" title="2.3 Memory Retrieval and Fusion ‚Ä£ 2 Methods ‚Ä£ Augmenting Language Models with Long-Term Memory"><span class="ltx_text ltx_ref_tag">2.3</span></a>), the memory bank removes the key-value pairs of the oldest sequences and appends the current sequences to the cached vector bank.
Thus such an update mechanism ensures the language modeling causality at the sequences level and enables the memory bank to always keep records of the nearest previous context for the current inputs.</p>
</div>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.6">After the forward pass with the backbone LLM, the SideNet module then takes all current input hidden states from the backbone LLM <math alttext="\{\mathbf{H}_{\text{LLM}}^{l^{\prime}}\}_{{l^{\prime}}=1}^{L^{\prime}}" class="ltx_Math" display="inline" id="S2.SS1.p4.1.m1.1"><semantics id="S2.SS1.p4.1.m1.1a"><msubsup id="S2.SS1.p4.1.m1.1.1" xref="S2.SS1.p4.1.m1.1.1.cmml"><mrow id="S2.SS1.p4.1.m1.1.1.1.1.1" xref="S2.SS1.p4.1.m1.1.1.1.1.2.cmml"><mo id="S2.SS1.p4.1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p4.1.m1.1.1.1.1.2.cmml">{</mo><msubsup id="S2.SS1.p4.1.m1.1.1.1.1.1.1" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p4.1.m1.1.1.1.1.1.1.2.2" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1.2.2.cmml">ùêá</mi><mtext id="S2.SS1.p4.1.m1.1.1.1.1.1.1.2.3" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1.2.3a.cmml">LLM</mtext><msup id="S2.SS1.p4.1.m1.1.1.1.1.1.1.3" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p4.1.m1.1.1.1.1.1.1.3.2" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.SS1.p4.1.m1.1.1.1.1.1.1.3.3" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1.3.3.cmml">‚Ä≤</mo></msup></msubsup><mo id="S2.SS1.p4.1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p4.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p4.1.m1.1.1.1.3" xref="S2.SS1.p4.1.m1.1.1.1.3.cmml"><msup id="S2.SS1.p4.1.m1.1.1.1.3.2" xref="S2.SS1.p4.1.m1.1.1.1.3.2.cmml"><mi id="S2.SS1.p4.1.m1.1.1.1.3.2.2" xref="S2.SS1.p4.1.m1.1.1.1.3.2.2.cmml">l</mi><mo id="S2.SS1.p4.1.m1.1.1.1.3.2.3" xref="S2.SS1.p4.1.m1.1.1.1.3.2.3.cmml">‚Ä≤</mo></msup><mo id="S2.SS1.p4.1.m1.1.1.1.3.1" xref="S2.SS1.p4.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p4.1.m1.1.1.1.3.3" xref="S2.SS1.p4.1.m1.1.1.1.3.3.cmml">1</mn></mrow><msup id="S2.SS1.p4.1.m1.1.1.3" xref="S2.SS1.p4.1.m1.1.1.3.cmml"><mi id="S2.SS1.p4.1.m1.1.1.3.2" xref="S2.SS1.p4.1.m1.1.1.3.2.cmml">L</mi><mo id="S2.SS1.p4.1.m1.1.1.3.3" xref="S2.SS1.p4.1.m1.1.1.3.3.cmml">‚Ä≤</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.1b"><apply id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.1.1.2.cmml" xref="S2.SS1.p4.1.m1.1.1">superscript</csymbol><apply id="S2.SS1.p4.1.m1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.1.1.1.2.cmml" xref="S2.SS1.p4.1.m1.1.1">subscript</csymbol><set id="S2.SS1.p4.1.m1.1.1.1.1.2.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1.1"><apply id="S2.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS1.p4.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p4.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1.2.2">ùêá</ci><ci id="S2.SS1.p4.1.m1.1.1.1.1.1.1.2.3a.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1.2.3"><mtext id="S2.SS1.p4.1.m1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1.2.3">LLM</mtext></ci></apply><apply id="S2.SS1.p4.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.SS1.p4.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1.3.2">ùëô</ci><ci id="S2.SS1.p4.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1.1.1.3.3">‚Ä≤</ci></apply></apply></set><apply id="S2.SS1.p4.1.m1.1.1.1.3.cmml" xref="S2.SS1.p4.1.m1.1.1.1.3"><eq id="S2.SS1.p4.1.m1.1.1.1.3.1.cmml" xref="S2.SS1.p4.1.m1.1.1.1.3.1"></eq><apply id="S2.SS1.p4.1.m1.1.1.1.3.2.cmml" xref="S2.SS1.p4.1.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.1.1.1.3.2.1.cmml" xref="S2.SS1.p4.1.m1.1.1.1.3.2">superscript</csymbol><ci id="S2.SS1.p4.1.m1.1.1.1.3.2.2.cmml" xref="S2.SS1.p4.1.m1.1.1.1.3.2.2">ùëô</ci><ci id="S2.SS1.p4.1.m1.1.1.1.3.2.3.cmml" xref="S2.SS1.p4.1.m1.1.1.1.3.2.3">‚Ä≤</ci></apply><cn id="S2.SS1.p4.1.m1.1.1.1.3.3.cmml" type="integer" xref="S2.SS1.p4.1.m1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.SS1.p4.1.m1.1.1.3.cmml" xref="S2.SS1.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.1.1.3.1.cmml" xref="S2.SS1.p4.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS1.p4.1.m1.1.1.3.2.cmml" xref="S2.SS1.p4.1.m1.1.1.3.2">ùêø</ci><ci id="S2.SS1.p4.1.m1.1.1.3.3.cmml" xref="S2.SS1.p4.1.m1.1.1.3.3">‚Ä≤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.1c">\{\mathbf{H}_{\text{LLM}}^{l^{\prime}}\}_{{l^{\prime}}=1}^{L^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.1.m1.1d">{ bold_H start_POSTSUBSCRIPT LLM end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l start_POSTSUPERSCRIPT ‚Ä≤ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_l start_POSTSUPERSCRIPT ‚Ä≤ end_POSTSUPERSCRIPT = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L start_POSTSUPERSCRIPT ‚Ä≤ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and the past key-value pairs in Cached Memory Bank for computing memory-augmented representations.
Specifically, our SideNet of <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p4.6.1">LongMem</span> consists of <math alttext="(L-1)" class="ltx_Math" display="inline" id="S2.SS1.p4.2.m2.1"><semantics id="S2.SS1.p4.2.m2.1a"><mrow id="S2.SS1.p4.2.m2.1.1.1" xref="S2.SS1.p4.2.m2.1.1.1.1.cmml"><mo id="S2.SS1.p4.2.m2.1.1.1.2" stretchy="false" xref="S2.SS1.p4.2.m2.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p4.2.m2.1.1.1.1" xref="S2.SS1.p4.2.m2.1.1.1.1.cmml"><mi id="S2.SS1.p4.2.m2.1.1.1.1.2" xref="S2.SS1.p4.2.m2.1.1.1.1.2.cmml">L</mi><mo id="S2.SS1.p4.2.m2.1.1.1.1.1" xref="S2.SS1.p4.2.m2.1.1.1.1.1.cmml">‚àí</mo><mn id="S2.SS1.p4.2.m2.1.1.1.1.3" xref="S2.SS1.p4.2.m2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.SS1.p4.2.m2.1.1.1.3" stretchy="false" xref="S2.SS1.p4.2.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m2.1b"><apply id="S2.SS1.p4.2.m2.1.1.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1.1"><minus id="S2.SS1.p4.2.m2.1.1.1.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1.1.1.1"></minus><ci id="S2.SS1.p4.2.m2.1.1.1.1.2.cmml" xref="S2.SS1.p4.2.m2.1.1.1.1.2">ùêø</ci><cn id="S2.SS1.p4.2.m2.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p4.2.m2.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m2.1c">(L-1)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.2.m2.1d">( italic_L - 1 )</annotation></semantics></math> normal Transformer decoder layers and one special memory-augmented decoder layer.
For efficient purposes, we mainly consider the case where #layers <math alttext="L" class="ltx_Math" display="inline" id="S2.SS1.p4.3.m3.1"><semantics id="S2.SS1.p4.3.m3.1a"><mi id="S2.SS1.p4.3.m3.1.1" xref="S2.SS1.p4.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.3.m3.1b"><ci id="S2.SS1.p4.3.m3.1.1.cmml" xref="S2.SS1.p4.3.m3.1.1">ùêø</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.3.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.3.m3.1d">italic_L</annotation></semantics></math> of the SideNet is smaller than that of the backbone LLM, <em class="ltx_emph ltx_font_italic" id="S2.SS1.p4.6.2">i.e.,</em>¬†<math alttext="L&lt;{L^{\prime}}" class="ltx_Math" display="inline" id="S2.SS1.p4.4.m4.1"><semantics id="S2.SS1.p4.4.m4.1a"><mrow id="S2.SS1.p4.4.m4.1.1" xref="S2.SS1.p4.4.m4.1.1.cmml"><mi id="S2.SS1.p4.4.m4.1.1.2" xref="S2.SS1.p4.4.m4.1.1.2.cmml">L</mi><mo id="S2.SS1.p4.4.m4.1.1.1" xref="S2.SS1.p4.4.m4.1.1.1.cmml">&lt;</mo><msup id="S2.SS1.p4.4.m4.1.1.3" xref="S2.SS1.p4.4.m4.1.1.3.cmml"><mi id="S2.SS1.p4.4.m4.1.1.3.2" xref="S2.SS1.p4.4.m4.1.1.3.2.cmml">L</mi><mo id="S2.SS1.p4.4.m4.1.1.3.3" xref="S2.SS1.p4.4.m4.1.1.3.3.cmml">‚Ä≤</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.4.m4.1b"><apply id="S2.SS1.p4.4.m4.1.1.cmml" xref="S2.SS1.p4.4.m4.1.1"><lt id="S2.SS1.p4.4.m4.1.1.1.cmml" xref="S2.SS1.p4.4.m4.1.1.1"></lt><ci id="S2.SS1.p4.4.m4.1.1.2.cmml" xref="S2.SS1.p4.4.m4.1.1.2">ùêø</ci><apply id="S2.SS1.p4.4.m4.1.1.3.cmml" xref="S2.SS1.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p4.4.m4.1.1.3.1.cmml" xref="S2.SS1.p4.4.m4.1.1.3">superscript</csymbol><ci id="S2.SS1.p4.4.m4.1.1.3.2.cmml" xref="S2.SS1.p4.4.m4.1.1.3.2">ùêø</ci><ci id="S2.SS1.p4.4.m4.1.1.3.3.cmml" xref="S2.SS1.p4.4.m4.1.1.3.3">‚Ä≤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.4.m4.1c">L&lt;{L^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.4.m4.1d">italic_L &lt; italic_L start_POSTSUPERSCRIPT ‚Ä≤ end_POSTSUPERSCRIPT</annotation></semantics></math>.
Our SideNet encodes <math alttext="\mathbf{H}^{0}" class="ltx_Math" display="inline" id="S2.SS1.p4.5.m5.1"><semantics id="S2.SS1.p4.5.m5.1a"><msup id="S2.SS1.p4.5.m5.1.1" xref="S2.SS1.p4.5.m5.1.1.cmml"><mi id="S2.SS1.p4.5.m5.1.1.2" xref="S2.SS1.p4.5.m5.1.1.2.cmml">ùêá</mi><mn id="S2.SS1.p4.5.m5.1.1.3" xref="S2.SS1.p4.5.m5.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.5.m5.1b"><apply id="S2.SS1.p4.5.m5.1.1.cmml" xref="S2.SS1.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.5.m5.1.1.1.cmml" xref="S2.SS1.p4.5.m5.1.1">superscript</csymbol><ci id="S2.SS1.p4.5.m5.1.1.2.cmml" xref="S2.SS1.p4.5.m5.1.1.2">ùêá</ci><cn id="S2.SS1.p4.5.m5.1.1.3.cmml" type="integer" xref="S2.SS1.p4.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.5.m5.1c">\mathbf{H}^{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.5.m5.1d">bold_H start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math> into memory-augmented contextual representation via <math alttext="(L-1)" class="ltx_Math" display="inline" id="S2.SS1.p4.6.m6.1"><semantics id="S2.SS1.p4.6.m6.1a"><mrow id="S2.SS1.p4.6.m6.1.1.1" xref="S2.SS1.p4.6.m6.1.1.1.1.cmml"><mo id="S2.SS1.p4.6.m6.1.1.1.2" stretchy="false" xref="S2.SS1.p4.6.m6.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p4.6.m6.1.1.1.1" xref="S2.SS1.p4.6.m6.1.1.1.1.cmml"><mi id="S2.SS1.p4.6.m6.1.1.1.1.2" xref="S2.SS1.p4.6.m6.1.1.1.1.2.cmml">L</mi><mo id="S2.SS1.p4.6.m6.1.1.1.1.1" xref="S2.SS1.p4.6.m6.1.1.1.1.1.cmml">‚àí</mo><mn id="S2.SS1.p4.6.m6.1.1.1.1.3" xref="S2.SS1.p4.6.m6.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.SS1.p4.6.m6.1.1.1.3" stretchy="false" xref="S2.SS1.p4.6.m6.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.6.m6.1b"><apply id="S2.SS1.p4.6.m6.1.1.1.1.cmml" xref="S2.SS1.p4.6.m6.1.1.1"><minus id="S2.SS1.p4.6.m6.1.1.1.1.1.cmml" xref="S2.SS1.p4.6.m6.1.1.1.1.1"></minus><ci id="S2.SS1.p4.6.m6.1.1.1.1.2.cmml" xref="S2.SS1.p4.6.m6.1.1.1.1.2">ùêø</ci><cn id="S2.SS1.p4.6.m6.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p4.6.m6.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.6.m6.1c">(L-1)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.6.m6.1d">( italic_L - 1 )</annotation></semantics></math> normal Transformer decoder layers and a special <span class="ltx_text ltx_font_bold" id="S2.SS1.p4.6.3">memory-augmented layer</span>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p5">
<p class="ltx_p" id="S2.SS1.p5.5">The <span class="ltx_text ltx_font_bold" id="S2.SS1.p5.5.1">memory-augmented layer</span> is an extension of the vanilla Transformer decoder layer that takes a memory-augmented input, including both top relevant key-value pairs in memory and the hidden states from the current input.
Here, the cached key-value pairs are recalled using a token-based memory retrieval module (¬ß<a class="ltx_ref" href="#S2.SS3" title="2.3 Memory Retrieval and Fusion ‚Ä£ 2 Methods ‚Ä£ Augmenting Language Models with Long-Term Memory"><span class="ltx_text ltx_ref_tag">2.3</span></a>).
For each current input token, the memory retrieval module <math alttext="s_{rt}(:)" class="ltx_Math" display="inline" id="S2.SS1.p5.1.m1.1"><semantics id="S2.SS1.p5.1.m1.1a"><mrow id="S2.SS1.p5.1.m1.1.2" xref="S2.SS1.p5.1.m1.1.2.cmml"><msub id="S2.SS1.p5.1.m1.1.2.2" xref="S2.SS1.p5.1.m1.1.2.2.cmml"><mi id="S2.SS1.p5.1.m1.1.2.2.2" xref="S2.SS1.p5.1.m1.1.2.2.2.cmml">s</mi><mrow id="S2.SS1.p5.1.m1.1.2.2.3" xref="S2.SS1.p5.1.m1.1.2.2.3.cmml"><mi id="S2.SS1.p5.1.m1.1.2.2.3.2" xref="S2.SS1.p5.1.m1.1.2.2.3.2.cmml">r</mi><mo id="S2.SS1.p5.1.m1.1.2.2.3.1" xref="S2.SS1.p5.1.m1.1.2.2.3.1.cmml">‚Å¢</mo><mi id="S2.SS1.p5.1.m1.1.2.2.3.3" xref="S2.SS1.p5.1.m1.1.2.2.3.3.cmml">t</mi></mrow></msub><mo id="S2.SS1.p5.1.m1.1.2.1" xref="S2.SS1.p5.1.m1.1.2.1.cmml">‚Å¢</mo><mrow id="S2.SS1.p5.1.m1.1.2.3.2" xref="S2.SS1.p5.1.m1.1.2.cmml"><mo id="S2.SS1.p5.1.m1.1.2.3.2.1" stretchy="false" xref="S2.SS1.p5.1.m1.1.2.cmml">(</mo><mo id="S2.SS1.p5.1.m1.1.1" rspace="0em" xref="S2.SS1.p5.1.m1.1.1.cmml">:</mo><mo id="S2.SS1.p5.1.m1.1.2.3.2.2" stretchy="false" xref="S2.SS1.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.1.m1.1b"><apply id="S2.SS1.p5.1.m1.1.2.cmml" xref="S2.SS1.p5.1.m1.1.2"><times id="S2.SS1.p5.1.m1.1.2.1.cmml" xref="S2.SS1.p5.1.m1.1.2.1"></times><apply id="S2.SS1.p5.1.m1.1.2.2.cmml" xref="S2.SS1.p5.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p5.1.m1.1.2.2.1.cmml" xref="S2.SS1.p5.1.m1.1.2.2">subscript</csymbol><ci id="S2.SS1.p5.1.m1.1.2.2.2.cmml" xref="S2.SS1.p5.1.m1.1.2.2.2">ùë†</ci><apply id="S2.SS1.p5.1.m1.1.2.2.3.cmml" xref="S2.SS1.p5.1.m1.1.2.2.3"><times id="S2.SS1.p5.1.m1.1.2.2.3.1.cmml" xref="S2.SS1.p5.1.m1.1.2.2.3.1"></times><ci id="S2.SS1.p5.1.m1.1.2.2.3.2.cmml" xref="S2.SS1.p5.1.m1.1.2.2.3.2">ùëü</ci><ci id="S2.SS1.p5.1.m1.1.2.2.3.3.cmml" xref="S2.SS1.p5.1.m1.1.2.2.3.3">ùë°</ci></apply></apply><ci id="S2.SS1.p5.1.m1.1.1.cmml" xref="S2.SS1.p5.1.m1.1.1">:</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.1.m1.1c">s_{rt}(:)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( : )</annotation></semantics></math> retrieves top-<math alttext="K" class="ltx_Math" display="inline" id="S2.SS1.p5.2.m2.1"><semantics id="S2.SS1.p5.2.m2.1a"><mi id="S2.SS1.p5.2.m2.1.1" xref="S2.SS1.p5.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.2.m2.1b"><ci id="S2.SS1.p5.2.m2.1.1.cmml" xref="S2.SS1.p5.2.m2.1.1">ùêæ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.2.m2.1d">italic_K</annotation></semantics></math> relevant key-value pairs in the memory bank <math alttext="\{\widetilde{\mathbf{\boldsymbol{k}}}_{ij},\widetilde{\mathbf{\boldsymbol{v}}}%
_{ij}\}_{j=1}^{K}=s_{rt}(\mathbf{x}_{i})" class="ltx_Math" display="inline" id="S2.SS1.p5.3.m3.3"><semantics id="S2.SS1.p5.3.m3.3a"><mrow id="S2.SS1.p5.3.m3.3.3" xref="S2.SS1.p5.3.m3.3.3.cmml"><msubsup id="S2.SS1.p5.3.m3.2.2.2" xref="S2.SS1.p5.3.m3.2.2.2.cmml"><mrow id="S2.SS1.p5.3.m3.2.2.2.2.2.2" xref="S2.SS1.p5.3.m3.2.2.2.2.2.3.cmml"><mo id="S2.SS1.p5.3.m3.2.2.2.2.2.2.3" stretchy="false" xref="S2.SS1.p5.3.m3.2.2.2.2.2.3.cmml">{</mo><msub id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.2" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.2.2.cmml">ùê§</mi><mo id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.2.1" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.3" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.3.2" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.3.1" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.3.1.cmml">‚Å¢</mo><mi id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.3.3" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS1.p5.3.m3.2.2.2.2.2.2.4" xref="S2.SS1.p5.3.m3.2.2.2.2.2.3.cmml">,</mo><msub id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.cmml"><mover accent="true" id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.2" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.2.cmml"><mi id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.2.2" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.2.2.cmml">ùêØ</mi><mo id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.2.1" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.2.1.cmml">~</mo></mover><mrow id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.3" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.3.cmml"><mi id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.3.2" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.3.2.cmml">i</mi><mo id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.3.1" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.3.1.cmml">‚Å¢</mo><mi id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.3.3" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS1.p5.3.m3.2.2.2.2.2.2.5" stretchy="false" xref="S2.SS1.p5.3.m3.2.2.2.2.2.3.cmml">}</mo></mrow><mrow id="S2.SS1.p5.3.m3.2.2.2.2.4" xref="S2.SS1.p5.3.m3.2.2.2.2.4.cmml"><mi id="S2.SS1.p5.3.m3.2.2.2.2.4.2" xref="S2.SS1.p5.3.m3.2.2.2.2.4.2.cmml">j</mi><mo id="S2.SS1.p5.3.m3.2.2.2.2.4.1" xref="S2.SS1.p5.3.m3.2.2.2.2.4.1.cmml">=</mo><mn id="S2.SS1.p5.3.m3.2.2.2.2.4.3" xref="S2.SS1.p5.3.m3.2.2.2.2.4.3.cmml">1</mn></mrow><mi id="S2.SS1.p5.3.m3.2.2.2.4" xref="S2.SS1.p5.3.m3.2.2.2.4.cmml">K</mi></msubsup><mo id="S2.SS1.p5.3.m3.3.3.4" xref="S2.SS1.p5.3.m3.3.3.4.cmml">=</mo><mrow id="S2.SS1.p5.3.m3.3.3.3" xref="S2.SS1.p5.3.m3.3.3.3.cmml"><msub id="S2.SS1.p5.3.m3.3.3.3.3" xref="S2.SS1.p5.3.m3.3.3.3.3.cmml"><mi id="S2.SS1.p5.3.m3.3.3.3.3.2" xref="S2.SS1.p5.3.m3.3.3.3.3.2.cmml">s</mi><mrow id="S2.SS1.p5.3.m3.3.3.3.3.3" xref="S2.SS1.p5.3.m3.3.3.3.3.3.cmml"><mi id="S2.SS1.p5.3.m3.3.3.3.3.3.2" xref="S2.SS1.p5.3.m3.3.3.3.3.3.2.cmml">r</mi><mo id="S2.SS1.p5.3.m3.3.3.3.3.3.1" xref="S2.SS1.p5.3.m3.3.3.3.3.3.1.cmml">‚Å¢</mo><mi id="S2.SS1.p5.3.m3.3.3.3.3.3.3" xref="S2.SS1.p5.3.m3.3.3.3.3.3.3.cmml">t</mi></mrow></msub><mo id="S2.SS1.p5.3.m3.3.3.3.2" xref="S2.SS1.p5.3.m3.3.3.3.2.cmml">‚Å¢</mo><mrow id="S2.SS1.p5.3.m3.3.3.3.1.1" xref="S2.SS1.p5.3.m3.3.3.3.1.1.1.cmml"><mo id="S2.SS1.p5.3.m3.3.3.3.1.1.2" stretchy="false" xref="S2.SS1.p5.3.m3.3.3.3.1.1.1.cmml">(</mo><msub id="S2.SS1.p5.3.m3.3.3.3.1.1.1" xref="S2.SS1.p5.3.m3.3.3.3.1.1.1.cmml"><mi id="S2.SS1.p5.3.m3.3.3.3.1.1.1.2" xref="S2.SS1.p5.3.m3.3.3.3.1.1.1.2.cmml">ùê±</mi><mi id="S2.SS1.p5.3.m3.3.3.3.1.1.1.3" xref="S2.SS1.p5.3.m3.3.3.3.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS1.p5.3.m3.3.3.3.1.1.3" stretchy="false" xref="S2.SS1.p5.3.m3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.3.m3.3b"><apply id="S2.SS1.p5.3.m3.3.3.cmml" xref="S2.SS1.p5.3.m3.3.3"><eq id="S2.SS1.p5.3.m3.3.3.4.cmml" xref="S2.SS1.p5.3.m3.3.3.4"></eq><apply id="S2.SS1.p5.3.m3.2.2.2.cmml" xref="S2.SS1.p5.3.m3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p5.3.m3.2.2.2.3.cmml" xref="S2.SS1.p5.3.m3.2.2.2">superscript</csymbol><apply id="S2.SS1.p5.3.m3.2.2.2.2.cmml" xref="S2.SS1.p5.3.m3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p5.3.m3.2.2.2.2.3.cmml" xref="S2.SS1.p5.3.m3.2.2.2">subscript</csymbol><set id="S2.SS1.p5.3.m3.2.2.2.2.2.3.cmml" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2"><apply id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.2"><ci id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.2.1">~</ci><ci id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.2.2">ùê§</ci></apply><apply id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.3"><times id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.3.1"></times><ci id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.3.2">ùëñ</ci><ci id="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p5.3.m3.1.1.1.1.1.1.1.3.3">ùëó</ci></apply></apply><apply id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.cmml" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.1.cmml" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2">subscript</csymbol><apply id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.2.cmml" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.2"><ci id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.2.1.cmml" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.2.1">~</ci><ci id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.2.2.cmml" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.2.2">ùêØ</ci></apply><apply id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.3.cmml" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.3"><times id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.3.1.cmml" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.3.1"></times><ci id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.3.2.cmml" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.3.2">ùëñ</ci><ci id="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.3.3.cmml" xref="S2.SS1.p5.3.m3.2.2.2.2.2.2.2.3.3">ùëó</ci></apply></apply></set><apply id="S2.SS1.p5.3.m3.2.2.2.2.4.cmml" xref="S2.SS1.p5.3.m3.2.2.2.2.4"><eq id="S2.SS1.p5.3.m3.2.2.2.2.4.1.cmml" xref="S2.SS1.p5.3.m3.2.2.2.2.4.1"></eq><ci id="S2.SS1.p5.3.m3.2.2.2.2.4.2.cmml" xref="S2.SS1.p5.3.m3.2.2.2.2.4.2">ùëó</ci><cn id="S2.SS1.p5.3.m3.2.2.2.2.4.3.cmml" type="integer" xref="S2.SS1.p5.3.m3.2.2.2.2.4.3">1</cn></apply></apply><ci id="S2.SS1.p5.3.m3.2.2.2.4.cmml" xref="S2.SS1.p5.3.m3.2.2.2.4">ùêæ</ci></apply><apply id="S2.SS1.p5.3.m3.3.3.3.cmml" xref="S2.SS1.p5.3.m3.3.3.3"><times id="S2.SS1.p5.3.m3.3.3.3.2.cmml" xref="S2.SS1.p5.3.m3.3.3.3.2"></times><apply id="S2.SS1.p5.3.m3.3.3.3.3.cmml" xref="S2.SS1.p5.3.m3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p5.3.m3.3.3.3.3.1.cmml" xref="S2.SS1.p5.3.m3.3.3.3.3">subscript</csymbol><ci id="S2.SS1.p5.3.m3.3.3.3.3.2.cmml" xref="S2.SS1.p5.3.m3.3.3.3.3.2">ùë†</ci><apply id="S2.SS1.p5.3.m3.3.3.3.3.3.cmml" xref="S2.SS1.p5.3.m3.3.3.3.3.3"><times id="S2.SS1.p5.3.m3.3.3.3.3.3.1.cmml" xref="S2.SS1.p5.3.m3.3.3.3.3.3.1"></times><ci id="S2.SS1.p5.3.m3.3.3.3.3.3.2.cmml" xref="S2.SS1.p5.3.m3.3.3.3.3.3.2">ùëü</ci><ci id="S2.SS1.p5.3.m3.3.3.3.3.3.3.cmml" xref="S2.SS1.p5.3.m3.3.3.3.3.3.3">ùë°</ci></apply></apply><apply id="S2.SS1.p5.3.m3.3.3.3.1.1.1.cmml" xref="S2.SS1.p5.3.m3.3.3.3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.3.m3.3.3.3.1.1.1.1.cmml" xref="S2.SS1.p5.3.m3.3.3.3.1.1">subscript</csymbol><ci id="S2.SS1.p5.3.m3.3.3.3.1.1.1.2.cmml" xref="S2.SS1.p5.3.m3.3.3.3.1.1.1.2">ùê±</ci><ci id="S2.SS1.p5.3.m3.3.3.3.1.1.1.3.cmml" xref="S2.SS1.p5.3.m3.3.3.3.1.1.1.3">ùëñ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.3.m3.3c">\{\widetilde{\mathbf{\boldsymbol{k}}}_{ij},\widetilde{\mathbf{\boldsymbol{v}}}%
_{ij}\}_{j=1}^{K}=s_{rt}(\mathbf{x}_{i})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.3.m3.3d">{ over~ start_ARG bold_k end_ARG start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT , over~ start_ARG bold_v end_ARG start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT = italic_s start_POSTSUBSCRIPT italic_r italic_t end_POSTSUBSCRIPT ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>.
Then SideNet computes the output using the memory-augmented input, <math alttext="\mathbf{H}^{m_{s}}_{\text{Side}}=f_{\theta_{\textnormal{Mem}}}(\mathbf{H}_{%
\text{Side}}^{m_{s}-1},\{\{\widetilde{\mathbf{k}}_{ij},\widetilde{\mathbf{v}}_%
{ij}\}_{j=1}^{K}\}_{i=1}^{|x|})" class="ltx_Math" display="inline" id="S2.SS1.p5.4.m4.3"><semantics id="S2.SS1.p5.4.m4.3a"><mrow id="S2.SS1.p5.4.m4.3.3" xref="S2.SS1.p5.4.m4.3.3.cmml"><msubsup id="S2.SS1.p5.4.m4.3.3.4" xref="S2.SS1.p5.4.m4.3.3.4.cmml"><mi id="S2.SS1.p5.4.m4.3.3.4.2.2" xref="S2.SS1.p5.4.m4.3.3.4.2.2.cmml">ùêá</mi><mtext id="S2.SS1.p5.4.m4.3.3.4.3" xref="S2.SS1.p5.4.m4.3.3.4.3a.cmml">Side</mtext><msub id="S2.SS1.p5.4.m4.3.3.4.2.3" xref="S2.SS1.p5.4.m4.3.3.4.2.3.cmml"><mi id="S2.SS1.p5.4.m4.3.3.4.2.3.2" xref="S2.SS1.p5.4.m4.3.3.4.2.3.2.cmml">m</mi><mi id="S2.SS1.p5.4.m4.3.3.4.2.3.3" xref="S2.SS1.p5.4.m4.3.3.4.2.3.3.cmml">s</mi></msub></msubsup><mo id="S2.SS1.p5.4.m4.3.3.3" xref="S2.SS1.p5.4.m4.3.3.3.cmml">=</mo><mrow id="S2.SS1.p5.4.m4.3.3.2" xref="S2.SS1.p5.4.m4.3.3.2.cmml"><msub id="S2.SS1.p5.4.m4.3.3.2.4" xref="S2.SS1.p5.4.m4.3.3.2.4.cmml"><mi id="S2.SS1.p5.4.m4.3.3.2.4.2" xref="S2.SS1.p5.4.m4.3.3.2.4.2.cmml">f</mi><msub id="S2.SS1.p5.4.m4.3.3.2.4.3" xref="S2.SS1.p5.4.m4.3.3.2.4.3.cmml"><mi id="S2.SS1.p5.4.m4.3.3.2.4.3.2" xref="S2.SS1.p5.4.m4.3.3.2.4.3.2.cmml">Œ∏</mi><mtext id="S2.SS1.p5.4.m4.3.3.2.4.3.3" xref="S2.SS1.p5.4.m4.3.3.2.4.3.3a.cmml">Mem</mtext></msub></msub><mo id="S2.SS1.p5.4.m4.3.3.2.3" xref="S2.SS1.p5.4.m4.3.3.2.3.cmml">‚Å¢</mo><mrow id="S2.SS1.p5.4.m4.3.3.2.2.2" xref="S2.SS1.p5.4.m4.3.3.2.2.3.cmml"><mo id="S2.SS1.p5.4.m4.3.3.2.2.2.3" stretchy="false" xref="S2.SS1.p5.4.m4.3.3.2.2.3.cmml">(</mo><msubsup id="S2.SS1.p5.4.m4.2.2.1.1.1.1" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.cmml"><mi id="S2.SS1.p5.4.m4.2.2.1.1.1.1.2.2" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.2.2.cmml">ùêá</mi><mtext id="S2.SS1.p5.4.m4.2.2.1.1.1.1.2.3" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.2.3a.cmml">Side</mtext><mrow id="S2.SS1.p5.4.m4.2.2.1.1.1.1.3" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.cmml"><msub id="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.2" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.2.cmml"><mi id="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.2.2" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.2.2.cmml">m</mi><mi id="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.2.3" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.2.3.cmml">s</mi></msub><mo id="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.1" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.1.cmml">‚àí</mo><mn id="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.3" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.SS1.p5.4.m4.3.3.2.2.2.4" xref="S2.SS1.p5.4.m4.3.3.2.2.3.cmml">,</mo><msubsup id="S2.SS1.p5.4.m4.3.3.2.2.2.2" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.cmml"><mrow id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.2.cmml"><mo id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.2" stretchy="false" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.2.cmml">{</mo><msubsup id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.cmml"><mrow id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.3.cmml"><mo id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.3.cmml">{</mo><msub id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml">ùê§</mi><mo id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.2.1" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.3.2" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.3.1" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.3.1.cmml">‚Å¢</mo><mi id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.3.3" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.4" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.cmml"><mover accent="true" id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.2" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.2.cmml"><mi id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.2.2" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.2.2.cmml">ùêØ</mi><mo id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.2.1" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.2.1.cmml">~</mo></mover><mrow id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.3" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.3.cmml"><mi id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.3.2" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.3.2.cmml">i</mi><mo id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.3.1" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.3.1.cmml">‚Å¢</mo><mi id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.3.3" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.5" stretchy="false" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.3.cmml">}</mo></mrow><mrow id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.4" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.4.cmml"><mi id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.4.2" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.4.2.cmml">j</mi><mo id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.4.1" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.4.1.cmml">=</mo><mn id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.4.3" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.4.3.cmml">1</mn></mrow><mi id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.4" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.4.cmml">K</mi></msubsup><mo id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.3" stretchy="false" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.3" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.3.cmml"><mi id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.3.2" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.3.2.cmml">i</mi><mo id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.3.1" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.3.1.cmml">=</mo><mn id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.3.3" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.3.3.cmml">1</mn></mrow><mrow id="S2.SS1.p5.4.m4.1.1.1.3" xref="S2.SS1.p5.4.m4.1.1.1.2.cmml"><mo id="S2.SS1.p5.4.m4.1.1.1.3.1" stretchy="false" xref="S2.SS1.p5.4.m4.1.1.1.2.1.cmml">|</mo><mi id="S2.SS1.p5.4.m4.1.1.1.1" xref="S2.SS1.p5.4.m4.1.1.1.1.cmml">x</mi><mo id="S2.SS1.p5.4.m4.1.1.1.3.2" stretchy="false" xref="S2.SS1.p5.4.m4.1.1.1.2.1.cmml">|</mo></mrow></msubsup><mo id="S2.SS1.p5.4.m4.3.3.2.2.2.5" stretchy="false" xref="S2.SS1.p5.4.m4.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.4.m4.3b"><apply id="S2.SS1.p5.4.m4.3.3.cmml" xref="S2.SS1.p5.4.m4.3.3"><eq id="S2.SS1.p5.4.m4.3.3.3.cmml" xref="S2.SS1.p5.4.m4.3.3.3"></eq><apply id="S2.SS1.p5.4.m4.3.3.4.cmml" xref="S2.SS1.p5.4.m4.3.3.4"><csymbol cd="ambiguous" id="S2.SS1.p5.4.m4.3.3.4.1.cmml" xref="S2.SS1.p5.4.m4.3.3.4">subscript</csymbol><apply id="S2.SS1.p5.4.m4.3.3.4.2.cmml" xref="S2.SS1.p5.4.m4.3.3.4"><csymbol cd="ambiguous" id="S2.SS1.p5.4.m4.3.3.4.2.1.cmml" xref="S2.SS1.p5.4.m4.3.3.4">superscript</csymbol><ci id="S2.SS1.p5.4.m4.3.3.4.2.2.cmml" xref="S2.SS1.p5.4.m4.3.3.4.2.2">ùêá</ci><apply id="S2.SS1.p5.4.m4.3.3.4.2.3.cmml" xref="S2.SS1.p5.4.m4.3.3.4.2.3"><csymbol cd="ambiguous" id="S2.SS1.p5.4.m4.3.3.4.2.3.1.cmml" xref="S2.SS1.p5.4.m4.3.3.4.2.3">subscript</csymbol><ci id="S2.SS1.p5.4.m4.3.3.4.2.3.2.cmml" xref="S2.SS1.p5.4.m4.3.3.4.2.3.2">ùëö</ci><ci id="S2.SS1.p5.4.m4.3.3.4.2.3.3.cmml" xref="S2.SS1.p5.4.m4.3.3.4.2.3.3">ùë†</ci></apply></apply><ci id="S2.SS1.p5.4.m4.3.3.4.3a.cmml" xref="S2.SS1.p5.4.m4.3.3.4.3"><mtext id="S2.SS1.p5.4.m4.3.3.4.3.cmml" mathsize="70%" xref="S2.SS1.p5.4.m4.3.3.4.3">Side</mtext></ci></apply><apply id="S2.SS1.p5.4.m4.3.3.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2"><times id="S2.SS1.p5.4.m4.3.3.2.3.cmml" xref="S2.SS1.p5.4.m4.3.3.2.3"></times><apply id="S2.SS1.p5.4.m4.3.3.2.4.cmml" xref="S2.SS1.p5.4.m4.3.3.2.4"><csymbol cd="ambiguous" id="S2.SS1.p5.4.m4.3.3.2.4.1.cmml" xref="S2.SS1.p5.4.m4.3.3.2.4">subscript</csymbol><ci id="S2.SS1.p5.4.m4.3.3.2.4.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2.4.2">ùëì</ci><apply id="S2.SS1.p5.4.m4.3.3.2.4.3.cmml" xref="S2.SS1.p5.4.m4.3.3.2.4.3"><csymbol cd="ambiguous" id="S2.SS1.p5.4.m4.3.3.2.4.3.1.cmml" xref="S2.SS1.p5.4.m4.3.3.2.4.3">subscript</csymbol><ci id="S2.SS1.p5.4.m4.3.3.2.4.3.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2.4.3.2">ùúÉ</ci><ci id="S2.SS1.p5.4.m4.3.3.2.4.3.3a.cmml" xref="S2.SS1.p5.4.m4.3.3.2.4.3.3"><mtext id="S2.SS1.p5.4.m4.3.3.2.4.3.3.cmml" mathsize="50%" xref="S2.SS1.p5.4.m4.3.3.2.4.3.3">Mem</mtext></ci></apply></apply><interval closure="open" id="S2.SS1.p5.4.m4.3.3.2.2.3.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2"><apply id="S2.SS1.p5.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.4.m4.2.2.1.1.1.1.1.cmml" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1">superscript</csymbol><apply id="S2.SS1.p5.4.m4.2.2.1.1.1.1.2.cmml" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.4.m4.2.2.1.1.1.1.2.1.cmml" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p5.4.m4.2.2.1.1.1.1.2.2.cmml" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.2.2">ùêá</ci><ci id="S2.SS1.p5.4.m4.2.2.1.1.1.1.2.3a.cmml" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.2.3"><mtext id="S2.SS1.p5.4.m4.2.2.1.1.1.1.2.3.cmml" mathsize="70%" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.2.3">Side</mtext></ci></apply><apply id="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.cmml" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.3"><minus id="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.1.cmml" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.1"></minus><apply id="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.2.cmml" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.2.1.cmml" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.2.2.cmml" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.2.2">ùëö</ci><ci id="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.2.3.cmml" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.2.3">ùë†</ci></apply><cn id="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS1.p5.4.m4.2.2.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.SS1.p5.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p5.4.m4.3.3.2.2.2.2.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2">superscript</csymbol><apply id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2">subscript</csymbol><set id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1"><apply id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.3.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1">superscript</csymbol><apply id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.3.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1">subscript</csymbol><set id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2"><apply id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.2"><ci id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.2.2">ùê§</ci></apply><apply id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.3"><times id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.3.1"></times><ci id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.3.2">ùëñ</ci><ci id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.1.1.1.1.3.3">ùëó</ci></apply></apply><apply id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.2"><ci id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.2.1">~</ci><ci id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.2.2">ùêØ</ci></apply><apply id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.3"><times id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.3.1.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.3.1"></times><ci id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.3.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.3.2">ùëñ</ci><ci id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.3.3.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.2.2.2.3.3">ùëó</ci></apply></apply></set><apply id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.4.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.4"><eq id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.4.1.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.4.1"></eq><ci id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.4.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.4.2">ùëó</ci><cn id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.4.3.cmml" type="integer" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.2.4.3">1</cn></apply></apply><ci id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.4.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.1.1.1.4">ùêæ</ci></apply></set><apply id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.3.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.3"><eq id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.3.1.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.3.1"></eq><ci id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.3.2.cmml" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.3.2">ùëñ</ci><cn id="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.3.3.cmml" type="integer" xref="S2.SS1.p5.4.m4.3.3.2.2.2.2.1.3.3">1</cn></apply></apply><apply id="S2.SS1.p5.4.m4.1.1.1.2.cmml" xref="S2.SS1.p5.4.m4.1.1.1.3"><abs id="S2.SS1.p5.4.m4.1.1.1.2.1.cmml" xref="S2.SS1.p5.4.m4.1.1.1.3.1"></abs><ci id="S2.SS1.p5.4.m4.1.1.1.1.cmml" xref="S2.SS1.p5.4.m4.1.1.1.1">ùë•</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.4.m4.3c">\mathbf{H}^{m_{s}}_{\text{Side}}=f_{\theta_{\textnormal{Mem}}}(\mathbf{H}_{%
\text{Side}}^{m_{s}-1},\{\{\widetilde{\mathbf{k}}_{ij},\widetilde{\mathbf{v}}_%
{ij}\}_{j=1}^{K}\}_{i=1}^{|x|})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.4.m4.3d">bold_H start_POSTSUPERSCRIPT italic_m start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT Side end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT italic_Œ∏ start_POSTSUBSCRIPT Mem end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_H start_POSTSUBSCRIPT Side end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT - 1 end_POSTSUPERSCRIPT , { { over~ start_ARG bold_k end_ARG start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT , over~ start_ARG bold_v end_ARG start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_x | end_POSTSUPERSCRIPT )</annotation></semantics></math>, where <math alttext="m_{s}" class="ltx_Math" display="inline" id="S2.SS1.p5.5.m5.1"><semantics id="S2.SS1.p5.5.m5.1a"><msub id="S2.SS1.p5.5.m5.1.1" xref="S2.SS1.p5.5.m5.1.1.cmml"><mi id="S2.SS1.p5.5.m5.1.1.2" xref="S2.SS1.p5.5.m5.1.1.2.cmml">m</mi><mi id="S2.SS1.p5.5.m5.1.1.3" xref="S2.SS1.p5.5.m5.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.5.m5.1b"><apply id="S2.SS1.p5.5.m5.1.1.cmml" xref="S2.SS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.5.m5.1.1.1.cmml" xref="S2.SS1.p5.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p5.5.m5.1.1.2.cmml" xref="S2.SS1.p5.5.m5.1.1.2">ùëö</ci><ci id="S2.SS1.p5.5.m5.1.1.3.cmml" xref="S2.SS1.p5.5.m5.1.1.3">ùë†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.5.m5.1c">m_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p5.5.m5.1d">italic_m start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> is the layer index where we inject the memory-augmentation layer.</p>
</div>
<div class="ltx_para" id="S2.SS1.p6">
<p class="ltx_p" id="S2.SS1.p6.5">Finally, the token probability is computed using the last SideNet hidden states <math alttext="P(\mathbf{x}_{i}|\mathbf{x}_{1},\cdots,\mathbf{x}_{i-1})=\textnormal{softmax}(%
W\mathbf{H}^{L})" class="ltx_Math" display="inline" id="S2.SS1.p6.1.m1.3"><semantics id="S2.SS1.p6.1.m1.3a"><mrow id="S2.SS1.p6.1.m1.3.3" xref="S2.SS1.p6.1.m1.3.3.cmml"><mrow id="S2.SS1.p6.1.m1.2.2.1" xref="S2.SS1.p6.1.m1.2.2.1.cmml"><mi id="S2.SS1.p6.1.m1.2.2.1.3" xref="S2.SS1.p6.1.m1.2.2.1.3.cmml">P</mi><mo id="S2.SS1.p6.1.m1.2.2.1.2" xref="S2.SS1.p6.1.m1.2.2.1.2.cmml">‚Å¢</mo><mrow id="S2.SS1.p6.1.m1.2.2.1.1.1" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.cmml"><mo id="S2.SS1.p6.1.m1.2.2.1.1.1.2" stretchy="false" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p6.1.m1.2.2.1.1.1.1" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.cmml"><msub id="S2.SS1.p6.1.m1.2.2.1.1.1.1.4" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.4.cmml"><mi id="S2.SS1.p6.1.m1.2.2.1.1.1.1.4.2" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.4.2.cmml">ùê±</mi><mi id="S2.SS1.p6.1.m1.2.2.1.1.1.1.4.3" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.4.3.cmml">i</mi></msub><mo fence="false" id="S2.SS1.p6.1.m1.2.2.1.1.1.1.3" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.3.cmml">|</mo><mrow id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.3.cmml"><msub id="S2.SS1.p6.1.m1.2.2.1.1.1.1.1.1.1" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p6.1.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.1.1.1.2.cmml">ùê±</mi><mn id="S2.SS1.p6.1.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.3" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.3.cmml">,</mo><mi id="S2.SS1.p6.1.m1.1.1" mathvariant="normal" xref="S2.SS1.p6.1.m1.1.1.cmml">‚ãØ</mi><mo id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.4" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.3.cmml">,</mo><msub id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.cmml"><mi id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.2" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.2.cmml">ùê±</mi><mrow id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.3" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.3.cmml"><mi id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.3.2" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.3.2.cmml">i</mi><mo id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.3.1" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.3.1.cmml">‚àí</mo><mn id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.3.3" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S2.SS1.p6.1.m1.2.2.1.1.1.3" stretchy="false" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p6.1.m1.3.3.3" xref="S2.SS1.p6.1.m1.3.3.3.cmml">=</mo><mrow id="S2.SS1.p6.1.m1.3.3.2" xref="S2.SS1.p6.1.m1.3.3.2.cmml"><mtext id="S2.SS1.p6.1.m1.3.3.2.3" xref="S2.SS1.p6.1.m1.3.3.2.3a.cmml">softmax</mtext><mo id="S2.SS1.p6.1.m1.3.3.2.2" xref="S2.SS1.p6.1.m1.3.3.2.2.cmml">‚Å¢</mo><mrow id="S2.SS1.p6.1.m1.3.3.2.1.1" xref="S2.SS1.p6.1.m1.3.3.2.1.1.1.cmml"><mo id="S2.SS1.p6.1.m1.3.3.2.1.1.2" stretchy="false" xref="S2.SS1.p6.1.m1.3.3.2.1.1.1.cmml">(</mo><mrow id="S2.SS1.p6.1.m1.3.3.2.1.1.1" xref="S2.SS1.p6.1.m1.3.3.2.1.1.1.cmml"><mi id="S2.SS1.p6.1.m1.3.3.2.1.1.1.2" xref="S2.SS1.p6.1.m1.3.3.2.1.1.1.2.cmml">W</mi><mo id="S2.SS1.p6.1.m1.3.3.2.1.1.1.1" xref="S2.SS1.p6.1.m1.3.3.2.1.1.1.1.cmml">‚Å¢</mo><msup id="S2.SS1.p6.1.m1.3.3.2.1.1.1.3" xref="S2.SS1.p6.1.m1.3.3.2.1.1.1.3.cmml"><mi id="S2.SS1.p6.1.m1.3.3.2.1.1.1.3.2" xref="S2.SS1.p6.1.m1.3.3.2.1.1.1.3.2.cmml">ùêá</mi><mi id="S2.SS1.p6.1.m1.3.3.2.1.1.1.3.3" xref="S2.SS1.p6.1.m1.3.3.2.1.1.1.3.3.cmml">L</mi></msup></mrow><mo id="S2.SS1.p6.1.m1.3.3.2.1.1.3" stretchy="false" xref="S2.SS1.p6.1.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.1.m1.3b"><apply id="S2.SS1.p6.1.m1.3.3.cmml" xref="S2.SS1.p6.1.m1.3.3"><eq id="S2.SS1.p6.1.m1.3.3.3.cmml" xref="S2.SS1.p6.1.m1.3.3.3"></eq><apply id="S2.SS1.p6.1.m1.2.2.1.cmml" xref="S2.SS1.p6.1.m1.2.2.1"><times id="S2.SS1.p6.1.m1.2.2.1.2.cmml" xref="S2.SS1.p6.1.m1.2.2.1.2"></times><ci id="S2.SS1.p6.1.m1.2.2.1.3.cmml" xref="S2.SS1.p6.1.m1.2.2.1.3">ùëÉ</ci><apply id="S2.SS1.p6.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS1.p6.1.m1.2.2.1.1.1"><csymbol cd="latexml" id="S2.SS1.p6.1.m1.2.2.1.1.1.1.3.cmml" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.3">conditional</csymbol><apply id="S2.SS1.p6.1.m1.2.2.1.1.1.1.4.cmml" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.p6.1.m1.2.2.1.1.1.1.4.1.cmml" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.4">subscript</csymbol><ci id="S2.SS1.p6.1.m1.2.2.1.1.1.1.4.2.cmml" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.4.2">ùê±</ci><ci id="S2.SS1.p6.1.m1.2.2.1.1.1.1.4.3.cmml" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.4.3">ùëñ</ci></apply><list id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2"><apply id="S2.SS1.p6.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p6.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p6.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.1.1.1.2">ùê±</ci><cn id="S2.SS1.p6.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.SS1.p6.1.m1.1.1.cmml" xref="S2.SS1.p6.1.m1.1.1">‚ãØ</ci><apply id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.1.cmml" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.2">ùê±</ci><apply id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.3.cmml" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.3"><minus id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.3.1.cmml" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.3.1"></minus><ci id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.3.2.cmml" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.3.2">ùëñ</ci><cn id="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S2.SS1.p6.1.m1.2.2.1.1.1.1.2.2.2.3.3">1</cn></apply></apply></list></apply></apply><apply id="S2.SS1.p6.1.m1.3.3.2.cmml" xref="S2.SS1.p6.1.m1.3.3.2"><times id="S2.SS1.p6.1.m1.3.3.2.2.cmml" xref="S2.SS1.p6.1.m1.3.3.2.2"></times><ci id="S2.SS1.p6.1.m1.3.3.2.3a.cmml" xref="S2.SS1.p6.1.m1.3.3.2.3"><mtext id="S2.SS1.p6.1.m1.3.3.2.3.cmml" xref="S2.SS1.p6.1.m1.3.3.2.3">softmax</mtext></ci><apply id="S2.SS1.p6.1.m1.3.3.2.1.1.1.cmml" xref="S2.SS1.p6.1.m1.3.3.2.1.1"><times id="S2.SS1.p6.1.m1.3.3.2.1.1.1.1.cmml" xref="S2.SS1.p6.1.m1.3.3.2.1.1.1.1"></times><ci id="S2.SS1.p6.1.m1.3.3.2.1.1.1.2.cmml" xref="S2.SS1.p6.1.m1.3.3.2.1.1.1.2">ùëä</ci><apply id="S2.SS1.p6.1.m1.3.3.2.1.1.1.3.cmml" xref="S2.SS1.p6.1.m1.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p6.1.m1.3.3.2.1.1.1.3.1.cmml" xref="S2.SS1.p6.1.m1.3.3.2.1.1.1.3">superscript</csymbol><ci id="S2.SS1.p6.1.m1.3.3.2.1.1.1.3.2.cmml" xref="S2.SS1.p6.1.m1.3.3.2.1.1.1.3.2">ùêá</ci><ci id="S2.SS1.p6.1.m1.3.3.2.1.1.1.3.3.cmml" xref="S2.SS1.p6.1.m1.3.3.2.1.1.1.3.3">ùêø</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.1.m1.3c">P(\mathbf{x}_{i}|\mathbf{x}_{1},\cdots,\mathbf{x}_{i-1})=\textnormal{softmax}(%
W\mathbf{H}^{L})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.1.m1.3d">italic_P ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ‚ãØ , bold_x start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ) = softmax ( italic_W bold_H start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT )</annotation></semantics></math>, where <math alttext="W" class="ltx_Math" display="inline" id="S2.SS1.p6.2.m2.1"><semantics id="S2.SS1.p6.2.m2.1a"><mi id="S2.SS1.p6.2.m2.1.1" xref="S2.SS1.p6.2.m2.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.2.m2.1b"><ci id="S2.SS1.p6.2.m2.1.1.cmml" xref="S2.SS1.p6.2.m2.1.1">ùëä</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.2.m2.1c">W</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.2.m2.1d">italic_W</annotation></semantics></math> is the frozen output embedding weight shared by both the backbone LLM and SideNet. We perform a memory-augmented adaptation training for <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p6.5.1">LongMem</span> to utilize the decoupled memory. Following the <span class="ltx_text ltx_font_italic" id="S2.SS1.p6.5.2">generative unsupervised pre-training</span>¬†<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib.bib14" title=""><span class="ltx_text" style="font-size:90%;">14</span></a>]</cite>, the training objective of <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p6.5.3">LongMem</span> is the standard left-to-right language modeling objective, which maximizes the likelihood of the next token based on the left context: <math alttext="\max\sum_{x\in\mathcal{D}}\sum_{i=1}^{|\mathbf{x}|}\log P(\mathbf{x}_{i}|%
\mathbf{x}_{1},\cdots,\mathbf{x}_{i-1})," class="ltx_Math" display="inline" id="S2.SS1.p6.3.m3.3"><semantics id="S2.SS1.p6.3.m3.3a"><mrow id="S2.SS1.p6.3.m3.3.3.1" xref="S2.SS1.p6.3.m3.3.3.1.1.cmml"><mrow id="S2.SS1.p6.3.m3.3.3.1.1" xref="S2.SS1.p6.3.m3.3.3.1.1.cmml"><mi id="S2.SS1.p6.3.m3.3.3.1.1.3" xref="S2.SS1.p6.3.m3.3.3.1.1.3.cmml">max</mi><mo id="S2.SS1.p6.3.m3.3.3.1.1.2" xref="S2.SS1.p6.3.m3.3.3.1.1.2.cmml">‚Å¢</mo><mrow id="S2.SS1.p6.3.m3.3.3.1.1.1" xref="S2.SS1.p6.3.m3.3.3.1.1.1.cmml"><msub id="S2.SS1.p6.3.m3.3.3.1.1.1.2" xref="S2.SS1.p6.3.m3.3.3.1.1.1.2.cmml"><mo id="S2.SS1.p6.3.m3.3.3.1.1.1.2.2" rspace="0em" xref="S2.SS1.p6.3.m3.3.3.1.1.1.2.2.cmml">‚àë</mo><mrow id="S2.SS1.p6.3.m3.3.3.1.1.1.2.3" xref="S2.SS1.p6.3.m3.3.3.1.1.1.2.3.cmml"><mi id="S2.SS1.p6.3.m3.3.3.1.1.1.2.3.2" xref="S2.SS1.p6.3.m3.3.3.1.1.1.2.3.2.cmml">x</mi><mo id="S2.SS1.p6.3.m3.3.3.1.1.1.2.3.1" xref="S2.SS1.p6.3.m3.3.3.1.1.1.2.3.1.cmml">‚àà</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p6.3.m3.3.3.1.1.1.2.3.3" xref="S2.SS1.p6.3.m3.3.3.1.1.1.2.3.3.cmml">ùíü</mi></mrow></msub><mrow id="S2.SS1.p6.3.m3.3.3.1.1.1.1" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.cmml"><msubsup id="S2.SS1.p6.3.m3.3.3.1.1.1.1.2" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.cmml"><mo id="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.2" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.2.cmml">‚àë</mo><mrow id="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.3" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.3.cmml"><mi id="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.3.2" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.3.1" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.3.3" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S2.SS1.p6.3.m3.1.1.1.3" xref="S2.SS1.p6.3.m3.1.1.1.2.cmml"><mo id="S2.SS1.p6.3.m3.1.1.1.3.1" stretchy="false" xref="S2.SS1.p6.3.m3.1.1.1.2.1.cmml">|</mo><mi id="S2.SS1.p6.3.m3.1.1.1.1" xref="S2.SS1.p6.3.m3.1.1.1.1.cmml">ùê±</mi><mo id="S2.SS1.p6.3.m3.1.1.1.3.2" stretchy="false" xref="S2.SS1.p6.3.m3.1.1.1.2.1.cmml">|</mo></mrow></msubsup><mrow id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.cmml"><mrow id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.3" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.3.1" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.3a" lspace="0.167em" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.3.cmml">‚Å°</mo><mi id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.3.2" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.3.2.cmml">P</mi></mrow><mo id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.2" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.2.cmml">‚Å¢</mo><mrow id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.cmml"><msub id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.4" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.4.cmml"><mi id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.4.2" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.4.2.cmml">ùê±</mi><mi id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.4.3" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.4.3.cmml">i</mi></msub><mo fence="false" id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.3.cmml"><msub id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">ùê±</mi><mn id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.3" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="S2.SS1.p6.3.m3.2.2" mathvariant="normal" xref="S2.SS1.p6.3.m3.2.2.cmml">‚ãØ</mi><mo id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.4" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml">ùê±</mi><mrow id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.3.2" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml">i</mi><mo id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.3.1" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">‚àí</mo><mn id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.3.3" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.SS1.p6.3.m3.3.3.1.2" xref="S2.SS1.p6.3.m3.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.3.m3.3b"><apply id="S2.SS1.p6.3.m3.3.3.1.1.cmml" xref="S2.SS1.p6.3.m3.3.3.1"><times id="S2.SS1.p6.3.m3.3.3.1.1.2.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.2"></times><max id="S2.SS1.p6.3.m3.3.3.1.1.3.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.3"></max><apply id="S2.SS1.p6.3.m3.3.3.1.1.1.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1"><apply id="S2.SS1.p6.3.m3.3.3.1.1.1.2.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p6.3.m3.3.3.1.1.1.2.1.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.2">subscript</csymbol><sum id="S2.SS1.p6.3.m3.3.3.1.1.1.2.2.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.2.2"></sum><apply id="S2.SS1.p6.3.m3.3.3.1.1.1.2.3.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.2.3"><in id="S2.SS1.p6.3.m3.3.3.1.1.1.2.3.1.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.2.3.1"></in><ci id="S2.SS1.p6.3.m3.3.3.1.1.1.2.3.2.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.2.3.2">ùë•</ci><ci id="S2.SS1.p6.3.m3.3.3.1.1.1.2.3.3.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.2.3.3">ùíü</ci></apply></apply><apply id="S2.SS1.p6.3.m3.3.3.1.1.1.1.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1"><apply id="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.1.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.2">superscript</csymbol><apply id="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.2">subscript</csymbol><sum id="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.2"></sum><apply id="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.3"><eq id="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.3.1.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.3.2.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.3.2">ùëñ</ci><cn id="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.SS1.p6.3.m3.1.1.1.2.cmml" xref="S2.SS1.p6.3.m3.1.1.1.3"><abs id="S2.SS1.p6.3.m3.1.1.1.2.1.cmml" xref="S2.SS1.p6.3.m3.1.1.1.3.1"></abs><ci id="S2.SS1.p6.3.m3.1.1.1.1.cmml" xref="S2.SS1.p6.3.m3.1.1.1.1">ùê±</ci></apply></apply><apply id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1"><times id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.2.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.2"></times><apply id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.3.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.3"><log id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.3.1"></log><ci id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.3.2">ùëÉ</ci></apply><apply id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.4.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.4.2">ùê±</ci><ci id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.4.3.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.4.3">ùëñ</ci></apply><list id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2"><apply id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1.1.1.2">ùê±</ci><cn id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.SS1.p6.3.m3.2.2.cmml" xref="S2.SS1.p6.3.m3.2.2">‚ãØ</ci><apply id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.2">ùê±</ci><apply id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.3"><minus id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.3.1"></minus><ci id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.3.2">ùëñ</ci><cn id="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S2.SS1.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.3.m3.3c">\max\sum_{x\in\mathcal{D}}\sum_{i=1}^{|\mathbf{x}|}\log P(\mathbf{x}_{i}|%
\mathbf{x}_{1},\cdots,\mathbf{x}_{i-1}),</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.3.m3.3d">roman_max ‚àë start_POSTSUBSCRIPT italic_x ‚àà caligraphic_D end_POSTSUBSCRIPT ‚àë start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | bold_x | end_POSTSUPERSCRIPT roman_log italic_P ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | bold_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ‚ãØ , bold_x start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT ) ,</annotation></semantics></math>
where <math alttext="x" class="ltx_Math" display="inline" id="S2.SS1.p6.4.m4.1"><semantics id="S2.SS1.p6.4.m4.1a"><mi id="S2.SS1.p6.4.m4.1.1" xref="S2.SS1.p6.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.4.m4.1b"><ci id="S2.SS1.p6.4.m4.1.1.cmml" xref="S2.SS1.p6.4.m4.1.1">ùë•</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.4.m4.1d">italic_x</annotation></semantics></math> is a randomly sampled sentence from the pre-training text corpus <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S2.SS1.p6.5.m5.1"><semantics id="S2.SS1.p6.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p6.5.m5.1.1" xref="S2.SS1.p6.5.m5.1.1.cmml">ùíü</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.5.m5.1b"><ci id="S2.SS1.p6.5.m5.1.1.cmml" xref="S2.SS1.p6.5.m5.1.1">ùíü</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.5.m5.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.5.m5.1d">caligraphic_D</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Residual SideNet</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.5"><span class="ltx_text ltx_font_bold" id="S2.SS2.p1.5.1">SideNet Architecture and Initialization.</span> Here, we again implement SideNet based on Transformer¬†<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib.bib24" title=""><span class="ltx_text" style="font-size:90%;">24</span></a>]</cite>.
Here, the number of decoder layers <math alttext="L" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">ùêø</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_L</annotation></semantics></math> in SideNet is equal to the number of layers <math alttext="L^{\prime}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><msup id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">L</mi><mo id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">‚Ä≤</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">superscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">ùêø</ci><ci id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3">‚Ä≤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">L^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_L start_POSTSUPERSCRIPT ‚Ä≤ end_POSTSUPERSCRIPT</annotation></semantics></math> in the backbone LLM divided by a reduction factor (a layer reduction factor of <math alttext="2" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><mn id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><cn id="S2.SS2.p1.3.m3.1.1.cmml" type="integer" xref="S2.SS2.p1.3.m3.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">2</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">2</annotation></semantics></math> throughout this work <math alttext="L^{\prime}=2L" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.1"><semantics id="S2.SS2.p1.4.m4.1a"><mrow id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml"><msup id="S2.SS2.p1.4.m4.1.1.2" xref="S2.SS2.p1.4.m4.1.1.2.cmml"><mi id="S2.SS2.p1.4.m4.1.1.2.2" xref="S2.SS2.p1.4.m4.1.1.2.2.cmml">L</mi><mo id="S2.SS2.p1.4.m4.1.1.2.3" xref="S2.SS2.p1.4.m4.1.1.2.3.cmml">‚Ä≤</mo></msup><mo id="S2.SS2.p1.4.m4.1.1.1" xref="S2.SS2.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S2.SS2.p1.4.m4.1.1.3" xref="S2.SS2.p1.4.m4.1.1.3.cmml"><mn id="S2.SS2.p1.4.m4.1.1.3.2" xref="S2.SS2.p1.4.m4.1.1.3.2.cmml">2</mn><mo id="S2.SS2.p1.4.m4.1.1.3.1" xref="S2.SS2.p1.4.m4.1.1.3.1.cmml">‚Å¢</mo><mi id="S2.SS2.p1.4.m4.1.1.3.3" xref="S2.SS2.p1.4.m4.1.1.3.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><apply id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1"><eq id="S2.SS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1.1"></eq><apply id="S2.SS2.p1.4.m4.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.1.1.2.1.cmml" xref="S2.SS2.p1.4.m4.1.1.2">superscript</csymbol><ci id="S2.SS2.p1.4.m4.1.1.2.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2.2">ùêø</ci><ci id="S2.SS2.p1.4.m4.1.1.2.3.cmml" xref="S2.SS2.p1.4.m4.1.1.2.3">‚Ä≤</ci></apply><apply id="S2.SS2.p1.4.m4.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3"><times id="S2.SS2.p1.4.m4.1.1.3.1.cmml" xref="S2.SS2.p1.4.m4.1.1.3.1"></times><cn id="S2.SS2.p1.4.m4.1.1.3.2.cmml" type="integer" xref="S2.SS2.p1.4.m4.1.1.3.2">2</cn><ci id="S2.SS2.p1.4.m4.1.1.3.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3.3">ùêø</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">L^{\prime}=2L</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.1d">italic_L start_POSTSUPERSCRIPT ‚Ä≤ end_POSTSUPERSCRIPT = 2 italic_L</annotation></semantics></math>).
The weights of each decoder layer in SideNet are initialized from the corresponding pre-trained decoder layer of the backbone LLM with the same depth: <math alttext="\Theta_{\textnormal{Side}}^{{l^{\prime}}\over 2}=\Theta_{\textnormal{LLM}}^{{l%
^{\prime}}}" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.1"><semantics id="S2.SS2.p1.5.m5.1a"><mrow id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml"><msubsup id="S2.SS2.p1.5.m5.1.1.2" xref="S2.SS2.p1.5.m5.1.1.2.cmml"><mi id="S2.SS2.p1.5.m5.1.1.2.2.2" mathvariant="normal" xref="S2.SS2.p1.5.m5.1.1.2.2.2.cmml">Œò</mi><mtext id="S2.SS2.p1.5.m5.1.1.2.2.3" xref="S2.SS2.p1.5.m5.1.1.2.2.3a.cmml">Side</mtext><mfrac id="S2.SS2.p1.5.m5.1.1.2.3" xref="S2.SS2.p1.5.m5.1.1.2.3.cmml"><msup id="S2.SS2.p1.5.m5.1.1.2.3.2" xref="S2.SS2.p1.5.m5.1.1.2.3.2.cmml"><mi id="S2.SS2.p1.5.m5.1.1.2.3.2.2" xref="S2.SS2.p1.5.m5.1.1.2.3.2.2.cmml">l</mi><mo id="S2.SS2.p1.5.m5.1.1.2.3.2.3" xref="S2.SS2.p1.5.m5.1.1.2.3.2.3.cmml">‚Ä≤</mo></msup><mn id="S2.SS2.p1.5.m5.1.1.2.3.3" xref="S2.SS2.p1.5.m5.1.1.2.3.3.cmml">2</mn></mfrac></msubsup><mo id="S2.SS2.p1.5.m5.1.1.1" xref="S2.SS2.p1.5.m5.1.1.1.cmml">=</mo><msubsup id="S2.SS2.p1.5.m5.1.1.3" xref="S2.SS2.p1.5.m5.1.1.3.cmml"><mi id="S2.SS2.p1.5.m5.1.1.3.2.2" mathvariant="normal" xref="S2.SS2.p1.5.m5.1.1.3.2.2.cmml">Œò</mi><mtext id="S2.SS2.p1.5.m5.1.1.3.2.3" xref="S2.SS2.p1.5.m5.1.1.3.2.3a.cmml">LLM</mtext><msup id="S2.SS2.p1.5.m5.1.1.3.3" xref="S2.SS2.p1.5.m5.1.1.3.3.cmml"><mi id="S2.SS2.p1.5.m5.1.1.3.3.2" xref="S2.SS2.p1.5.m5.1.1.3.3.2.cmml">l</mi><mo id="S2.SS2.p1.5.m5.1.1.3.3.3" xref="S2.SS2.p1.5.m5.1.1.3.3.3.cmml">‚Ä≤</mo></msup></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><apply id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1"><eq id="S2.SS2.p1.5.m5.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1.1"></eq><apply id="S2.SS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.2.1.cmml" xref="S2.SS2.p1.5.m5.1.1.2">superscript</csymbol><apply id="S2.SS2.p1.5.m5.1.1.2.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.2.2.1.cmml" xref="S2.SS2.p1.5.m5.1.1.2">subscript</csymbol><ci id="S2.SS2.p1.5.m5.1.1.2.2.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2.2.2">Œò</ci><ci id="S2.SS2.p1.5.m5.1.1.2.2.3a.cmml" xref="S2.SS2.p1.5.m5.1.1.2.2.3"><mtext id="S2.SS2.p1.5.m5.1.1.2.2.3.cmml" mathsize="70%" xref="S2.SS2.p1.5.m5.1.1.2.2.3">Side</mtext></ci></apply><apply id="S2.SS2.p1.5.m5.1.1.2.3.cmml" xref="S2.SS2.p1.5.m5.1.1.2.3"><divide id="S2.SS2.p1.5.m5.1.1.2.3.1.cmml" xref="S2.SS2.p1.5.m5.1.1.2.3"></divide><apply id="S2.SS2.p1.5.m5.1.1.2.3.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.2.3.2.1.cmml" xref="S2.SS2.p1.5.m5.1.1.2.3.2">superscript</csymbol><ci id="S2.SS2.p1.5.m5.1.1.2.3.2.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2.3.2.2">ùëô</ci><ci id="S2.SS2.p1.5.m5.1.1.2.3.2.3.cmml" xref="S2.SS2.p1.5.m5.1.1.2.3.2.3">‚Ä≤</ci></apply><cn id="S2.SS2.p1.5.m5.1.1.2.3.3.cmml" type="integer" xref="S2.SS2.p1.5.m5.1.1.2.3.3">2</cn></apply></apply><apply id="S2.SS2.p1.5.m5.1.1.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.3.1.cmml" xref="S2.SS2.p1.5.m5.1.1.3">superscript</csymbol><apply id="S2.SS2.p1.5.m5.1.1.3.2.cmml" xref="S2.SS2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.3.2.1.cmml" xref="S2.SS2.p1.5.m5.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.5.m5.1.1.3.2.2.cmml" xref="S2.SS2.p1.5.m5.1.1.3.2.2">Œò</ci><ci id="S2.SS2.p1.5.m5.1.1.3.2.3a.cmml" xref="S2.SS2.p1.5.m5.1.1.3.2.3"><mtext id="S2.SS2.p1.5.m5.1.1.3.2.3.cmml" mathsize="70%" xref="S2.SS2.p1.5.m5.1.1.3.2.3">LLM</mtext></ci></apply><apply id="S2.SS2.p1.5.m5.1.1.3.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.3.3.1.cmml" xref="S2.SS2.p1.5.m5.1.1.3.3">superscript</csymbol><ci id="S2.SS2.p1.5.m5.1.1.3.3.2.cmml" xref="S2.SS2.p1.5.m5.1.1.3.3.2">ùëô</ci><ci id="S2.SS2.p1.5.m5.1.1.3.3.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3.3.3">‚Ä≤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">\Theta_{\textnormal{Side}}^{{l^{\prime}}\over 2}=\Theta_{\textnormal{LLM}}^{{l%
^{\prime}}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.1d">roman_Œò start_POSTSUBSCRIPT Side end_POSTSUBSCRIPT start_POSTSUPERSCRIPT divide start_ARG italic_l start_POSTSUPERSCRIPT ‚Ä≤ end_POSTSUPERSCRIPT end_ARG start_ARG 2 end_ARG end_POSTSUPERSCRIPT = roman_Œò start_POSTSUBSCRIPT LLM end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l start_POSTSUPERSCRIPT ‚Ä≤ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
As illustrated in Figure¬†<a class="ltx_ref" href="#S2.F2" title="Figure 2 ‚Ä£ 2 Methods ‚Ä£ Augmenting Language Models with Long-Term Memory"><span class="ltx_text ltx_ref_tag">2</span></a>, the SideNet takes the output of backbone LLM‚Äôs embedding layer and reuses the language modeling head layer of backbone LLM, which is also frozen during the continual adaption stage.
During the memory-augmented adaptation stage, all other parameters of SideNet are updated accordingly based on the training signal. In this way, the lightweight SideNet achieves fast convergence with knowledge transferred from pre-trained parameters.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.5"><span class="ltx_text ltx_font_bold" id="S2.SS2.p2.5.1">Cross-Network Residual Connections.</span>
To tap into knowledge from the pretrained backbone LLM, we resort to proposed cross-network residual connections for fusing representations from the backbone LLM into SideNet. Specifically, we add the difference between output hidden states at <math alttext="2l" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mrow id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mn id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">2</mn><mo id="S2.SS2.p2.1.m1.1.1.1" xref="S2.SS2.p2.1.m1.1.1.1.cmml">‚Å¢</mo><mi id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><times id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1"></times><cn id="S2.SS2.p2.1.m1.1.1.2.cmml" type="integer" xref="S2.SS2.p2.1.m1.1.1.2">2</cn><ci id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3">ùëô</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">2l</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">2 italic_l</annotation></semantics></math>-th and <math alttext="(2l-2)" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><mrow id="S2.SS2.p2.2.m2.1.1.1" xref="S2.SS2.p2.2.m2.1.1.1.1.cmml"><mo id="S2.SS2.p2.2.m2.1.1.1.2" stretchy="false" xref="S2.SS2.p2.2.m2.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.2.m2.1.1.1.1" xref="S2.SS2.p2.2.m2.1.1.1.1.cmml"><mrow id="S2.SS2.p2.2.m2.1.1.1.1.2" xref="S2.SS2.p2.2.m2.1.1.1.1.2.cmml"><mn id="S2.SS2.p2.2.m2.1.1.1.1.2.2" xref="S2.SS2.p2.2.m2.1.1.1.1.2.2.cmml">2</mn><mo id="S2.SS2.p2.2.m2.1.1.1.1.2.1" xref="S2.SS2.p2.2.m2.1.1.1.1.2.1.cmml">‚Å¢</mo><mi id="S2.SS2.p2.2.m2.1.1.1.1.2.3" xref="S2.SS2.p2.2.m2.1.1.1.1.2.3.cmml">l</mi></mrow><mo id="S2.SS2.p2.2.m2.1.1.1.1.1" xref="S2.SS2.p2.2.m2.1.1.1.1.1.cmml">‚àí</mo><mn id="S2.SS2.p2.2.m2.1.1.1.1.3" xref="S2.SS2.p2.2.m2.1.1.1.1.3.cmml">2</mn></mrow><mo id="S2.SS2.p2.2.m2.1.1.1.3" stretchy="false" xref="S2.SS2.p2.2.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1.1"><minus id="S2.SS2.p2.2.m2.1.1.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1.1.1.1"></minus><apply id="S2.SS2.p2.2.m2.1.1.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.1.1.2"><times id="S2.SS2.p2.2.m2.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.2.m2.1.1.1.1.2.1"></times><cn id="S2.SS2.p2.2.m2.1.1.1.1.2.2.cmml" type="integer" xref="S2.SS2.p2.2.m2.1.1.1.1.2.2">2</cn><ci id="S2.SS2.p2.2.m2.1.1.1.1.2.3.cmml" xref="S2.SS2.p2.2.m2.1.1.1.1.2.3">ùëô</ci></apply><cn id="S2.SS2.p2.2.m2.1.1.1.1.3.cmml" type="integer" xref="S2.SS2.p2.2.m2.1.1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">(2l-2)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">( 2 italic_l - 2 )</annotation></semantics></math>-th layers of the backbone LLM as the residual connections to the output hidden states at <math alttext="l" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m3.1"><semantics id="S2.SS2.p2.3.m3.1a"><mi id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">ùëô</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">italic_l</annotation></semantics></math>-th layer of SideNet.
Then, the input to the next <math alttext="(l+1)" class="ltx_Math" display="inline" id="S2.SS2.p2.4.m4.1"><semantics id="S2.SS2.p2.4.m4.1a"><mrow id="S2.SS2.p2.4.m4.1.1.1" xref="S2.SS2.p2.4.m4.1.1.1.1.cmml"><mo id="S2.SS2.p2.4.m4.1.1.1.2" stretchy="false" xref="S2.SS2.p2.4.m4.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.4.m4.1.1.1.1" xref="S2.SS2.p2.4.m4.1.1.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.1.1.2" xref="S2.SS2.p2.4.m4.1.1.1.1.2.cmml">l</mi><mo id="S2.SS2.p2.4.m4.1.1.1.1.1" xref="S2.SS2.p2.4.m4.1.1.1.1.1.cmml">+</mo><mn id="S2.SS2.p2.4.m4.1.1.1.1.3" xref="S2.SS2.p2.4.m4.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.SS2.p2.4.m4.1.1.1.3" stretchy="false" xref="S2.SS2.p2.4.m4.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1.1"><plus id="S2.SS2.p2.4.m4.1.1.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1.1.1.1"></plus><ci id="S2.SS2.p2.4.m4.1.1.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.1.1.2">ùëô</ci><cn id="S2.SS2.p2.4.m4.1.1.1.1.3.cmml" type="integer" xref="S2.SS2.p2.4.m4.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">(l+1)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m4.1d">( italic_l + 1 )</annotation></semantics></math>-th layer of SideNet is the sum of the original hidden state forwarded through the previous layer <math alttext="f_{\Theta_{\textnormal{Side}}^{l}}(\mathbf{H}_{\text{Side}}^{l-1})" class="ltx_Math" display="inline" id="S2.SS2.p2.5.m5.1"><semantics id="S2.SS2.p2.5.m5.1a"><mrow id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml"><msub id="S2.SS2.p2.5.m5.1.1.3" xref="S2.SS2.p2.5.m5.1.1.3.cmml"><mi id="S2.SS2.p2.5.m5.1.1.3.2" xref="S2.SS2.p2.5.m5.1.1.3.2.cmml">f</mi><msubsup id="S2.SS2.p2.5.m5.1.1.3.3" xref="S2.SS2.p2.5.m5.1.1.3.3.cmml"><mi id="S2.SS2.p2.5.m5.1.1.3.3.2.2" mathvariant="normal" xref="S2.SS2.p2.5.m5.1.1.3.3.2.2.cmml">Œò</mi><mtext id="S2.SS2.p2.5.m5.1.1.3.3.2.3" xref="S2.SS2.p2.5.m5.1.1.3.3.2.3a.cmml">Side</mtext><mi id="S2.SS2.p2.5.m5.1.1.3.3.3" xref="S2.SS2.p2.5.m5.1.1.3.3.3.cmml">l</mi></msubsup></msub><mo id="S2.SS2.p2.5.m5.1.1.2" xref="S2.SS2.p2.5.m5.1.1.2.cmml">‚Å¢</mo><mrow id="S2.SS2.p2.5.m5.1.1.1.1" xref="S2.SS2.p2.5.m5.1.1.1.1.1.cmml"><mo id="S2.SS2.p2.5.m5.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.5.m5.1.1.1.1.1.cmml">(</mo><msubsup id="S2.SS2.p2.5.m5.1.1.1.1.1" xref="S2.SS2.p2.5.m5.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.5.m5.1.1.1.1.1.2.2" xref="S2.SS2.p2.5.m5.1.1.1.1.1.2.2.cmml">ùêá</mi><mtext id="S2.SS2.p2.5.m5.1.1.1.1.1.2.3" xref="S2.SS2.p2.5.m5.1.1.1.1.1.2.3a.cmml">Side</mtext><mrow id="S2.SS2.p2.5.m5.1.1.1.1.1.3" xref="S2.SS2.p2.5.m5.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p2.5.m5.1.1.1.1.1.3.2" xref="S2.SS2.p2.5.m5.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.SS2.p2.5.m5.1.1.1.1.1.3.1" xref="S2.SS2.p2.5.m5.1.1.1.1.1.3.1.cmml">‚àí</mo><mn id="S2.SS2.p2.5.m5.1.1.1.1.1.3.3" xref="S2.SS2.p2.5.m5.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.SS2.p2.5.m5.1.1.1.1.3" stretchy="false" xref="S2.SS2.p2.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><apply id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1"><times id="S2.SS2.p2.5.m5.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.2"></times><apply id="S2.SS2.p2.5.m5.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.1.1.3.1.cmml" xref="S2.SS2.p2.5.m5.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.5.m5.1.1.3.2.cmml" xref="S2.SS2.p2.5.m5.1.1.3.2">ùëì</ci><apply id="S2.SS2.p2.5.m5.1.1.3.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.1.1.3.3.1.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3">superscript</csymbol><apply id="S2.SS2.p2.5.m5.1.1.3.3.2.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.1.1.3.3.2.1.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p2.5.m5.1.1.3.3.2.2.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3.2.2">Œò</ci><ci id="S2.SS2.p2.5.m5.1.1.3.3.2.3a.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3.2.3"><mtext id="S2.SS2.p2.5.m5.1.1.3.3.2.3.cmml" mathsize="50%" xref="S2.SS2.p2.5.m5.1.1.3.3.2.3">Side</mtext></ci></apply><ci id="S2.SS2.p2.5.m5.1.1.3.3.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3.3.3">ùëô</ci></apply></apply><apply id="S2.SS2.p2.5.m5.1.1.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1">superscript</csymbol><apply id="S2.SS2.p2.5.m5.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.5.m5.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1.2.2">ùêá</ci><ci id="S2.SS2.p2.5.m5.1.1.1.1.1.2.3a.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1.2.3"><mtext id="S2.SS2.p2.5.m5.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S2.SS2.p2.5.m5.1.1.1.1.1.2.3">Side</mtext></ci></apply><apply id="S2.SS2.p2.5.m5.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1.3"><minus id="S2.SS2.p2.5.m5.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1.3.1"></minus><ci id="S2.SS2.p2.5.m5.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1.3.2">ùëô</ci><cn id="S2.SS2.p2.5.m5.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS2.p2.5.m5.1.1.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">f_{\Theta_{\textnormal{Side}}^{l}}(\mathbf{H}_{\text{Side}}^{l-1})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.5.m5.1d">italic_f start_POSTSUBSCRIPT roman_Œò start_POSTSUBSCRIPT Side end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_H start_POSTSUBSCRIPT Side end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l - 1 end_POSTSUPERSCRIPT )</annotation></semantics></math> and the cross-network residual connection of the hidden state difference from the backbone LLM</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx1">
<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{H}^{l}_{\textnormal{Side}}=f_{\Theta^{l}_{\textnormal{%
Side}}}(\mathbf{H}_{\textnormal{Side}}^{l-1})+(\mathbf{H}_{\textnormal{LLM}}^{%
2l}-\mathbf{H}_{\textnormal{LLM}}^{2l-2}),\forall l\in[1,L]," class="ltx_Math" display="inline" id="S2.E1.m1.3"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1"><mrow id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.3.cmml"><mrow id="S2.E1.m1.3.3.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.cmml"><msubsup id="S2.E1.m1.3.3.1.1.1.1.4" xref="S2.E1.m1.3.3.1.1.1.1.4.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.4.2.2" xref="S2.E1.m1.3.3.1.1.1.1.4.2.2.cmml">ùêá</mi><mtext id="S2.E1.m1.3.3.1.1.1.1.4.3" xref="S2.E1.m1.3.3.1.1.1.1.4.3a.cmml">Side</mtext><mi id="S2.E1.m1.3.3.1.1.1.1.4.2.3" xref="S2.E1.m1.3.3.1.1.1.1.4.2.3.cmml">l</mi></msubsup><mo id="S2.E1.m1.3.3.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.3.cmml">=</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.2.cmml"><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.3.3.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.3.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.2.cmml">f</mi><msubsup id="S2.E1.m1.3.3.1.1.1.1.1.1.3.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.2.2" mathvariant="normal" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.2.2.cmml">Œò</mi><mtext id="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.3a.cmml">Side</mtext><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.2.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.2.3.cmml">l</mi></msubsup></msub><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml">‚Å¢</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">ùêá</mi><mtext id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3a.cmml">Side</mtext><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml">‚àí</mo><mn id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.1.1.1.1.2.3" xref="S2.E1.m1.3.3.1.1.1.1.2.3.cmml">+</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.2.2.1" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.cmml"><mo id="S2.E1.m1.3.3.1.1.1.1.2.2.1.2" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.cmml"><msubsup id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.2.2" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.2.2.cmml">ùêá</mi><mtext id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.2.3" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.2.3a.cmml">LLM</mtext><mrow id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.3" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.3.cmml"><mn id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.3.2" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.3.2.cmml">2</mn><mo id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.3.1" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.3.1.cmml">‚Å¢</mo><mi id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.3.3" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.3.3.cmml">l</mi></mrow></msubsup><mo id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.1.cmml">‚àí</mo><msubsup id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.2.2" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.2.2.cmml">ùêá</mi><mtext id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.2.3" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.2.3a.cmml">LLM</mtext><mrow id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.cmml"><mrow id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.2" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.2.cmml"><mn id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.2.2" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.2.2.cmml">2</mn><mo id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.2.1" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.2.1.cmml">‚Å¢</mo><mi id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.2.3" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.2.3.cmml">l</mi></mrow><mo id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.1" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.1.cmml">‚àí</mo><mn id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.3" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.3.cmml">2</mn></mrow></msubsup></mrow><mo id="S2.E1.m1.3.3.1.1.1.1.2.2.1.3" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.1.2.3" xref="S2.E1.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S2.E1.m1.3.3.1.1.2.2" xref="S2.E1.m1.3.3.1.1.2.2.cmml"><mrow id="S2.E1.m1.3.3.1.1.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.cmml"><mo id="S2.E1.m1.3.3.1.1.2.2.2.1" rspace="0.167em" xref="S2.E1.m1.3.3.1.1.2.2.2.1.cmml">‚àÄ</mo><mi id="S2.E1.m1.3.3.1.1.2.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.2.cmml">l</mi></mrow><mo id="S2.E1.m1.3.3.1.1.2.2.1" xref="S2.E1.m1.3.3.1.1.2.2.1.cmml">‚àà</mo><mrow id="S2.E1.m1.3.3.1.1.2.2.3.2" xref="S2.E1.m1.3.3.1.1.2.2.3.1.cmml"><mo id="S2.E1.m1.3.3.1.1.2.2.3.2.1" stretchy="false" xref="S2.E1.m1.3.3.1.1.2.2.3.1.cmml">[</mo><mn id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">1</mn><mo id="S2.E1.m1.3.3.1.1.2.2.3.2.2" xref="S2.E1.m1.3.3.1.1.2.2.3.1.cmml">,</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">L</mi><mo id="S2.E1.m1.3.3.1.1.2.2.3.2.3" stretchy="false" xref="S2.E1.m1.3.3.1.1.2.2.3.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3a.cmml" xref="S2.E1.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.3.3.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1"><eq id="S2.E1.m1.3.3.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3"></eq><apply id="S2.E1.m1.3.3.1.1.1.1.4.cmml" xref="S2.E1.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.4.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.4">subscript</csymbol><apply id="S2.E1.m1.3.3.1.1.1.1.4.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.4.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.4">superscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.4.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.4.2.2">ùêá</ci><ci id="S2.E1.m1.3.3.1.1.1.1.4.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.4.2.3">ùëô</ci></apply><ci id="S2.E1.m1.3.3.1.1.1.1.4.3a.cmml" xref="S2.E1.m1.3.3.1.1.1.1.4.3"><mtext id="S2.E1.m1.3.3.1.1.1.1.4.3.cmml" mathsize="70%" xref="S2.E1.m1.3.3.1.1.1.1.4.3">Side</mtext></ci></apply><apply id="S2.E1.m1.3.3.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2"><plus id="S2.E1.m1.3.3.1.1.1.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.3"></plus><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1"><times id="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2"></times><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.2">ùëì</ci><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.3">subscript</csymbol><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.2.2">Œò</ci><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.2.3">ùëô</ci></apply><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.3a.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.3"><mtext id="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.3.cmml" mathsize="50%" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.3">Side</mtext></ci></apply></apply><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">ùêá</ci><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3"><mtext id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3">Side</mtext></ci></apply><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3"><minus id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.2">ùëô</ci><cn id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1"><minus id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.1"></minus><apply id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2">superscript</csymbol><apply id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.2.2">ùêá</ci><ci id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.2.3a.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.2.3"><mtext id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.2.3.cmml" mathsize="70%" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.2.3">LLM</mtext></ci></apply><apply id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.3"><times id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.3.1"></times><cn id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.3.2.cmml" type="integer" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.3.2">2</cn><ci id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.2.3.3">ùëô</ci></apply></apply><apply id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3">superscript</csymbol><apply id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.2.2">ùêá</ci><ci id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.2.3a.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.2.3"><mtext id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.2.3.cmml" mathsize="70%" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.2.3">LLM</mtext></ci></apply><apply id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3"><minus id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.1"></minus><apply id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.2"><times id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.2.1"></times><cn id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.2.2.cmml" type="integer" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.2.2">2</cn><ci id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.2.3">ùëô</ci></apply><cn id="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.3.cmml" type="integer" xref="S2.E1.m1.3.3.1.1.1.1.2.2.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply><apply id="S2.E1.m1.3.3.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2"><in id="S2.E1.m1.3.3.1.1.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.1"></in><apply id="S2.E1.m1.3.3.1.1.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2"><csymbol cd="latexml" id="S2.E1.m1.3.3.1.1.2.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.1">for-all</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2">ùëô</ci></apply><interval closure="closed" id="S2.E1.m1.3.3.1.1.2.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.3.2"><cn id="S2.E1.m1.1.1.cmml" type="integer" xref="S2.E1.m1.1.1">1</cn><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">ùêø</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">\displaystyle\mathbf{H}^{l}_{\textnormal{Side}}=f_{\Theta^{l}_{\textnormal{%
Side}}}(\mathbf{H}_{\textnormal{Side}}^{l-1})+(\mathbf{H}_{\textnormal{LLM}}^{%
2l}-\mathbf{H}_{\textnormal{LLM}}^{2l-2}),\forall l\in[1,L],</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.3d">bold_H start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT Side end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT roman_Œò start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT Side end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_H start_POSTSUBSCRIPT Side end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l - 1 end_POSTSUPERSCRIPT ) + ( bold_H start_POSTSUBSCRIPT LLM end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 italic_l end_POSTSUPERSCRIPT - bold_H start_POSTSUBSCRIPT LLM end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 italic_l - 2 end_POSTSUPERSCRIPT ) , ‚àÄ italic_l ‚àà [ 1 , italic_L ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p2.7">where <math alttext="\mathbf{H}^{0}" class="ltx_Math" display="inline" id="S2.SS2.p2.6.m1.1"><semantics id="S2.SS2.p2.6.m1.1a"><msup id="S2.SS2.p2.6.m1.1.1" xref="S2.SS2.p2.6.m1.1.1.cmml"><mi id="S2.SS2.p2.6.m1.1.1.2" xref="S2.SS2.p2.6.m1.1.1.2.cmml">ùêá</mi><mn id="S2.SS2.p2.6.m1.1.1.3" xref="S2.SS2.p2.6.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m1.1b"><apply id="S2.SS2.p2.6.m1.1.1.cmml" xref="S2.SS2.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m1.1.1.1.cmml" xref="S2.SS2.p2.6.m1.1.1">superscript</csymbol><ci id="S2.SS2.p2.6.m1.1.1.2.cmml" xref="S2.SS2.p2.6.m1.1.1.2">ùêá</ci><cn id="S2.SS2.p2.6.m1.1.1.3.cmml" type="integer" xref="S2.SS2.p2.6.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m1.1c">\mathbf{H}^{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.6.m1.1d">bold_H start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math> is the output of embedding layer. It is worth noting that the residual connections after the self-attention and feed-forward network of a decoder layer¬†<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib.bib24" title=""><span class="ltx_text" style="font-size:90%;">24</span></a>]</cite> will be performed as normal in <math alttext="f_{\Theta^{l}_{\textnormal{Side}}}(\mathbf{H}_{\textnormal{Side}}^{l-1})" class="ltx_Math" display="inline" id="S2.SS2.p2.7.m2.1"><semantics id="S2.SS2.p2.7.m2.1a"><mrow id="S2.SS2.p2.7.m2.1.1" xref="S2.SS2.p2.7.m2.1.1.cmml"><msub id="S2.SS2.p2.7.m2.1.1.3" xref="S2.SS2.p2.7.m2.1.1.3.cmml"><mi id="S2.SS2.p2.7.m2.1.1.3.2" xref="S2.SS2.p2.7.m2.1.1.3.2.cmml">f</mi><msubsup id="S2.SS2.p2.7.m2.1.1.3.3" xref="S2.SS2.p2.7.m2.1.1.3.3.cmml"><mi id="S2.SS2.p2.7.m2.1.1.3.3.2.2" mathvariant="normal" xref="S2.SS2.p2.7.m2.1.1.3.3.2.2.cmml">Œò</mi><mtext id="S2.SS2.p2.7.m2.1.1.3.3.3" xref="S2.SS2.p2.7.m2.1.1.3.3.3a.cmml">Side</mtext><mi id="S2.SS2.p2.7.m2.1.1.3.3.2.3" xref="S2.SS2.p2.7.m2.1.1.3.3.2.3.cmml">l</mi></msubsup></msub><mo id="S2.SS2.p2.7.m2.1.1.2" xref="S2.SS2.p2.7.m2.1.1.2.cmml">‚Å¢</mo><mrow id="S2.SS2.p2.7.m2.1.1.1.1" xref="S2.SS2.p2.7.m2.1.1.1.1.1.cmml"><mo id="S2.SS2.p2.7.m2.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.7.m2.1.1.1.1.1.cmml">(</mo><msubsup id="S2.SS2.p2.7.m2.1.1.1.1.1" xref="S2.SS2.p2.7.m2.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.7.m2.1.1.1.1.1.2.2" xref="S2.SS2.p2.7.m2.1.1.1.1.1.2.2.cmml">ùêá</mi><mtext id="S2.SS2.p2.7.m2.1.1.1.1.1.2.3" xref="S2.SS2.p2.7.m2.1.1.1.1.1.2.3a.cmml">Side</mtext><mrow id="S2.SS2.p2.7.m2.1.1.1.1.1.3" xref="S2.SS2.p2.7.m2.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p2.7.m2.1.1.1.1.1.3.2" xref="S2.SS2.p2.7.m2.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.SS2.p2.7.m2.1.1.1.1.1.3.1" xref="S2.SS2.p2.7.m2.1.1.1.1.1.3.1.cmml">‚àí</mo><mn id="S2.SS2.p2.7.m2.1.1.1.1.1.3.3" xref="S2.SS2.p2.7.m2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.SS2.p2.7.m2.1.1.1.1.3" stretchy="false" xref="S2.SS2.p2.7.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m2.1b"><apply id="S2.SS2.p2.7.m2.1.1.cmml" xref="S2.SS2.p2.7.m2.1.1"><times id="S2.SS2.p2.7.m2.1.1.2.cmml" xref="S2.SS2.p2.7.m2.1.1.2"></times><apply id="S2.SS2.p2.7.m2.1.1.3.cmml" xref="S2.SS2.p2.7.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m2.1.1.3.1.cmml" xref="S2.SS2.p2.7.m2.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.7.m2.1.1.3.2.cmml" xref="S2.SS2.p2.7.m2.1.1.3.2">ùëì</ci><apply id="S2.SS2.p2.7.m2.1.1.3.3.cmml" xref="S2.SS2.p2.7.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m2.1.1.3.3.1.cmml" xref="S2.SS2.p2.7.m2.1.1.3.3">subscript</csymbol><apply id="S2.SS2.p2.7.m2.1.1.3.3.2.cmml" xref="S2.SS2.p2.7.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m2.1.1.3.3.2.1.cmml" xref="S2.SS2.p2.7.m2.1.1.3.3">superscript</csymbol><ci id="S2.SS2.p2.7.m2.1.1.3.3.2.2.cmml" xref="S2.SS2.p2.7.m2.1.1.3.3.2.2">Œò</ci><ci id="S2.SS2.p2.7.m2.1.1.3.3.2.3.cmml" xref="S2.SS2.p2.7.m2.1.1.3.3.2.3">ùëô</ci></apply><ci id="S2.SS2.p2.7.m2.1.1.3.3.3a.cmml" xref="S2.SS2.p2.7.m2.1.1.3.3.3"><mtext id="S2.SS2.p2.7.m2.1.1.3.3.3.cmml" mathsize="50%" xref="S2.SS2.p2.7.m2.1.1.3.3.3">Side</mtext></ci></apply></apply><apply id="S2.SS2.p2.7.m2.1.1.1.1.1.cmml" xref="S2.SS2.p2.7.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m2.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.7.m2.1.1.1.1">superscript</csymbol><apply id="S2.SS2.p2.7.m2.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.7.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m2.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.7.m2.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.7.m2.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p2.7.m2.1.1.1.1.1.2.2">ùêá</ci><ci id="S2.SS2.p2.7.m2.1.1.1.1.1.2.3a.cmml" xref="S2.SS2.p2.7.m2.1.1.1.1.1.2.3"><mtext id="S2.SS2.p2.7.m2.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S2.SS2.p2.7.m2.1.1.1.1.1.2.3">Side</mtext></ci></apply><apply id="S2.SS2.p2.7.m2.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.7.m2.1.1.1.1.1.3"><minus id="S2.SS2.p2.7.m2.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.7.m2.1.1.1.1.1.3.1"></minus><ci id="S2.SS2.p2.7.m2.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.7.m2.1.1.1.1.1.3.2">ùëô</ci><cn id="S2.SS2.p2.7.m2.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS2.p2.7.m2.1.1.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m2.1c">f_{\Theta^{l}_{\textnormal{Side}}}(\mathbf{H}_{\textnormal{Side}}^{l-1})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.7.m2.1d">italic_f start_POSTSUBSCRIPT roman_Œò start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT Side end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_H start_POSTSUBSCRIPT Side end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l - 1 end_POSTSUPERSCRIPT )</annotation></semantics></math> and parallel to the proposed cross-network residual connections.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Memory Retrieval and Fusion</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">The long-term memory capability of <span class="ltx_text ltx_font_smallcaps" id="S2.SS3.p1.1.1">LongMem</span> is achieved via a memory-augmentation module for retrieval and fusion.
</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.7"><span class="ltx_text ltx_font_bold" id="S2.SS3.p2.7.1">Token-to-Chunk Memory Retrieval.</span>
Instead of performing token-to-token retrieval, we focus on token-to-chunk retrieval for acceleration and integrity. A text-chunk refers to an n-gram structure of chunk-size <math alttext="csz" class="ltx_Math" display="inline" id="S2.SS3.p2.1.m1.1"><semantics id="S2.SS3.p2.1.m1.1a"><mrow id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml"><mi id="S2.SS3.p2.1.m1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.2.cmml">c</mi><mo id="S2.SS3.p2.1.m1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.cmml">‚Å¢</mo><mi id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml">s</mi><mo id="S2.SS3.p2.1.m1.1.1.1a" xref="S2.SS3.p2.1.m1.1.1.1.cmml">‚Å¢</mo><mi id="S2.SS3.p2.1.m1.1.1.4" xref="S2.SS3.p2.1.m1.1.1.4.cmml">z</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><times id="S2.SS3.p2.1.m1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1"></times><ci id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.2">ùëê</ci><ci id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3">ùë†</ci><ci id="S2.SS3.p2.1.m1.1.1.4.cmml" xref="S2.SS3.p2.1.m1.1.1.4">ùëß</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">csz</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">italic_c italic_s italic_z</annotation></semantics></math> number of contiguous tokens. The memory bank stores cached key-value pairs at the level of token chunks. We divide the memory bank into <math alttext="M/csz" class="ltx_Math" display="inline" id="S2.SS3.p2.2.m2.1"><semantics id="S2.SS3.p2.2.m2.1a"><mrow id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml"><mrow id="S2.SS3.p2.2.m2.1.1.2" xref="S2.SS3.p2.2.m2.1.1.2.cmml"><mi id="S2.SS3.p2.2.m2.1.1.2.2" xref="S2.SS3.p2.2.m2.1.1.2.2.cmml">M</mi><mo id="S2.SS3.p2.2.m2.1.1.2.1" xref="S2.SS3.p2.2.m2.1.1.2.1.cmml">/</mo><mi id="S2.SS3.p2.2.m2.1.1.2.3" xref="S2.SS3.p2.2.m2.1.1.2.3.cmml">c</mi></mrow><mo id="S2.SS3.p2.2.m2.1.1.1" xref="S2.SS3.p2.2.m2.1.1.1.cmml">‚Å¢</mo><mi id="S2.SS3.p2.2.m2.1.1.3" xref="S2.SS3.p2.2.m2.1.1.3.cmml">s</mi><mo id="S2.SS3.p2.2.m2.1.1.1a" xref="S2.SS3.p2.2.m2.1.1.1.cmml">‚Å¢</mo><mi id="S2.SS3.p2.2.m2.1.1.4" xref="S2.SS3.p2.2.m2.1.1.4.cmml">z</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><apply id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1"><times id="S2.SS3.p2.2.m2.1.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1.1"></times><apply id="S2.SS3.p2.2.m2.1.1.2.cmml" xref="S2.SS3.p2.2.m2.1.1.2"><divide id="S2.SS3.p2.2.m2.1.1.2.1.cmml" xref="S2.SS3.p2.2.m2.1.1.2.1"></divide><ci id="S2.SS3.p2.2.m2.1.1.2.2.cmml" xref="S2.SS3.p2.2.m2.1.1.2.2">ùëÄ</ci><ci id="S2.SS3.p2.2.m2.1.1.2.3.cmml" xref="S2.SS3.p2.2.m2.1.1.2.3">ùëê</ci></apply><ci id="S2.SS3.p2.2.m2.1.1.3.cmml" xref="S2.SS3.p2.2.m2.1.1.3">ùë†</ci><ci id="S2.SS3.p2.2.m2.1.1.4.cmml" xref="S2.SS3.p2.2.m2.1.1.4">ùëß</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">M/csz</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.2.m2.1d">italic_M / italic_c italic_s italic_z</annotation></semantics></math> attention key-value paired chunks and use the mean-pooled vector on the chunk-size dimension to get the key vector for retrieval.
Then we retrieve the top-<math alttext="(K/csz)" class="ltx_Math" display="inline" id="S2.SS3.p2.3.m3.1"><semantics id="S2.SS3.p2.3.m3.1a"><mrow id="S2.SS3.p2.3.m3.1.1.1" xref="S2.SS3.p2.3.m3.1.1.1.1.cmml"><mo id="S2.SS3.p2.3.m3.1.1.1.2" stretchy="false" xref="S2.SS3.p2.3.m3.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p2.3.m3.1.1.1.1" xref="S2.SS3.p2.3.m3.1.1.1.1.cmml"><mrow id="S2.SS3.p2.3.m3.1.1.1.1.2" xref="S2.SS3.p2.3.m3.1.1.1.1.2.cmml"><mi id="S2.SS3.p2.3.m3.1.1.1.1.2.2" xref="S2.SS3.p2.3.m3.1.1.1.1.2.2.cmml">K</mi><mo id="S2.SS3.p2.3.m3.1.1.1.1.2.1" xref="S2.SS3.p2.3.m3.1.1.1.1.2.1.cmml">/</mo><mi id="S2.SS3.p2.3.m3.1.1.1.1.2.3" xref="S2.SS3.p2.3.m3.1.1.1.1.2.3.cmml">c</mi></mrow><mo id="S2.SS3.p2.3.m3.1.1.1.1.1" xref="S2.SS3.p2.3.m3.1.1.1.1.1.cmml">‚Å¢</mo><mi id="S2.SS3.p2.3.m3.1.1.1.1.3" xref="S2.SS3.p2.3.m3.1.1.1.1.3.cmml">s</mi><mo id="S2.SS3.p2.3.m3.1.1.1.1.1a" xref="S2.SS3.p2.3.m3.1.1.1.1.1.cmml">‚Å¢</mo><mi id="S2.SS3.p2.3.m3.1.1.1.1.4" xref="S2.SS3.p2.3.m3.1.1.1.1.4.cmml">z</mi></mrow><mo id="S2.SS3.p2.3.m3.1.1.1.3" stretchy="false" xref="S2.SS3.p2.3.m3.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><apply id="S2.SS3.p2.3.m3.1.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1.1"><times id="S2.SS3.p2.3.m3.1.1.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1.1.1.1"></times><apply id="S2.SS3.p2.3.m3.1.1.1.1.2.cmml" xref="S2.SS3.p2.3.m3.1.1.1.1.2"><divide id="S2.SS3.p2.3.m3.1.1.1.1.2.1.cmml" xref="S2.SS3.p2.3.m3.1.1.1.1.2.1"></divide><ci id="S2.SS3.p2.3.m3.1.1.1.1.2.2.cmml" xref="S2.SS3.p2.3.m3.1.1.1.1.2.2">ùêæ</ci><ci id="S2.SS3.p2.3.m3.1.1.1.1.2.3.cmml" xref="S2.SS3.p2.3.m3.1.1.1.1.2.3">ùëê</ci></apply><ci id="S2.SS3.p2.3.m3.1.1.1.1.3.cmml" xref="S2.SS3.p2.3.m3.1.1.1.1.3">ùë†</ci><ci id="S2.SS3.p2.3.m3.1.1.1.1.4.cmml" xref="S2.SS3.p2.3.m3.1.1.1.1.4">ùëß</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">(K/csz)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.3.m3.1d">( italic_K / italic_c italic_s italic_z )</annotation></semantics></math> attention key-value chunks w.r.t the dot product between the attention query of the current input token and the mean-pooled attention key of a candidate chunk. Finally, we squeeze the chunk-size dimension for retrieved key-value paired chunks and flatten them into <math alttext="K" class="ltx_Math" display="inline" id="S2.SS3.p2.4.m4.1"><semantics id="S2.SS3.p2.4.m4.1a"><mi id="S2.SS3.p2.4.m4.1.1" xref="S2.SS3.p2.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.1b"><ci id="S2.SS3.p2.4.m4.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1">ùêæ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.4.m4.1d">italic_K</annotation></semantics></math> key-value pairs at token-level <math alttext="\{\widetilde{\mathbf{K}}_{j},\widetilde{\mathbf{V}}_{j}\}_{j=1}^{K}" class="ltx_Math" display="inline" id="S2.SS3.p2.5.m5.2"><semantics id="S2.SS3.p2.5.m5.2a"><msubsup id="S2.SS3.p2.5.m5.2.2" xref="S2.SS3.p2.5.m5.2.2.cmml"><mrow id="S2.SS3.p2.5.m5.2.2.2.2.2" xref="S2.SS3.p2.5.m5.2.2.2.2.3.cmml"><mo id="S2.SS3.p2.5.m5.2.2.2.2.2.3" stretchy="false" xref="S2.SS3.p2.5.m5.2.2.2.2.3.cmml">{</mo><msub id="S2.SS3.p2.5.m5.1.1.1.1.1.1" xref="S2.SS3.p2.5.m5.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.SS3.p2.5.m5.1.1.1.1.1.1.2" xref="S2.SS3.p2.5.m5.1.1.1.1.1.1.2.cmml"><mi id="S2.SS3.p2.5.m5.1.1.1.1.1.1.2.2" xref="S2.SS3.p2.5.m5.1.1.1.1.1.1.2.2.cmml">ùêä</mi><mo id="S2.SS3.p2.5.m5.1.1.1.1.1.1.2.1" xref="S2.SS3.p2.5.m5.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S2.SS3.p2.5.m5.1.1.1.1.1.1.3" xref="S2.SS3.p2.5.m5.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S2.SS3.p2.5.m5.2.2.2.2.2.4" xref="S2.SS3.p2.5.m5.2.2.2.2.3.cmml">,</mo><msub id="S2.SS3.p2.5.m5.2.2.2.2.2.2" xref="S2.SS3.p2.5.m5.2.2.2.2.2.2.cmml"><mover accent="true" id="S2.SS3.p2.5.m5.2.2.2.2.2.2.2" xref="S2.SS3.p2.5.m5.2.2.2.2.2.2.2.cmml"><mi id="S2.SS3.p2.5.m5.2.2.2.2.2.2.2.2" xref="S2.SS3.p2.5.m5.2.2.2.2.2.2.2.2.cmml">ùêï</mi><mo id="S2.SS3.p2.5.m5.2.2.2.2.2.2.2.1" xref="S2.SS3.p2.5.m5.2.2.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S2.SS3.p2.5.m5.2.2.2.2.2.2.3" xref="S2.SS3.p2.5.m5.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S2.SS3.p2.5.m5.2.2.2.2.2.5" stretchy="false" xref="S2.SS3.p2.5.m5.2.2.2.2.3.cmml">}</mo></mrow><mrow id="S2.SS3.p2.5.m5.2.2.2.4" xref="S2.SS3.p2.5.m5.2.2.2.4.cmml"><mi id="S2.SS3.p2.5.m5.2.2.2.4.2" xref="S2.SS3.p2.5.m5.2.2.2.4.2.cmml">j</mi><mo id="S2.SS3.p2.5.m5.2.2.2.4.1" xref="S2.SS3.p2.5.m5.2.2.2.4.1.cmml">=</mo><mn id="S2.SS3.p2.5.m5.2.2.2.4.3" xref="S2.SS3.p2.5.m5.2.2.2.4.3.cmml">1</mn></mrow><mi id="S2.SS3.p2.5.m5.2.2.4" xref="S2.SS3.p2.5.m5.2.2.4.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m5.2b"><apply id="S2.SS3.p2.5.m5.2.2.cmml" xref="S2.SS3.p2.5.m5.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m5.2.2.3.cmml" xref="S2.SS3.p2.5.m5.2.2">superscript</csymbol><apply id="S2.SS3.p2.5.m5.2.2.2.cmml" xref="S2.SS3.p2.5.m5.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m5.2.2.2.3.cmml" xref="S2.SS3.p2.5.m5.2.2">subscript</csymbol><set id="S2.SS3.p2.5.m5.2.2.2.2.3.cmml" xref="S2.SS3.p2.5.m5.2.2.2.2.2"><apply id="S2.SS3.p2.5.m5.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m5.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1.1.1.1.1">subscript</csymbol><apply id="S2.SS3.p2.5.m5.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.5.m5.1.1.1.1.1.1.2"><ci id="S2.SS3.p2.5.m5.1.1.1.1.1.1.2.1.cmml" xref="S2.SS3.p2.5.m5.1.1.1.1.1.1.2.1">~</ci><ci id="S2.SS3.p2.5.m5.1.1.1.1.1.1.2.2.cmml" xref="S2.SS3.p2.5.m5.1.1.1.1.1.1.2.2">ùêä</ci></apply><ci id="S2.SS3.p2.5.m5.1.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.5.m5.1.1.1.1.1.1.3">ùëó</ci></apply><apply id="S2.SS3.p2.5.m5.2.2.2.2.2.2.cmml" xref="S2.SS3.p2.5.m5.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m5.2.2.2.2.2.2.1.cmml" xref="S2.SS3.p2.5.m5.2.2.2.2.2.2">subscript</csymbol><apply id="S2.SS3.p2.5.m5.2.2.2.2.2.2.2.cmml" xref="S2.SS3.p2.5.m5.2.2.2.2.2.2.2"><ci id="S2.SS3.p2.5.m5.2.2.2.2.2.2.2.1.cmml" xref="S2.SS3.p2.5.m5.2.2.2.2.2.2.2.1">~</ci><ci id="S2.SS3.p2.5.m5.2.2.2.2.2.2.2.2.cmml" xref="S2.SS3.p2.5.m5.2.2.2.2.2.2.2.2">ùêï</ci></apply><ci id="S2.SS3.p2.5.m5.2.2.2.2.2.2.3.cmml" xref="S2.SS3.p2.5.m5.2.2.2.2.2.2.3">ùëó</ci></apply></set><apply id="S2.SS3.p2.5.m5.2.2.2.4.cmml" xref="S2.SS3.p2.5.m5.2.2.2.4"><eq id="S2.SS3.p2.5.m5.2.2.2.4.1.cmml" xref="S2.SS3.p2.5.m5.2.2.2.4.1"></eq><ci id="S2.SS3.p2.5.m5.2.2.2.4.2.cmml" xref="S2.SS3.p2.5.m5.2.2.2.4.2">ùëó</ci><cn id="S2.SS3.p2.5.m5.2.2.2.4.3.cmml" type="integer" xref="S2.SS3.p2.5.m5.2.2.2.4.3">1</cn></apply></apply><ci id="S2.SS3.p2.5.m5.2.2.4.cmml" xref="S2.SS3.p2.5.m5.2.2.4">ùêæ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m5.2c">\{\widetilde{\mathbf{K}}_{j},\widetilde{\mathbf{V}}_{j}\}_{j=1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.5.m5.2d">{ over~ start_ARG bold_K end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , over~ start_ARG bold_V end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>.
Adopting token-to-chunk retrieval reduces the size of the retrieval index and accelerates the process. Meanwhile, the retrieval accuracy can be further improved, which is also observed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib.bib10" title=""><span class="ltx_text" style="font-size:90%;">10</span></a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib.bib2" title=""><span class="ltx_text" style="font-size:90%;">2</span></a>]</cite>. The hyperparameter chunk-size <math alttext="csz" class="ltx_Math" display="inline" id="S2.SS3.p2.6.m6.1"><semantics id="S2.SS3.p2.6.m6.1a"><mrow id="S2.SS3.p2.6.m6.1.1" xref="S2.SS3.p2.6.m6.1.1.cmml"><mi id="S2.SS3.p2.6.m6.1.1.2" xref="S2.SS3.p2.6.m6.1.1.2.cmml">c</mi><mo id="S2.SS3.p2.6.m6.1.1.1" xref="S2.SS3.p2.6.m6.1.1.1.cmml">‚Å¢</mo><mi id="S2.SS3.p2.6.m6.1.1.3" xref="S2.SS3.p2.6.m6.1.1.3.cmml">s</mi><mo id="S2.SS3.p2.6.m6.1.1.1a" xref="S2.SS3.p2.6.m6.1.1.1.cmml">‚Å¢</mo><mi id="S2.SS3.p2.6.m6.1.1.4" xref="S2.SS3.p2.6.m6.1.1.4.cmml">z</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m6.1b"><apply id="S2.SS3.p2.6.m6.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1"><times id="S2.SS3.p2.6.m6.1.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1.1"></times><ci id="S2.SS3.p2.6.m6.1.1.2.cmml" xref="S2.SS3.p2.6.m6.1.1.2">ùëê</ci><ci id="S2.SS3.p2.6.m6.1.1.3.cmml" xref="S2.SS3.p2.6.m6.1.1.3">ùë†</ci><ci id="S2.SS3.p2.6.m6.1.1.4.cmml" xref="S2.SS3.p2.6.m6.1.1.4">ùëß</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.6.m6.1c">csz</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.6.m6.1d">italic_c italic_s italic_z</annotation></semantics></math> controls the granularity of retrieved contexts, which can be empirically adjusted based on downstream tasks.
For instance, in-context learning requires more fine-grained label tokens from demonstration examples cached in memory, where a smaller <math alttext="csz" class="ltx_Math" display="inline" id="S2.SS3.p2.7.m7.1"><semantics id="S2.SS3.p2.7.m7.1a"><mrow id="S2.SS3.p2.7.m7.1.1" xref="S2.SS3.p2.7.m7.1.1.cmml"><mi id="S2.SS3.p2.7.m7.1.1.2" xref="S2.SS3.p2.7.m7.1.1.2.cmml">c</mi><mo id="S2.SS3.p2.7.m7.1.1.1" xref="S2.SS3.p2.7.m7.1.1.1.cmml">‚Å¢</mo><mi id="S2.SS3.p2.7.m7.1.1.3" xref="S2.SS3.p2.7.m7.1.1.3.cmml">s</mi><mo id="S2.SS3.p2.7.m7.1.1.1a" xref="S2.SS3.p2.7.m7.1.1.1.cmml">‚Å¢</mo><mi id="S2.SS3.p2.7.m7.1.1.4" xref="S2.SS3.p2.7.m7.1.1.4.cmml">z</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.7.m7.1b"><apply id="S2.SS3.p2.7.m7.1.1.cmml" xref="S2.SS3.p2.7.m7.1.1"><times id="S2.SS3.p2.7.m7.1.1.1.cmml" xref="S2.SS3.p2.7.m7.1.1.1"></times><ci id="S2.SS3.p2.7.m7.1.1.2.cmml" xref="S2.SS3.p2.7.m7.1.1.2">ùëê</ci><ci id="S2.SS3.p2.7.m7.1.1.3.cmml" xref="S2.SS3.p2.7.m7.1.1.3">ùë†</ci><ci id="S2.SS3.p2.7.m7.1.1.4.cmml" xref="S2.SS3.p2.7.m7.1.1.4">ùëß</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.7.m7.1c">csz</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.7.m7.1d">italic_c italic_s italic_z</annotation></semantics></math> is helpful.</p>
</div>
<div class="ltx_para" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.4"><span class="ltx_text ltx_font_bold" id="S2.SS3.p3.4.1">Memory Fusion.</span>
The memory fusion is performed within a special memory-augmented layer. As the conventional Transformer decoder layer uses the multi-head self-attention¬†<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib.bib24" title=""><span class="ltx_text" style="font-size:90%;">24</span></a>]</cite>, we follow <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib.bib27" title=""><span class="ltx_text" style="font-size:90%;">27</span></a>]</cite> to extend it to a joint-attention mechanism and propose a long-term memory fusion process to enable each token to attend on both local contexts and retrieved memory contexts. With the head-wise hidden state output from previous layer <math alttext="\mathbf{H}^{l-1}\in\mathbb{R}^{|x|\times d}" class="ltx_Math" display="inline" id="S2.SS3.p3.1.m1.1"><semantics id="S2.SS3.p3.1.m1.1a"><mrow id="S2.SS3.p3.1.m1.1.2" xref="S2.SS3.p3.1.m1.1.2.cmml"><msup id="S2.SS3.p3.1.m1.1.2.2" xref="S2.SS3.p3.1.m1.1.2.2.cmml"><mi id="S2.SS3.p3.1.m1.1.2.2.2" xref="S2.SS3.p3.1.m1.1.2.2.2.cmml">ùêá</mi><mrow id="S2.SS3.p3.1.m1.1.2.2.3" xref="S2.SS3.p3.1.m1.1.2.2.3.cmml"><mi id="S2.SS3.p3.1.m1.1.2.2.3.2" xref="S2.SS3.p3.1.m1.1.2.2.3.2.cmml">l</mi><mo id="S2.SS3.p3.1.m1.1.2.2.3.1" xref="S2.SS3.p3.1.m1.1.2.2.3.1.cmml">‚àí</mo><mn id="S2.SS3.p3.1.m1.1.2.2.3.3" xref="S2.SS3.p3.1.m1.1.2.2.3.3.cmml">1</mn></mrow></msup><mo id="S2.SS3.p3.1.m1.1.2.1" xref="S2.SS3.p3.1.m1.1.2.1.cmml">‚àà</mo><msup id="S2.SS3.p3.1.m1.1.2.3" xref="S2.SS3.p3.1.m1.1.2.3.cmml"><mi id="S2.SS3.p3.1.m1.1.2.3.2" mathvariant="normal" xref="S2.SS3.p3.1.m1.1.2.3.2.cmml">‚Ñù</mi><mrow id="S2.SS3.p3.1.m1.1.1.1" xref="S2.SS3.p3.1.m1.1.1.1.cmml"><mrow id="S2.SS3.p3.1.m1.1.1.1.3.2" xref="S2.SS3.p3.1.m1.1.1.1.3.1.cmml"><mo id="S2.SS3.p3.1.m1.1.1.1.3.2.1" stretchy="false" xref="S2.SS3.p3.1.m1.1.1.1.3.1.1.cmml">|</mo><mi id="S2.SS3.p3.1.m1.1.1.1.1" xref="S2.SS3.p3.1.m1.1.1.1.1.cmml">x</mi><mo id="S2.SS3.p3.1.m1.1.1.1.3.2.2" rspace="0.055em" stretchy="false" xref="S2.SS3.p3.1.m1.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S2.SS3.p3.1.m1.1.1.1.2" rspace="0.222em" xref="S2.SS3.p3.1.m1.1.1.1.2.cmml">√ó</mo><mi id="S2.SS3.p3.1.m1.1.1.1.4" xref="S2.SS3.p3.1.m1.1.1.1.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b"><apply id="S2.SS3.p3.1.m1.1.2.cmml" xref="S2.SS3.p3.1.m1.1.2"><in id="S2.SS3.p3.1.m1.1.2.1.cmml" xref="S2.SS3.p3.1.m1.1.2.1"></in><apply id="S2.SS3.p3.1.m1.1.2.2.cmml" xref="S2.SS3.p3.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.1.2.2.1.cmml" xref="S2.SS3.p3.1.m1.1.2.2">superscript</csymbol><ci id="S2.SS3.p3.1.m1.1.2.2.2.cmml" xref="S2.SS3.p3.1.m1.1.2.2.2">ùêá</ci><apply id="S2.SS3.p3.1.m1.1.2.2.3.cmml" xref="S2.SS3.p3.1.m1.1.2.2.3"><minus id="S2.SS3.p3.1.m1.1.2.2.3.1.cmml" xref="S2.SS3.p3.1.m1.1.2.2.3.1"></minus><ci id="S2.SS3.p3.1.m1.1.2.2.3.2.cmml" xref="S2.SS3.p3.1.m1.1.2.2.3.2">ùëô</ci><cn id="S2.SS3.p3.1.m1.1.2.2.3.3.cmml" type="integer" xref="S2.SS3.p3.1.m1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.SS3.p3.1.m1.1.2.3.cmml" xref="S2.SS3.p3.1.m1.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.1.2.3.1.cmml" xref="S2.SS3.p3.1.m1.1.2.3">superscript</csymbol><ci id="S2.SS3.p3.1.m1.1.2.3.2.cmml" xref="S2.SS3.p3.1.m1.1.2.3.2">‚Ñù</ci><apply id="S2.SS3.p3.1.m1.1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1.1"><times id="S2.SS3.p3.1.m1.1.1.1.2.cmml" xref="S2.SS3.p3.1.m1.1.1.1.2"></times><apply id="S2.SS3.p3.1.m1.1.1.1.3.1.cmml" xref="S2.SS3.p3.1.m1.1.1.1.3.2"><abs id="S2.SS3.p3.1.m1.1.1.1.3.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1.1.3.2.1"></abs><ci id="S2.SS3.p3.1.m1.1.1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1.1.1">ùë•</ci></apply><ci id="S2.SS3.p3.1.m1.1.1.1.4.cmml" xref="S2.SS3.p3.1.m1.1.1.1.4">ùëë</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">\mathbf{H}^{l-1}\in\mathbb{R}^{|x|\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.1.m1.1d">bold_H start_POSTSUPERSCRIPT italic_l - 1 end_POSTSUPERSCRIPT ‚àà roman_‚Ñù start_POSTSUPERSCRIPT | italic_x | √ó italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and the corresponding retrieved attention key-value pairs are <math alttext="\{\widetilde{\mathbf{K}}_{i},\widetilde{\mathbf{V}}_{i}\}_{i=1}^{|x|}\in%
\mathbb{R}^{|x|\times\mathrm{K}\times\mathrm{d}}" class="ltx_Math" display="inline" id="S2.SS3.p3.2.m2.4"><semantics id="S2.SS3.p3.2.m2.4a"><mrow id="S2.SS3.p3.2.m2.4.4" xref="S2.SS3.p3.2.m2.4.4.cmml"><msubsup id="S2.SS3.p3.2.m2.4.4.2" xref="S2.SS3.p3.2.m2.4.4.2.cmml"><mrow id="S2.SS3.p3.2.m2.4.4.2.2.2.2" xref="S2.SS3.p3.2.m2.4.4.2.2.2.3.cmml"><mo id="S2.SS3.p3.2.m2.4.4.2.2.2.2.3" stretchy="false" xref="S2.SS3.p3.2.m2.4.4.2.2.2.3.cmml">{</mo><msub id="S2.SS3.p3.2.m2.3.3.1.1.1.1.1" xref="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.cmml"><mover accent="true" id="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.2" xref="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.2.cmml"><mi id="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.2.2" xref="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.2.2.cmml">ùêä</mi><mo id="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.2.1" xref="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.3" xref="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS3.p3.2.m2.4.4.2.2.2.2.4" xref="S2.SS3.p3.2.m2.4.4.2.2.2.3.cmml">,</mo><msub id="S2.SS3.p3.2.m2.4.4.2.2.2.2.2" xref="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.cmml"><mover accent="true" id="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.2" xref="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.2.cmml"><mi id="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.2.2" xref="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.2.2.cmml">ùêï</mi><mo id="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.2.1" xref="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.3" xref="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S2.SS3.p3.2.m2.4.4.2.2.2.2.5" stretchy="false" xref="S2.SS3.p3.2.m2.4.4.2.2.2.3.cmml">}</mo></mrow><mrow id="S2.SS3.p3.2.m2.4.4.2.2.4" xref="S2.SS3.p3.2.m2.4.4.2.2.4.cmml"><mi id="S2.SS3.p3.2.m2.4.4.2.2.4.2" xref="S2.SS3.p3.2.m2.4.4.2.2.4.2.cmml">i</mi><mo id="S2.SS3.p3.2.m2.4.4.2.2.4.1" xref="S2.SS3.p3.2.m2.4.4.2.2.4.1.cmml">=</mo><mn id="S2.SS3.p3.2.m2.4.4.2.2.4.3" xref="S2.SS3.p3.2.m2.4.4.2.2.4.3.cmml">1</mn></mrow><mrow id="S2.SS3.p3.2.m2.1.1.1.3" xref="S2.SS3.p3.2.m2.1.1.1.2.cmml"><mo id="S2.SS3.p3.2.m2.1.1.1.3.1" stretchy="false" xref="S2.SS3.p3.2.m2.1.1.1.2.1.cmml">|</mo><mi id="S2.SS3.p3.2.m2.1.1.1.1" xref="S2.SS3.p3.2.m2.1.1.1.1.cmml">x</mi><mo id="S2.SS3.p3.2.m2.1.1.1.3.2" stretchy="false" xref="S2.SS3.p3.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msubsup><mo id="S2.SS3.p3.2.m2.4.4.3" xref="S2.SS3.p3.2.m2.4.4.3.cmml">‚àà</mo><msup id="S2.SS3.p3.2.m2.4.4.4" xref="S2.SS3.p3.2.m2.4.4.4.cmml"><mi id="S2.SS3.p3.2.m2.4.4.4.2" mathvariant="normal" xref="S2.SS3.p3.2.m2.4.4.4.2.cmml">‚Ñù</mi><mrow id="S2.SS3.p3.2.m2.2.2.1" xref="S2.SS3.p3.2.m2.2.2.1.cmml"><mrow id="S2.SS3.p3.2.m2.2.2.1.3.2" xref="S2.SS3.p3.2.m2.2.2.1.3.1.cmml"><mo id="S2.SS3.p3.2.m2.2.2.1.3.2.1" stretchy="false" xref="S2.SS3.p3.2.m2.2.2.1.3.1.1.cmml">|</mo><mi id="S2.SS3.p3.2.m2.2.2.1.1" xref="S2.SS3.p3.2.m2.2.2.1.1.cmml">x</mi><mo id="S2.SS3.p3.2.m2.2.2.1.3.2.2" rspace="0.055em" stretchy="false" xref="S2.SS3.p3.2.m2.2.2.1.3.1.1.cmml">|</mo></mrow><mo id="S2.SS3.p3.2.m2.2.2.1.2" rspace="0.222em" xref="S2.SS3.p3.2.m2.2.2.1.2.cmml">√ó</mo><mi id="S2.SS3.p3.2.m2.2.2.1.4" mathvariant="normal" xref="S2.SS3.p3.2.m2.2.2.1.4.cmml">K</mi><mo id="S2.SS3.p3.2.m2.2.2.1.2a" lspace="0.222em" rspace="0.222em" xref="S2.SS3.p3.2.m2.2.2.1.2.cmml">√ó</mo><mi id="S2.SS3.p3.2.m2.2.2.1.5" mathvariant="normal" xref="S2.SS3.p3.2.m2.2.2.1.5.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.4b"><apply id="S2.SS3.p3.2.m2.4.4.cmml" xref="S2.SS3.p3.2.m2.4.4"><in id="S2.SS3.p3.2.m2.4.4.3.cmml" xref="S2.SS3.p3.2.m2.4.4.3"></in><apply id="S2.SS3.p3.2.m2.4.4.2.cmml" xref="S2.SS3.p3.2.m2.4.4.2"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.4.4.2.3.cmml" xref="S2.SS3.p3.2.m2.4.4.2">superscript</csymbol><apply id="S2.SS3.p3.2.m2.4.4.2.2.cmml" xref="S2.SS3.p3.2.m2.4.4.2"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.4.4.2.2.3.cmml" xref="S2.SS3.p3.2.m2.4.4.2">subscript</csymbol><set id="S2.SS3.p3.2.m2.4.4.2.2.2.3.cmml" xref="S2.SS3.p3.2.m2.4.4.2.2.2.2"><apply id="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.cmml" xref="S2.SS3.p3.2.m2.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.1.cmml" xref="S2.SS3.p3.2.m2.3.3.1.1.1.1.1">subscript</csymbol><apply id="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.2.cmml" xref="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.2"><ci id="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.2.1.cmml" xref="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.2.1">~</ci><ci id="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.2.2.cmml" xref="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.2.2">ùêä</ci></apply><ci id="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.3.cmml" xref="S2.SS3.p3.2.m2.3.3.1.1.1.1.1.3">ùëñ</ci></apply><apply id="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.cmml" xref="S2.SS3.p3.2.m2.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.1.cmml" xref="S2.SS3.p3.2.m2.4.4.2.2.2.2.2">subscript</csymbol><apply id="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.2.cmml" xref="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.2"><ci id="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.2.1.cmml" xref="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.2.1">~</ci><ci id="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.2.2.cmml" xref="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.2.2">ùêï</ci></apply><ci id="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.3.cmml" xref="S2.SS3.p3.2.m2.4.4.2.2.2.2.2.3">ùëñ</ci></apply></set><apply id="S2.SS3.p3.2.m2.4.4.2.2.4.cmml" xref="S2.SS3.p3.2.m2.4.4.2.2.4"><eq id="S2.SS3.p3.2.m2.4.4.2.2.4.1.cmml" xref="S2.SS3.p3.2.m2.4.4.2.2.4.1"></eq><ci id="S2.SS3.p3.2.m2.4.4.2.2.4.2.cmml" xref="S2.SS3.p3.2.m2.4.4.2.2.4.2">ùëñ</ci><cn id="S2.SS3.p3.2.m2.4.4.2.2.4.3.cmml" type="integer" xref="S2.SS3.p3.2.m2.4.4.2.2.4.3">1</cn></apply></apply><apply id="S2.SS3.p3.2.m2.1.1.1.2.cmml" xref="S2.SS3.p3.2.m2.1.1.1.3"><abs id="S2.SS3.p3.2.m2.1.1.1.2.1.cmml" xref="S2.SS3.p3.2.m2.1.1.1.3.1"></abs><ci id="S2.SS3.p3.2.m2.1.1.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1.1.1">ùë•</ci></apply></apply><apply id="S2.SS3.p3.2.m2.4.4.4.cmml" xref="S2.SS3.p3.2.m2.4.4.4"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.4.4.4.1.cmml" xref="S2.SS3.p3.2.m2.4.4.4">superscript</csymbol><ci id="S2.SS3.p3.2.m2.4.4.4.2.cmml" xref="S2.SS3.p3.2.m2.4.4.4.2">‚Ñù</ci><apply id="S2.SS3.p3.2.m2.2.2.1.cmml" xref="S2.SS3.p3.2.m2.2.2.1"><times id="S2.SS3.p3.2.m2.2.2.1.2.cmml" xref="S2.SS3.p3.2.m2.2.2.1.2"></times><apply id="S2.SS3.p3.2.m2.2.2.1.3.1.cmml" xref="S2.SS3.p3.2.m2.2.2.1.3.2"><abs id="S2.SS3.p3.2.m2.2.2.1.3.1.1.cmml" xref="S2.SS3.p3.2.m2.2.2.1.3.2.1"></abs><ci id="S2.SS3.p3.2.m2.2.2.1.1.cmml" xref="S2.SS3.p3.2.m2.2.2.1.1">ùë•</ci></apply><ci id="S2.SS3.p3.2.m2.2.2.1.4.cmml" xref="S2.SS3.p3.2.m2.2.2.1.4">K</ci><ci id="S2.SS3.p3.2.m2.2.2.1.5.cmml" xref="S2.SS3.p3.2.m2.2.2.1.5">d</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.4c">\{\widetilde{\mathbf{K}}_{i},\widetilde{\mathbf{V}}_{i}\}_{i=1}^{|x|}\in%
\mathbb{R}^{|x|\times\mathrm{K}\times\mathrm{d}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.2.m2.4d">{ over~ start_ARG bold_K end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , over~ start_ARG bold_V end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_x | end_POSTSUPERSCRIPT ‚àà roman_‚Ñù start_POSTSUPERSCRIPT | italic_x | √ó roman_K √ó roman_d end_POSTSUPERSCRIPT</annotation></semantics></math>, the output hidden state for the <math alttext="l" class="ltx_Math" display="inline" id="S2.SS3.p3.3.m3.1"><semantics id="S2.SS3.p3.3.m3.1a"><mi id="S2.SS3.p3.3.m3.1.1" xref="S2.SS3.p3.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.3.m3.1b"><ci id="S2.SS3.p3.3.m3.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1">ùëô</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.3.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.3.m3.1d">italic_l</annotation></semantics></math>-th memory-augmented layer <math alttext="\mathbf{H}^{l}" class="ltx_Math" display="inline" id="S2.SS3.p3.4.m4.1"><semantics id="S2.SS3.p3.4.m4.1a"><msup id="S2.SS3.p3.4.m4.1.1" xref="S2.SS3.p3.4.m4.1.1.cmml"><mi id="S2.SS3.p3.4.m4.1.1.2" xref="S2.SS3.p3.4.m4.1.1.2.cmml">ùêá</mi><mi id="S2.SS3.p3.4.m4.1.1.3" xref="S2.SS3.p3.4.m4.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.4.m4.1b"><apply id="S2.SS3.p3.4.m4.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.4.m4.1.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1">superscript</csymbol><ci id="S2.SS3.p3.4.m4.1.1.2.cmml" xref="S2.SS3.p3.4.m4.1.1.2">ùêá</ci><ci id="S2.SS3.p3.4.m4.1.1.3.cmml" xref="S2.SS3.p3.4.m4.1.1.3">ùëô</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.4.m4.1c">\mathbf{H}^{l}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.4.m4.1d">bold_H start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> is computed as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx2">
<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{A}=\textnormal{softmax}(\frac{\mathbf{Q}\mathbf{K}^{T}}{%
\sqrt{d}})\mathbf{V},\ \ \mathbf{M}=\textnormal{Concat}\{\textnormal{softmax}(%
\frac{\mathbf{Q}_{i}\widetilde{\mathbf{K}}_{i}^{T}}{\sqrt{d}})\widetilde{%
\mathbf{V}}_{i}\}_{i=1}^{|x|}," class="ltx_Math" display="inline" id="S2.E2.m1.4"><semantics id="S2.E2.m1.4a"><mrow id="S2.E2.m1.4.4.1"><mrow id="S2.E2.m1.4.4.1.1.2" xref="S2.E2.m1.4.4.1.1.3.cmml"><mrow id="S2.E2.m1.4.4.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.1.1.2.cmml">ùêÄ</mi><mo id="S2.E2.m1.4.4.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.1.cmml">=</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.3" xref="S2.E2.m1.4.4.1.1.1.1.3.cmml"><mtext id="S2.E2.m1.4.4.1.1.1.1.3.2" xref="S2.E2.m1.4.4.1.1.1.1.3.2a.cmml">softmax</mtext><mo id="S2.E2.m1.4.4.1.1.1.1.3.1" xref="S2.E2.m1.4.4.1.1.1.1.3.1.cmml">‚Å¢</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.3.3.2" xref="S2.E2.m1.2.2.cmml"><mo id="S2.E2.m1.4.4.1.1.1.1.3.3.2.1" stretchy="false" xref="S2.E2.m1.2.2.cmml">(</mo><mstyle displaystyle="true" id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml"><mfrac id="S2.E2.m1.2.2a" xref="S2.E2.m1.2.2.cmml"><msup id="S2.E2.m1.2.2.2" xref="S2.E2.m1.2.2.2.cmml"><mi id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.2.cmml">ùêêùêä</mi><mi id="S2.E2.m1.2.2.2.3" xref="S2.E2.m1.2.2.2.3.cmml">T</mi></msup><msqrt id="S2.E2.m1.2.2.3" xref="S2.E2.m1.2.2.3.cmml"><mi id="S2.E2.m1.2.2.3.2" xref="S2.E2.m1.2.2.3.2.cmml">d</mi></msqrt></mfrac></mstyle><mo id="S2.E2.m1.4.4.1.1.1.1.3.3.2.2" stretchy="false" xref="S2.E2.m1.2.2.cmml">)</mo></mrow><mo id="S2.E2.m1.4.4.1.1.1.1.3.1a" xref="S2.E2.m1.4.4.1.1.1.1.3.1.cmml">‚Å¢</mo><mi id="S2.E2.m1.4.4.1.1.1.1.3.4" xref="S2.E2.m1.4.4.1.1.1.1.3.4.cmml">ùêï</mi></mrow></mrow><mo id="S2.E2.m1.4.4.1.1.2.3" rspace="1.167em" xref="S2.E2.m1.4.4.1.1.3a.cmml">,</mo><mrow id="S2.E2.m1.4.4.1.1.2.2" xref="S2.E2.m1.4.4.1.1.2.2.cmml"><mi id="S2.E2.m1.4.4.1.1.2.2.3" xref="S2.E2.m1.4.4.1.1.2.2.3.cmml">ùêå</mi><mo id="S2.E2.m1.4.4.1.1.2.2.2" xref="S2.E2.m1.4.4.1.1.2.2.2.cmml">=</mo><mrow id="S2.E2.m1.4.4.1.1.2.2.1" xref="S2.E2.m1.4.4.1.1.2.2.1.cmml"><mtext id="S2.E2.m1.4.4.1.1.2.2.1.3" xref="S2.E2.m1.4.4.1.1.2.2.1.3a.cmml">Concat</mtext><mo id="S2.E2.m1.4.4.1.1.2.2.1.2" xref="S2.E2.m1.4.4.1.1.2.2.1.2.cmml">‚Å¢</mo><msubsup id="S2.E2.m1.4.4.1.1.2.2.1.1" xref="S2.E2.m1.4.4.1.1.2.2.1.1.cmml"><mrow id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.2.cmml"><mo id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.2.cmml">{</mo><mrow id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.cmml"><mtext id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.2a.cmml">softmax</mtext><mo id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.cmml">‚Å¢</mo><mrow id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.2" xref="S2.E2.m1.3.3.cmml"><mo id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E2.m1.3.3.cmml">(</mo><mstyle displaystyle="true" id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml"><mfrac id="S2.E2.m1.3.3a" xref="S2.E2.m1.3.3.cmml"><mrow id="S2.E2.m1.3.3.2" xref="S2.E2.m1.3.3.2.cmml"><msub id="S2.E2.m1.3.3.2.2" xref="S2.E2.m1.3.3.2.2.cmml"><mi id="S2.E2.m1.3.3.2.2.2" xref="S2.E2.m1.3.3.2.2.2.cmml">ùêê</mi><mi id="S2.E2.m1.3.3.2.2.3" xref="S2.E2.m1.3.3.2.2.3.cmml">i</mi></msub><mo id="S2.E2.m1.3.3.2.1" xref="S2.E2.m1.3.3.2.1.cmml">‚Å¢</mo><msubsup id="S2.E2.m1.3.3.2.3" xref="S2.E2.m1.3.3.2.3.cmml"><mover accent="true" id="S2.E2.m1.3.3.2.3.2.2" xref="S2.E2.m1.3.3.2.3.2.2.cmml"><mi id="S2.E2.m1.3.3.2.3.2.2.2" xref="S2.E2.m1.3.3.2.3.2.2.2.cmml">ùêä</mi><mo id="S2.E2.m1.3.3.2.3.2.2.1" xref="S2.E2.m1.3.3.2.3.2.2.1.cmml">~</mo></mover><mi id="S2.E2.m1.3.3.2.3.2.3" xref="S2.E2.m1.3.3.2.3.2.3.cmml">i</mi><mi id="S2.E2.m1.3.3.2.3.3" xref="S2.E2.m1.3.3.2.3.3.cmml">T</mi></msubsup></mrow><msqrt id="S2.E2.m1.3.3.3" xref="S2.E2.m1.3.3.3.cmml"><mi id="S2.E2.m1.3.3.3.2" xref="S2.E2.m1.3.3.3.2.cmml">d</mi></msqrt></mfrac></mstyle><mo id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E2.m1.3.3.cmml">)</mo></mrow><mo id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.1a" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.cmml">‚Å¢</mo><msub id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.cmml"><mover accent="true" id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.2" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.2.cmml"><mi id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.2.2" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.2.2.cmml">ùêï</mi><mo id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.2.1" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.2.1.cmml">~</mo></mover><mi id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.3" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.3.cmml">i</mi></msub></mrow><mo id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.E2.m1.4.4.1.1.2.2.1.1.1.3" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.cmml"><mi id="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.2" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.2.cmml">i</mi><mo id="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.1" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.1.cmml">=</mo><mn id="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.3" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.3.cmml">1</mn></mrow><mrow id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.1.1.1.2.cmml"><mo id="S2.E2.m1.1.1.1.3.1" stretchy="false" xref="S2.E2.m1.1.1.1.2.1.cmml">|</mo><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">x</mi><mo id="S2.E2.m1.1.1.1.3.2" stretchy="false" xref="S2.E2.m1.1.1.1.2.1.cmml">|</mo></mrow></msubsup></mrow></mrow></mrow><mo id="S2.E2.m1.4.4.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.4b"><apply id="S2.E2.m1.4.4.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.3a.cmml" xref="S2.E2.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E2.m1.4.4.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1"><eq id="S2.E2.m1.4.4.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1"></eq><ci id="S2.E2.m1.4.4.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2">ùêÄ</ci><apply id="S2.E2.m1.4.4.1.1.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3"><times id="S2.E2.m1.4.4.1.1.1.1.3.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3.1"></times><ci id="S2.E2.m1.4.4.1.1.1.1.3.2a.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3.2"><mtext id="S2.E2.m1.4.4.1.1.1.1.3.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3.2">softmax</mtext></ci><apply id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3.3.2"><divide id="S2.E2.m1.2.2.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3.3.2"></divide><apply id="S2.E2.m1.2.2.2.cmml" xref="S2.E2.m1.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.1.cmml" xref="S2.E2.m1.2.2.2">superscript</csymbol><ci id="S2.E2.m1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2">ùêêùêä</ci><ci id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.3">ùëá</ci></apply><apply id="S2.E2.m1.2.2.3.cmml" xref="S2.E2.m1.2.2.3"><root id="S2.E2.m1.2.2.3a.cmml" xref="S2.E2.m1.2.2.3"></root><ci id="S2.E2.m1.2.2.3.2.cmml" xref="S2.E2.m1.2.2.3.2">ùëë</ci></apply></apply><ci id="S2.E2.m1.4.4.1.1.1.1.3.4.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3.4">ùêï</ci></apply></apply><apply id="S2.E2.m1.4.4.1.1.2.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2"><eq id="S2.E2.m1.4.4.1.1.2.2.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.2"></eq><ci id="S2.E2.m1.4.4.1.1.2.2.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.3">ùêå</ci><apply id="S2.E2.m1.4.4.1.1.2.2.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1"><times id="S2.E2.m1.4.4.1.1.2.2.1.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.2"></times><ci id="S2.E2.m1.4.4.1.1.2.2.1.3a.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.3"><mtext id="S2.E2.m1.4.4.1.1.2.2.1.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.3">Concat</mtext></ci><apply id="S2.E2.m1.4.4.1.1.2.2.1.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.2.2.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1">superscript</csymbol><apply id="S2.E2.m1.4.4.1.1.2.2.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.2.2.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1">subscript</csymbol><set id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1"><apply id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1"><times id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.1"></times><ci id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.2a.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.2"><mtext id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.2">softmax</mtext></ci><apply id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.2"><divide id="S2.E2.m1.3.3.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.2"></divide><apply id="S2.E2.m1.3.3.2.cmml" xref="S2.E2.m1.3.3.2"><times id="S2.E2.m1.3.3.2.1.cmml" xref="S2.E2.m1.3.3.2.1"></times><apply id="S2.E2.m1.3.3.2.2.cmml" xref="S2.E2.m1.3.3.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.2.2.1.cmml" xref="S2.E2.m1.3.3.2.2">subscript</csymbol><ci id="S2.E2.m1.3.3.2.2.2.cmml" xref="S2.E2.m1.3.3.2.2.2">ùêê</ci><ci id="S2.E2.m1.3.3.2.2.3.cmml" xref="S2.E2.m1.3.3.2.2.3">ùëñ</ci></apply><apply id="S2.E2.m1.3.3.2.3.cmml" xref="S2.E2.m1.3.3.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.2.3.1.cmml" xref="S2.E2.m1.3.3.2.3">superscript</csymbol><apply id="S2.E2.m1.3.3.2.3.2.cmml" xref="S2.E2.m1.3.3.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.2.3.2.1.cmml" xref="S2.E2.m1.3.3.2.3">subscript</csymbol><apply id="S2.E2.m1.3.3.2.3.2.2.cmml" xref="S2.E2.m1.3.3.2.3.2.2"><ci id="S2.E2.m1.3.3.2.3.2.2.1.cmml" xref="S2.E2.m1.3.3.2.3.2.2.1">~</ci><ci id="S2.E2.m1.3.3.2.3.2.2.2.cmml" xref="S2.E2.m1.3.3.2.3.2.2.2">ùêä</ci></apply><ci id="S2.E2.m1.3.3.2.3.2.3.cmml" xref="S2.E2.m1.3.3.2.3.2.3">ùëñ</ci></apply><ci id="S2.E2.m1.3.3.2.3.3.cmml" xref="S2.E2.m1.3.3.2.3.3">ùëá</ci></apply></apply><apply id="S2.E2.m1.3.3.3.cmml" xref="S2.E2.m1.3.3.3"><root id="S2.E2.m1.3.3.3a.cmml" xref="S2.E2.m1.3.3.3"></root><ci id="S2.E2.m1.3.3.3.2.cmml" xref="S2.E2.m1.3.3.3.2">ùëë</ci></apply></apply><apply id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4">subscript</csymbol><apply id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.2"><ci id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.2.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.2.1">~</ci><ci id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.2.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.2.2">ùêï</ci></apply><ci id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.4.3">ùëñ</ci></apply></apply></set><apply id="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.3"><eq id="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.1"></eq><ci id="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.2">ùëñ</ci><cn id="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.3.cmml" type="integer" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.3"><abs id="S2.E2.m1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.3.1"></abs><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">ùë•</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.4c">\displaystyle\mathbf{A}=\textnormal{softmax}(\frac{\mathbf{Q}\mathbf{K}^{T}}{%
\sqrt{d}})\mathbf{V},\ \ \mathbf{M}=\textnormal{Concat}\{\textnormal{softmax}(%
\frac{\mathbf{Q}_{i}\widetilde{\mathbf{K}}_{i}^{T}}{\sqrt{d}})\widetilde{%
\mathbf{V}}_{i}\}_{i=1}^{|x|},</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.4d">bold_A = softmax ( divide start_ARG bold_QK start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG ) bold_V , bold_M = Concat { softmax ( divide start_ARG bold_Q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT over~ start_ARG bold_K end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG ) over~ start_ARG bold_V end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_x | end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{H}^{l}=\textnormal{sigmoid}(g)\cdot\mathbf{A}+(1-%
\textnormal{sigmoid}(g))\cdot\mathbf{M}," class="ltx_Math" display="inline" id="S2.E3.m1.3"><semantics id="S2.E3.m1.3a"><mrow id="S2.E3.m1.3.3.1" xref="S2.E3.m1.3.3.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1" xref="S2.E3.m1.3.3.1.1.cmml"><msup id="S2.E3.m1.3.3.1.1.3" xref="S2.E3.m1.3.3.1.1.3.cmml"><mi id="S2.E3.m1.3.3.1.1.3.2" xref="S2.E3.m1.3.3.1.1.3.2.cmml">ùêá</mi><mi id="S2.E3.m1.3.3.1.1.3.3" xref="S2.E3.m1.3.3.1.1.3.3.cmml">l</mi></msup><mo id="S2.E3.m1.3.3.1.1.2" xref="S2.E3.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E3.m1.3.3.1.1.1" xref="S2.E3.m1.3.3.1.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.3.cmml"><mrow id="S2.E3.m1.3.3.1.1.1.3.2" xref="S2.E3.m1.3.3.1.1.1.3.2.cmml"><mtext id="S2.E3.m1.3.3.1.1.1.3.2.2" xref="S2.E3.m1.3.3.1.1.1.3.2.2a.cmml">sigmoid</mtext><mo id="S2.E3.m1.3.3.1.1.1.3.2.1" xref="S2.E3.m1.3.3.1.1.1.3.2.1.cmml">‚Å¢</mo><mrow id="S2.E3.m1.3.3.1.1.1.3.2.3.2" xref="S2.E3.m1.3.3.1.1.1.3.2.cmml"><mo id="S2.E3.m1.3.3.1.1.1.3.2.3.2.1" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.3.2.cmml">(</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">g</mi><mo id="S2.E3.m1.3.3.1.1.1.3.2.3.2.2" rspace="0.055em" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.3.3.1.1.1.3.1" rspace="0.222em" xref="S2.E3.m1.3.3.1.1.1.3.1.cmml">‚ãÖ</mo><mi id="S2.E3.m1.3.3.1.1.1.3.3" xref="S2.E3.m1.3.3.1.1.1.3.3.cmml">ùêÄ</mi></mrow><mo id="S2.E3.m1.3.3.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.2.cmml">+</mo><mrow id="S2.E3.m1.3.3.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml"><mn id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml">‚àí</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mtext id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.2a.cmml">sigmoid</mtext><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">‚Å¢</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.3.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">g</mi><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E3.m1.3.3.1.1.1.1.2" rspace="0.222em" xref="S2.E3.m1.3.3.1.1.1.1.2.cmml">‚ãÖ</mo><mi id="S2.E3.m1.3.3.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.3.cmml">ùêå</mi></mrow></mrow></mrow><mo id="S2.E3.m1.3.3.1.2" xref="S2.E3.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.3b"><apply id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1"><eq id="S2.E3.m1.3.3.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2"></eq><apply id="S2.E3.m1.3.3.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.3.1.cmml" xref="S2.E3.m1.3.3.1.1.3">superscript</csymbol><ci id="S2.E3.m1.3.3.1.1.3.2.cmml" xref="S2.E3.m1.3.3.1.1.3.2">ùêá</ci><ci id="S2.E3.m1.3.3.1.1.3.3.cmml" xref="S2.E3.m1.3.3.1.1.3.3">ùëô</ci></apply><apply id="S2.E3.m1.3.3.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1"><plus id="S2.E3.m1.3.3.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.2"></plus><apply id="S2.E3.m1.3.3.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.3"><ci id="S2.E3.m1.3.3.1.1.1.3.1.cmml" xref="S2.E3.m1.3.3.1.1.1.3.1">‚ãÖ</ci><apply id="S2.E3.m1.3.3.1.1.1.3.2.cmml" xref="S2.E3.m1.3.3.1.1.1.3.2"><times id="S2.E3.m1.3.3.1.1.1.3.2.1.cmml" xref="S2.E3.m1.3.3.1.1.1.3.2.1"></times><ci id="S2.E3.m1.3.3.1.1.1.3.2.2a.cmml" xref="S2.E3.m1.3.3.1.1.1.3.2.2"><mtext id="S2.E3.m1.3.3.1.1.1.3.2.2.cmml" xref="S2.E3.m1.3.3.1.1.1.3.2.2">sigmoid</mtext></ci><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">ùëî</ci></apply><ci id="S2.E3.m1.3.3.1.1.1.3.3.cmml" xref="S2.E3.m1.3.3.1.1.1.3.3">ùêÄ</ci></apply><apply id="S2.E3.m1.3.3.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1"><ci id="S2.E3.m1.3.3.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.2">‚ãÖ</ci><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1"><minus id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.1"></minus><cn id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.2">1</cn><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.3"><times id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.1"></times><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.2a.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.2"><mtext id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.2">sigmoid</mtext></ci><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">ùëî</ci></apply></apply><ci id="S2.E3.m1.3.3.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3">ùêå</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.3c">\displaystyle\mathbf{H}^{l}=\textnormal{sigmoid}(g)\cdot\mathbf{A}+(1-%
\textnormal{sigmoid}(g))\cdot\mathbf{M},</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.3d">bold_H start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = sigmoid ( italic_g ) ‚ãÖ bold_A + ( 1 - sigmoid ( italic_g ) ) ‚ãÖ bold_M ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p3.10">where <math alttext="\mathbf{Q},\mathbf{K},\mathbf{V},\mathbf{A},\mathbf{M}\in\mathbb{R}^{|x|\times%
\mathrm{d}}" class="ltx_Math" display="inline" id="S2.SS3.p3.5.m1.6"><semantics id="S2.SS3.p3.5.m1.6a"><mrow id="S2.SS3.p3.5.m1.6.7" xref="S2.SS3.p3.5.m1.6.7.cmml"><mrow id="S2.SS3.p3.5.m1.6.7.2.2" xref="S2.SS3.p3.5.m1.6.7.2.1.cmml"><mi id="S2.SS3.p3.5.m1.2.2" xref="S2.SS3.p3.5.m1.2.2.cmml">ùêê</mi><mo id="S2.SS3.p3.5.m1.6.7.2.2.1" xref="S2.SS3.p3.5.m1.6.7.2.1.cmml">,</mo><mi id="S2.SS3.p3.5.m1.3.3" xref="S2.SS3.p3.5.m1.3.3.cmml">ùêä</mi><mo id="S2.SS3.p3.5.m1.6.7.2.2.2" xref="S2.SS3.p3.5.m1.6.7.2.1.cmml">,</mo><mi id="S2.SS3.p3.5.m1.4.4" xref="S2.SS3.p3.5.m1.4.4.cmml">ùêï</mi><mo id="S2.SS3.p3.5.m1.6.7.2.2.3" xref="S2.SS3.p3.5.m1.6.7.2.1.cmml">,</mo><mi id="S2.SS3.p3.5.m1.5.5" xref="S2.SS3.p3.5.m1.5.5.cmml">ùêÄ</mi><mo id="S2.SS3.p3.5.m1.6.7.2.2.4" xref="S2.SS3.p3.5.m1.6.7.2.1.cmml">,</mo><mi id="S2.SS3.p3.5.m1.6.6" xref="S2.SS3.p3.5.m1.6.6.cmml">ùêå</mi></mrow><mo id="S2.SS3.p3.5.m1.6.7.1" xref="S2.SS3.p3.5.m1.6.7.1.cmml">‚àà</mo><msup id="S2.SS3.p3.5.m1.6.7.3" xref="S2.SS3.p3.5.m1.6.7.3.cmml"><mi id="S2.SS3.p3.5.m1.6.7.3.2" mathvariant="normal" xref="S2.SS3.p3.5.m1.6.7.3.2.cmml">‚Ñù</mi><mrow id="S2.SS3.p3.5.m1.1.1.1" xref="S2.SS3.p3.5.m1.1.1.1.cmml"><mrow id="S2.SS3.p3.5.m1.1.1.1.3.2" xref="S2.SS3.p3.5.m1.1.1.1.3.1.cmml"><mo id="S2.SS3.p3.5.m1.1.1.1.3.2.1" stretchy="false" xref="S2.SS3.p3.5.m1.1.1.1.3.1.1.cmml">|</mo><mi id="S2.SS3.p3.5.m1.1.1.1.1" xref="S2.SS3.p3.5.m1.1.1.1.1.cmml">x</mi><mo id="S2.SS3.p3.5.m1.1.1.1.3.2.2" rspace="0.055em" stretchy="false" xref="S2.SS3.p3.5.m1.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S2.SS3.p3.5.m1.1.1.1.2" rspace="0.222em" xref="S2.SS3.p3.5.m1.1.1.1.2.cmml">√ó</mo><mi id="S2.SS3.p3.5.m1.1.1.1.4" mathvariant="normal" xref="S2.SS3.p3.5.m1.1.1.1.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.5.m1.6b"><apply id="S2.SS3.p3.5.m1.6.7.cmml" xref="S2.SS3.p3.5.m1.6.7"><in id="S2.SS3.p3.5.m1.6.7.1.cmml" xref="S2.SS3.p3.5.m1.6.7.1"></in><list id="S2.SS3.p3.5.m1.6.7.2.1.cmml" xref="S2.SS3.p3.5.m1.6.7.2.2"><ci id="S2.SS3.p3.5.m1.2.2.cmml" xref="S2.SS3.p3.5.m1.2.2">ùêê</ci><ci id="S2.SS3.p3.5.m1.3.3.cmml" xref="S2.SS3.p3.5.m1.3.3">ùêä</ci><ci id="S2.SS3.p3.5.m1.4.4.cmml" xref="S2.SS3.p3.5.m1.4.4">ùêï</ci><ci id="S2.SS3.p3.5.m1.5.5.cmml" xref="S2.SS3.p3.5.m1.5.5">ùêÄ</ci><ci id="S2.SS3.p3.5.m1.6.6.cmml" xref="S2.SS3.p3.5.m1.6.6">ùêå</ci></list><apply id="S2.SS3.p3.5.m1.6.7.3.cmml" xref="S2.SS3.p3.5.m1.6.7.3"><csymbol cd="ambiguous" id="S2.SS3.p3.5.m1.6.7.3.1.cmml" xref="S2.SS3.p3.5.m1.6.7.3">superscript</csymbol><ci id="S2.SS3.p3.5.m1.6.7.3.2.cmml" xref="S2.SS3.p3.5.m1.6.7.3.2">‚Ñù</ci><apply id="S2.SS3.p3.5.m1.1.1.1.cmml" xref="S2.SS3.p3.5.m1.1.1.1"><times id="S2.SS3.p3.5.m1.1.1.1.2.cmml" xref="S2.SS3.p3.5.m1.1.1.1.2"></times><apply id="S2.SS3.p3.5.m1.1.1.1.3.1.cmml" xref="S2.SS3.p3.5.m1.1.1.1.3.2"><abs id="S2.SS3.p3.5.m1.1.1.1.3.1.1.cmml" xref="S2.SS3.p3.5.m1.1.1.1.3.2.1"></abs><ci id="S2.SS3.p3.5.m1.1.1.1.1.cmml" xref="S2.SS3.p3.5.m1.1.1.1.1">ùë•</ci></apply><ci id="S2.SS3.p3.5.m1.1.1.1.4.cmml" xref="S2.SS3.p3.5.m1.1.1.1.4">d</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.5.m1.6c">\mathbf{Q},\mathbf{K},\mathbf{V},\mathbf{A},\mathbf{M}\in\mathbb{R}^{|x|\times%
\mathrm{d}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.5.m1.6d">bold_Q , bold_K , bold_V , bold_A , bold_M ‚àà roman_‚Ñù start_POSTSUPERSCRIPT | italic_x | √ó roman_d end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathrm{K}" class="ltx_Math" display="inline" id="S2.SS3.p3.6.m2.1"><semantics id="S2.SS3.p3.6.m2.1a"><mi id="S2.SS3.p3.6.m2.1.1" mathvariant="normal" xref="S2.SS3.p3.6.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.6.m2.1b"><ci id="S2.SS3.p3.6.m2.1.1.cmml" xref="S2.SS3.p3.6.m2.1.1">K</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.6.m2.1c">\mathrm{K}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.6.m2.1d">roman_K</annotation></semantics></math> is the number of retrieved attention key-value pairs in cached memory for each token, and <math alttext="g" class="ltx_Math" display="inline" id="S2.SS3.p3.7.m3.1"><semantics id="S2.SS3.p3.7.m3.1a"><mi id="S2.SS3.p3.7.m3.1.1" xref="S2.SS3.p3.7.m3.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.7.m3.1b"><ci id="S2.SS3.p3.7.m3.1.1.cmml" xref="S2.SS3.p3.7.m3.1.1">ùëî</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.7.m3.1c">g</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.7.m3.1d">italic_g</annotation></semantics></math> is a trainable head-wise gating vector. The hidden state output from previous layer <math alttext="\mathbf{H}^{(l-1)}" class="ltx_Math" display="inline" id="S2.SS3.p3.8.m4.1"><semantics id="S2.SS3.p3.8.m4.1a"><msup id="S2.SS3.p3.8.m4.1.2" xref="S2.SS3.p3.8.m4.1.2.cmml"><mi id="S2.SS3.p3.8.m4.1.2.2" xref="S2.SS3.p3.8.m4.1.2.2.cmml">ùêá</mi><mrow id="S2.SS3.p3.8.m4.1.1.1.1" xref="S2.SS3.p3.8.m4.1.1.1.1.1.cmml"><mo id="S2.SS3.p3.8.m4.1.1.1.1.2" stretchy="false" xref="S2.SS3.p3.8.m4.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p3.8.m4.1.1.1.1.1" xref="S2.SS3.p3.8.m4.1.1.1.1.1.cmml"><mi id="S2.SS3.p3.8.m4.1.1.1.1.1.2" xref="S2.SS3.p3.8.m4.1.1.1.1.1.2.cmml">l</mi><mo id="S2.SS3.p3.8.m4.1.1.1.1.1.1" xref="S2.SS3.p3.8.m4.1.1.1.1.1.1.cmml">‚àí</mo><mn id="S2.SS3.p3.8.m4.1.1.1.1.1.3" xref="S2.SS3.p3.8.m4.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.SS3.p3.8.m4.1.1.1.1.3" stretchy="false" xref="S2.SS3.p3.8.m4.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.8.m4.1b"><apply id="S2.SS3.p3.8.m4.1.2.cmml" xref="S2.SS3.p3.8.m4.1.2"><csymbol cd="ambiguous" id="S2.SS3.p3.8.m4.1.2.1.cmml" xref="S2.SS3.p3.8.m4.1.2">superscript</csymbol><ci id="S2.SS3.p3.8.m4.1.2.2.cmml" xref="S2.SS3.p3.8.m4.1.2.2">ùêá</ci><apply id="S2.SS3.p3.8.m4.1.1.1.1.1.cmml" xref="S2.SS3.p3.8.m4.1.1.1.1"><minus id="S2.SS3.p3.8.m4.1.1.1.1.1.1.cmml" xref="S2.SS3.p3.8.m4.1.1.1.1.1.1"></minus><ci id="S2.SS3.p3.8.m4.1.1.1.1.1.2.cmml" xref="S2.SS3.p3.8.m4.1.1.1.1.1.2">ùëô</ci><cn id="S2.SS3.p3.8.m4.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS3.p3.8.m4.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.8.m4.1c">\mathbf{H}^{(l-1)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.8.m4.1d">bold_H start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT</annotation></semantics></math> is linearly projected into attention queries, keys, and values <math alttext="\mathbf{Q},\mathbf{K},\mathbf{V}" class="ltx_Math" display="inline" id="S2.SS3.p3.9.m5.3"><semantics id="S2.SS3.p3.9.m5.3a"><mrow id="S2.SS3.p3.9.m5.3.4.2" xref="S2.SS3.p3.9.m5.3.4.1.cmml"><mi id="S2.SS3.p3.9.m5.1.1" xref="S2.SS3.p3.9.m5.1.1.cmml">ùêê</mi><mo id="S2.SS3.p3.9.m5.3.4.2.1" xref="S2.SS3.p3.9.m5.3.4.1.cmml">,</mo><mi id="S2.SS3.p3.9.m5.2.2" xref="S2.SS3.p3.9.m5.2.2.cmml">ùêä</mi><mo id="S2.SS3.p3.9.m5.3.4.2.2" xref="S2.SS3.p3.9.m5.3.4.1.cmml">,</mo><mi id="S2.SS3.p3.9.m5.3.3" xref="S2.SS3.p3.9.m5.3.3.cmml">ùêï</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.9.m5.3b"><list id="S2.SS3.p3.9.m5.3.4.1.cmml" xref="S2.SS3.p3.9.m5.3.4.2"><ci id="S2.SS3.p3.9.m5.1.1.cmml" xref="S2.SS3.p3.9.m5.1.1">ùêê</ci><ci id="S2.SS3.p3.9.m5.2.2.cmml" xref="S2.SS3.p3.9.m5.2.2">ùêä</ci><ci id="S2.SS3.p3.9.m5.3.3.cmml" xref="S2.SS3.p3.9.m5.3.3">ùêï</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.9.m5.3c">\mathbf{Q},\mathbf{K},\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.9.m5.3d">bold_Q , bold_K , bold_V</annotation></semantics></math> separately via three matrices <math alttext="W^{Q},W^{K},W^{V}\in\mathbb{R}^{\mathrm{d}\times\mathrm{d}}" class="ltx_Math" display="inline" id="S2.SS3.p3.10.m6.3"><semantics id="S2.SS3.p3.10.m6.3a"><mrow id="S2.SS3.p3.10.m6.3.3" xref="S2.SS3.p3.10.m6.3.3.cmml"><mrow id="S2.SS3.p3.10.m6.3.3.3.3" xref="S2.SS3.p3.10.m6.3.3.3.4.cmml"><msup id="S2.SS3.p3.10.m6.1.1.1.1.1" xref="S2.SS3.p3.10.m6.1.1.1.1.1.cmml"><mi id="S2.SS3.p3.10.m6.1.1.1.1.1.2" xref="S2.SS3.p3.10.m6.1.1.1.1.1.2.cmml">W</mi><mi id="S2.SS3.p3.10.m6.1.1.1.1.1.3" xref="S2.SS3.p3.10.m6.1.1.1.1.1.3.cmml">Q</mi></msup><mo id="S2.SS3.p3.10.m6.3.3.3.3.4" xref="S2.SS3.p3.10.m6.3.3.3.4.cmml">,</mo><msup id="S2.SS3.p3.10.m6.2.2.2.2.2" xref="S2.SS3.p3.10.m6.2.2.2.2.2.cmml"><mi id="S2.SS3.p3.10.m6.2.2.2.2.2.2" xref="S2.SS3.p3.10.m6.2.2.2.2.2.2.cmml">W</mi><mi id="S2.SS3.p3.10.m6.2.2.2.2.2.3" xref="S2.SS3.p3.10.m6.2.2.2.2.2.3.cmml">K</mi></msup><mo id="S2.SS3.p3.10.m6.3.3.3.3.5" xref="S2.SS3.p3.10.m6.3.3.3.4.cmml">,</mo><msup id="S2.SS3.p3.10.m6.3.3.3.3.3" xref="S2.SS3.p3.10.m6.3.3.3.3.3.cmml"><mi id="S2.SS3.p3.10.m6.3.3.3.3.3.2" xref="S2.SS3.p3.10.m6.3.3.3.3.3.2.cmml">W</mi><mi id="S2.SS3.p3.10.m6.3.3.3.3.3.3" xref="S2.SS3.p3.10.m6.3.3.3.3.3.3.cmml">V</mi></msup></mrow><mo id="S2.SS3.p3.10.m6.3.3.4" xref="S2.SS3.p3.10.m6.3.3.4.cmml">‚àà</mo><msup id="S2.SS3.p3.10.m6.3.3.5" xref="S2.SS3.p3.10.m6.3.3.5.cmml"><mi id="S2.SS3.p3.10.m6.3.3.5.2" mathvariant="normal" xref="S2.SS3.p3.10.m6.3.3.5.2.cmml">‚Ñù</mi><mrow id="S2.SS3.p3.10.m6.3.3.5.3" xref="S2.SS3.p3.10.m6.3.3.5.3.cmml"><mi id="S2.SS3.p3.10.m6.3.3.5.3.2" mathvariant="normal" xref="S2.SS3.p3.10.m6.3.3.5.3.2.cmml">d</mi><mo id="S2.SS3.p3.10.m6.3.3.5.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.p3.10.m6.3.3.5.3.1.cmml">√ó</mo><mi id="S2.SS3.p3.10.m6.3.3.5.3.3" mathvariant="normal" xref="S2.SS3.p3.10.m6.3.3.5.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.10.m6.3b"><apply id="S2.SS3.p3.10.m6.3.3.cmml" xref="S2.SS3.p3.10.m6.3.3"><in id="S2.SS3.p3.10.m6.3.3.4.cmml" xref="S2.SS3.p3.10.m6.3.3.4"></in><list id="S2.SS3.p3.10.m6.3.3.3.4.cmml" xref="S2.SS3.p3.10.m6.3.3.3.3"><apply id="S2.SS3.p3.10.m6.1.1.1.1.1.cmml" xref="S2.SS3.p3.10.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.10.m6.1.1.1.1.1.1.cmml" xref="S2.SS3.p3.10.m6.1.1.1.1.1">superscript</csymbol><ci id="S2.SS3.p3.10.m6.1.1.1.1.1.2.cmml" xref="S2.SS3.p3.10.m6.1.1.1.1.1.2">ùëä</ci><ci id="S2.SS3.p3.10.m6.1.1.1.1.1.3.cmml" xref="S2.SS3.p3.10.m6.1.1.1.1.1.3">ùëÑ</ci></apply><apply id="S2.SS3.p3.10.m6.2.2.2.2.2.cmml" xref="S2.SS3.p3.10.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.10.m6.2.2.2.2.2.1.cmml" xref="S2.SS3.p3.10.m6.2.2.2.2.2">superscript</csymbol><ci id="S2.SS3.p3.10.m6.2.2.2.2.2.2.cmml" xref="S2.SS3.p3.10.m6.2.2.2.2.2.2">ùëä</ci><ci id="S2.SS3.p3.10.m6.2.2.2.2.2.3.cmml" xref="S2.SS3.p3.10.m6.2.2.2.2.2.3">ùêæ</ci></apply><apply id="S2.SS3.p3.10.m6.3.3.3.3.3.cmml" xref="S2.SS3.p3.10.m6.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.p3.10.m6.3.3.3.3.3.1.cmml" xref="S2.SS3.p3.10.m6.3.3.3.3.3">superscript</csymbol><ci id="S2.SS3.p3.10.m6.3.3.3.3.3.2.cmml" xref="S2.SS3.p3.10.m6.3.3.3.3.3.2">ùëä</ci><ci id="S2.SS3.p3.10.m6.3.3.3.3.3.3.cmml" xref="S2.SS3.p3.10.m6.3.3.3.3.3.3">ùëâ</ci></apply></list><apply id="S2.SS3.p3.10.m6.3.3.5.cmml" xref="S2.SS3.p3.10.m6.3.3.5"><csymbol cd="ambiguous" id="S2.SS3.p3.10.m6.3.3.5.1.cmml" xref="S2.SS3.p3.10.m6.3.3.5">superscript</csymbol><ci id="S2.SS3.p3.10.m6.3.3.5.2.cmml" xref="S2.SS3.p3.10.m6.3.3.5.2">‚Ñù</ci><apply id="S2.SS3.p3.10.m6.3.3.5.3.cmml" xref="S2.SS3.p3.10.m6.3.3.5.3"><times id="S2.SS3.p3.10.m6.3.3.5.3.1.cmml" xref="S2.SS3.p3.10.m6.3.3.5.3.1"></times><ci id="S2.SS3.p3.10.m6.3.3.5.3.2.cmml" xref="S2.SS3.p3.10.m6.3.3.5.3.2">d</ci><ci id="S2.SS3.p3.10.m6.3.3.5.3.3.cmml" xref="S2.SS3.p3.10.m6.3.3.5.3.3">d</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.10.m6.3c">W^{Q},W^{K},W^{V}\in\mathbb{R}^{\mathrm{d}\times\mathrm{d}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.10.m6.3d">italic_W start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT ‚àà roman_‚Ñù start_POSTSUPERSCRIPT roman_d √ó roman_d end_POSTSUPERSCRIPT</annotation></semantics></math>. It is worth noting that the retrieved attention key-value pairs in cached memory are distinct to each token.

</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We evaluate our proposed <span class="ltx_text ltx_font_smallcaps" id="S3.p1.1.1">LongMem</span> model on different tasks based on the demanded in-memory long-contexts:
a) long-text language modeling and language understanding when loading the past long-context into cached memory;
b) infinite-length in-context learning when loading large number of demonstration examples into cached memory.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Training Setup</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p1.1.1">Batchfying the training corpora. </span> The conventional batchyfing process for large corpora truncates the whole corpora into consecutive fix-length text segments without padding and shuffles all segments to construct mini-batches¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib18" title=""><span class="ltx_text" style="font-size:90%;">18</span></a>]</cite>. In contrast, <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p1.1.2">LongMem</span> must disable global shuffling and ensure the global causality at segment level. Firstly, we divide all long documents in training corpora into batch-size number of document groups with equivalent length and then perform a document-level shuffling within each group. Then, we concatenate shuffled documents within one group and truncate them into ordered segments. In order to ensure that two consecutive segments of one long document are distributed in two consecutive input batches after batchfying, we select one segment from batch-size number of document groups with the same inner-group index. Thus a mini-batch with batch-size number of segments are constructed from exactly batch-size number of document groups. In this way, as the training iteration steps, the cached attention key-value pairs in memory bank are exactly previous context of current inputs within the same document. The batchfying process is illustrated in Figure¬†<a class="ltx_ref" href="#S3.F3" title="Figure 3 ‚Ä£ 3.1 Training Setup ‚Ä£ 3 Experiments ‚Ä£ Augmenting Language Models with Long-Term Memory"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="320" id="S3.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Batchfying the large text corpora into batches to ensure that each consecutive segments within each document is distributed in consecutive batches.
</figcaption>
</figure>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.6"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.6.1">Training Corpus and Hyperparameters.</span> We sample a subset of the Pile¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib7" title=""><span class="ltx_text" style="font-size:90%;">7</span></a>]</cite> as the training corpus, including BookCorpus2, Books3, OpenWebText2, Stack Exchange, Wikipedia, Gutenberg (PG-19), NIH ExPorter, and Pile-CC datasets. We reproduce GPT-2 (407M-params) as the pre-trained backbone LLM with Alibi¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib13" title=""><span class="ltx_text" style="font-size:90%;">13</span></a>]</cite> position embedding because original GPT-2¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib18" title=""><span class="ltx_text" style="font-size:90%;">18</span></a>]</cite> adopts absolute position embedding, which is found to perform poorly to enable LLM to learn long-distance dependencies¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib6" title=""><span class="ltx_text" style="font-size:90%;">6</span></a>]</cite>. The backbone LLM holds a <math alttext="L^{\prime}=24,H=16,d=64" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.2"><semantics id="S3.SS1.p2.1.m1.2a"><mrow id="S3.SS1.p2.1.m1.2.2.2" xref="S3.SS1.p2.1.m1.2.2.3.cmml"><mrow id="S3.SS1.p2.1.m1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.cmml"><msup id="S3.SS1.p2.1.m1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.2.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.2.2" xref="S3.SS1.p2.1.m1.1.1.1.1.2.2.cmml">L</mi><mo id="S3.SS1.p2.1.m1.1.1.1.1.2.3" xref="S3.SS1.p2.1.m1.1.1.1.1.2.3.cmml">‚Ä≤</mo></msup><mo id="S3.SS1.p2.1.m1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S3.SS1.p2.1.m1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.3.cmml">24</mn></mrow><mo id="S3.SS1.p2.1.m1.2.2.2.3" xref="S3.SS1.p2.1.m1.2.2.3a.cmml">,</mo><mrow id="S3.SS1.p2.1.m1.2.2.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.2.3.cmml"><mrow id="S3.SS1.p2.1.m1.2.2.2.2.1.1" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.cmml"><mi id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.cmml">H</mi><mo id="S3.SS1.p2.1.m1.2.2.2.2.1.1.1" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.1.cmml">=</mo><mn id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.cmml">16</mn></mrow><mo id="S3.SS1.p2.1.m1.2.2.2.2.2.3" xref="S3.SS1.p2.1.m1.2.2.2.2.3a.cmml">,</mo><mrow id="S3.SS1.p2.1.m1.2.2.2.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.2.2.2.cmml"><mi id="S3.SS1.p2.1.m1.2.2.2.2.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.2.2.2.2.cmml">d</mi><mo id="S3.SS1.p2.1.m1.2.2.2.2.2.2.1" xref="S3.SS1.p2.1.m1.2.2.2.2.2.2.1.cmml">=</mo><mn id="S3.SS1.p2.1.m1.2.2.2.2.2.2.3" xref="S3.SS1.p2.1.m1.2.2.2.2.2.2.3.cmml">64</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.2b"><apply id="S3.SS1.p2.1.m1.2.2.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.2.2.3a.cmml" xref="S3.SS1.p2.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p2.1.m1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1"><eq id="S3.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1"></eq><apply id="S3.SS1.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.2.2">ùêø</ci><ci id="S3.SS1.p2.1.m1.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.2.3">‚Ä≤</ci></apply><cn id="S3.SS1.p2.1.m1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.1.m1.1.1.1.1.3">24</cn></apply><apply id="S3.SS1.p2.1.m1.2.2.2.2.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.2.2.2.2.3a.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p2.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1"><eq id="S3.SS1.p2.1.m1.2.2.2.2.1.1.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.1"></eq><ci id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2">ùêª</ci><cn id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.cmml" type="integer" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3">16</cn></apply><apply id="S3.SS1.p2.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2.2"><eq id="S3.SS1.p2.1.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2.2.1"></eq><ci id="S3.SS1.p2.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2.2.2">ùëë</ci><cn id="S3.SS1.p2.1.m1.2.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS1.p2.1.m1.2.2.2.2.2.2.3">64</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.2c">L^{\prime}=24,H=16,d=64</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.2d">italic_L start_POSTSUPERSCRIPT ‚Ä≤ end_POSTSUPERSCRIPT = 24 , italic_H = 16 , italic_d = 64</annotation></semantics></math> architecture. The SideNet holds a <math alttext="L=12,H=16,d=64" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.2"><semantics id="S3.SS1.p2.2.m2.2a"><mrow id="S3.SS1.p2.2.m2.2.2.2" xref="S3.SS1.p2.2.m2.2.2.3.cmml"><mrow id="S3.SS1.p2.2.m2.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.2.cmml">L</mi><mo id="S3.SS1.p2.2.m2.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml">=</mo><mn id="S3.SS1.p2.2.m2.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.3.cmml">12</mn></mrow><mo id="S3.SS1.p2.2.m2.2.2.2.3" xref="S3.SS1.p2.2.m2.2.2.3a.cmml">,</mo><mrow id="S3.SS1.p2.2.m2.2.2.2.2.2" xref="S3.SS1.p2.2.m2.2.2.2.2.3.cmml"><mrow id="S3.SS1.p2.2.m2.2.2.2.2.1.1" xref="S3.SS1.p2.2.m2.2.2.2.2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.2.2.2.2.1.1.2" xref="S3.SS1.p2.2.m2.2.2.2.2.1.1.2.cmml">H</mi><mo id="S3.SS1.p2.2.m2.2.2.2.2.1.1.1" xref="S3.SS1.p2.2.m2.2.2.2.2.1.1.1.cmml">=</mo><mn id="S3.SS1.p2.2.m2.2.2.2.2.1.1.3" xref="S3.SS1.p2.2.m2.2.2.2.2.1.1.3.cmml">16</mn></mrow><mo id="S3.SS1.p2.2.m2.2.2.2.2.2.3" xref="S3.SS1.p2.2.m2.2.2.2.2.3a.cmml">,</mo><mrow id="S3.SS1.p2.2.m2.2.2.2.2.2.2" xref="S3.SS1.p2.2.m2.2.2.2.2.2.2.cmml"><mi id="S3.SS1.p2.2.m2.2.2.2.2.2.2.2" xref="S3.SS1.p2.2.m2.2.2.2.2.2.2.2.cmml">d</mi><mo id="S3.SS1.p2.2.m2.2.2.2.2.2.2.1" xref="S3.SS1.p2.2.m2.2.2.2.2.2.2.1.cmml">=</mo><mn id="S3.SS1.p2.2.m2.2.2.2.2.2.2.3" xref="S3.SS1.p2.2.m2.2.2.2.2.2.2.3.cmml">64</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.2b"><apply id="S3.SS1.p2.2.m2.2.2.3.cmml" xref="S3.SS1.p2.2.m2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.2.2.3a.cmml" xref="S3.SS1.p2.2.m2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p2.2.m2.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1"><eq id="S3.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1"></eq><ci id="S3.SS1.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.2">ùêø</ci><cn id="S3.SS1.p2.2.m2.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.1.1.1.1.3">12</cn></apply><apply id="S3.SS1.p2.2.m2.2.2.2.2.3.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.2.2.2.2.3a.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p2.2.m2.2.2.2.2.1.1.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.1.1"><eq id="S3.SS1.p2.2.m2.2.2.2.2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.1.1.1"></eq><ci id="S3.SS1.p2.2.m2.2.2.2.2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.1.1.2">ùêª</ci><cn id="S3.SS1.p2.2.m2.2.2.2.2.1.1.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.2.2.2.2.1.1.3">16</cn></apply><apply id="S3.SS1.p2.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.2.2"><eq id="S3.SS1.p2.2.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.2.2.1"></eq><ci id="S3.SS1.p2.2.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.2.2.2">ùëë</ci><cn id="S3.SS1.p2.2.m2.2.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.2.2.2.2.2.2.3">64</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.2c">L=12,H=16,d=64</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.2d">italic_L = 12 , italic_H = 16 , italic_d = 64</annotation></semantics></math> architecture. The training for memory-augmented adaptation iterates on 26B tokens, with a global 256 batch-size and 1024 sequence length. The chunk-size <math alttext="csz" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">c</mi><mo id="S3.SS1.p2.3.m3.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.cmml">‚Å¢</mo><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">s</mi><mo id="S3.SS1.p2.3.m3.1.1.1a" xref="S3.SS1.p2.3.m3.1.1.1.cmml">‚Å¢</mo><mi id="S3.SS1.p2.3.m3.1.1.4" xref="S3.SS1.p2.3.m3.1.1.4.cmml">z</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><times id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1"></times><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">ùëê</ci><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">ùë†</ci><ci id="S3.SS1.p2.3.m3.1.1.4.cmml" xref="S3.SS1.p2.3.m3.1.1.4">ùëß</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">csz</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_c italic_s italic_z</annotation></semantics></math> is 4 tokens and the memory size <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">ùëÄ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_M</annotation></semantics></math> is 65k key-value pairs of tokens. For each token, we retrieve <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">ùêæ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_K</annotation></semantics></math>=64 attention key-value pairs for augmentation, which are <math alttext="K/csz" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><mrow id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mrow id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml"><mi id="S3.SS1.p2.6.m6.1.1.2.2" xref="S3.SS1.p2.6.m6.1.1.2.2.cmml">K</mi><mo id="S3.SS1.p2.6.m6.1.1.2.1" xref="S3.SS1.p2.6.m6.1.1.2.1.cmml">/</mo><mi id="S3.SS1.p2.6.m6.1.1.2.3" xref="S3.SS1.p2.6.m6.1.1.2.3.cmml">c</mi></mrow><mo id="S3.SS1.p2.6.m6.1.1.1" xref="S3.SS1.p2.6.m6.1.1.1.cmml">‚Å¢</mo><mi id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml">s</mi><mo id="S3.SS1.p2.6.m6.1.1.1a" xref="S3.SS1.p2.6.m6.1.1.1.cmml">‚Å¢</mo><mi id="S3.SS1.p2.6.m6.1.1.4" xref="S3.SS1.p2.6.m6.1.1.4.cmml">z</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><times id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1.1"></times><apply id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2"><divide id="S3.SS1.p2.6.m6.1.1.2.1.cmml" xref="S3.SS1.p2.6.m6.1.1.2.1"></divide><ci id="S3.SS1.p2.6.m6.1.1.2.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2.2">ùêæ</ci><ci id="S3.SS1.p2.6.m6.1.1.2.3.cmml" xref="S3.SS1.p2.6.m6.1.1.2.3">ùëê</ci></apply><ci id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3">ùë†</ci><ci id="S3.SS1.p2.6.m6.1.1.4.cmml" xref="S3.SS1.p2.6.m6.1.1.4">ùëß</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">K/csz</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">italic_K / italic_c italic_s italic_z</annotation></semantics></math>=16 text chunks. The memory-augmentation layer is the 9-th layer of SideNet. The attention keys and values from 18-th layer of backbone LLM is cached into memory and used for future retrieval. Other training details are presented in Appendix C.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p3.1.1">Memory Retrieval Module.</span> The fixed memory-size of cached memory bank in one GPU is 65536 key-value pairs of tokens. We enable each GPU to construct and update their own memory retrieval module for efficiency. For the implementation of the efficient token-to-chunk retrieval, we use the <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p3.1.2">faiss</span>¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib8" title=""><span class="ltx_text" style="font-size:90%;">8</span></a>]</cite> toolkit to construct an exact-search index on GPU to store the mean-pooled attention keys of text chunks and perform efficient retrieval. The <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p3.1.3">faiss</span> index maintains a fixed <math alttext="M/csz" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mrow id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2.2" xref="S3.SS1.p3.1.m1.1.1.2.2.cmml">M</mi><mo id="S3.SS1.p3.1.m1.1.1.2.1" xref="S3.SS1.p3.1.m1.1.1.2.1.cmml">/</mo><mi id="S3.SS1.p3.1.m1.1.1.2.3" xref="S3.SS1.p3.1.m1.1.1.2.3.cmml">c</mi></mrow><mo id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">‚Å¢</mo><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">s</mi><mo id="S3.SS1.p3.1.m1.1.1.1a" xref="S3.SS1.p3.1.m1.1.1.1.cmml">‚Å¢</mo><mi id="S3.SS1.p3.1.m1.1.1.4" xref="S3.SS1.p3.1.m1.1.1.4.cmml">z</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><times id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1"></times><apply id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2"><divide id="S3.SS1.p3.1.m1.1.1.2.1.cmml" xref="S3.SS1.p3.1.m1.1.1.2.1"></divide><ci id="S3.SS1.p3.1.m1.1.1.2.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2.2">ùëÄ</ci><ci id="S3.SS1.p3.1.m1.1.1.2.3.cmml" xref="S3.SS1.p3.1.m1.1.1.2.3">ùëê</ci></apply><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">ùë†</ci><ci id="S3.SS1.p3.1.m1.1.1.4.cmml" xref="S3.SS1.p3.1.m1.1.1.4">ùëß</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">M/csz</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_M / italic_c italic_s italic_z</annotation></semantics></math> keys and provides the efficient exact search w.r.t. inner product. The retrieval takes about 15ms per 1k tokens, which is 55% timecost of backbone LLM forwarding pass. We can easily adapt the exact search index to approximate search index to gain more the retrieval efficiency.</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p4.1.1">Baselines.</span> In addition to the baseline of pre-trained GPT-2*, we reproduce Memorizing Transformer (MemTRM)¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib27" title=""><span class="ltx_text" style="font-size:90%;">27</span></a>]</cite> as another memory-augmented adaptation baseline. The MemTRM can be easily adapted to tune a pre-trained LLM to use external memory. We insert the knn-augmented layer proposed by MemTRM as the same 18-th layer in the LLM decoder. The MemTRM baseline is also trained for the same number of tokens under the same hyperparameter setting.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.1" style="width:238.6pt;height:90pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1.0,1.0) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt ltx_border_t" id="S3.T1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.1.1" style="font-size:90%;">Dataset</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt ltx_border_t" colspan="5" id="S3.T1.1.1.1.1.2">
<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.2.1" style="font-size:90%;">PG-22</span><span class="ltx_text" id="S3.T1.1.1.1.1.2.2" style="font-size:90%;"></span>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="S3.T1.1.1.1.1.3" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.3.1" style="font-size:90%;">ArXiv</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.2.1.1" style="font-size:90%;">Splits</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.2.2.2"><span class="ltx_text" id="S3.T1.1.1.2.2.2.1" style="font-size:90%;">S1</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.2.2.3"><span class="ltx_text" id="S3.T1.1.1.2.2.3.1" style="font-size:90%;">S2</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.2.2.4"><span class="ltx_text" id="S3.T1.1.1.2.2.4.1" style="font-size:90%;">S3</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.2.2.5"><span class="ltx_text" id="S3.T1.1.1.2.2.5.1" style="font-size:90%;">S4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.1.2.2.6"><span class="ltx_text" id="S3.T1.1.1.2.2.6.1" style="font-size:90%;">S5</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.1.3.3.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.3.3.1.1" style="font-size:90%;">Len. Range</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.3.3.2"><span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.3.3.2.1" style="font-size:90%;">5k-10k</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.3.3.3"><span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.3.3.3.1" style="font-size:90%;">10k-100k</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.3.3.4"><span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.3.3.4.1" style="font-size:90%;">100k-500k</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.3.3.5"><span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.3.3.5.1" style="font-size:90%;">500k-1M</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.1.3.3.6"><span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.3.3.6.1" style="font-size:90%;">&gt;1M</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.3.3.7"><span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.3.3.7.1" style="font-size:90%;">&lt;60k</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.4.4.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.4.4.1.1" style="font-size:90%;">#Documents</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.4.2"><span class="ltx_text" id="S3.T1.1.1.4.4.2.1" style="font-size:90%;">500</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.4.3"><span class="ltx_text" id="S3.T1.1.1.4.4.3.1" style="font-size:90%;">100</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.4.4"><span class="ltx_text" id="S3.T1.1.1.4.4.4.1" style="font-size:90%;">30</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.4.5"><span class="ltx_text" id="S3.T1.1.1.4.4.5.1" style="font-size:90%;">8</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.1.4.4.6"><span class="ltx_text" id="S3.T1.1.1.4.4.6.1" style="font-size:90%;">1</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.4.7"><span class="ltx_text" id="S3.T1.1.1.4.4.7.1" style="font-size:90%;">100</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_b ltx_border_r" id="S3.T1.1.1.5.5.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.5.5.1.1" style="font-size:90%;">Avg. #tokens</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S3.T1.1.1.5.5.2"><span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.5.5.2.1" style="font-size:90%;">7.6k</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S3.T1.1.1.5.5.3"><span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.5.5.3.1" style="font-size:90%;">47.6k</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S3.T1.1.1.5.5.4"><span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.5.5.4.1" style="font-size:90%;">140k</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S3.T1.1.1.5.5.5"><span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.5.5.5.1" style="font-size:90%;">640k</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_r" id="S3.T1.1.1.5.5.6"><span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.5.5.6.1" style="font-size:90%;">1.2M</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S3.T1.1.1.5.5.7"><span class="ltx_text ltx_font_smallcaps" id="S3.T1.1.1.5.5.7.1" style="font-size:90%;">15.4k</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>Dataset Statistics of five splits of PG-22 based on length range and ArXiv.
</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Long-Context Language Modeling</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">The long-context language modeling can easily benefit from the augmented decoupled memory of past long-contexts, in which the knowledge stored in retrieved attention key-values can play a useful role in providing significant background and contextual information to help models perform better on long-context language modeling. For instance, when trying to model a long-text book accurately, acquiring knowledge from previous background and character relationships can be helpful to model the consequent stories.
</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.1">Evaluation Setting.</span>
We first compare <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p2.1.2">LongMem</span> and baselines on 3 long-context modeling datasets, <span class="ltx_text ltx_font_italic" id="S3.SS2.p2.1.3">Project Gutenberg 2020-2022</span>, <span class="ltx_text ltx_font_italic" id="S3.SS2.p2.1.4">ArXiv</span>, and <span class="ltx_text ltx_font_italic" id="S3.SS2.p2.1.5">ChapterBreak</span>. The majority of included books or papers in these datasets have the length of at least 16k tokens. All listed datasets are evaluated in <span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.6">zero-shot</span> manner without any task-specific tuning. The detailed evaluation settings on 3 datasets are as follows:</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">‚Ä¢</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.1.1">Project Gutenberg 2020-2022 Language Modeling Dataset.</span> We crawled and cleaned the books published between 2020 and 2022 under Project Gutenberg Library<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://www.gutenberg.org/</span></span></span> to build up a completely new long-text modeling dataset, named <span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.1.2">PG-22</span>. It is highly differentiated from our training subset PG-19 in domains and writing styles, because books in PG-19¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib15" title=""><span class="ltx_text" style="font-size:90%;">15</span></a>]</cite> are published before 1919. We provide different validation splits of PG-22 based on length range, and data statistics are presented in Table¬†<a class="ltx_ref" href="#S3.T1" title="Table 1 ‚Ä£ 3.1 Training Setup ‚Ä£ 3 Experiments ‚Ä£ Augmenting Language Models with Long-Term Memory"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">‚Ä¢</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.1.1">ArXiv Dataset.</span> <span class="ltx_text ltx_font_typewriter" id="S3.I1.i2.p1.1.2">ArXiv</span> dataset involves papers in the areas of Math, Computer Science, and Physics. We select a validation split of <span class="ltx_text ltx_font_typewriter" id="S3.I1.i2.p1.1.3">ArXiv</span> paper subset in the Pile corpus¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib7" title=""><span class="ltx_text" style="font-size:90%;">7</span></a>]</cite>. <span class="ltx_text ltx_font_typewriter" id="S3.I1.i2.p1.1.4">ArXiv</span> subset of the Pile is excluded from our training and is an out-of-distribution dataset. We report the token-level language modeling perplexity on the long-context language modeling benchmarks of PG-22 and ArXiv.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">‚Ä¢</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i3.p1.1.1">ChapterBreak Benchmark.</span> <span class="ltx_text ltx_font_typewriter" id="S3.I1.i3.p1.1.2">ChapterBreak</span> is proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib.bib23" title=""><span class="ltx_text" style="font-size:90%;">23</span></a>]</cite> as a challenging suffix identification dataset that requires LLMs to distinguish the beginning of the ground-truth next chapter from a set of hard negative segments sampled from the same book, given the long context of previous chapters. <span class="ltx_text ltx_font_typewriter" id="S3.I1.i3.p1.1.3">ChapterBreak</span> requires processing global long-context to comprehend and identify the correct suffix. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib.bib23" title=""><span class="ltx_text" style="font-size:90%;">23</span></a>]</cite> demonstrated that even state-of-the-art x-formers for long-text processing fail to effectively leverage long-range context to perform well on <span class="ltx_text ltx_font_typewriter" id="S3.I1.i3.p1.1.4">ChapterBreak</span>. We select the Archive of Our Own (AO3) subset of <span class="ltx_text ltx_font_typewriter" id="S3.I1.i3.p1.1.5">ChapterBreak</span> which contains fan-fictions extracted from AO3. <span class="ltx_text ltx_font_typewriter" id="S3.I1.i3.p1.1.6">ChapterBreak</span> provides 8 splits based on the prefix length from 0.5k to 8k tokens to fit the length limit of different models. The splits of 4k, 6k, and 8k prefix are selected for evaluation. For LLMs that cannot process over 4k tokens, we abandon the front prefix to fulfill the maximum input length of LLMs. For MemTRM and <span class="ltx_text ltx_font_smallcaps" id="S3.I1.i3.p1.1.7">LongMem</span> model, we firstly load the given 4k/6k/8k prefix contexts into the cached memory and then do the scoring. we use the perplexity as the scorer for each candidate suffix segment in zero-shot evaluation manner. Then the suffix segment with lower perplexity is selected as the label. The suffix identification accuracy is used as the evaluation metric.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="S3.T2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T2.1" style="width:291.0pt;height:83.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-11.0pt,3.1pt) scale(0.93,0.93) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T2.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="S3.T2.1.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.1.1" style="font-size:90%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="S3.T2.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.2.1" style="font-size:90%;">In-Context</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_border_t" id="S3.T2.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.3.1" style="font-size:90%;">In-Memory</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_border_t" colspan="5" id="S3.T2.1.1.1.1.4">
<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.4.1" style="font-size:90%;">PG-22</span><span class="ltx_text" id="S3.T2.1.1.1.1.4.2" style="font-size:90%;"></span>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="S3.T2.1.1.1.1.5" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.5.1" style="font-size:90%;">ArXiv</span></th>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.1.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.2.2.1.1" style="font-size:90%;">Len.</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T2.1.1.2.2.2"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.2.2.2.1" style="font-size:90%;">Len.</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.1.1.2.2.3"><span class="ltx_text ltx_font_smallcaps" id="S3.T2.1.1.2.2.3.1" style="font-size:90%;">5k-10k</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.1.1.2.2.4"><span class="ltx_text ltx_font_smallcaps" id="S3.T2.1.1.2.2.4.1" style="font-size:90%;">10k-100k</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.1.1.2.2.5"><span class="ltx_text ltx_font_smallcaps" id="S3.T2.1.1.2.2.5.1" style="font-size:90%;">100k-500k</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.1.1.2.2.6"><span class="ltx_text ltx_font_smallcaps" id="S3.T2.1.1.2.2.6.1" style="font-size:90%;">500k-1M</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S3.T2.1.1.2.2.7"><span class="ltx_text ltx_font_smallcaps" id="S3.T2.1.1.2.2.7.1" style="font-size:90%;">&gt;1M</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.1.3.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.1.3.1.1"><span class="ltx_text" id="S3.T2.1.1.3.1.1.1" style="font-size:90%;">GPT-2*</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.3.1.2"><span class="ltx_text" id="S3.T2.1.1.3.1.2.1" style="font-size:90%;">1k</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.1.3.1.3"><span class="ltx_text" id="S3.T2.1.1.3.1.3.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.3.1.4"><span class="ltx_text" id="S3.T2.1.1.3.1.4.1" style="font-size:90%;">22.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.3.1.5"><span class="ltx_text" id="S3.T2.1.1.3.1.5.1" style="font-size:90%;">24.39</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.3.1.6"><span class="ltx_text" id="S3.T2.1.1.3.1.6.1" style="font-size:90%;">24.12</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.3.1.7"><span class="ltx_text" id="S3.T2.1.1.3.1.7.1" style="font-size:90%;">24.97</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.1.3.1.8"><span class="ltx_text" id="S3.T2.1.1.3.1.8.1" style="font-size:90%;">18.07</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.3.1.9"><span class="ltx_text" id="S3.T2.1.1.3.1.9.1" style="font-size:90%;">11.05</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.4.2">
<td class="ltx_td ltx_align_left" id="S3.T2.1.1.4.2.1"><span class="ltx_text" id="S3.T2.1.1.4.2.1.1" style="font-size:90%;">MemTRM</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.4.2.2"><span class="ltx_text" id="S3.T2.1.1.4.2.2.1" style="font-size:90%;">1k</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.4.2.3"><span class="ltx_text" id="S3.T2.1.1.4.2.3.1" style="font-size:90%;">65K</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.4.2.4"><span class="ltx_text" id="S3.T2.1.1.4.2.4.1" style="font-size:90%;">21.77</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.4.2.5"><span class="ltx_text" id="S3.T2.1.1.4.2.5.1" style="font-size:90%;">23.56</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.4.2.6"><span class="ltx_text" id="S3.T2.1.1.4.2.6.1" style="font-size:90%;">23.23</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.4.2.7"><span class="ltx_text" id="S3.T2.1.1.4.2.7.1" style="font-size:90%;">24.16</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.1.1.4.2.8"><span class="ltx_text" id="S3.T2.1.1.4.2.8.1" style="font-size:90%;">17.39</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.1.4.2.9"><span class="ltx_text" id="S3.T2.1.1.4.2.9.1" style="font-size:90%;">10.81</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.1.5.3">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_b ltx_border_t" id="S3.T2.1.1.5.3.1"><span class="ltx_text ltx_font_smallcaps" id="S3.T2.1.1.5.3.1.1" style="font-size:90%;">LongMem</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" id="S3.T2.1.1.5.3.2"><span class="ltx_text" id="S3.T2.1.1.5.3.2.1" style="font-size:90%;">1k</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_r ltx_border_t" id="S3.T2.1.1.5.3.3"><span class="ltx_text" id="S3.T2.1.1.5.3.3.1" style="font-size:90%;">65k</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" id="S3.T2.1.1.5.3.4"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.5.3.4.1" style="font-size:90%;">21.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" id="S3.T2.1.1.5.3.5"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.5.3.5.1" style="font-size:90%;">23.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" id="S3.T2.1.1.5.3.6"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.5.3.6.1" style="font-size:90%;">22.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" id="S3.T2.1.1.5.3.7"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.5.3.7.1" style="font-size:90%;">23.35</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_r ltx_border_t" id="S3.T2.1.1.5.3.8"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.5.3.8.1" style="font-size:90%;">16.71</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" id="S3.T2.1.1.5.3.9"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.5.3.9.1" style="font-size:90%;">10.05</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 2: </span>Evaluation results on long-context language modeling datasets. We report token-level perplexity (PPL) (lower the better) on all datasets.
</figcaption>
</figure>
<figure class="ltx_table" id="S3.T3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T3.8" style="width:335.8pt;height:172.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-7.0pt,3.6pt) scale(0.96,0.96) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T3.8.8">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T3.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt ltx_border_t" id="S3.T3.1.1.1.2" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.2.1" style="font-size:90%;">Model</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="S3.T3.1.1.1.3" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.3.1" style="font-size:90%;">#Params</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="S3.T3.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.4.1" style="font-size:90%;">In-Context</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="S3.T3.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.5.1" style="font-size:90%;">In-Memory</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" colspan="3" id="S3.T3.1.1.1.1">
<span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.1.1" style="font-size:90%;">ChapterBreak<math alttext="{}_{\textbf{ao3}}" class="ltx_Math" display="inline" id="S3.T3.1.1.1.1.1.m1.1"><semantics id="S3.T3.1.1.1.1.1.m1.1a"><msub id="S3.T3.1.1.1.1.1.m1.1.1" xref="S3.T3.1.1.1.1.1.m1.1.1.cmml"><mi id="S3.T3.1.1.1.1.1.m1.1.1a" xref="S3.T3.1.1.1.1.1.m1.1.1.cmml"></mi><mtext id="S3.T3.1.1.1.1.1.m1.1.1.1" xref="S3.T3.1.1.1.1.1.m1.1.1.1a.cmml">ùêöùê®ùüë</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.T3.1.1.1.1.1.m1.1b"><apply id="S3.T3.1.1.1.1.1.m1.1.1.cmml" xref="S3.T3.1.1.1.1.1.m1.1.1"><ci id="S3.T3.1.1.1.1.1.m1.1.1.1a.cmml" xref="S3.T3.1.1.1.1.1.m1.1.1.1"><mtext id="S3.T3.1.1.1.1.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.T3.1.1.1.1.1.m1.1.1.1">ùêöùê®ùüë</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.1.1.1.1.1.m1.1c">{}_{\textbf{ao3}}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.1.1.1.1.1.m1.1d">start_FLOATSUBSCRIPT ao3 end_FLOATSUBSCRIPT</annotation></semantics></math></span><span class="ltx_text" id="S3.T3.1.1.1.1.2" style="font-size:90%;"></span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.8.8.9.1">
<td class="ltx_td ltx_align_center" id="S3.T3.8.8.9.1.1"><span class="ltx_text ltx_font_bold" id="S3.T3.8.8.9.1.1.1" style="font-size:90%;">Len.</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.8.8.9.1.2"><span class="ltx_text ltx_font_bold" id="S3.T3.8.8.9.1.2.1" style="font-size:90%;">Len.</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.8.8.9.1.3"><span class="ltx_text ltx_font_bold" id="S3.T3.8.8.9.1.3.1" style="font-size:90%;">ctx-4k</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.8.8.9.1.4"><span class="ltx_text ltx_font_bold" id="S3.T3.8.8.9.1.4.1" style="font-size:90%;">ctx-6k</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.8.8.9.1.5"><span class="ltx_text ltx_font_bold" id="S3.T3.8.8.9.1.5.1" style="font-size:90%;">ctx-8k</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T3.2.2.2.1">
<span class="ltx_text" id="S3.T3.2.2.2.1.1" style="font-size:90%;">GPT-2-XL</span><math alttext="{}^{\dagger}" class="ltx_Math" display="inline" id="S3.T3.2.2.2.1.m1.1"><semantics id="S3.T3.2.2.2.1.m1.1a"><msup id="S3.T3.2.2.2.1.m1.1.1" xref="S3.T3.2.2.2.1.m1.1.1.cmml"><mi id="S3.T3.2.2.2.1.m1.1.1a" xref="S3.T3.2.2.2.1.m1.1.1.cmml"></mi><mo id="S3.T3.2.2.2.1.m1.1.1.1" mathsize="90%" xref="S3.T3.2.2.2.1.m1.1.1.1.cmml">‚Ä†</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T3.2.2.2.1.m1.1b"><apply id="S3.T3.2.2.2.1.m1.1.1.cmml" xref="S3.T3.2.2.2.1.m1.1.1"><ci id="S3.T3.2.2.2.1.m1.1.1.1.cmml" xref="S3.T3.2.2.2.1.m1.1.1.1">‚Ä†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.2.2.2.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.2.2.2.1.m1.1d">start_FLOATSUPERSCRIPT ‚Ä† end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="S3.T3.2.2.2.1.2" style="font-size:90%;">¬†</span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S3.T3.2.2.2.1.3.1" style="font-size:90%;">[</span><a class="ltx_ref" href="#bib.bib18" title=""><span class="ltx_text" style="font-size:90%;">18</span></a><span class="ltx_text" id="S3.T3.2.2.2.1.4.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.2.2.2.2"><span class="ltx_text" id="S3.T3.2.2.2.2.1" style="font-size:90%;">1.5B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.2.2.2.3"><span class="ltx_text" id="S3.T3.2.2.2.3.1" style="font-size:90%;">1K</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.2.2.2.4"><span class="ltx_text" id="S3.T3.2.2.2.4.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.2.2.2.5"><span class="ltx_text" id="S3.T3.2.2.2.5.1" style="font-size:90%;">24%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.2.2.2.6"><span class="ltx_text" id="S3.T3.2.2.2.6.1" style="font-size:90%;">24%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.2.2.2.7"><span class="ltx_text" id="S3.T3.2.2.2.7.1" style="font-size:90%;">24%</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T3.3.3.3.1">
<span class="ltx_text" id="S3.T3.3.3.3.1.1" style="font-size:90%;">GPT-3</span><math alttext="{}^{\dagger}" class="ltx_Math" display="inline" id="S3.T3.3.3.3.1.m1.1"><semantics id="S3.T3.3.3.3.1.m1.1a"><msup id="S3.T3.3.3.3.1.m1.1.1" xref="S3.T3.3.3.3.1.m1.1.1.cmml"><mi id="S3.T3.3.3.3.1.m1.1.1a" xref="S3.T3.3.3.3.1.m1.1.1.cmml"></mi><mo id="S3.T3.3.3.3.1.m1.1.1.1" mathsize="90%" xref="S3.T3.3.3.3.1.m1.1.1.1.cmml">‚Ä†</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T3.3.3.3.1.m1.1b"><apply id="S3.T3.3.3.3.1.m1.1.1.cmml" xref="S3.T3.3.3.3.1.m1.1.1"><ci id="S3.T3.3.3.3.1.m1.1.1.1.cmml" xref="S3.T3.3.3.3.1.m1.1.1.1">‚Ä†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.3.3.3.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.3.3.3.1.m1.1d">start_FLOATSUPERSCRIPT ‚Ä† end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="S3.T3.3.3.3.1.2" style="font-size:90%;">¬†</span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S3.T3.3.3.3.1.3.1" style="font-size:90%;">[</span><a class="ltx_ref" href="#bib.bib3" title=""><span class="ltx_text" style="font-size:90%;">3</span></a><span class="ltx_text" id="S3.T3.3.3.3.1.4.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T3.3.3.3.2"><span class="ltx_text" id="S3.T3.3.3.3.2.1" style="font-size:90%;">175B</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.3.3.3.3"><span class="ltx_text" id="S3.T3.3.3.3.3.1" style="font-size:90%;">2K</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.3.3.3.4"><span class="ltx_text" id="S3.T3.3.3.3.4.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.3.3.3.5"><span class="ltx_text" id="S3.T3.3.3.3.5.1" style="font-size:90%;">28%</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.3.3.3.6"><span class="ltx_text" id="S3.T3.3.3.3.6.1" style="font-size:90%;">28%</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.3.3.3.7"><span class="ltx_text" id="S3.T3.3.3.3.7.1" style="font-size:90%;">28%</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T3.4.4.4.1">
<span class="ltx_text" id="S3.T3.4.4.4.1.1" style="font-size:90%;">LocalTRM</span><math alttext="{}^{\dagger}" class="ltx_Math" display="inline" id="S3.T3.4.4.4.1.m1.1"><semantics id="S3.T3.4.4.4.1.m1.1a"><msup id="S3.T3.4.4.4.1.m1.1.1" xref="S3.T3.4.4.4.1.m1.1.1.cmml"><mi id="S3.T3.4.4.4.1.m1.1.1a" xref="S3.T3.4.4.4.1.m1.1.1.cmml"></mi><mo id="S3.T3.4.4.4.1.m1.1.1.1" mathsize="90%" xref="S3.T3.4.4.4.1.m1.1.1.1.cmml">‚Ä†</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T3.4.4.4.1.m1.1b"><apply id="S3.T3.4.4.4.1.m1.1.1.cmml" xref="S3.T3.4.4.4.1.m1.1.1"><ci id="S3.T3.4.4.4.1.m1.1.1.1.cmml" xref="S3.T3.4.4.4.1.m1.1.1.1">‚Ä†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.4.4.4.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.4.4.4.1.m1.1d">start_FLOATSUPERSCRIPT ‚Ä† end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="S3.T3.4.4.4.1.2" style="font-size:90%;">¬†</span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S3.T3.4.4.4.1.3.1" style="font-size:90%;">[</span><a class="ltx_ref" href="#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a><span class="ltx_text" id="S3.T3.4.4.4.1.4.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T3.4.4.4.2"><span class="ltx_text" id="S3.T3.4.4.4.2.1" style="font-size:90%;">516M</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.4.4.3"><span class="ltx_text" id="S3.T3.4.4.4.3.1" style="font-size:90%;">8K</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.4.4.4"><span class="ltx_text" id="S3.T3.4.4.4.4.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.4.4.5"><span class="ltx_text" id="S3.T3.4.4.4.5.1" style="font-size:90%;">24%</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.4.4.6"><span class="ltx_text" id="S3.T3.4.4.4.6.1" style="font-size:90%;">24%</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.4.4.7"><span class="ltx_text" id="S3.T3.4.4.4.7.1" style="font-size:90%;">24%</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.5.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T3.5.5.5.1">
<span class="ltx_text" id="S3.T3.5.5.5.1.1" style="font-size:90%;">RoutTRM</span><math alttext="{}^{\dagger}" class="ltx_Math" display="inline" id="S3.T3.5.5.5.1.m1.1"><semantics id="S3.T3.5.5.5.1.m1.1a"><msup id="S3.T3.5.5.5.1.m1.1.1" xref="S3.T3.5.5.5.1.m1.1.1.cmml"><mi id="S3.T3.5.5.5.1.m1.1.1a" xref="S3.T3.5.5.5.1.m1.1.1.cmml"></mi><mo id="S3.T3.5.5.5.1.m1.1.1.1" mathsize="90%" xref="S3.T3.5.5.5.1.m1.1.1.1.cmml">‚Ä†</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T3.5.5.5.1.m1.1b"><apply id="S3.T3.5.5.5.1.m1.1.1.cmml" xref="S3.T3.5.5.5.1.m1.1.1"><ci id="S3.T3.5.5.5.1.m1.1.1.1.cmml" xref="S3.T3.5.5.5.1.m1.1.1.1">‚Ä†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.5.5.5.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.5.5.5.1.m1.1d">start_FLOATSUPERSCRIPT ‚Ä† end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="S3.T3.5.5.5.1.2" style="font-size:90%;">¬†</span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S3.T3.5.5.5.1.3.1" style="font-size:90%;">[</span><a class="ltx_ref" href="#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a><span class="ltx_text" id="S3.T3.5.5.5.1.4.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T3.5.5.5.2"><span class="ltx_text" id="S3.T3.5.5.5.2.1" style="font-size:90%;">490M</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.5.5.5.3"><span class="ltx_text" id="S3.T3.5.5.5.3.1" style="font-size:90%;">8K</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.5.5.5.4"><span class="ltx_text" id="S3.T3.5.5.5.4.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.5.5.5.5"><span class="ltx_text" id="S3.T3.5.5.5.5.1" style="font-size:90%;">25%</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.5.5.5.6"><span class="ltx_text" id="S3.T3.5.5.5.6.1" style="font-size:90%;">24%</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.5.5.5.7"><span class="ltx_text" id="S3.T3.5.5.5.7.1" style="font-size:90%;">24%</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.6.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T3.6.6.6.1">
<span class="ltx_text" id="S3.T3.6.6.6.1.1" style="font-size:90%;">Bigbird</span><math alttext="{}^{\dagger}" class="ltx_Math" display="inline" id="S3.T3.6.6.6.1.m1.1"><semantics id="S3.T3.6.6.6.1.m1.1a"><msup id="S3.T3.6.6.6.1.m1.1.1" xref="S3.T3.6.6.6.1.m1.1.1.cmml"><mi id="S3.T3.6.6.6.1.m1.1.1a" xref="S3.T3.6.6.6.1.m1.1.1.cmml"></mi><mo id="S3.T3.6.6.6.1.m1.1.1.1" mathsize="90%" xref="S3.T3.6.6.6.1.m1.1.1.1.cmml">‚Ä†</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T3.6.6.6.1.m1.1b"><apply id="S3.T3.6.6.6.1.m1.1.1.cmml" xref="S3.T3.6.6.6.1.m1.1.1"><ci id="S3.T3.6.6.6.1.m1.1.1.1.cmml" xref="S3.T3.6.6.6.1.m1.1.1.1">‚Ä†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.6.6.6.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.6.6.6.1.m1.1d">start_FLOATSUPERSCRIPT ‚Ä† end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="S3.T3.6.6.6.1.2" style="font-size:90%;">¬†</span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="S3.T3.6.6.6.1.3.1" style="font-size:90%;">[</span><a class="ltx_ref" href="#bib.bib33" title=""><span class="ltx_text" style="font-size:90%;">33</span></a><span class="ltx_text" id="S3.T3.6.6.6.1.4.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T3.6.6.6.2"><span class="ltx_text" id="S3.T3.6.6.6.2.1" style="font-size:90%;">128M</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.6.6.6.3"><span class="ltx_text" id="S3.T3.6.6.6.3.1" style="font-size:90%;">4K</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.6.6.6.4"><span class="ltx_text" id="S3.T3.6.6.6.4.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.6.6.6.5"><span class="ltx_text" id="S3.T3.6.6.6.5.1" style="font-size:90%;">26%</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.6.6.6.6"><span class="ltx_text" id="S3.T3.6.6.6.6.1" style="font-size:90%;">26%</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.6.6.6.7"><span class="ltx_text" id="S3.T3.6.6.6.7.1" style="font-size:90%;">26%</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.8.8.10.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T3.8.8.10.2.1"><span class="ltx_text" id="S3.T3.8.8.10.2.1.1" style="font-size:90%;">GPT-2*</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.8.8.10.2.2"><span class="ltx_text" id="S3.T3.8.8.10.2.2.1" style="font-size:90%;">407M</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.8.8.10.2.3"><span class="ltx_text" id="S3.T3.8.8.10.2.3.1" style="font-size:90%;">1K</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.8.8.10.2.4"><span class="ltx_text" id="S3.T3.8.8.10.2.4.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.8.8.10.2.5"><span class="ltx_text" id="S3.T3.8.8.10.2.5.1" style="font-size:90%;">18.4%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.8.8.10.2.6"><span class="ltx_text" id="S3.T3.8.8.10.2.6.1" style="font-size:90%;">18.4%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.8.8.10.2.7"><span class="ltx_text" id="S3.T3.8.8.10.2.7.1" style="font-size:90%;">18.4%</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.7.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T3.7.7.7.2"><span class="ltx_text" id="S3.T3.7.7.7.2.1" style="font-size:90%;">MemTRM</span></th>
<td class="ltx_td ltx_align_center" id="S3.T3.7.7.7.3"><span class="ltx_text" id="S3.T3.7.7.7.3.1" style="font-size:90%;">407M</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.7.7.7.4"><span class="ltx_text" id="S3.T3.7.7.7.4.1" style="font-size:90%;">1K</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.7.7.7.1"><math alttext="\infty" class="ltx_Math" display="inline" id="S3.T3.7.7.7.1.m1.1"><semantics id="S3.T3.7.7.7.1.m1.1a"><mi id="S3.T3.7.7.7.1.m1.1.1" mathsize="90%" mathvariant="normal" xref="S3.T3.7.7.7.1.m1.1.1.cmml">‚àû</mi><annotation-xml encoding="MathML-Content" id="S3.T3.7.7.7.1.m1.1b"><infinity id="S3.T3.7.7.7.1.m1.1.1.cmml" xref="S3.T3.7.7.7.1.m1.1.1"></infinity></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.7.7.7.1.m1.1c">\infty</annotation><annotation encoding="application/x-llamapun" id="S3.T3.7.7.7.1.m1.1d">‚àû</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T3.7.7.7.5"><span class="ltx_text" id="S3.T3.7.7.7.5.1" style="font-size:90%;">28.3%</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.7.7.7.6"><span class="ltx_text" id="S3.T3.7.7.7.6.1" style="font-size:90%;">28.7%</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.7.7.7.7"><span class="ltx_text" id="S3.T3.7.7.7.7.1" style="font-size:90%;">28.7%</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.8.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_b ltx_border_t" id="S3.T3.8.8.8.2"><span class="ltx_text ltx_font_smallcaps" id="S3.T3.8.8.8.2.1" style="font-size:90%;">LongMem</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" id="S3.T3.8.8.8.3"><span class="ltx_text" id="S3.T3.8.8.8.3.1" style="font-size:90%;">558M</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" id="S3.T3.8.8.8.4"><span class="ltx_text" id="S3.T3.8.8.8.4.1" style="font-size:90%;">1K</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" id="S3.T3.8.8.8.1"><math alttext="\infty" class="ltx_Math" display="inline" id="S3.T3.8.8.8.1.m1.1"><semantics id="S3.T3.8.8.8.1.m1.1a"><mi id="S3.T3.8.8.8.1.m1.1.1" mathsize="90%" mathvariant="normal" xref="S3.T3.8.8.8.1.m1.1.1.cmml">‚àû</mi><annotation-xml encoding="MathML-Content" id="S3.T3.8.8.8.1.m1.1b"><infinity id="S3.T3.8.8.8.1.m1.1.1.cmml" xref="S3.T3.8.8.8.1.m1.1.1"></infinity></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.8.8.8.1.m1.1c">\infty</annotation><annotation encoding="application/x-llamapun" id="S3.T3.8.8.8.1.m1.1d">‚àû</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" id="S3.T3.8.8.8.5"><span class="ltx_text ltx_font_bold" id="S3.T3.8.8.8.5.1" style="font-size:90%;">37.7%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" id="S3.T3.8.8.8.6"><span class="ltx_text ltx_font_bold" id="S3.T3.8.8.8.6.1" style="font-size:90%;">39.4%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" id="S3.T3.8.8.8.7"><span class="ltx_text ltx_font_bold" id="S3.T3.8.8.8.7.1" style="font-size:90%;">40.5%</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3: </span>Zero-shot Suffix Identification Accuracy on AO3 subset of <span class="ltx_text ltx_font_typewriter" id="S3.T3.21.1">ChapterBreak</span>. Baselines marked with <math alttext="{}^{\dagger}" class="ltx_Math" display="inline" id="S3.T3.10.m1.1"><semantics id="S3.T3.10.m1.1b"><msup id="S3.T3.10.m1.1.1" xref="S3.T3.10.m1.1.1.cmml"><mi id="S3.T3.10.m1.1.1b" xref="S3.T3.10.m1.1.1.cmml"></mi><mo id="S3.T3.10.m1.1.1.1" xref="S3.T3.10.m1.1.1.1.cmml">‚Ä†</mo></msup><annotation-xml encoding="MathML-Content" id="S3.T3.10.m1.1c"><apply id="S3.T3.10.m1.1.1.cmml" xref="S3.T3.10.m1.1.1"><ci id="S3.T3.10.m1.1.1.1.cmml" xref="S3.T3.10.m1.1.1.1">‚Ä†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.10.m1.1d">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.10.m1.1e">start_FLOATSUPERSCRIPT ‚Ä† end_FLOATSUPERSCRIPT</annotation></semantics></math> are directly cited from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="#bib.bib23" title=""><span class="ltx_text" style="font-size:90%;">23</span></a>]</cite>. The MemTRM and <span class="ltx_text ltx_font_smallcaps" id="S3.T3.22.2">LongMem</span> loads the given 4k/6k/8k prefix contexts into cached memory, while the input length to local context is still 1k tokens. </figcaption>
</figure>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p4.1.2">Results.</span> The main results on evaluated long-context datasets are summarized in Table¬†<a class="ltx_ref" href="#S3.T2" title="Table 2 ‚Ä£ 3.2 Long-Context Language Modeling ‚Ä£ 3 Experiments ‚Ä£ Augmenting Language Models with Long-Term Memory"><span class="ltx_text ltx_ref_tag">2</span></a>. The proposed <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p4.1.3">LongMem</span> model significantly outperform all considered baselines on long-text language modeling datasets, with improvements of -1.38 to -1.62 perplexity on different length splits of <span class="ltx_text ltx_font_italic" id="S3.SS2.p4.1.4">PG-22</span>, and -1.0 ppl on <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p4.1.5">ArXiv</span> datasets. Surprisingly, the proposed method achieves the state-of-the-art performance of 40.5% accuracy on <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p4.1.1">ChapterBreak<math alttext="{}_{\textnormal{AO3}}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.1.m1.1"><semantics id="S3.SS2.p4.1.1.m1.1a"><msub id="S3.SS2.p4.1.1.m1.1.1" xref="S3.SS2.p4.1.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.1.m1.1.1a" xref="S3.SS2.p4.1.1.m1.1.1.cmml"></mi><mtext id="S3.SS2.p4.1.1.m1.1.1.1" mathvariant="normal" xref="S3.SS2.p4.1.1.m1.1.1.1a.cmml">AO3</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.1.m1.1b"><apply id="S3.SS2.p4.1.1.m1.1.1.cmml" xref="S3.SS2.p4.1.1.m1.1.1"><ci id="S3.SS2.p4.1.1.m1.1.1.1a.cmml" xref="S3.SS2.p4.1.1.m1.1.1.1"><mtext id="S3.SS2.p4.1.1.m1.1.1.1.cmml" mathsize="70%" mathvariant="normal" xref="S3.SS2.p4.1.1.m1.1.1.1">AO3</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.1.m1.1c">{}_{\textnormal{AO3}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.1.m1.1d">start_FLOATSUBSCRIPT AO3 end_FLOATSUBSCRIPT</annotation></semantics></math></span> suffix identification benchmark and outperforms both the strong long-context transformers and latest LLM GPT-3 with 313x larger parameters. The substantial improvements on these datasets demonstrate that <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p4.1.6">LongMem</span> can comprehend past long-context in cached memory to well complete the language modeling towards future inputs.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Memory-Augmented In-Context Learning</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">LLMs have the emerging capability of in-context learning (ICL) via learning knowledge non-parametrically from few-shot demonstration examples in the local context. However, conventional in-context learning is heavily restricted by input context length, rendering it ineffective to absorb supervision from sufficient demonstration examples in the training set. With the proposed unlimited-length memory augmentation, our <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p1.1.1">LongMem</span> method can overcome the limitation of the number of demonstration examples in the local context and even attend on the whole training set by loading it into the cached memory. In this way, <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p1.1.2">LongMem</span> goes beyond the conventional few-shot in-context learning and realized memory-augmented in-context learning with thousands of auxiliary demonstration examples.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.4"><span class="ltx_text ltx_font_bold" id="S3.SS3.p2.4.1">Evaluation Setting.</span> Here, we evaluate the in-context learning capability of baselines and the proposed <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p2.4.2">LongMem</span> model on five Natural Language Understanding (NLU) datasets, SST-2¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib22" title=""><span class="ltx_text" style="font-size:90%;">22</span></a>]</cite>, MPQA¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib29" title=""><span class="ltx_text" style="font-size:90%;">29</span></a>]</cite>, MR¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib1" title=""><span class="ltx_text" style="font-size:90%;">1</span></a>]</cite>, Subj¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib12" title=""><span class="ltx_text" style="font-size:90%;">12</span></a>]</cite> and SST-5¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib22" title=""><span class="ltx_text" style="font-size:90%;">22</span></a>]</cite>. We evaluate models on two few-shot settings, 4-shot and 20-shot. The 4-shot demonstrations are data-insufficient scenario, while the 20-shot demonstrations can almost fulfill the 1k input length and provide sufficient contextual self-supervisions. We transform the k-shot examples to semantically meaningful demonstration examples via fixed text template, i.e., <math alttext="d_{i}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">d</mi><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">ùëë</ci><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">ùëñ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">d_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>="Review: <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">x</mi><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">ùë•</ci><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">ùëñ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> Sentiment: <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">y</mi><mi id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">ùë¶</ci><ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">ùëñ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>",<math alttext="\forall\{(x_{i},y_{i})\}_{i=1}^{k}\in\mathcal{D}_{\textnormal{train}}" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><mrow id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mrow id="S3.SS3.p2.4.m4.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.cmml"><mo id="S3.SS3.p2.4.m4.1.1.1.2" xref="S3.SS3.p2.4.m4.1.1.1.2.cmml">‚àÄ</mo><msubsup id="S3.SS3.p2.4.m4.1.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.1.cmml"><mrow id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.2.cmml"><mo id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.4" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.2" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.2.2" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.2.3" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.p2.4.m4.1.1.1.1.1.3" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.4.m4.1.1.1.1.1.3.2" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p2.4.m4.1.1.1.1.1.3.1" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS3.p2.4.m4.1.1.1.1.1.3.3" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p2.4.m4.1.1.1.1.3" xref="S3.SS3.p2.4.m4.1.1.1.1.3.cmml">k</mi></msubsup></mrow><mo id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">‚àà</mo><msub id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.4.m4.1.1.3.2" xref="S3.SS3.p2.4.m4.1.1.3.2.cmml">ùíü</mi><mtext id="S3.SS3.p2.4.m4.1.1.3.3" xref="S3.SS3.p2.4.m4.1.1.3.3a.cmml">train</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><in id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2"></in><apply id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.4.m4.1.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.2">for-all</csymbol><apply id="S3.SS3.p2.4.m4.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1">subscript</csymbol><set id="S3.SS3.p2.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1"><interval closure="open" id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2"><apply id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.1.1.2">ùë•</ci><ci id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.1.1.3">ùëñ</ci></apply><apply id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.2.2">ùë¶</ci><ci id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.2.2.3">ùëñ</ci></apply></interval></set><apply id="S3.SS3.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3"><eq id="S3.SS3.p2.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3.1"></eq><ci id="S3.SS3.p2.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3.2">ùëñ</ci><cn id="S3.SS3.p2.4.m4.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS3.p2.4.m4.1.1.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.3">ùëò</ci></apply></apply><apply id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.3.2">ùíü</ci><ci id="S3.SS3.p2.4.m4.1.1.3.3a.cmml" xref="S3.SS3.p2.4.m4.1.1.3.3"><mtext id="S3.SS3.p2.4.m4.1.1.3.3.cmml" mathsize="70%" xref="S3.SS3.p2.4.m4.1.1.3.3">train</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\forall\{(x_{i},y_{i})\}_{i=1}^{k}\in\mathcal{D}_{\textnormal{train}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">‚àÄ { ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ‚àà caligraphic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math> for sentiment analysis tasks. Additionally, we evaluate the 3-shot ICL on question-answering tasks of SQuAD¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib19" title=""><span class="ltx_text" style="font-size:90%;">19</span></a>]</cite> under an open-ended generation setting. The details of all prompt templates are presented in Appendix D. Then we concatenate the demonstration examples with newlines to delimit them. The prediction label is directly generated using greedy decoding given the demonstration examples and test cases in context. The prediction accuracy is used as the evaluation metric. We report the mean and standard deviation of 6 runs with different random seeds to overcome the randomness in selecting k-shot demonstration examples. As illustrated before, the chunk size controls the granularity of retrieved text chunks. As the select NLU datasets require to retrieve fine-grained labels from cached memory, we perform an hypperparameter selection on the validation set of SST-2, and the best chunk-size 2 is used to report the results for MemTRM and our model.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p3.1.1">Results.</span> The results on in-context learning are summarized in Table¬†<a class="ltx_ref" href="#S3.T5" title="Table 5 ‚Ä£ 3.3 Memory-Augmented In-Context Learning ‚Ä£ 3 Experiments ‚Ä£ Augmenting Language Models with Long-Term Memory"><span class="ltx_text ltx_ref_tag">5</span></a> and Table¬†<a class="ltx_ref" href="#S3.T4" title="Table 4 ‚Ä£ 3.3 Memory-Augmented In-Context Learning ‚Ä£ 3 Experiments ‚Ä£ Augmenting Language Models with Long-Term Memory"><span class="ltx_text ltx_ref_tag">4</span></a>.
<span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p3.1.2">LongMem</span> achieves remarkable improvements on all NLU tasks in 20-shot sufficient in-context setting, with +8.0 average scores increase over pretrained GPT-2* and MemTRM. Meanwhile, <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p3.1.3">LongMem</span> also brings performance improvements on the scenario of 4-shot demonstrations in local context.
Additionally, <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p3.1.4">LongMem</span> improves the in-context learning capabilities of LLMs on open-ended generation tasks, with +4.5 EM score increase on SQuAD.</p>
</div>
<figure class="ltx_table ltx_align_floatright" id="S3.T4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T4.6" style="width:173.4pt;height:123.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(36.2pt,-25.8pt) scale(1.71719189942168,1.71719189942168) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T4.6.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T4.6.6.7.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T4.6.6.7.1.1"><span class="ltx_text ltx_font_bold" id="S3.T4.6.6.7.1.1.1" style="font-size:90%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T4.6.6.7.1.2"><span class="ltx_text ltx_font_bold" id="S3.T4.6.6.7.1.2.1" style="font-size:90%;">EM</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T4.6.6.7.1.3"><span class="ltx_text ltx_font_bold" id="S3.T4.6.6.7.1.3.1" style="font-size:90%;">F1</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T4.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T4.2.2.2.3"><span class="ltx_text" id="S3.T4.2.2.2.3.1" style="font-size:90%;">GPT-2*</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.1.1">
<span class="ltx_text" id="S3.T4.1.1.1.1.1" style="font-size:90%;">22.28</span><math alttext="{}_{2.3}" class="ltx_Math" display="inline" id="S3.T4.1.1.1.1.m1.1"><semantics id="S3.T4.1.1.1.1.m1.1a"><msub id="S3.T4.1.1.1.1.m1.1.1" xref="S3.T4.1.1.1.1.m1.1.1.cmml"><mi id="S3.T4.1.1.1.1.m1.1.1a" xref="S3.T4.1.1.1.1.m1.1.1.cmml"></mi><mn id="S3.T4.1.1.1.1.m1.1.1.1" mathsize="90%" xref="S3.T4.1.1.1.1.m1.1.1.1.cmml">2.3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T4.1.1.1.1.m1.1b"><apply id="S3.T4.1.1.1.1.m1.1.1.cmml" xref="S3.T4.1.1.1.1.m1.1.1"><cn id="S3.T4.1.1.1.1.m1.1.1.1.cmml" type="float" xref="S3.T4.1.1.1.1.m1.1.1.1">2.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.1.1.1.1.m1.1c">{}_{2.3}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.1.1.1.1.m1.1d">start_FLOATSUBSCRIPT 2.3 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.2.2.2.2">
<span class="ltx_text" id="S3.T4.2.2.2.2.1" style="font-size:90%;">30.78</span><math alttext="{}_{2.0}" class="ltx_Math" display="inline" id="S3.T4.2.2.2.2.m1.1"><semantics id="S3.T4.2.2.2.2.m1.1a"><msub id="S3.T4.2.2.2.2.m1.1.1" xref="S3.T4.2.2.2.2.m1.1.1.cmml"><mi id="S3.T4.2.2.2.2.m1.1.1a" xref="S3.T4.2.2.2.2.m1.1.1.cmml"></mi><mn id="S3.T4.2.2.2.2.m1.1.1.1" mathsize="90%" xref="S3.T4.2.2.2.2.m1.1.1.1.cmml">2.0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T4.2.2.2.2.m1.1b"><apply id="S3.T4.2.2.2.2.m1.1.1.cmml" xref="S3.T4.2.2.2.2.m1.1.1"><cn id="S3.T4.2.2.2.2.m1.1.1.1.cmml" type="float" xref="S3.T4.2.2.2.2.m1.1.1.1">2.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.2.2.2.2.m1.1c">{}_{2.0}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.2.2.2.2.m1.1d">start_FLOATSUBSCRIPT 2.0 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S3.T4.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T4.4.4.4.3"><span class="ltx_text" id="S3.T4.4.4.4.3.1" style="font-size:90%;">MemTRM</span></th>
<td class="ltx_td ltx_align_center" id="S3.T4.3.3.3.1">
<span class="ltx_text" id="S3.T4.3.3.3.1.1" style="font-size:90%;">22.84</span><math alttext="{}_{3.5}" class="ltx_Math" display="inline" id="S3.T4.3.3.3.1.m1.1"><semantics id="S3.T4.3.3.3.1.m1.1a"><msub id="S3.T4.3.3.3.1.m1.1.1" xref="S3.T4.3.3.3.1.m1.1.1.cmml"><mi id="S3.T4.3.3.3.1.m1.1.1a" xref="S3.T4.3.3.3.1.m1.1.1.cmml"></mi><mn id="S3.T4.3.3.3.1.m1.1.1.1" mathsize="90%" xref="S3.T4.3.3.3.1.m1.1.1.1.cmml">3.5</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T4.3.3.3.1.m1.1b"><apply id="S3.T4.3.3.3.1.m1.1.1.cmml" xref="S3.T4.3.3.3.1.m1.1.1"><cn id="S3.T4.3.3.3.1.m1.1.1.1.cmml" type="float" xref="S3.T4.3.3.3.1.m1.1.1.1">3.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.3.3.3.1.m1.1c">{}_{3.5}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.3.3.3.1.m1.1d">start_FLOATSUBSCRIPT 3.5 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.4.4.2">
<span class="ltx_text" id="S3.T4.4.4.4.2.1" style="font-size:90%;">32.65</span><math alttext="{}_{2.8}" class="ltx_Math" display="inline" id="S3.T4.4.4.4.2.m1.1"><semantics id="S3.T4.4.4.4.2.m1.1a"><msub id="S3.T4.4.4.4.2.m1.1.1" xref="S3.T4.4.4.4.2.m1.1.1.cmml"><mi id="S3.T4.4.4.4.2.m1.1.1a" xref="S3.T4.4.4.4.2.m1.1.1.cmml"></mi><mn id="S3.T4.4.4.4.2.m1.1.1.1" mathsize="90%" xref="S3.T4.4.4.4.2.m1.1.1.1.cmml">2.8</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T4.4.4.4.2.m1.1b"><apply id="S3.T4.4.4.4.2.m1.1.1.cmml" xref="S3.T4.4.4.4.2.m1.1.1"><cn id="S3.T4.4.4.4.2.m1.1.1.1.cmml" type="float" xref="S3.T4.4.4.4.2.m1.1.1.1">2.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.4.4.4.2.m1.1c">{}_{2.8}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.4.4.4.2.m1.1d">start_FLOATSUBSCRIPT 2.8 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S3.T4.6.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T4.6.6.6.3"><span class="ltx_text ltx_font_smallcaps" id="S3.T4.6.6.6.3.1" style="font-size:90%;">LongMem</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.5.5.5.1">
<span class="ltx_text" id="S3.T4.5.5.5.1.1" style="font-size:90%;">26.77</span><math alttext="{}_{2.3}" class="ltx_Math" display="inline" id="S3.T4.5.5.5.1.m1.1"><semantics id="S3.T4.5.5.5.1.m1.1a"><msub id="S3.T4.5.5.5.1.m1.1.1" xref="S3.T4.5.5.5.1.m1.1.1.cmml"><mi id="S3.T4.5.5.5.1.m1.1.1a" xref="S3.T4.5.5.5.1.m1.1.1.cmml"></mi><mn id="S3.T4.5.5.5.1.m1.1.1.1" mathsize="90%" xref="S3.T4.5.5.5.1.m1.1.1.1.cmml">2.3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T4.5.5.5.1.m1.1b"><apply id="S3.T4.5.5.5.1.m1.1.1.cmml" xref="S3.T4.5.5.5.1.m1.1.1"><cn id="S3.T4.5.5.5.1.m1.1.1.1.cmml" type="float" xref="S3.T4.5.5.5.1.m1.1.1.1">2.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.5.5.5.1.m1.1c">{}_{2.3}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.5.5.5.1.m1.1d">start_FLOATSUBSCRIPT 2.3 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.6.6.6.2">
<span class="ltx_text" id="S3.T4.6.6.6.2.1" style="font-size:90%;">35.70</span><math alttext="{}_{2.0}" class="ltx_Math" display="inline" id="S3.T4.6.6.6.2.m1.1"><semantics id="S3.T4.6.6.6.2.m1.1a"><msub id="S3.T4.6.6.6.2.m1.1.1" xref="S3.T4.6.6.6.2.m1.1.1.cmml"><mi id="S3.T4.6.6.6.2.m1.1.1a" xref="S3.T4.6.6.6.2.m1.1.1.cmml"></mi><mn id="S3.T4.6.6.6.2.m1.1.1.1" mathsize="90%" xref="S3.T4.6.6.6.2.m1.1.1.1.cmml">2.0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T4.6.6.6.2.m1.1b"><apply id="S3.T4.6.6.6.2.m1.1.1.cmml" xref="S3.T4.6.6.6.2.m1.1.1"><cn id="S3.T4.6.6.6.2.m1.1.1.1.cmml" type="float" xref="S3.T4.6.6.6.2.m1.1.1.1">2.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.6.6.6.2.m1.1c">{}_{2.0}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.6.6.6.2.m1.1d">start_FLOATSUBSCRIPT 2.0 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 4: </span>Exact match (EM) and F1 scores of 3-shot (about 1k tokens) in-context learning on SQuAD. <span class="ltx_text ltx_font_smallcaps" id="S3.T4.11.1">LongMem</span> loads 200 extra demonstration examples into cached memory.
</figcaption>
</figure>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.1">The results indicate that the demonstration examples loaded in cached memory can be regarded as auxiliary contextual demonstrations to attend to and be helpful for in-context learning.
<span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p4.1.1">LongMem</span> model can harvest both the task-relevant knowledge in both local contextual demonstrations and in-memory augmented demonstrations for better in-context learning.</p>
</div>
<figure class="ltx_table" id="S3.T5">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T5.35" style="width:279.4pt;height:162pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1.0,1.0) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T5.35.35">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T5.35.35.36.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt ltx_border_t" id="S3.T5.35.35.36.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T5.35.35.36.1.1.1" style="font-size:90%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="S3.T5.35.35.36.1.2"><span class="ltx_text ltx_font_bold" id="S3.T5.35.35.36.1.2.1" style="font-size:90%;">In-Context</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="S3.T5.35.35.36.1.3"><span class="ltx_text ltx_font_bold" id="S3.T5.35.35.36.1.3.1" style="font-size:90%;">In-Memory</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="S3.T5.35.35.36.1.4"><span class="ltx_text ltx_font_bold" id="S3.T5.35.35.36.1.4.1" style="font-size:90%;">SST-2</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="S3.T5.35.35.36.1.5"><span class="ltx_text ltx_font_bold" id="S3.T5.35.35.36.1.5.1" style="font-size:90%;">MR</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="S3.T5.35.35.36.1.6"><span class="ltx_text ltx_font_bold" id="S3.T5.35.35.36.1.6.1" style="font-size:90%;">Subj</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="S3.T5.35.35.36.1.7"><span class="ltx_text ltx_font_bold" id="S3.T5.35.35.36.1.7.1" style="font-size:90%;">SST-5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="S3.T5.35.35.36.1.8"><span class="ltx_text ltx_font_bold" id="S3.T5.35.35.36.1.8.1" style="font-size:90%;">MPQA</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="S3.T5.35.35.36.1.9" rowspan="2"><span class="ltx_text ltx_font_bold" id="S3.T5.35.35.36.1.9.1" style="font-size:90%;">Avg.</span></th>
</tr>
<tr class="ltx_tr" id="S3.T5.5.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.5.5.5.6"><span class="ltx_text ltx_font_bold" id="S3.T5.5.5.5.6.1" style="font-size:90%;">#Demons.</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.5.5.5.7"><span class="ltx_text ltx_font_bold" id="S3.T5.5.5.5.7.1" style="font-size:90%;">#Demons.</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.1.1.1.1">
<span class="ltx_text" id="S3.T5.1.1.1.1.1" style="font-size:90%;">ACC</span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T5.1.1.1.1.m1.1"><semantics id="S3.T5.1.1.1.1.m1.1a"><mo id="S3.T5.1.1.1.1.m1.1.1" mathsize="90%" stretchy="false" xref="S3.T5.1.1.1.1.m1.1.1.cmml">‚Üë</mo><annotation-xml encoding="MathML-Content" id="S3.T5.1.1.1.1.m1.1b"><ci id="S3.T5.1.1.1.1.m1.1.1.cmml" xref="S3.T5.1.1.1.1.m1.1.1">‚Üë</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T5.1.1.1.1.m1.1d">‚Üë</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.2.2.2.2">
<span class="ltx_text" id="S3.T5.2.2.2.2.1" style="font-size:90%;">ACC</span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T5.2.2.2.2.m1.1"><semantics id="S3.T5.2.2.2.2.m1.1a"><mo id="S3.T5.2.2.2.2.m1.1.1" mathsize="90%" stretchy="false" xref="S3.T5.2.2.2.2.m1.1.1.cmml">‚Üë</mo><annotation-xml encoding="MathML-Content" id="S3.T5.2.2.2.2.m1.1b"><ci id="S3.T5.2.2.2.2.m1.1.1.cmml" xref="S3.T5.2.2.2.2.m1.1.1">‚Üë</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T5.2.2.2.2.m1.1d">‚Üë</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.3.3.3.3">
<span class="ltx_text" id="S3.T5.3.3.3.3.1" style="font-size:90%;">ACC</span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T5.3.3.3.3.m1.1"><semantics id="S3.T5.3.3.3.3.m1.1a"><mo id="S3.T5.3.3.3.3.m1.1.1" mathsize="90%" stretchy="false" xref="S3.T5.3.3.3.3.m1.1.1.cmml">‚Üë</mo><annotation-xml encoding="MathML-Content" id="S3.T5.3.3.3.3.m1.1b"><ci id="S3.T5.3.3.3.3.m1.1.1.cmml" xref="S3.T5.3.3.3.3.m1.1.1">‚Üë</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T5.3.3.3.3.m1.1d">‚Üë</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.4.4.4.4">
<span class="ltx_text" id="S3.T5.4.4.4.4.1" style="font-size:90%;">ACC</span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T5.4.4.4.4.m1.1"><semantics id="S3.T5.4.4.4.4.m1.1a"><mo id="S3.T5.4.4.4.4.m1.1.1" mathsize="90%" stretchy="false" xref="S3.T5.4.4.4.4.m1.1.1.cmml">‚Üë</mo><annotation-xml encoding="MathML-Content" id="S3.T5.4.4.4.4.m1.1b"><ci id="S3.T5.4.4.4.4.m1.1.1.cmml" xref="S3.T5.4.4.4.4.m1.1.1">‚Üë</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.4.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T5.4.4.4.4.m1.1d">‚Üë</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T5.5.5.5.5">
<span class="ltx_text" id="S3.T5.5.5.5.5.1" style="font-size:90%;">ACC</span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T5.5.5.5.5.m1.1"><semantics id="S3.T5.5.5.5.5.m1.1a"><mo id="S3.T5.5.5.5.5.m1.1.1" mathsize="90%" stretchy="false" xref="S3.T5.5.5.5.5.m1.1.1.cmml">‚Üë</mo><annotation-xml encoding="MathML-Content" id="S3.T5.5.5.5.5.m1.1b"><ci id="S3.T5.5.5.5.5.m1.1.1.cmml" xref="S3.T5.5.5.5.5.m1.1.1">‚Üë</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.5.5.5.5.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T5.5.5.5.5.m1.1d">‚Üë</annotation></semantics></math>
</th>
</tr>
<tr class="ltx_tr" id="S3.T5.35.35.37.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S3.T5.35.35.37.2.1"><span class="ltx_text" id="S3.T5.35.35.37.2.1.1" style="font-size:90%;">Majority</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.35.35.37.2.2"><span class="ltx_text" id="S3.T5.35.35.37.2.2.1" style="font-size:90%;">N/A</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.35.35.37.2.3"><span class="ltx_text" id="S3.T5.35.35.37.2.3.1" style="font-size:90%;">N/A</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.35.35.37.2.4"><span class="ltx_text" id="S3.T5.35.35.37.2.4.1" style="font-size:90%;">50.9</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.35.35.37.2.5"><span class="ltx_text" id="S3.T5.35.35.37.2.5.1" style="font-size:90%;">50.0</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.35.35.37.2.6"><span class="ltx_text" id="S3.T5.35.35.37.2.6.1" style="font-size:90%;">50.0</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.35.35.37.2.7"><span class="ltx_text" id="S3.T5.35.35.37.2.7.1" style="font-size:90%;">20.0</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.35.35.37.2.8"><span class="ltx_text" id="S3.T5.35.35.37.2.8.1" style="font-size:90%;">50.0</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.35.35.37.2.9"><span class="ltx_text" id="S3.T5.35.35.37.2.9.1" style="font-size:90%;">44.2</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T5.10.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T5.10.10.10.6"><span class="ltx_text" id="S3.T5.10.10.10.6.1" style="font-size:90%;">GPT-2*</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.10.10.10.7"><span class="ltx_text" id="S3.T5.10.10.10.7.1" style="font-size:90%;">4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.10.10.10.8"><span class="ltx_text" id="S3.T5.10.10.10.8.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.6.6.6.1">
<span class="ltx_text" id="S3.T5.6.6.6.1.1" style="font-size:90%;">68.3</span><math alttext="{}_{11.6}" class="ltx_Math" display="inline" id="S3.T5.6.6.6.1.m1.1"><semantics id="S3.T5.6.6.6.1.m1.1a"><msub id="S3.T5.6.6.6.1.m1.1.1" xref="S3.T5.6.6.6.1.m1.1.1.cmml"><mi id="S3.T5.6.6.6.1.m1.1.1a" xref="S3.T5.6.6.6.1.m1.1.1.cmml"></mi><mn id="S3.T5.6.6.6.1.m1.1.1.1" mathsize="90%" xref="S3.T5.6.6.6.1.m1.1.1.1.cmml">11.6</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.6.6.6.1.m1.1b"><apply id="S3.T5.6.6.6.1.m1.1.1.cmml" xref="S3.T5.6.6.6.1.m1.1.1"><cn id="S3.T5.6.6.6.1.m1.1.1.1.cmml" type="float" xref="S3.T5.6.6.6.1.m1.1.1.1">11.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.6.6.6.1.m1.1c">{}_{11.6}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.6.6.6.1.m1.1d">start_FLOATSUBSCRIPT 11.6 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.7.7.7.2">
<span class="ltx_text" id="S3.T5.7.7.7.2.1" style="font-size:90%;">64.7</span><math alttext="{}_{12.5}" class="ltx_Math" display="inline" id="S3.T5.7.7.7.2.m1.1"><semantics id="S3.T5.7.7.7.2.m1.1a"><msub id="S3.T5.7.7.7.2.m1.1.1" xref="S3.T5.7.7.7.2.m1.1.1.cmml"><mi id="S3.T5.7.7.7.2.m1.1.1a" xref="S3.T5.7.7.7.2.m1.1.1.cmml"></mi><mn id="S3.T5.7.7.7.2.m1.1.1.1" mathsize="90%" xref="S3.T5.7.7.7.2.m1.1.1.1.cmml">12.5</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.7.7.7.2.m1.1b"><apply id="S3.T5.7.7.7.2.m1.1.1.cmml" xref="S3.T5.7.7.7.2.m1.1.1"><cn id="S3.T5.7.7.7.2.m1.1.1.1.cmml" type="float" xref="S3.T5.7.7.7.2.m1.1.1.1">12.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.7.7.7.2.m1.1c">{}_{12.5}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.7.7.7.2.m1.1d">start_FLOATSUBSCRIPT 12.5 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.8.8.8.3">
<span class="ltx_text" id="S3.T5.8.8.8.3.1" style="font-size:90%;">51.9</span><math alttext="{}_{4.2}" class="ltx_Math" display="inline" id="S3.T5.8.8.8.3.m1.1"><semantics id="S3.T5.8.8.8.3.m1.1a"><msub id="S3.T5.8.8.8.3.m1.1.1" xref="S3.T5.8.8.8.3.m1.1.1.cmml"><mi id="S3.T5.8.8.8.3.m1.1.1a" xref="S3.T5.8.8.8.3.m1.1.1.cmml"></mi><mn id="S3.T5.8.8.8.3.m1.1.1.1" mathsize="90%" xref="S3.T5.8.8.8.3.m1.1.1.1.cmml">4.2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.8.8.8.3.m1.1b"><apply id="S3.T5.8.8.8.3.m1.1.1.cmml" xref="S3.T5.8.8.8.3.m1.1.1"><cn id="S3.T5.8.8.8.3.m1.1.1.1.cmml" type="float" xref="S3.T5.8.8.8.3.m1.1.1.1">4.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.8.8.8.3.m1.1c">{}_{4.2}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.8.8.8.3.m1.1d">start_FLOATSUBSCRIPT 4.2 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.9.9.9.4">
<span class="ltx_text" id="S3.T5.9.9.9.4.1" style="font-size:90%;">31.4</span><math alttext="{}_{4.4}" class="ltx_Math" display="inline" id="S3.T5.9.9.9.4.m1.1"><semantics id="S3.T5.9.9.9.4.m1.1a"><msub id="S3.T5.9.9.9.4.m1.1.1" xref="S3.T5.9.9.9.4.m1.1.1.cmml"><mi id="S3.T5.9.9.9.4.m1.1.1a" xref="S3.T5.9.9.9.4.m1.1.1.cmml"></mi><mn id="S3.T5.9.9.9.4.m1.1.1.1" mathsize="90%" xref="S3.T5.9.9.9.4.m1.1.1.1.cmml">4.4</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.9.9.9.4.m1.1b"><apply id="S3.T5.9.9.9.4.m1.1.1.cmml" xref="S3.T5.9.9.9.4.m1.1.1"><cn id="S3.T5.9.9.9.4.m1.1.1.1.cmml" type="float" xref="S3.T5.9.9.9.4.m1.1.1.1">4.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.9.9.9.4.m1.1c">{}_{4.4}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.9.9.9.4.m1.1d">start_FLOATSUBSCRIPT 4.4 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.10.10.10.5">
<span class="ltx_text" id="S3.T5.10.10.10.5.1" style="font-size:90%;">61.5</span><math alttext="{}_{11.8}" class="ltx_Math" display="inline" id="S3.T5.10.10.10.5.m1.1"><semantics id="S3.T5.10.10.10.5.m1.1a"><msub id="S3.T5.10.10.10.5.m1.1.1" xref="S3.T5.10.10.10.5.m1.1.1.cmml"><mi id="S3.T5.10.10.10.5.m1.1.1a" xref="S3.T5.10.10.10.5.m1.1.1.cmml"></mi><mn id="S3.T5.10.10.10.5.m1.1.1.1" mathsize="90%" xref="S3.T5.10.10.10.5.m1.1.1.1.cmml">11.8</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.10.10.10.5.m1.1b"><apply id="S3.T5.10.10.10.5.m1.1.1.cmml" xref="S3.T5.10.10.10.5.m1.1.1"><cn id="S3.T5.10.10.10.5.m1.1.1.1.cmml" type="float" xref="S3.T5.10.10.10.5.m1.1.1.1">11.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.10.10.10.5.m1.1c">{}_{11.8}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.10.10.10.5.m1.1d">start_FLOATSUBSCRIPT 11.8 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.10.10.10.9"><span class="ltx_text" id="S3.T5.10.10.10.9.1" style="font-size:90%;">55.6</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.15.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.15.15.15.6"><span class="ltx_text" id="S3.T5.15.15.15.6.1" style="font-size:90%;">MemTRM</span></th>
<td class="ltx_td ltx_align_center" id="S3.T5.15.15.15.7"><span class="ltx_text" id="S3.T5.15.15.15.7.1" style="font-size:90%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.15.15.15.8"><span class="ltx_text" id="S3.T5.15.15.15.8.1" style="font-size:90%;">2000</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.11.11.11.1">
<span class="ltx_text" id="S3.T5.11.11.11.1.1" style="font-size:90%;">67.5</span><math alttext="{}_{12.4}" class="ltx_Math" display="inline" id="S3.T5.11.11.11.1.m1.1"><semantics id="S3.T5.11.11.11.1.m1.1a"><msub id="S3.T5.11.11.11.1.m1.1.1" xref="S3.T5.11.11.11.1.m1.1.1.cmml"><mi id="S3.T5.11.11.11.1.m1.1.1a" xref="S3.T5.11.11.11.1.m1.1.1.cmml"></mi><mn id="S3.T5.11.11.11.1.m1.1.1.1" mathsize="90%" xref="S3.T5.11.11.11.1.m1.1.1.1.cmml">12.4</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.11.11.11.1.m1.1b"><apply id="S3.T5.11.11.11.1.m1.1.1.cmml" xref="S3.T5.11.11.11.1.m1.1.1"><cn id="S3.T5.11.11.11.1.m1.1.1.1.cmml" type="float" xref="S3.T5.11.11.11.1.m1.1.1.1">12.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.11.11.11.1.m1.1c">{}_{12.4}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.11.11.11.1.m1.1d">start_FLOATSUBSCRIPT 12.4 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.12.12.12.2">
<span class="ltx_text" id="S3.T5.12.12.12.2.1" style="font-size:90%;">64.6</span><math alttext="{}_{11.3}" class="ltx_Math" display="inline" id="S3.T5.12.12.12.2.m1.1"><semantics id="S3.T5.12.12.12.2.m1.1a"><msub id="S3.T5.12.12.12.2.m1.1.1" xref="S3.T5.12.12.12.2.m1.1.1.cmml"><mi id="S3.T5.12.12.12.2.m1.1.1a" xref="S3.T5.12.12.12.2.m1.1.1.cmml"></mi><mn id="S3.T5.12.12.12.2.m1.1.1.1" mathsize="90%" xref="S3.T5.12.12.12.2.m1.1.1.1.cmml">11.3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.12.12.12.2.m1.1b"><apply id="S3.T5.12.12.12.2.m1.1.1.cmml" xref="S3.T5.12.12.12.2.m1.1.1"><cn id="S3.T5.12.12.12.2.m1.1.1.1.cmml" type="float" xref="S3.T5.12.12.12.2.m1.1.1.1">11.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.12.12.12.2.m1.1c">{}_{11.3}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.12.12.12.2.m1.1d">start_FLOATSUBSCRIPT 11.3 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.13.13.13.3">
<span class="ltx_text" id="S3.T5.13.13.13.3.1" style="font-size:90%;">53.2</span><math alttext="{}_{6.0}" class="ltx_Math" display="inline" id="S3.T5.13.13.13.3.m1.1"><semantics id="S3.T5.13.13.13.3.m1.1a"><msub id="S3.T5.13.13.13.3.m1.1.1" xref="S3.T5.13.13.13.3.m1.1.1.cmml"><mi id="S3.T5.13.13.13.3.m1.1.1a" xref="S3.T5.13.13.13.3.m1.1.1.cmml"></mi><mn id="S3.T5.13.13.13.3.m1.1.1.1" mathsize="90%" xref="S3.T5.13.13.13.3.m1.1.1.1.cmml">6.0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.13.13.13.3.m1.1b"><apply id="S3.T5.13.13.13.3.m1.1.1.cmml" xref="S3.T5.13.13.13.3.m1.1.1"><cn id="S3.T5.13.13.13.3.m1.1.1.1.cmml" type="float" xref="S3.T5.13.13.13.3.m1.1.1.1">6.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.13.13.13.3.m1.1c">{}_{6.0}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.13.13.13.3.m1.1d">start_FLOATSUBSCRIPT 6.0 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.14.14.14.4">
<span class="ltx_text" id="S3.T5.14.14.14.4.1" style="font-size:90%;">29.6</span><math alttext="{}_{4.4}" class="ltx_Math" display="inline" id="S3.T5.14.14.14.4.m1.1"><semantics id="S3.T5.14.14.14.4.m1.1a"><msub id="S3.T5.14.14.14.4.m1.1.1" xref="S3.T5.14.14.14.4.m1.1.1.cmml"><mi id="S3.T5.14.14.14.4.m1.1.1a" xref="S3.T5.14.14.14.4.m1.1.1.cmml"></mi><mn id="S3.T5.14.14.14.4.m1.1.1.1" mathsize="90%" xref="S3.T5.14.14.14.4.m1.1.1.1.cmml">4.4</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.14.14.14.4.m1.1b"><apply id="S3.T5.14.14.14.4.m1.1.1.cmml" xref="S3.T5.14.14.14.4.m1.1.1"><cn id="S3.T5.14.14.14.4.m1.1.1.1.cmml" type="float" xref="S3.T5.14.14.14.4.m1.1.1.1">4.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.14.14.14.4.m1.1c">{}_{4.4}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.14.14.14.4.m1.1d">start_FLOATSUBSCRIPT 4.4 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.15.15.15.5">
<span class="ltx_text" id="S3.T5.15.15.15.5.1" style="font-size:90%;">63.0</span><math alttext="{}_{12.1}" class="ltx_Math" display="inline" id="S3.T5.15.15.15.5.m1.1"><semantics id="S3.T5.15.15.15.5.m1.1a"><msub id="S3.T5.15.15.15.5.m1.1.1" xref="S3.T5.15.15.15.5.m1.1.1.cmml"><mi id="S3.T5.15.15.15.5.m1.1.1a" xref="S3.T5.15.15.15.5.m1.1.1.cmml"></mi><mn id="S3.T5.15.15.15.5.m1.1.1.1" mathsize="90%" xref="S3.T5.15.15.15.5.m1.1.1.1.cmml">12.1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.15.15.15.5.m1.1b"><apply id="S3.T5.15.15.15.5.m1.1.1.cmml" xref="S3.T5.15.15.15.5.m1.1.1"><cn id="S3.T5.15.15.15.5.m1.1.1.1.cmml" type="float" xref="S3.T5.15.15.15.5.m1.1.1.1">12.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.15.15.15.5.m1.1c">{}_{12.1}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.15.15.15.5.m1.1d">start_FLOATSUBSCRIPT 12.1 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.15.15.15.9"><span class="ltx_text" id="S3.T5.15.15.15.9.1" style="font-size:90%;">55.6</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.20.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.20.20.20.6"><span class="ltx_text ltx_font_smallcaps" id="S3.T5.20.20.20.6.1" style="font-size:90%;">LongMem</span></th>
<td class="ltx_td ltx_align_center" id="S3.T5.20.20.20.7"><span class="ltx_text" id="S3.T5.20.20.20.7.1" style="font-size:90%;">4</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.20.20.20.8"><span class="ltx_text" id="S3.T5.20.20.20.8.1" style="font-size:90%;">2000</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.16.16.16.1"><span class="ltx_text ltx_font_bold" id="S3.T5.16.16.16.1.1" style="font-size:90%;">71.8<math alttext="{}_{14.0}" class="ltx_Math" display="inline" id="S3.T5.16.16.16.1.1.m1.1"><semantics id="S3.T5.16.16.16.1.1.m1.1a"><msub id="S3.T5.16.16.16.1.1.m1.1.1" xref="S3.T5.16.16.16.1.1.m1.1.1.cmml"><mi id="S3.T5.16.16.16.1.1.m1.1.1a" xref="S3.T5.16.16.16.1.1.m1.1.1.cmml"></mi><mn id="S3.T5.16.16.16.1.1.m1.1.1.1" mathvariant="normal" xref="S3.T5.16.16.16.1.1.m1.1.1.1.cmml">14.0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.16.16.16.1.1.m1.1b"><apply id="S3.T5.16.16.16.1.1.m1.1.1.cmml" xref="S3.T5.16.16.16.1.1.m1.1.1"><cn id="S3.T5.16.16.16.1.1.m1.1.1.1.cmml" type="float" xref="S3.T5.16.16.16.1.1.m1.1.1.1">14.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.16.16.16.1.1.m1.1c">{}_{14.0}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.16.16.16.1.1.m1.1d">start_FLOATSUBSCRIPT 14.0 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.17.17.17.2"><span class="ltx_text ltx_font_bold" id="S3.T5.17.17.17.2.1" style="font-size:90%;">65.1<math alttext="{}_{11.0}" class="ltx_Math" display="inline" id="S3.T5.17.17.17.2.1.m1.1"><semantics id="S3.T5.17.17.17.2.1.m1.1a"><msub id="S3.T5.17.17.17.2.1.m1.1.1" xref="S3.T5.17.17.17.2.1.m1.1.1.cmml"><mi id="S3.T5.17.17.17.2.1.m1.1.1a" xref="S3.T5.17.17.17.2.1.m1.1.1.cmml"></mi><mn id="S3.T5.17.17.17.2.1.m1.1.1.1" mathvariant="normal" xref="S3.T5.17.17.17.2.1.m1.1.1.1.cmml">11.0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.17.17.17.2.1.m1.1b"><apply id="S3.T5.17.17.17.2.1.m1.1.1.cmml" xref="S3.T5.17.17.17.2.1.m1.1.1"><cn id="S3.T5.17.17.17.2.1.m1.1.1.1.cmml" type="float" xref="S3.T5.17.17.17.2.1.m1.1.1.1">11.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.17.17.17.2.1.m1.1c">{}_{11.0}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.17.17.17.2.1.m1.1d">start_FLOATSUBSCRIPT 11.0 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.18.18.18.3"><span class="ltx_text ltx_font_bold" id="S3.T5.18.18.18.3.1" style="font-size:90%;">53.8<math alttext="{}_{3.7}" class="ltx_Math" display="inline" id="S3.T5.18.18.18.3.1.m1.1"><semantics id="S3.T5.18.18.18.3.1.m1.1a"><msub id="S3.T5.18.18.18.3.1.m1.1.1" xref="S3.T5.18.18.18.3.1.m1.1.1.cmml"><mi id="S3.T5.18.18.18.3.1.m1.1.1a" xref="S3.T5.18.18.18.3.1.m1.1.1.cmml"></mi><mn id="S3.T5.18.18.18.3.1.m1.1.1.1" mathvariant="normal" xref="S3.T5.18.18.18.3.1.m1.1.1.1.cmml">3.7</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.18.18.18.3.1.m1.1b"><apply id="S3.T5.18.18.18.3.1.m1.1.1.cmml" xref="S3.T5.18.18.18.3.1.m1.1.1"><cn id="S3.T5.18.18.18.3.1.m1.1.1.1.cmml" type="float" xref="S3.T5.18.18.18.3.1.m1.1.1.1">3.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.18.18.18.3.1.m1.1c">{}_{3.7}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.18.18.18.3.1.m1.1d">start_FLOATSUBSCRIPT 3.7 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.19.19.19.4"><span class="ltx_text ltx_font_bold" id="S3.T5.19.19.19.4.1" style="font-size:90%;">36.0<math alttext="{}_{6.8}" class="ltx_Math" display="inline" id="S3.T5.19.19.19.4.1.m1.1"><semantics id="S3.T5.19.19.19.4.1.m1.1a"><msub id="S3.T5.19.19.19.4.1.m1.1.1" xref="S3.T5.19.19.19.4.1.m1.1.1.cmml"><mi id="S3.T5.19.19.19.4.1.m1.1.1a" xref="S3.T5.19.19.19.4.1.m1.1.1.cmml"></mi><mn id="S3.T5.19.19.19.4.1.m1.1.1.1" mathvariant="normal" xref="S3.T5.19.19.19.4.1.m1.1.1.1.cmml">6.8</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.19.19.19.4.1.m1.1b"><apply id="S3.T5.19.19.19.4.1.m1.1.1.cmml" xref="S3.T5.19.19.19.4.1.m1.1.1"><cn id="S3.T5.19.19.19.4.1.m1.1.1.1.cmml" type="float" xref="S3.T5.19.19.19.4.1.m1.1.1.1">6.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.19.19.19.4.1.m1.1c">{}_{6.8}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.19.19.19.4.1.m1.1d">start_FLOATSUBSCRIPT 6.8 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.20.20.20.5"><span class="ltx_text ltx_font_bold" id="S3.T5.20.20.20.5.1" style="font-size:90%;">65.4<math alttext="{}_{12.8}" class="ltx_Math" display="inline" id="S3.T5.20.20.20.5.1.m1.1"><semantics id="S3.T5.20.20.20.5.1.m1.1a"><msub id="S3.T5.20.20.20.5.1.m1.1.1" xref="S3.T5.20.20.20.5.1.m1.1.1.cmml"><mi id="S3.T5.20.20.20.5.1.m1.1.1a" xref="S3.T5.20.20.20.5.1.m1.1.1.cmml"></mi><mn id="S3.T5.20.20.20.5.1.m1.1.1.1" mathvariant="normal" xref="S3.T5.20.20.20.5.1.m1.1.1.1.cmml">12.8</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.20.20.20.5.1.m1.1b"><apply id="S3.T5.20.20.20.5.1.m1.1.1.cmml" xref="S3.T5.20.20.20.5.1.m1.1.1"><cn id="S3.T5.20.20.20.5.1.m1.1.1.1.cmml" type="float" xref="S3.T5.20.20.20.5.1.m1.1.1.1">12.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.20.20.20.5.1.m1.1c">{}_{12.8}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.20.20.20.5.1.m1.1d">start_FLOATSUBSCRIPT 12.8 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.20.20.20.9"><span class="ltx_text ltx_font_bold" id="S3.T5.20.20.20.9.1" style="font-size:90%;">58.4</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.25.25.25">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T5.25.25.25.6"><span class="ltx_text" id="S3.T5.25.25.25.6.1" style="font-size:90%;">GPT-2*</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.25.25.25.7"><span class="ltx_text" id="S3.T5.25.25.25.7.1" style="font-size:90%;">20</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.25.25.25.8"><span class="ltx_text" id="S3.T5.25.25.25.8.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.21.21.21.1">
<span class="ltx_text" id="S3.T5.21.21.21.1.1" style="font-size:90%;">68.2</span><math alttext="{}_{11.5}" class="ltx_Math" display="inline" id="S3.T5.21.21.21.1.m1.1"><semantics id="S3.T5.21.21.21.1.m1.1a"><msub id="S3.T5.21.21.21.1.m1.1.1" xref="S3.T5.21.21.21.1.m1.1.1.cmml"><mi id="S3.T5.21.21.21.1.m1.1.1a" xref="S3.T5.21.21.21.1.m1.1.1.cmml"></mi><mn id="S3.T5.21.21.21.1.m1.1.1.1" mathsize="90%" xref="S3.T5.21.21.21.1.m1.1.1.1.cmml">11.5</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.21.21.21.1.m1.1b"><apply id="S3.T5.21.21.21.1.m1.1.1.cmml" xref="S3.T5.21.21.21.1.m1.1.1"><cn id="S3.T5.21.21.21.1.m1.1.1.1.cmml" type="float" xref="S3.T5.21.21.21.1.m1.1.1.1">11.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.21.21.21.1.m1.1c">{}_{11.5}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.21.21.21.1.m1.1d">start_FLOATSUBSCRIPT 11.5 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.22.22.22.2">
<span class="ltx_text" id="S3.T5.22.22.22.2.1" style="font-size:90%;">63.4</span><math alttext="{}_{5.2}" class="ltx_Math" display="inline" id="S3.T5.22.22.22.2.m1.1"><semantics id="S3.T5.22.22.22.2.m1.1a"><msub id="S3.T5.22.22.22.2.m1.1.1" xref="S3.T5.22.22.22.2.m1.1.1.cmml"><mi id="S3.T5.22.22.22.2.m1.1.1a" xref="S3.T5.22.22.22.2.m1.1.1.cmml"></mi><mn id="S3.T5.22.22.22.2.m1.1.1.1" mathsize="90%" xref="S3.T5.22.22.22.2.m1.1.1.1.cmml">5.2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.22.22.22.2.m1.1b"><apply id="S3.T5.22.22.22.2.m1.1.1.cmml" xref="S3.T5.22.22.22.2.m1.1.1"><cn id="S3.T5.22.22.22.2.m1.1.1.1.cmml" type="float" xref="S3.T5.22.22.22.2.m1.1.1.1">5.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.22.22.22.2.m1.1c">{}_{5.2}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.22.22.22.2.m1.1d">start_FLOATSUBSCRIPT 5.2 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.23.23.23.3">
<span class="ltx_text" id="S3.T5.23.23.23.3.1" style="font-size:90%;">57.6</span><math alttext="{}_{10.2}" class="ltx_Math" display="inline" id="S3.T5.23.23.23.3.m1.1"><semantics id="S3.T5.23.23.23.3.m1.1a"><msub id="S3.T5.23.23.23.3.m1.1.1" xref="S3.T5.23.23.23.3.m1.1.1.cmml"><mi id="S3.T5.23.23.23.3.m1.1.1a" xref="S3.T5.23.23.23.3.m1.1.1.cmml"></mi><mn id="S3.T5.23.23.23.3.m1.1.1.1" mathsize="90%" xref="S3.T5.23.23.23.3.m1.1.1.1.cmml">10.2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.23.23.23.3.m1.1b"><apply id="S3.T5.23.23.23.3.m1.1.1.cmml" xref="S3.T5.23.23.23.3.m1.1.1"><cn id="S3.T5.23.23.23.3.m1.1.1.1.cmml" type="float" xref="S3.T5.23.23.23.3.m1.1.1.1">10.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.23.23.23.3.m1.1c">{}_{10.2}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.23.23.23.3.m1.1d">start_FLOATSUBSCRIPT 10.2 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.24.24.24.4">
<span class="ltx_text" id="S3.T5.24.24.24.4.1" style="font-size:90%;">33.6</span><math alttext="{}_{6.0}" class="ltx_Math" display="inline" id="S3.T5.24.24.24.4.m1.1"><semantics id="S3.T5.24.24.24.4.m1.1a"><msub id="S3.T5.24.24.24.4.m1.1.1" xref="S3.T5.24.24.24.4.m1.1.1.cmml"><mi id="S3.T5.24.24.24.4.m1.1.1a" xref="S3.T5.24.24.24.4.m1.1.1.cmml"></mi><mn id="S3.T5.24.24.24.4.m1.1.1.1" mathsize="90%" xref="S3.T5.24.24.24.4.m1.1.1.1.cmml">6.0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.24.24.24.4.m1.1b"><apply id="S3.T5.24.24.24.4.m1.1.1.cmml" xref="S3.T5.24.24.24.4.m1.1.1"><cn id="S3.T5.24.24.24.4.m1.1.1.1.cmml" type="float" xref="S3.T5.24.24.24.4.m1.1.1.1">6.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.24.24.24.4.m1.1c">{}_{6.0}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.24.24.24.4.m1.1d">start_FLOATSUBSCRIPT 6.0 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.25.25.25.5">
<span class="ltx_text" id="S3.T5.25.25.25.5.1" style="font-size:90%;">70.8</span><math alttext="{}_{7.6}" class="ltx_Math" display="inline" id="S3.T5.25.25.25.5.m1.1"><semantics id="S3.T5.25.25.25.5.m1.1a"><msub id="S3.T5.25.25.25.5.m1.1.1" xref="S3.T5.25.25.25.5.m1.1.1.cmml"><mi id="S3.T5.25.25.25.5.m1.1.1a" xref="S3.T5.25.25.25.5.m1.1.1.cmml"></mi><mn id="S3.T5.25.25.25.5.m1.1.1.1" mathsize="90%" xref="S3.T5.25.25.25.5.m1.1.1.1.cmml">7.6</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.25.25.25.5.m1.1b"><apply id="S3.T5.25.25.25.5.m1.1.1.cmml" xref="S3.T5.25.25.25.5.m1.1.1"><cn id="S3.T5.25.25.25.5.m1.1.1.1.cmml" type="float" xref="S3.T5.25.25.25.5.m1.1.1.1">7.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.25.25.25.5.m1.1c">{}_{7.6}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.25.25.25.5.m1.1d">start_FLOATSUBSCRIPT 7.6 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.25.25.25.9"><span class="ltx_text" id="S3.T5.25.25.25.9.1" style="font-size:90%;">58.7</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.30.30.30">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T5.30.30.30.6"><span class="ltx_text" id="S3.T5.30.30.30.6.1" style="font-size:90%;">MemTRM</span></th>
<td class="ltx_td ltx_align_center" id="S3.T5.30.30.30.7"><span class="ltx_text" id="S3.T5.30.30.30.7.1" style="font-size:90%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.30.30.30.8"><span class="ltx_text" id="S3.T5.30.30.30.8.1" style="font-size:90%;">2000</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.26.26.26.1">
<span class="ltx_text" id="S3.T5.26.26.26.1.1" style="font-size:90%;">65.1</span><math alttext="{}_{9.6}" class="ltx_Math" display="inline" id="S3.T5.26.26.26.1.m1.1"><semantics id="S3.T5.26.26.26.1.m1.1a"><msub id="S3.T5.26.26.26.1.m1.1.1" xref="S3.T5.26.26.26.1.m1.1.1.cmml"><mi id="S3.T5.26.26.26.1.m1.1.1a" xref="S3.T5.26.26.26.1.m1.1.1.cmml"></mi><mn id="S3.T5.26.26.26.1.m1.1.1.1" mathsize="90%" xref="S3.T5.26.26.26.1.m1.1.1.1.cmml">9.6</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.26.26.26.1.m1.1b"><apply id="S3.T5.26.26.26.1.m1.1.1.cmml" xref="S3.T5.26.26.26.1.m1.1.1"><cn id="S3.T5.26.26.26.1.m1.1.1.1.cmml" type="float" xref="S3.T5.26.26.26.1.m1.1.1.1">9.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.26.26.26.1.m1.1c">{}_{9.6}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.26.26.26.1.m1.1d">start_FLOATSUBSCRIPT 9.6 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.27.27.27.2">
<span class="ltx_text" id="S3.T5.27.27.27.2.1" style="font-size:90%;">65.1</span><math alttext="{}_{9.3}" class="ltx_Math" display="inline" id="S3.T5.27.27.27.2.m1.1"><semantics id="S3.T5.27.27.27.2.m1.1a"><msub id="S3.T5.27.27.27.2.m1.1.1" xref="S3.T5.27.27.27.2.m1.1.1.cmml"><mi id="S3.T5.27.27.27.2.m1.1.1a" xref="S3.T5.27.27.27.2.m1.1.1.cmml"></mi><mn id="S3.T5.27.27.27.2.m1.1.1.1" mathsize="90%" xref="S3.T5.27.27.27.2.m1.1.1.1.cmml">9.3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.27.27.27.2.m1.1b"><apply id="S3.T5.27.27.27.2.m1.1.1.cmml" xref="S3.T5.27.27.27.2.m1.1.1"><cn id="S3.T5.27.27.27.2.m1.1.1.1.cmml" type="float" xref="S3.T5.27.27.27.2.m1.1.1.1">9.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.27.27.27.2.m1.1c">{}_{9.3}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.27.27.27.2.m1.1d">start_FLOATSUBSCRIPT 9.3 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.28.28.28.3">
<span class="ltx_text" id="S3.T5.28.28.28.3.1" style="font-size:90%;">58.2</span><math alttext="{}_{10.6}" class="ltx_Math" display="inline" id="S3.T5.28.28.28.3.m1.1"><semantics id="S3.T5.28.28.28.3.m1.1a"><msub id="S3.T5.28.28.28.3.m1.1.1" xref="S3.T5.28.28.28.3.m1.1.1.cmml"><mi id="S3.T5.28.28.28.3.m1.1.1a" xref="S3.T5.28.28.28.3.m1.1.1.cmml"></mi><mn id="S3.T5.28.28.28.3.m1.1.1.1" mathsize="90%" xref="S3.T5.28.28.28.3.m1.1.1.1.cmml">10.6</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.28.28.28.3.m1.1b"><apply id="S3.T5.28.28.28.3.m1.1.1.cmml" xref="S3.T5.28.28.28.3.m1.1.1"><cn id="S3.T5.28.28.28.3.m1.1.1.1.cmml" type="float" xref="S3.T5.28.28.28.3.m1.1.1.1">10.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.28.28.28.3.m1.1c">{}_{10.6}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.28.28.28.3.m1.1d">start_FLOATSUBSCRIPT 10.6 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.29.29.29.4">
<span class="ltx_text" id="S3.T5.29.29.29.4.1" style="font-size:90%;">31.9</span><math alttext="{}_{6.3}" class="ltx_Math" display="inline" id="S3.T5.29.29.29.4.m1.1"><semantics id="S3.T5.29.29.29.4.m1.1a"><msub id="S3.T5.29.29.29.4.m1.1.1" xref="S3.T5.29.29.29.4.m1.1.1.cmml"><mi id="S3.T5.29.29.29.4.m1.1.1a" xref="S3.T5.29.29.29.4.m1.1.1.cmml"></mi><mn id="S3.T5.29.29.29.4.m1.1.1.1" mathsize="90%" xref="S3.T5.29.29.29.4.m1.1.1.1.cmml">6.3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.29.29.29.4.m1.1b"><apply id="S3.T5.29.29.29.4.m1.1.1.cmml" xref="S3.T5.29.29.29.4.m1.1.1"><cn id="S3.T5.29.29.29.4.m1.1.1.1.cmml" type="float" xref="S3.T5.29.29.29.4.m1.1.1.1">6.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.29.29.29.4.m1.1c">{}_{6.3}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.29.29.29.4.m1.1d">start_FLOATSUBSCRIPT 6.3 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.30.30.30.5">
<span class="ltx_text" id="S3.T5.30.30.30.5.1" style="font-size:90%;">72.7</span><math alttext="{}_{7.4}" class="ltx_Math" display="inline" id="S3.T5.30.30.30.5.m1.1"><semantics id="S3.T5.30.30.30.5.m1.1a"><msub id="S3.T5.30.30.30.5.m1.1.1" xref="S3.T5.30.30.30.5.m1.1.1.cmml"><mi id="S3.T5.30.30.30.5.m1.1.1a" xref="S3.T5.30.30.30.5.m1.1.1.cmml"></mi><mn id="S3.T5.30.30.30.5.m1.1.1.1" mathsize="90%" xref="S3.T5.30.30.30.5.m1.1.1.1.cmml">7.4</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.30.30.30.5.m1.1b"><apply id="S3.T5.30.30.30.5.m1.1.1.cmml" xref="S3.T5.30.30.30.5.m1.1.1"><cn id="S3.T5.30.30.30.5.m1.1.1.1.cmml" type="float" xref="S3.T5.30.30.30.5.m1.1.1.1">7.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.30.30.30.5.m1.1c">{}_{7.4}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.30.30.30.5.m1.1d">start_FLOATSUBSCRIPT 7.4 end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.30.30.30.9"><span class="ltx_text" id="S3.T5.30.30.30.9.1" style="font-size:90%;">58.6</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.35.35.35">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_b" id="S3.T5.35.35.35.6"><span class="ltx_text ltx_font_smallcaps" id="S3.T5.35.35.35.6.1" style="font-size:90%;">LongMem</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S3.T5.35.35.35.7"><span class="ltx_text" id="S3.T5.35.35.35.7.1" style="font-size:90%;">20</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S3.T5.35.35.35.8"><span class="ltx_text" id="S3.T5.35.35.35.8.1" style="font-size:90%;">2000</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S3.T5.31.31.31.1"><span class="ltx_text ltx_font_bold" id="S3.T5.31.31.31.1.1" style="font-size:90%;">78.0<math alttext="{}_{14.1}" class="ltx_Math" display="inline" id="S3.T5.31.31.31.1.1.m1.1"><semantics id="S3.T5.31.31.31.1.1.m1.1a"><msub id="S3.T5.31.31.31.1.1.m1.1.1" xref="S3.T5.31.31.31.1.1.m1.1.1.cmml"><mi id="S3.T5.31.31.31.1.1.m1.1.1a" xref="S3.T5.31.31.31.1.1.m1.1.1.cmml"></mi><mn id="S3.T5.31.31.31.1.1.m1.1.1.1" mathvariant="normal" xref="S3.T5.31.31.31.1.1.m1.1.1.1.cmml">14.1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.31.31.31.1.1.m1.1b"><apply id="S3.T5.31.31.31.1.1.m1.1.1.cmml" xref="S3.T5.31.31.31.1.1.m1.1.1"><cn id="S3.T5.31.31.31.1.1.m1.1.1.1.cmml" type="float" xref="S3.T5.31.31.31.1.1.m1.1.1.1">14.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.31.31.31.1.1.m1.1c">{}_{14.1}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.31.31.31.1.1.m1.1d">start_FLOATSUBSCRIPT 14.1 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S3.T5.32.32.32.2"><span class="ltx_text ltx_font_bold" id="S3.T5.32.32.32.2.1" style="font-size:90%;">78.6<math alttext="{}_{3.3}" class="ltx_Math" display="inline" id="S3.T5.32.32.32.2.1.m1.1"><semantics id="S3.T5.32.32.32.2.1.m1.1a"><msub id="S3.T5.32.32.32.2.1.m1.1.1" xref="S3.T5.32.32.32.2.1.m1.1.1.cmml"><mi id="S3.T5.32.32.32.2.1.m1.1.1a" xref="S3.T5.32.32.32.2.1.m1.1.1.cmml"></mi><mn id="S3.T5.32.32.32.2.1.m1.1.1.1" mathvariant="normal" xref="S3.T5.32.32.32.2.1.m1.1.1.1.cmml">3.3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.32.32.32.2.1.m1.1b"><apply id="S3.T5.32.32.32.2.1.m1.1.1.cmml" xref="S3.T5.32.32.32.2.1.m1.1.1"><cn id="S3.T5.32.32.32.2.1.m1.1.1.1.cmml" type="float" xref="S3.T5.32.32.32.2.1.m1.1.1.1">3.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.32.32.32.2.1.m1.1c">{}_{3.3}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.32.32.32.2.1.m1.1d">start_FLOATSUBSCRIPT 3.3 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S3.T5.33.33.33.3"><span class="ltx_text ltx_font_bold" id="S3.T5.33.33.33.3.1" style="font-size:90%;">65.6<math alttext="{}_{8.5}" class="ltx_Math" display="inline" id="S3.T5.33.33.33.3.1.m1.1"><semantics id="S3.T5.33.33.33.3.1.m1.1a"><msub id="S3.T5.33.33.33.3.1.m1.1.1" xref="S3.T5.33.33.33.3.1.m1.1.1.cmml"><mi id="S3.T5.33.33.33.3.1.m1.1.1a" xref="S3.T5.33.33.33.3.1.m1.1.1.cmml"></mi><mn id="S3.T5.33.33.33.3.1.m1.1.1.1" mathvariant="normal" xref="S3.T5.33.33.33.3.1.m1.1.1.1.cmml">8.5</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.33.33.33.3.1.m1.1b"><apply id="S3.T5.33.33.33.3.1.m1.1.1.cmml" xref="S3.T5.33.33.33.3.1.m1.1.1"><cn id="S3.T5.33.33.33.3.1.m1.1.1.1.cmml" type="float" xref="S3.T5.33.33.33.3.1.m1.1.1.1">8.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.33.33.33.3.1.m1.1c">{}_{8.5}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.33.33.33.3.1.m1.1d">start_FLOATSUBSCRIPT 8.5 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S3.T5.34.34.34.4"><span class="ltx_text ltx_font_bold" id="S3.T5.34.34.34.4.1" style="font-size:90%;">36.5<math alttext="{}_{7.5}" class="ltx_Math" display="inline" id="S3.T5.34.34.34.4.1.m1.1"><semantics id="S3.T5.34.34.34.4.1.m1.1a"><msub id="S3.T5.34.34.34.4.1.m1.1.1" xref="S3.T5.34.34.34.4.1.m1.1.1.cmml"><mi id="S3.T5.34.34.34.4.1.m1.1.1a" xref="S3.T5.34.34.34.4.1.m1.1.1.cmml"></mi><mn id="S3.T5.34.34.34.4.1.m1.1.1.1" mathvariant="normal" xref="S3.T5.34.34.34.4.1.m1.1.1.1.cmml">7.5</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.34.34.34.4.1.m1.1b"><apply id="S3.T5.34.34.34.4.1.m1.1.1.cmml" xref="S3.T5.34.34.34.4.1.m1.1.1"><cn id="S3.T5.34.34.34.4.1.m1.1.1.1.cmml" type="float" xref="S3.T5.34.34.34.4.1.m1.1.1.1">7.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.34.34.34.4.1.m1.1c">{}_{7.5}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.34.34.34.4.1.m1.1d">start_FLOATSUBSCRIPT 7.5 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S3.T5.35.35.35.5"><span class="ltx_text ltx_font_bold" id="S3.T5.35.35.35.5.1" style="font-size:90%;">74.6<math alttext="{}_{7.3}" class="ltx_Math" display="inline" id="S3.T5.35.35.35.5.1.m1.1"><semantics id="S3.T5.35.35.35.5.1.m1.1a"><msub id="S3.T5.35.35.35.5.1.m1.1.1" xref="S3.T5.35.35.35.5.1.m1.1.1.cmml"><mi id="S3.T5.35.35.35.5.1.m1.1.1a" xref="S3.T5.35.35.35.5.1.m1.1.1.cmml"></mi><mn id="S3.T5.35.35.35.5.1.m1.1.1.1" mathvariant="normal" xref="S3.T5.35.35.35.5.1.m1.1.1.1.cmml">7.3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T5.35.35.35.5.1.m1.1b"><apply id="S3.T5.35.35.35.5.1.m1.1.1.cmml" xref="S3.T5.35.35.35.5.1.m1.1.1"><cn id="S3.T5.35.35.35.5.1.m1.1.1.1.cmml" type="float" xref="S3.T5.35.35.35.5.1.m1.1.1.1">7.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.35.35.35.5.1.m1.1c">{}_{7.3}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.35.35.35.5.1.m1.1d">start_FLOATSUBSCRIPT 7.3 end_FLOATSUBSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S3.T5.35.35.35.9"><span class="ltx_text ltx_font_bold" id="S3.T5.35.35.35.9.1" style="font-size:90%;">66.7</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 5: </span>Accuracy [%] of 4-shot and 20-shot ICL on 5 NLU tasks (SST-2, mr, subj, SST-5, mpqa). We sample 2000 extra demonstration examples and load them into cached memory. The subscript is the standard deviation across 6 runs. Avg. refers to the average accuracy on 5 datasets.
</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Ablation Studies</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.2">So far, we empirically verify the effectiveness and superiority of <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p1.2.1">LongMem</span> in utilizing cached memory for long-context modeling, long-context understanding, and many-shot in-context learning. As the design of cached memory bank involves many hyperparameters like memory size <math alttext="msz" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mrow id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">m</mi><mo id="S3.SS4.p1.1.m1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.cmml">‚Å¢</mo><mi id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml">s</mi><mo id="S3.SS4.p1.1.m1.1.1.1a" xref="S3.SS4.p1.1.m1.1.1.1.cmml">‚Å¢</mo><mi id="S3.SS4.p1.1.m1.1.1.4" xref="S3.SS4.p1.1.m1.1.1.4.cmml">z</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><times id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1"></times><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">ùëö</ci><ci id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">ùë†</ci><ci id="S3.SS4.p1.1.m1.1.1.4.cmml" xref="S3.SS4.p1.1.m1.1.1.4">ùëß</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">msz</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">italic_m italic_s italic_z</annotation></semantics></math> and chunk-size <math alttext="csz" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.1"><semantics id="S3.SS4.p1.2.m2.1a"><mrow id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">c</mi><mo id="S3.SS4.p1.2.m2.1.1.1" xref="S3.SS4.p1.2.m2.1.1.1.cmml">‚Å¢</mo><mi id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">s</mi><mo id="S3.SS4.p1.2.m2.1.1.1a" xref="S3.SS4.p1.2.m2.1.1.1.cmml">‚Å¢</mo><mi id="S3.SS4.p1.2.m2.1.1.4" xref="S3.SS4.p1.2.m2.1.1.4.cmml">z</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><times id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1"></times><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">ùëê</ci><ci id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3">ùë†</ci><ci id="S3.SS4.p1.2.m2.1.1.4.cmml" xref="S3.SS4.p1.2.m2.1.1.4">ùëß</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">csz</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.1d">italic_c italic_s italic_z</annotation></semantics></math>, we perform a series of ablation studies to evaluate the effects of these hyperparameters on task performance.</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.2"><span class="ltx_text ltx_font_bold" id="S3.SS4.p2.2.1">Effects of Chunk-Size.</span> As analyzed before, the chunk-size <math alttext="csz" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.1"><semantics id="S3.SS4.p2.1.m1.1a"><mrow id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml">c</mi><mo id="S3.SS4.p2.1.m1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.cmml">‚Å¢</mo><mi id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml">s</mi><mo id="S3.SS4.p2.1.m1.1.1.1a" xref="S3.SS4.p2.1.m1.1.1.1.cmml">‚Å¢</mo><mi id="S3.SS4.p2.1.m1.1.1.4" xref="S3.SS4.p2.1.m1.1.1.4.cmml">z</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><times id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1"></times><ci id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2">ùëê</ci><ci id="S3.SS4.p2.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3">ùë†</ci><ci id="S3.SS4.p2.1.m1.1.1.4.cmml" xref="S3.SS4.p2.1.m1.1.1.4">ùëß</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">csz</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.1d">italic_c italic_s italic_z</annotation></semantics></math> controls the granularity of retrieval and thus it may make a difference to tasks with requirements of fine-grained retrieval like in-context learning. We perform an ablation study on the effects of various chunk-size <math alttext="csz\in\{2,4,8\}" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.3"><semantics id="S3.SS4.p2.2.m2.3a"><mrow id="S3.SS4.p2.2.m2.3.4" xref="S3.SS4.p2.2.m2.3.4.cmml"><mrow id="S3.SS4.p2.2.m2.3.4.2" xref="S3.SS4.p2.2.m2.3.4.2.cmml"><mi id="S3.SS4.p2.2.m2.3.4.2.2" xref="S3.SS4.p2.2.m2.3.4.2.2.cmml">c</mi><mo id="S3.SS4.p2.2.m2.3.4.2.1" xref="S3.SS4.p2.2.m2.3.4.2.1.cmml">‚Å¢</mo><mi id="S3.SS4.p2.2.m2.3.4.2.3" xref="S3.SS4.p2.2.m2.3.4.2.3.cmml">s</mi><mo id="S3.SS4.p2.2.m2.3.4.2.1a" xref="S3.SS4.p2.2.m2.3.4.2.1.cmml">‚Å¢</mo><mi id="S3.SS4.p2.2.m2.3.4.2.4" xref="S3.SS4.p2.2.m2.3.4.2.4.cmml">z</mi></mrow><mo id="S3.SS4.p2.2.m2.3.4.1" xref="S3.SS4.p2.2.m2.3.4.1.cmml">‚àà</mo><mrow id="S3.SS4.p2.2.m2.3.4.3.2" xref="S3.SS4.p2.2.m2.3.4.3.1.cmml"><mo id="S3.SS4.p2.2.m2.3.4.3.2.1" stretchy="false" xref="S3.SS4.p2.2.m2.3.4.3.1.cmml">{</mo><mn id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml">2</mn><mo id="S3.SS4.p2.2.m2.3.4.3.2.2" xref="S3.SS4.p2.2.m2.3.4.3.1.cmml">,</mo><mn id="S3.SS4.p2.2.m2.2.2" xref="S3.SS4.p2.2.m2.2.2.cmml">4</mn><mo id="S3.SS4.p2.2.m2.3.4.3.2.3" xref="S3.SS4.p2.2.m2.3.4.3.1.cmml">,</mo><mn id="S3.SS4.p2.2.m2.3.3" xref="S3.SS4.p2.2.m2.3.3.cmml">8</mn><mo id="S3.SS4.p2.2.m2.3.4.3.2.4" stretchy="false" xref="S3.SS4.p2.2.m2.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.3b"><apply id="S3.SS4.p2.2.m2.3.4.cmml" xref="S3.SS4.p2.2.m2.3.4"><in id="S3.SS4.p2.2.m2.3.4.1.cmml" xref="S3.SS4.p2.2.m2.3.4.1"></in><apply id="S3.SS4.p2.2.m2.3.4.2.cmml" xref="S3.SS4.p2.2.m2.3.4.2"><times id="S3.SS4.p2.2.m2.3.4.2.1.cmml" xref="S3.SS4.p2.2.m2.3.4.2.1"></times><ci id="S3.SS4.p2.2.m2.3.4.2.2.cmml" xref="S3.SS4.p2.2.m2.3.4.2.2">ùëê</ci><ci id="S3.SS4.p2.2.m2.3.4.2.3.cmml" xref="S3.SS4.p2.2.m2.3.4.2.3">ùë†</ci><ci id="S3.SS4.p2.2.m2.3.4.2.4.cmml" xref="S3.SS4.p2.2.m2.3.4.2.4">ùëß</ci></apply><set id="S3.SS4.p2.2.m2.3.4.3.1.cmml" xref="S3.SS4.p2.2.m2.3.4.3.2"><cn id="S3.SS4.p2.2.m2.1.1.cmml" type="integer" xref="S3.SS4.p2.2.m2.1.1">2</cn><cn id="S3.SS4.p2.2.m2.2.2.cmml" type="integer" xref="S3.SS4.p2.2.m2.2.2">4</cn><cn id="S3.SS4.p2.2.m2.3.3.cmml" type="integer" xref="S3.SS4.p2.2.m2.3.3">8</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.3c">csz\in\{2,4,8\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.2.m2.3d">italic_c italic_s italic_z ‚àà { 2 , 4 , 8 }</annotation></semantics></math> on in-context learning and the results are presented in Figure¬†<a class="ltx_ref" href="#S3.F4" title="Figure 4 ‚Ä£ 3.4 Ablation Studies ‚Ä£ 3 Experiments ‚Ä£ Augmenting Language Models with Long-Term Memory"><span class="ltx_text ltx_ref_tag">4</span></a>. The chunk size of 2 yields the best performance on in-context learning tasks on five NLU datasets, which is consistent with the property of NLU tasks with the requirement of fine-grained retrieval and fusion towards classification label tokens.</p>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.3"><span class="ltx_text ltx_font_bold" id="S3.SS4.p3.3.1">Effects of Memory Size.</span> The memory size (msz) controls the capacity of the memory bank. In general, the memory size should be compatible with the average length of documents or contexts, <em class="ltx_emph ltx_font_italic" id="S3.SS4.p3.3.2">i.e.,</em>¬†, a set of books with average 16k tokens should deploy the memory size of 16k tokens in cached memory. The training <math alttext="msz" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.1"><semantics id="S3.SS4.p3.1.m1.1a"><mrow id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml"><mi id="S3.SS4.p3.1.m1.1.1.2" xref="S3.SS4.p3.1.m1.1.1.2.cmml">m</mi><mo id="S3.SS4.p3.1.m1.1.1.1" xref="S3.SS4.p3.1.m1.1.1.1.cmml">‚Å¢</mo><mi id="S3.SS4.p3.1.m1.1.1.3" xref="S3.SS4.p3.1.m1.1.1.3.cmml">s</mi><mo id="S3.SS4.p3.1.m1.1.1.1a" xref="S3.SS4.p3.1.m1.1.1.1.cmml">‚Å¢</mo><mi id="S3.SS4.p3.1.m1.1.1.4" xref="S3.SS4.p3.1.m1.1.1.4.cmml">z</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><apply id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1"><times id="S3.SS4.p3.1.m1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1"></times><ci id="S3.SS4.p3.1.m1.1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.1.2">ùëö</ci><ci id="S3.SS4.p3.1.m1.1.1.3.cmml" xref="S3.SS4.p3.1.m1.1.1.3">ùë†</ci><ci id="S3.SS4.p3.1.m1.1.1.4.cmml" xref="S3.SS4.p3.1.m1.1.1.4">ùëß</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">msz</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.1.m1.1d">italic_m italic_s italic_z</annotation></semantics></math> of 65 tokens is excessive for downstream tasks such as ChapterBreak as the whole prefix context length does not exceed 65k tokens. Thus, we perform an ablation study on the effects of memory size <math alttext="msz\in\{8k,16k,32k,65k\}" class="ltx_Math" display="inline" id="S3.SS4.p3.2.m2.4"><semantics id="S3.SS4.p3.2.m2.4a"><mrow id="S3.SS4.p3.2.m2.4.4" xref="S3.SS4.p3.2.m2.4.4.cmml"><mrow id="S3.SS4.p3.2.m2.4.4.6" xref="S3.SS4.p3.2.m2.4.4.6.cmml"><mi id="S3.SS4.p3.2.m2.4.4.6.2" xref="S3.SS4.p3.2.m2.4.4.6.2.cmml">m</mi><mo id="S3.SS4.p3.2.m2.4.4.6.1" xref="S3.SS4.p3.2.m2.4.4.6.1.cmml">‚Å¢</mo><mi id="S3.SS4.p3.2.m2.4.4.6.3" xref="S3.SS4.p3.2.m2.4.4.6.3.cmml">s</mi><mo id="S3.SS4.p3.2.m2.4.4.6.1a" xref="S3.SS4.p3.2.m2.4.4.6.1.cmml">‚Å¢</mo><mi id="S3.SS4.p3.2.m2.4.4.6.4" xref="S3.SS4.p3.2.m2.4.4.6.4.cmml">z</mi></mrow><mo id="S3.SS4.p3.2.m2.4.4.5" xref="S3.SS4.p3.2.m2.4.4.5.cmml">‚àà</mo><mrow id="S3.SS4.p3.2.m2.4.4.4.4" xref="S3.SS4.p3.2.m2.4.4.4.5.cmml"><mo id="S3.SS4.p3.2.m2.4.4.4.4.5" stretchy="false" xref="S3.SS4.p3.2.m2.4.4.4.5.cmml">{</mo><mrow id="S3.SS4.p3.2.m2.1.1.1.1.1" xref="S3.SS4.p3.2.m2.1.1.1.1.1.cmml"><mn id="S3.SS4.p3.2.m2.1.1.1.1.1.2" xref="S3.SS4.p3.2.m2.1.1.1.1.1.2.cmml">8</mn><mo id="S3.SS4.p3.2.m2.1.1.1.1.1.1" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.cmml">‚Å¢</mo><mi id="S3.SS4.p3.2.m2.1.1.1.1.1.3" xref="S3.SS4.p3.2.m2.1.1.1.1.1.3.cmml">k</mi></mrow><mo id="S3.SS4.p3.2.m2.4.4.4.4.6" xref="S3.SS4.p3.2.m2.4.4.4.5.cmml">,</mo><mrow id="S3.SS4.p3.2.m2.2.2.2.2.2" xref="S3.SS4.p3.2.m2.2.2.2.2.2.cmml"><mn id="S3.SS4.p3.2.m2.2.2.2.2.2.2" xref="S3.SS4.p3.2.m2.2.2.2.2.2.2.cmml">16</mn><mo id="S3.SS4.p3.2.m2.2.2.2.2.2.1" xref="S3.SS4.p3.2.m2.2.2.2.2.2.1.cmml">‚Å¢</mo><mi id="S3.SS4.p3.2.m2.2.2.2.2.2.3" xref="S3.SS4.p3.2.m2.2.2.2.2.2.3.cmml">k</mi></mrow><mo id="S3.SS4.p3.2.m2.4.4.4.4.7" xref="S3.SS4.p3.2.m2.4.4.4.5.cmml">,</mo><mrow id="S3.SS4.p3.2.m2.3.3.3.3.3" xref="S3.SS4.p3.2.m2.3.3.3.3.3.cmml"><mn id="S3.SS4.p3.2.m2.3.3.3.3.3.2" xref="S3.SS4.p3.2.m2.3.3.3.3.3.2.cmml">32</mn><mo id="S3.SS4.p3.2.m2.3.3.3.3.3.1" xref="S3.SS4.p3.2.m2.3.3.3.3.3.1.cmml">‚Å¢</mo><mi id="S3.SS4.p3.2.m2.3.3.3.3.3.3" xref="S3.SS4.p3.2.m2.3.3.3.3.3.3.cmml">k</mi></mrow><mo id="S3.SS4.p3.2.m2.4.4.4.4.8" xref="S3.SS4.p3.2.m2.4.4.4.5.cmml">,</mo><mrow id="S3.SS4.p3.2.m2.4.4.4.4.4" xref="S3.SS4.p3.2.m2.4.4.4.4.4.cmml"><mn id="S3.SS4.p3.2.m2.4.4.4.4.4.2" xref="S3.SS4.p3.2.m2.4.4.4.4.4.2.cmml">65</mn><mo id="S3.SS4.p3.2.m2.4.4.4.4.4.1" xref="S3.SS4.p3.2.m2.4.4.4.4.4.1.cmml">‚Å¢</mo><mi id="S3.SS4.p3.2.m2.4.4.4.4.4.3" xref="S3.SS4.p3.2.m2.4.4.4.4.4.3.cmml">k</mi></mrow><mo id="S3.SS4.p3.2.m2.4.4.4.4.9" stretchy="false" xref="S3.SS4.p3.2.m2.4.4.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.4b"><apply id="S3.SS4.p3.2.m2.4.4.cmml" xref="S3.SS4.p3.2.m2.4.4"><in id="S3.SS4.p3.2.m2.4.4.5.cmml" xref="S3.SS4.p3.2.m2.4.4.5"></in><apply id="S3.SS4.p3.2.m2.4.4.6.cmml" xref="S3.SS4.p3.2.m2.4.4.6"><times id="S3.SS4.p3.2.m2.4.4.6.1.cmml" xref="S3.SS4.p3.2.m2.4.4.6.1"></times><ci id="S3.SS4.p3.2.m2.4.4.6.2.cmml" xref="S3.SS4.p3.2.m2.4.4.6.2">ùëö</ci><ci id="S3.SS4.p3.2.m2.4.4.6.3.cmml" xref="S3.SS4.p3.2.m2.4.4.6.3">ùë†</ci><ci id="S3.SS4.p3.2.m2.4.4.6.4.cmml" xref="S3.SS4.p3.2.m2.4.4.6.4">ùëß</ci></apply><set id="S3.SS4.p3.2.m2.4.4.4.5.cmml" xref="S3.SS4.p3.2.m2.4.4.4.4"><apply id="S3.SS4.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.1"><times id="S3.SS4.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1"></times><cn id="S3.SS4.p3.2.m2.1.1.1.1.1.2.cmml" type="integer" xref="S3.SS4.p3.2.m2.1.1.1.1.1.2">8</cn><ci id="S3.SS4.p3.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.1.3">ùëò</ci></apply><apply id="S3.SS4.p3.2.m2.2.2.2.2.2.cmml" xref="S3.SS4.p3.2.m2.2.2.2.2.2"><times id="S3.SS4.p3.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS4.p3.2.m2.2.2.2.2.2.1"></times><cn id="S3.SS4.p3.2.m2.2.2.2.2.2.2.cmml" type="integer" xref="S3.SS4.p3.2.m2.2.2.2.2.2.2">16</cn><ci id="S3.SS4.p3.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS4.p3.2.m2.2.2.2.2.2.3">ùëò</ci></apply><apply id="S3.SS4.p3.2.m2.3.3.3.3.3.cmml" xref="S3.SS4.p3.2.m2.3.3.3.3.3"><times id="S3.SS4.p3.2.m2.3.3.3.3.3.1.cmml" xref="S3.SS4.p3.2.m2.3.3.3.3.3.1"></times><cn id="S3.SS4.p3.2.m2.3.3.3.3.3.2.cmml" type="integer" xref="S3.SS4.p3.2.m2.3.3.3.3.3.2">32</cn><ci id="S3.SS4.p3.2.m2.3.3.3.3.3.3.cmml" xref="S3.SS4.p3.2.m2.3.3.3.3.3.3">ùëò</ci></apply><apply id="S3.SS4.p3.2.m2.4.4.4.4.4.cmml" xref="S3.SS4.p3.2.m2.4.4.4.4.4"><times id="S3.SS4.p3.2.m2.4.4.4.4.4.1.cmml" xref="S3.SS4.p3.2.m2.4.4.4.4.4.1"></times><cn id="S3.SS4.p3.2.m2.4.4.4.4.4.2.cmml" type="integer" xref="S3.SS4.p3.2.m2.4.4.4.4.4.2">65</cn><ci id="S3.SS4.p3.2.m2.4.4.4.4.4.3.cmml" xref="S3.SS4.p3.2.m2.4.4.4.4.4.3">ùëò</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.4c">msz\in\{8k,16k,32k,65k\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.2.m2.4d">italic_m italic_s italic_z ‚àà { 8 italic_k , 16 italic_k , 32 italic_k , 65 italic_k }</annotation></semantics></math> during the inference stage on the PG-22 language modeling datasets and the results are shown in Figure¬†<a class="ltx_ref" href="#S3.F4" title="Figure 4 ‚Ä£ 3.4 Ablation Studies ‚Ä£ 3 Experiments ‚Ä£ Augmenting Language Models with Long-Term Memory"><span class="ltx_text ltx_ref_tag">4</span></a>. To model the books with average 8k-50k length, the smaller memory size <math alttext="16k" class="ltx_Math" display="inline" id="S3.SS4.p3.3.m3.1"><semantics id="S3.SS4.p3.3.m3.1a"><mrow id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml"><mn id="S3.SS4.p3.3.m3.1.1.2" xref="S3.SS4.p3.3.m3.1.1.2.cmml">16</mn><mo id="S3.SS4.p3.3.m3.1.1.1" xref="S3.SS4.p3.3.m3.1.1.1.cmml">‚Å¢</mo><mi id="S3.SS4.p3.3.m3.1.1.3" xref="S3.SS4.p3.3.m3.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.1b"><apply id="S3.SS4.p3.3.m3.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1"><times id="S3.SS4.p3.3.m3.1.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1.1"></times><cn id="S3.SS4.p3.3.m3.1.1.2.cmml" type="integer" xref="S3.SS4.p3.3.m3.1.1.2">16</cn><ci id="S3.SS4.p3.3.m3.1.1.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3">ùëò</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.1c">16k</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.3.m3.1d">16 italic_k</annotation></semantics></math> which is consistent with the average length of target books yields the best perplexity.</p>
</div>
<figure class="ltx_figure" id="S3.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_flex_size_2 ltx_align_center" id="S3.F4.1"><span class="ltx_inline-para ltx_minipage ltx_align_middle" id="S3.F4.1.1" style="width:216.8pt;">
<span class="ltx_para ltx_align_center" id="S3.F4.1.1.p1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="328" id="S3.F4.1.1.p1.g1" src="x4.png" width="830"/>
</span></span>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_flex_size_2 ltx_align_center" id="S3.F4.2"><span class="ltx_inline-para ltx_minipage ltx_align_middle" id="S3.F4.2.1" style="width:195.1pt;">
<span class="ltx_para ltx_align_center" id="S3.F4.2.1.p1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="415" id="S3.F4.2.1.p1.g1" src="x5.png" width="830"/>
</span></span>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>(a) Accuracy on 5 NLU datasets given different chunk size during inference; (b) <math alttext="\Delta" class="ltx_Math" display="inline" id="S3.F4.5.m1.1"><semantics id="S3.F4.5.m1.1b"><mi id="S3.F4.5.m1.1.1" mathvariant="normal" xref="S3.F4.5.m1.1.1.cmml">Œî</mi><annotation-xml encoding="MathML-Content" id="S3.F4.5.m1.1c"><ci id="S3.F4.5.m1.1.1.cmml" xref="S3.F4.5.m1.1.1">Œî</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.5.m1.1d">\Delta</annotation><annotation encoding="application/x-llamapun" id="S3.F4.5.m1.1e">roman_Œî</annotation></semantics></math>Perplexity on 4 splits of PG-22 given different memory size during inference, in which the perplexity when <math alttext="msz" class="ltx_Math" display="inline" id="S3.F4.6.m2.1"><semantics id="S3.F4.6.m2.1b"><mrow id="S3.F4.6.m2.1.1" xref="S3.F4.6.m2.1.1.cmml"><mi id="S3.F4.6.m2.1.1.2" xref="S3.F4.6.m2.1.1.2.cmml">m</mi><mo id="S3.F4.6.m2.1.1.1" xref="S3.F4.6.m2.1.1.1.cmml">‚Å¢</mo><mi id="S3.F4.6.m2.1.1.3" xref="S3.F4.6.m2.1.1.3.cmml">s</mi><mo id="S3.F4.6.m2.1.1.1b" xref="S3.F4.6.m2.1.1.1.cmml">‚Å¢</mo><mi id="S3.F4.6.m2.1.1.4" xref="S3.F4.6.m2.1.1.4.cmml">z</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.6.m2.1c"><apply id="S3.F4.6.m2.1.1.cmml" xref="S3.F4.6.m2.1.1"><times id="S3.F4.6.m2.1.1.1.cmml" xref="S3.F4.6.m2.1.1.1"></times><ci id="S3.F4.6.m2.1.1.2.cmml" xref="S3.F4.6.m2.1.1.2">ùëö</ci><ci id="S3.F4.6.m2.1.1.3.cmml" xref="S3.F4.6.m2.1.1.3">ùë†</ci><ci id="S3.F4.6.m2.1.1.4.cmml" xref="S3.F4.6.m2.1.1.4">ùëß</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.6.m2.1d">msz</annotation><annotation encoding="application/x-llamapun" id="S3.F4.6.m2.1e">italic_m italic_s italic_z</annotation></semantics></math>=65k is used as baseline.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Related Work</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.p1.1.1">Large Language Models.</span> Large Language Models, <em class="ltx_emph ltx_font_italic" id="S4.p1.1.2">i.e.,</em>¬†GPT-2¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib18" title=""><span class="ltx_text" style="font-size:90%;">18</span></a>]</cite>, GPT-3¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib3" title=""><span class="ltx_text" style="font-size:90%;">3</span></a>]</cite>, OPT¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib34" title=""><span class="ltx_text" style="font-size:90%;">34</span></a>]</cite>, and BLOOM¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib21" title=""><span class="ltx_text" style="font-size:90%;">21</span></a>]</cite>, significantly revolutionized NLP research and promoted the state-of-the-art of various language understanding, language generation¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib31" title=""><span class="ltx_text" style="font-size:90%;">31</span></a>]</cite>, and even vision-language tasks¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib25" title=""><span class="ltx_text" style="font-size:90%;">25</span></a>]</cite>. Additionally, via scaling the model parameters, LLMs exhibit ‚Äúemergent abilities‚Äú¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib28" title=""><span class="ltx_text" style="font-size:90%;">28</span></a>]</cite> like few-shot in-context learning¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib3" title=""><span class="ltx_text" style="font-size:90%;">3</span></a>]</cite>, multi-step reasoning¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib30" title=""><span class="ltx_text" style="font-size:90%;">30</span></a>]</cite>, code completion, etc.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.3"><span class="ltx_text ltx_font_bold" id="S4.p2.3.1">x-formers.</span> To enable transformers to attend on longer context, many variants of ‚Äúx-formers‚Äú are proposed. Transformer-XL¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib6" title=""><span class="ltx_text" style="font-size:90%;">6</span></a>]</cite> proposes to cache attention keys and values of past segment and reuse them in recurrent manner. Recent seminal works of x-formers, including LinFormer¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib26" title=""><span class="ltx_text" style="font-size:90%;">26</span></a>]</cite>, LongFormer¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib4" title=""><span class="ltx_text" style="font-size:90%;">4</span></a>]</cite>, Routing Transformer¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib17" title=""><span class="ltx_text" style="font-size:90%;">17</span></a>]</cite>, proposed various sparse attention mechanisms for decreasing <math alttext="O(n^{2})" class="ltx_Math" display="inline" id="S4.p2.1.m1.1"><semantics id="S4.p2.1.m1.1a"><mrow id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mi id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml">O</mi><mo id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml">‚Å¢</mo><mrow id="S4.p2.1.m1.1.1.1.1" xref="S4.p2.1.m1.1.1.1.1.1.cmml"><mo id="S4.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S4.p2.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S4.p2.1.m1.1.1.1.1.1" xref="S4.p2.1.m1.1.1.1.1.1.cmml"><mi id="S4.p2.1.m1.1.1.1.1.1.2" xref="S4.p2.1.m1.1.1.1.1.1.2.cmml">n</mi><mn id="S4.p2.1.m1.1.1.1.1.1.3" xref="S4.p2.1.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S4.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><times id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2"></times><ci id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3">ùëÇ</ci><apply id="S4.p2.1.m1.1.1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1.1">superscript</csymbol><ci id="S4.p2.1.m1.1.1.1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.1.1.1.2">ùëõ</ci><cn id="S4.p2.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.p2.1.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">O(n^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.p2.1.m1.1d">italic_O ( italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> complexity to <math alttext="O(n\log n)" class="ltx_Math" display="inline" id="S4.p2.2.m2.1"><semantics id="S4.p2.2.m2.1a"><mrow id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mi id="S4.p2.2.m2.1.1.3" xref="S4.p2.2.m2.1.1.3.cmml">O</mi><mo id="S4.p2.2.m2.1.1.2" xref="S4.p2.2.m2.1.1.2.cmml">‚Å¢</mo><mrow id="S4.p2.2.m2.1.1.1.1" xref="S4.p2.2.m2.1.1.1.1.1.cmml"><mo id="S4.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S4.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.p2.2.m2.1.1.1.1.1" xref="S4.p2.2.m2.1.1.1.1.1.cmml"><mi id="S4.p2.2.m2.1.1.1.1.1.2" xref="S4.p2.2.m2.1.1.1.1.1.2.cmml">n</mi><mo id="S4.p2.2.m2.1.1.1.1.1.1" lspace="0.167em" xref="S4.p2.2.m2.1.1.1.1.1.1.cmml">‚Å¢</mo><mrow id="S4.p2.2.m2.1.1.1.1.1.3" xref="S4.p2.2.m2.1.1.1.1.1.3.cmml"><mi id="S4.p2.2.m2.1.1.1.1.1.3.1" xref="S4.p2.2.m2.1.1.1.1.1.3.1.cmml">log</mi><mo id="S4.p2.2.m2.1.1.1.1.1.3a" lspace="0.167em" xref="S4.p2.2.m2.1.1.1.1.1.3.cmml">‚Å°</mo><mi id="S4.p2.2.m2.1.1.1.1.1.3.2" xref="S4.p2.2.m2.1.1.1.1.1.3.2.cmml">n</mi></mrow></mrow><mo id="S4.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S4.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><times id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1.2"></times><ci id="S4.p2.2.m2.1.1.3.cmml" xref="S4.p2.2.m2.1.1.3">ùëÇ</ci><apply id="S4.p2.2.m2.1.1.1.1.1.cmml" xref="S4.p2.2.m2.1.1.1.1"><times id="S4.p2.2.m2.1.1.1.1.1.1.cmml" xref="S4.p2.2.m2.1.1.1.1.1.1"></times><ci id="S4.p2.2.m2.1.1.1.1.1.2.cmml" xref="S4.p2.2.m2.1.1.1.1.1.2">ùëõ</ci><apply id="S4.p2.2.m2.1.1.1.1.1.3.cmml" xref="S4.p2.2.m2.1.1.1.1.1.3"><log id="S4.p2.2.m2.1.1.1.1.1.3.1.cmml" xref="S4.p2.2.m2.1.1.1.1.1.3.1"></log><ci id="S4.p2.2.m2.1.1.1.1.1.3.2.cmml" xref="S4.p2.2.m2.1.1.1.1.1.3.2">ùëõ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">O(n\log n)</annotation><annotation encoding="application/x-llamapun" id="S4.p2.2.m2.1d">italic_O ( italic_n roman_log italic_n )</annotation></semantics></math> or even <math alttext="O(n)" class="ltx_Math" display="inline" id="S4.p2.3.m3.1"><semantics id="S4.p2.3.m3.1a"><mrow id="S4.p2.3.m3.1.2" xref="S4.p2.3.m3.1.2.cmml"><mi id="S4.p2.3.m3.1.2.2" xref="S4.p2.3.m3.1.2.2.cmml">O</mi><mo id="S4.p2.3.m3.1.2.1" xref="S4.p2.3.m3.1.2.1.cmml">‚Å¢</mo><mrow id="S4.p2.3.m3.1.2.3.2" xref="S4.p2.3.m3.1.2.cmml"><mo id="S4.p2.3.m3.1.2.3.2.1" stretchy="false" xref="S4.p2.3.m3.1.2.cmml">(</mo><mi id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml">n</mi><mo id="S4.p2.3.m3.1.2.3.2.2" stretchy="false" xref="S4.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><apply id="S4.p2.3.m3.1.2.cmml" xref="S4.p2.3.m3.1.2"><times id="S4.p2.3.m3.1.2.1.cmml" xref="S4.p2.3.m3.1.2.1"></times><ci id="S4.p2.3.m3.1.2.2.cmml" xref="S4.p2.3.m3.1.2.2">ùëÇ</ci><ci id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1">ùëõ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">O(n)</annotation><annotation encoding="application/x-llamapun" id="S4.p2.3.m3.1d">italic_O ( italic_n )</annotation></semantics></math>. BigBird¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib33" title=""><span class="ltx_text" style="font-size:90%;">33</span></a>]</cite> achieves a 4k sequence length via attending on a subset of context tokens. Although these x-formers achieve substantial efficiency improvements, such efficiency gains are not remarkable when modeling sequences that spans book-level length. Moreover, the largest sequence length of these methods is still upper-bounded by 16k tokens, making them invalid in modeling long-sequences at the book or wikipedia-page level (<em class="ltx_emph ltx_font_italic" id="S4.p2.3.2">i.e.,</em>¬†average 70k tokens for full-length books in PG19 dataset¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib15" title=""><span class="ltx_text" style="font-size:90%;">15</span></a>]</cite>).</p>
</div>
<div class="ltx_para" id="S4.p3">
<p class="ltx_p" id="S4.p3.1"><span class="ltx_text ltx_font_bold" id="S4.p3.1.1">Side-Tuning.</span> The method of Side-Tuning¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib35" title=""><span class="ltx_text" style="font-size:90%;">35</span></a>, <a class="ltx_ref" href="#bib.bib20" title=""><span class="ltx_text" style="font-size:90%;">20</span></a>]</cite> is a task-specific tuning method for pre-trained models via training a lightweight side-network that is fused with the fixed pre-trained network via summation. Our method inherits the idea of adopting a side-network but distinguishes the side-tuning method in terms of learning objective and cross-network fusion ways. <span class="ltx_text ltx_font_smallcaps" id="S4.p3.1.2">LongMem</span> proposes to augment LLMs with decoupled memory for memorizing long past inputs, which does not involve any task-specific tuning. The cross-network residual connections proposed by <span class="ltx_text ltx_font_smallcaps" id="S4.p3.1.3">LongMem</span> is novel and distincts from the vanilla summation of Side-Tuning.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we propose to augment LLMs with long-term memory for enabling them to memorize long-form context and gain long-form memory. The designed decoupled memory module can cache attention key and value pairs of past inputs for future retrieval and fusion. A decoupled residual SideNet is introduced as the memory retriever and reader, meanwhile the LLM itself is frozen and works as knowledge and memory encoder. Experiments on various long-contextual language modeling datasets demonstrate the effectiveness of our model over other memory-augmentation baselines. The proposed method can also enable in-context learning of LLMs to overcome the limited number of demonstration examples in context, which is constrained by the contextual length, via caching thousands of auxiliary demonstration examples in memory.
</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib1.6.6.1" style="font-size:90%;">ABK</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib1.2.2.m1.1"><semantics id="bib.bib1.2.2.m1.1a"><msup id="bib.bib1.2.2.m1.1.1" xref="bib.bib1.2.2.m1.1.1.cmml"><mi id="bib.bib1.2.2.m1.1.1a" xref="bib.bib1.2.2.m1.1.1.cmml"></mi><mo id="bib.bib1.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib1.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib1.2.2.m1.1b"><apply id="bib.bib1.2.2.m1.1.1.cmml" xref="bib.bib1.2.2.m1.1.1"><plus id="bib.bib1.2.2.m1.1.1.1.cmml" xref="bib.bib1.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib1.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib1.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib1.7.7.2" style="font-size:90%;"> [07]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.9.1" style="font-size:90%;">
S√∂ren Auer, Christian Bizer, Georgi Kobilarov, Jens Lehmann, Richard
Cyganiak, and Zachary Ives.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.10.1" style="font-size:90%;">Dbpedia: A nucleus for a web of open data.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.11.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib1.12.2" style="font-size:90%;">The semantic web</span><span class="ltx_text" id="bib.bib1.13.3" style="font-size:90%;">, pages 722‚Äì735. Springer, 2007.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib2.6.6.1" style="font-size:90%;">BMH</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib2.2.2.m1.1"><semantics id="bib.bib2.2.2.m1.1a"><msup id="bib.bib2.2.2.m1.1.1" xref="bib.bib2.2.2.m1.1.1.cmml"><mi id="bib.bib2.2.2.m1.1.1a" xref="bib.bib2.2.2.m1.1.1.cmml"></mi><mo id="bib.bib2.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib2.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib2.2.2.m1.1b"><apply id="bib.bib2.2.2.m1.1.1.cmml" xref="bib.bib2.2.2.m1.1.1"><plus id="bib.bib2.2.2.m1.1.1.1.cmml" xref="bib.bib2.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib2.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib2.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib2.7.7.2" style="font-size:90%;"> [21]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.9.1" style="font-size:90%;">
Sebastian Borgeaud, Arthur Mensch, Jordan Hoffmann, Trevor Cai, Eliza
Rutherford, Katie Millican, George van¬†den Driessche, Jean-Baptiste Lespiau,
Bogdan Damoc, Aidan Clark, Diego de¬†Las¬†Casas, Aurelia Guy, Jacob Menick,
Roman Ring, T.¬†W. Hennigan, Saffron Huang, Lorenzo Maggiore, Chris Jones,
Albin Cassirer, Andy Brock, Michela Paganini, Geoffrey Irving, Oriol Vinyals,
Simon Osindero, Karen Simonyan, Jack¬†W. Rae, Erich Elsen, and L.¬†Sifre.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.10.1" style="font-size:90%;">Improving language models by retrieving from trillions of tokens.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib2.11.1" style="font-size:90%;">ArXiv</span><span class="ltx_text" id="bib.bib2.12.2" style="font-size:90%;">, abs/2112.04426, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib3.6.6.1" style="font-size:90%;">BMR</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib3.2.2.m1.1"><semantics id="bib.bib3.2.2.m1.1a"><msup id="bib.bib3.2.2.m1.1.1" xref="bib.bib3.2.2.m1.1.1.cmml"><mi id="bib.bib3.2.2.m1.1.1a" xref="bib.bib3.2.2.m1.1.1.cmml"></mi><mo id="bib.bib3.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib3.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib3.2.2.m1.1b"><apply id="bib.bib3.2.2.m1.1.1.cmml" xref="bib.bib3.2.2.m1.1.1"><plus id="bib.bib3.2.2.m1.1.1.1.cmml" xref="bib.bib3.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib3.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib3.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib3.7.7.2" style="font-size:90%;"> [20]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.9.1" style="font-size:90%;">
Tom¬†B. Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan,
Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda
Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, T.¬†J.
Henighan, Rewon Child, Aditya Ramesh, Daniel¬†M. Ziegler, Jeff Wu, Clemens
</span><span class="ltx_text" id="bib.bib3.10.2" style="font-size:90%;">Winter, Christopher Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott
Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec
Radford, Ilya Sutskever, and Dario Amodei.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.11.1" style="font-size:90%;">Language models are few-shot learners.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib3.12.1" style="font-size:90%;">ArXiv</span><span class="ltx_text" id="bib.bib3.13.2" style="font-size:90%;">, abs/2005.14165, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib4.4.4.1" style="font-size:90%;">BPC [20]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.6.1" style="font-size:90%;">
Iz¬†Beltagy, Matthew¬†E Peters, and Arman Cohan.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.7.1" style="font-size:90%;">Longformer: The long-document transformer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib4.8.1" style="font-size:90%;">arXiv preprint arXiv:2004.05150</span><span class="ltx_text" id="bib.bib4.9.2" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib5.4.4.1" style="font-size:90%;">DCLT [19]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.6.1" style="font-size:90%;">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.7.1" style="font-size:90%;">BERT: Pre-training of deep bidirectional transformers for language
understanding.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.8.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib5.9.2" style="font-size:90%;">NAACL</span><span class="ltx_text" id="bib.bib5.10.3" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib6.6.6.1" style="font-size:90%;">DYY</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib6.2.2.m1.1"><semantics id="bib.bib6.2.2.m1.1a"><msup id="bib.bib6.2.2.m1.1.1" xref="bib.bib6.2.2.m1.1.1.cmml"><mi id="bib.bib6.2.2.m1.1.1a" xref="bib.bib6.2.2.m1.1.1.cmml"></mi><mo id="bib.bib6.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib6.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib6.2.2.m1.1b"><apply id="bib.bib6.2.2.m1.1.1.cmml" xref="bib.bib6.2.2.m1.1.1"><plus id="bib.bib6.2.2.m1.1.1.1.cmml" xref="bib.bib6.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib6.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib6.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib6.7.7.2" style="font-size:90%;"> [19]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.9.1" style="font-size:90%;">
Zihang Dai, Zhilin Yang, Yiming Yang, Jaime Carbonell, Quoc¬†V Le, and Ruslan
Salakhutdinov.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.10.1" style="font-size:90%;">Transformer-xl: Attentive language models beyond a fixed-length
context.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib6.11.1" style="font-size:90%;">arXiv preprint arXiv:1901.02860</span><span class="ltx_text" id="bib.bib6.12.2" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib7.6.6.1" style="font-size:90%;">GBB</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib7.2.2.m1.1"><semantics id="bib.bib7.2.2.m1.1a"><msup id="bib.bib7.2.2.m1.1.1" xref="bib.bib7.2.2.m1.1.1.cmml"><mi id="bib.bib7.2.2.m1.1.1a" xref="bib.bib7.2.2.m1.1.1.cmml"></mi><mo id="bib.bib7.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib7.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib7.2.2.m1.1b"><apply id="bib.bib7.2.2.m1.1.1.cmml" xref="bib.bib7.2.2.m1.1.1"><plus id="bib.bib7.2.2.m1.1.1.1.cmml" xref="bib.bib7.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib7.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib7.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib7.7.7.2" style="font-size:90%;"> [20]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.9.1" style="font-size:90%;">
</span><span class="ltx_text" id="bib.bib7.10.2" style="font-size:90%;">Leo Gao, Stella Biderman, Sid Black, Laurence Golding, Travis Hoppe, Charles
Foster, Jason Phang, Horace He, Anish Thite, Noa Nabeshima, et¬†al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.11.1" style="font-size:90%;">The pile: An 800gb dataset of diverse text for language modeling.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib7.12.1" style="font-size:90%;">arXiv preprint arXiv:2101.00027</span><span class="ltx_text" id="bib.bib7.13.2" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib8.4.4.1" style="font-size:90%;">JDJ [21]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.6.1" style="font-size:90%;">
Jeff Johnson, Matthijs Douze, and Herv√© J√©gou.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.7.1" style="font-size:90%;">Billion-scale similarity search with gpus.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib8.8.1" style="font-size:90%;">IEEE Transactions on Big Data</span><span class="ltx_text" id="bib.bib8.9.2" style="font-size:90%;">, 7:535‚Äì547, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib9.4.4.1" style="font-size:90%;">KB [15]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.6.1" style="font-size:90%;">
Diederik¬†P. Kingma and Jimmy Ba.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.7.1" style="font-size:90%;">Adam: A method for stochastic optimization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib9.8.1" style="font-size:90%;">CoRR</span><span class="ltx_text" id="bib.bib9.9.2" style="font-size:90%;">, abs/1412.6980, 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib10.6.6.1" style="font-size:90%;">LGW</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib10.2.2.m1.1"><semantics id="bib.bib10.2.2.m1.1a"><msup id="bib.bib10.2.2.m1.1.1" xref="bib.bib10.2.2.m1.1.1.cmml"><mi id="bib.bib10.2.2.m1.1.1a" xref="bib.bib10.2.2.m1.1.1.cmml"></mi><mo id="bib.bib10.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib10.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib10.2.2.m1.1b"><apply id="bib.bib10.2.2.m1.1.1.cmml" xref="bib.bib10.2.2.m1.1.1"><plus id="bib.bib10.2.2.m1.1.1.1.cmml" xref="bib.bib10.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib10.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib10.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib10.7.7.2" style="font-size:90%;"> [23]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.9.1" style="font-size:90%;">
Rui Lv, Junliang Guo, Rui Wang, Xu¬†Tan, Qi¬†Liu, and Tao Qin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.10.1" style="font-size:90%;">N-gram nearest neighbor machine translation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib10.11.1" style="font-size:90%;">arXiv preprint arXiv:2301.12866</span><span class="ltx_text" id="bib.bib10.12.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib11.6.6.1" style="font-size:90%;">LOG</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib11.2.2.m1.1"><semantics id="bib.bib11.2.2.m1.1a"><msup id="bib.bib11.2.2.m1.1.1" xref="bib.bib11.2.2.m1.1.1.cmml"><mi id="bib.bib11.2.2.m1.1.1a" xref="bib.bib11.2.2.m1.1.1.cmml"></mi><mo id="bib.bib11.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib11.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib11.2.2.m1.1b"><apply id="bib.bib11.2.2.m1.1.1.cmml" xref="bib.bib11.2.2.m1.1.1"><plus id="bib.bib11.2.2.m1.1.1.1.cmml" xref="bib.bib11.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib11.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib11.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib11.7.7.2" style="font-size:90%;"> [19]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.9.1" style="font-size:90%;">
Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer
Levy, Mike Lewis, Luke Zettlemoyer, and Veselin Stoyanov.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.10.1" style="font-size:90%;">RoBERTa: A robustly optimized bert pretraining approach.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib11.11.1" style="font-size:90%;">ArXiv</span><span class="ltx_text" id="bib.bib11.12.2" style="font-size:90%;">, abs/1907.11692, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib12.4.4.1" style="font-size:90%;">PL [04]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.6.1" style="font-size:90%;">
Bo¬†Pang and Lillian Lee.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.7.1" style="font-size:90%;">A sentimental education: Sentiment analysis using subjectivity
summarization based on minimum cuts.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib12.8.1" style="font-size:90%;">arXiv preprint cs/0409058</span><span class="ltx_text" id="bib.bib12.9.2" style="font-size:90%;">, 2004.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib13.4.4.1" style="font-size:90%;">PSL [21]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.6.1" style="font-size:90%;">
Ofir Press, Noah¬†A Smith, and Mike Lewis.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.7.1" style="font-size:90%;">Train short, test long: Attention with linear biases enables input
length extrapolation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib13.8.1" style="font-size:90%;">arXiv preprint arXiv:2108.12409</span><span class="ltx_text" id="bib.bib13.9.2" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib14.4.4.1" style="font-size:90%;">RNSS [18]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.6.1" style="font-size:90%;">
Alec Radford, Karthik Narasimhan, Tim Salimans, and Ilya Sutskever.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.7.1" style="font-size:90%;">Improving language understanding with unsupervised learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.8.1" style="font-size:90%;">2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib15.4.4.1" style="font-size:90%;">RPJL [19]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.6.1" style="font-size:90%;">
Jack¬†W Rae, Anna Potapenko, Siddhant¬†M Jayakumar, and Timothy¬†P Lillicrap.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.7.1" style="font-size:90%;">Compressive transformers for long-range sequence modelling.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib15.8.1" style="font-size:90%;">arXiv preprint arXiv:1911.05507</span><span class="ltx_text" id="bib.bib15.9.2" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib16.6.6.1" style="font-size:90%;">RSR</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib16.2.2.m1.1"><semantics id="bib.bib16.2.2.m1.1a"><msup id="bib.bib16.2.2.m1.1.1" xref="bib.bib16.2.2.m1.1.1.cmml"><mi id="bib.bib16.2.2.m1.1.1a" xref="bib.bib16.2.2.m1.1.1.cmml"></mi><mo id="bib.bib16.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib16.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib16.2.2.m1.1b"><apply id="bib.bib16.2.2.m1.1.1.cmml" xref="bib.bib16.2.2.m1.1.1"><plus id="bib.bib16.2.2.m1.1.1.1.cmml" xref="bib.bib16.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib16.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib16.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib16.7.7.2" style="font-size:90%;"> [20]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.9.1" style="font-size:90%;">
Colin Raffel, Noam¬†M. Shazeer, Adam Roberts, Katherine Lee, Sharan Narang,
</span><span class="ltx_text" id="bib.bib16.10.2" style="font-size:90%;">Michael Matena, Yanqi Zhou, Wei Li, and Peter¬†J. Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.11.1" style="font-size:90%;">Exploring the limits of transfer learning with a unified text-to-text
transformer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib16.12.1" style="font-size:90%;">ArXiv</span><span class="ltx_text" id="bib.bib16.13.2" style="font-size:90%;">, abs/1910.10683, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib17.4.4.1" style="font-size:90%;">RSVG [21]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.6.1" style="font-size:90%;">
Aurko Roy, Mohammad Saffar, Ashish Vaswani, and David Grangier.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.7.1" style="font-size:90%;">Efficient content-based sparse attention with routing transformers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib17.8.1" style="font-size:90%;">Transactions of the Association for Computational Linguistics</span><span class="ltx_text" id="bib.bib17.9.2" style="font-size:90%;">,
9:53‚Äì68, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib18.6.6.1" style="font-size:90%;">RWC</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib18.2.2.m1.1"><semantics id="bib.bib18.2.2.m1.1a"><msup id="bib.bib18.2.2.m1.1.1" xref="bib.bib18.2.2.m1.1.1.cmml"><mi id="bib.bib18.2.2.m1.1.1a" xref="bib.bib18.2.2.m1.1.1.cmml"></mi><mo id="bib.bib18.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib18.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib18.2.2.m1.1b"><apply id="bib.bib18.2.2.m1.1.1.cmml" xref="bib.bib18.2.2.m1.1.1"><plus id="bib.bib18.2.2.m1.1.1.1.cmml" xref="bib.bib18.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib18.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib18.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib18.7.7.2" style="font-size:90%;"> [19]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.9.1" style="font-size:90%;">
Alec Radford, Jeff Wu, Rewon Child, David Luan, Dario Amodei, and Ilya
Sutskever.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.10.1" style="font-size:90%;">Language models are unsupervised multitask learners.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.11.1" style="font-size:90%;">2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib19.4.4.1" style="font-size:90%;">RZLL [16]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.6.1" style="font-size:90%;">
Pranav Rajpurkar, Jian Zhang, Konstantin Lopyrev, and Percy Liang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.7.1" style="font-size:90%;">SQuAD: 100,000+ Questions for Machine Comprehension of Text.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib19.8.1" style="font-size:90%;">arXiv e-prints</span><span class="ltx_text" id="bib.bib19.9.2" style="font-size:90%;">, page arXiv:1606.05250, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib20.4.4.1" style="font-size:90%;">SCB [22]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.6.1" style="font-size:90%;">
Yi-Lin Sung, Jaemin Cho, and Mohit Bansal.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.7.1" style="font-size:90%;">Lst: Ladder side-tuning for parameter and memory efficient transfer
</span><span class="ltx_text" id="bib.bib20.8.2" style="font-size:90%;">learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib20.9.1" style="font-size:90%;">arXiv preprint arXiv:2206.06522</span><span class="ltx_text" id="bib.bib20.10.2" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib21.6.6.1" style="font-size:90%;">SFA</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib21.2.2.m1.1"><semantics id="bib.bib21.2.2.m1.1a"><msup id="bib.bib21.2.2.m1.1.1" xref="bib.bib21.2.2.m1.1.1.cmml"><mi id="bib.bib21.2.2.m1.1.1a" xref="bib.bib21.2.2.m1.1.1.cmml"></mi><mo id="bib.bib21.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib21.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib21.2.2.m1.1b"><apply id="bib.bib21.2.2.m1.1.1.cmml" xref="bib.bib21.2.2.m1.1.1"><plus id="bib.bib21.2.2.m1.1.1.1.cmml" xref="bib.bib21.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib21.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib21.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib21.7.7.2" style="font-size:90%;"> [22]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.9.1" style="font-size:90%;">
Teven¬†Le Scao, Angela Fan, Christopher Akiki, Ellie Pavlick, Suzana Iliƒá,
Daniel Hesslow, Roman Castagn√©, Alexandra¬†Sasha Luccioni, Fran√ßois
Yvon, Matthias Gall√©, et¬†al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.10.1" style="font-size:90%;">Bloom: A 176b-parameter open-access multilingual language model.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib21.11.1" style="font-size:90%;">arXiv preprint arXiv:2211.05100</span><span class="ltx_text" id="bib.bib21.12.2" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib22.6.6.1" style="font-size:90%;">SPW</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib22.2.2.m1.1"><semantics id="bib.bib22.2.2.m1.1a"><msup id="bib.bib22.2.2.m1.1.1" xref="bib.bib22.2.2.m1.1.1.cmml"><mi id="bib.bib22.2.2.m1.1.1a" xref="bib.bib22.2.2.m1.1.1.cmml"></mi><mo id="bib.bib22.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib22.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib22.2.2.m1.1b"><apply id="bib.bib22.2.2.m1.1.1.cmml" xref="bib.bib22.2.2.m1.1.1"><plus id="bib.bib22.2.2.m1.1.1.1.cmml" xref="bib.bib22.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib22.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib22.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib22.7.7.2" style="font-size:90%;"> [13]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.9.1" style="font-size:90%;">
Richard Socher, Alex Perelygin, Jean Wu, Jason Chuang, Christopher¬†D Manning,
Andrew¬†Y Ng, and Christopher Potts.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.10.1" style="font-size:90%;">Recursive deep models for semantic compositionality over a sentiment
treebank.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.11.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib22.12.2" style="font-size:90%;">Proceedings of the 2013 conference on empirical methods in
natural language processing</span><span class="ltx_text" id="bib.bib22.13.3" style="font-size:90%;">, pages 1631‚Äì1642, 2013.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib23.4.4.1" style="font-size:90%;">STI [22]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.6.1" style="font-size:90%;">
Simeng Sun, Katherine Thai, and Mohit Iyyer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.7.1" style="font-size:90%;">Chapterbreak: A challenge dataset for long-range language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib23.8.1" style="font-size:90%;">arXiv preprint arXiv:2204.10878</span><span class="ltx_text" id="bib.bib23.9.2" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib24.6.6.1" style="font-size:90%;">VSP</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib24.2.2.m1.1"><semantics id="bib.bib24.2.2.m1.1a"><msup id="bib.bib24.2.2.m1.1.1" xref="bib.bib24.2.2.m1.1.1.cmml"><mi id="bib.bib24.2.2.m1.1.1a" xref="bib.bib24.2.2.m1.1.1.cmml"></mi><mo id="bib.bib24.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib24.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib24.2.2.m1.1b"><apply id="bib.bib24.2.2.m1.1.1.cmml" xref="bib.bib24.2.2.m1.1.1"><plus id="bib.bib24.2.2.m1.1.1.1.cmml" xref="bib.bib24.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib24.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib24.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib24.7.7.2" style="font-size:90%;"> [17]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.9.1" style="font-size:90%;">
Ashish Vaswani, Noam¬†M. Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
</span><span class="ltx_text" id="bib.bib24.10.2" style="font-size:90%;">Aidan¬†N. Gomez, Lukasz Kaiser, and Illia Polosukhin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.11.1" style="font-size:90%;">Attention is all you need.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.12.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib24.13.2" style="font-size:90%;">NIPS</span><span class="ltx_text" id="bib.bib24.14.3" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib25.6.6.1" style="font-size:90%;">WDC</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib25.2.2.m1.1"><semantics id="bib.bib25.2.2.m1.1a"><msup id="bib.bib25.2.2.m1.1.1" xref="bib.bib25.2.2.m1.1.1.cmml"><mi id="bib.bib25.2.2.m1.1.1a" xref="bib.bib25.2.2.m1.1.1.cmml"></mi><mo id="bib.bib25.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib25.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib25.2.2.m1.1b"><apply id="bib.bib25.2.2.m1.1.1.cmml" xref="bib.bib25.2.2.m1.1.1"><plus id="bib.bib25.2.2.m1.1.1.1.cmml" xref="bib.bib25.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib25.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib25.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib25.7.7.2" style="font-size:90%;"> [22]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.9.1" style="font-size:90%;">
Weizhi Wang, Li¬†Dong, Hao Cheng, Haoyu Song, Xiaodong Liu, Xifeng Yan, Jianfeng
Gao, and Furu Wei.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.10.1" style="font-size:90%;">Visually-augmented language modeling.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib25.11.1" style="font-size:90%;">arXiv preprint arXiv:2205.10178</span><span class="ltx_text" id="bib.bib25.12.2" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib26.6.6.1" style="font-size:90%;">WLK</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib26.2.2.m1.1"><semantics id="bib.bib26.2.2.m1.1a"><msup id="bib.bib26.2.2.m1.1.1" xref="bib.bib26.2.2.m1.1.1.cmml"><mi id="bib.bib26.2.2.m1.1.1a" xref="bib.bib26.2.2.m1.1.1.cmml"></mi><mo id="bib.bib26.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib26.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib26.2.2.m1.1b"><apply id="bib.bib26.2.2.m1.1.1.cmml" xref="bib.bib26.2.2.m1.1.1"><plus id="bib.bib26.2.2.m1.1.1.1.cmml" xref="bib.bib26.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib26.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib26.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib26.7.7.2" style="font-size:90%;"> [20]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.9.1" style="font-size:90%;">
Sinong Wang, Belinda¬†Z Li, Madian Khabsa, Han Fang, and Hao Ma.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.10.1" style="font-size:90%;">Linformer: Self-attention with linear complexity.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib26.11.1" style="font-size:90%;">arXiv preprint arXiv:2006.04768</span><span class="ltx_text" id="bib.bib26.12.2" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib27.4.4.1" style="font-size:90%;">WRHS [22]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.6.1" style="font-size:90%;">
Yuhuai Wu, Markus¬†N. Rabe, DeLesley¬†S. Hutchins, and Christian Szegedy.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.7.1" style="font-size:90%;">Memorizing transformers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib27.8.1" style="font-size:90%;">ArXiv</span><span class="ltx_text" id="bib.bib27.9.2" style="font-size:90%;">, abs/2203.08913, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib28.6.6.1" style="font-size:90%;">WTB</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib28.2.2.m1.1"><semantics id="bib.bib28.2.2.m1.1a"><msup id="bib.bib28.2.2.m1.1.1" xref="bib.bib28.2.2.m1.1.1.cmml"><mi id="bib.bib28.2.2.m1.1.1a" xref="bib.bib28.2.2.m1.1.1.cmml"></mi><mo id="bib.bib28.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib28.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib28.2.2.m1.1b"><apply id="bib.bib28.2.2.m1.1.1.cmml" xref="bib.bib28.2.2.m1.1.1"><plus id="bib.bib28.2.2.m1.1.1.1.cmml" xref="bib.bib28.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib28.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib28.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib28.7.7.2" style="font-size:90%;"> [22]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.9.1" style="font-size:90%;">
Jason Wei, Yi¬†Tay, Rishi Bommasani, Colin Raffel, Barret Zoph, Sebastian
Borgeaud, Dani Yogatama, Maarten Bosma, Denny Zhou, Donald Metzler, et¬†al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.10.1" style="font-size:90%;">Emergent abilities of large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib28.11.1" style="font-size:90%;">arXiv preprint arXiv:2206.07682</span><span class="ltx_text" id="bib.bib28.12.2" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib29.4.4.1" style="font-size:90%;">WWC [05]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.6.1" style="font-size:90%;">
Janyce Wiebe, Theresa Wilson, and Claire Cardie.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.7.1" style="font-size:90%;">Annotating expressions of opinions and emotions in language.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib29.8.1" style="font-size:90%;">Language resources and evaluation</span><span class="ltx_text" id="bib.bib29.9.2" style="font-size:90%;">, 39(2):165‚Äì210, 2005.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib30.6.6.1" style="font-size:90%;">WWS</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib30.2.2.m1.1"><semantics id="bib.bib30.2.2.m1.1a"><msup id="bib.bib30.2.2.m1.1.1" xref="bib.bib30.2.2.m1.1.1.cmml"><mi id="bib.bib30.2.2.m1.1.1a" xref="bib.bib30.2.2.m1.1.1.cmml"></mi><mo id="bib.bib30.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib30.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib30.2.2.m1.1b"><apply id="bib.bib30.2.2.m1.1.1.cmml" xref="bib.bib30.2.2.m1.1.1"><plus id="bib.bib30.2.2.m1.1.1.1.cmml" xref="bib.bib30.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib30.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib30.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib30.7.7.2" style="font-size:90%;"> [22]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.9.1" style="font-size:90%;">
Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Ed¬†Chi, Quoc Le, and
Denny Zhou.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.10.1" style="font-size:90%;">Chain of thought prompting elicits reasoning in large language
models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib30.11.1" style="font-size:90%;">arXiv preprint arXiv:2201.11903</span><span class="ltx_text" id="bib.bib30.12.2" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib31.6.6.1" style="font-size:90%;">WZG</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib31.2.2.m1.1"><semantics id="bib.bib31.2.2.m1.1a"><msup id="bib.bib31.2.2.m1.1.1" xref="bib.bib31.2.2.m1.1.1.cmml"><mi id="bib.bib31.2.2.m1.1.1a" xref="bib.bib31.2.2.m1.1.1.cmml"></mi><mo id="bib.bib31.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib31.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib31.2.2.m1.1b"><apply id="bib.bib31.2.2.m1.1.1.cmml" xref="bib.bib31.2.2.m1.1.1"><plus id="bib.bib31.2.2.m1.1.1.1.cmml" xref="bib.bib31.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib31.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib31.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib31.7.7.2" style="font-size:90%;"> [22]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.9.1" style="font-size:90%;">
Weizhi Wang, Zhirui Zhang, Junliang Guo, Yinpei Dai, Boxing Chen, and Weihua
Luo.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.10.1" style="font-size:90%;">Task-oriented dialogue system as natural language generation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.11.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib31.12.2" style="font-size:90%;">Proceedings of the 45th International ACM SIGIR Conference on
Research and Development in Information Retrieval</span><span class="ltx_text" id="bib.bib31.13.3" style="font-size:90%;">, pages 2698‚Äì2703, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib32.6.6.1" style="font-size:90%;">YDY</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib32.2.2.m1.1"><semantics id="bib.bib32.2.2.m1.1a"><msup id="bib.bib32.2.2.m1.1.1" xref="bib.bib32.2.2.m1.1.1.cmml"><mi id="bib.bib32.2.2.m1.1.1a" xref="bib.bib32.2.2.m1.1.1.cmml"></mi><mo id="bib.bib32.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib32.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib32.2.2.m1.1b"><apply id="bib.bib32.2.2.m1.1.1.cmml" xref="bib.bib32.2.2.m1.1.1"><plus id="bib.bib32.2.2.m1.1.1.1.cmml" xref="bib.bib32.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib32.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib32.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib32.7.7.2" style="font-size:90%;"> [19]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.9.1" style="font-size:90%;">
Zhilin Yang, Zihang Dai, Yiming Yang, Jaime¬†G. Carbonell, Ruslan Salakhutdinov,
and Quoc¬†V. Le.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.10.1" style="font-size:90%;">XLNet: Generalized autoregressive pretraining for language
understanding.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.11.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib32.12.2" style="font-size:90%;">NeurIPS</span><span class="ltx_text" id="bib.bib32.13.3" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib33.6.6.1" style="font-size:90%;">ZGD</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib33.2.2.m1.1"><semantics id="bib.bib33.2.2.m1.1a"><msup id="bib.bib33.2.2.m1.1.1" xref="bib.bib33.2.2.m1.1.1.cmml"><mi id="bib.bib33.2.2.m1.1.1a" xref="bib.bib33.2.2.m1.1.1.cmml"></mi><mo id="bib.bib33.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib33.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib33.2.2.m1.1b"><apply id="bib.bib33.2.2.m1.1.1.cmml" xref="bib.bib33.2.2.m1.1.1"><plus id="bib.bib33.2.2.m1.1.1.1.cmml" xref="bib.bib33.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib33.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib33.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib33.7.7.2" style="font-size:90%;"> [20]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.9.1" style="font-size:90%;">
Manzil Zaheer, Guru Guruganesh, Kumar¬†Avinava Dubey, Joshua Ainslie, Chris
Alberti, Santiago Ontanon, Philip Pham, Anirudh Ravula, Qifan Wang, Li¬†Yang,
et¬†al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.10.1" style="font-size:90%;">Big bird: Transformers for longer sequences.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib33.11.1" style="font-size:90%;">Advances in neural information processing systems</span><span class="ltx_text" id="bib.bib33.12.2" style="font-size:90%;">,
33:17283‚Äì17297, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib34.6.6.1" style="font-size:90%;">ZRG</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib34.2.2.m1.1"><semantics id="bib.bib34.2.2.m1.1a"><msup id="bib.bib34.2.2.m1.1.1" xref="bib.bib34.2.2.m1.1.1.cmml"><mi id="bib.bib34.2.2.m1.1.1a" xref="bib.bib34.2.2.m1.1.1.cmml"></mi><mo id="bib.bib34.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib34.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib34.2.2.m1.1b"><apply id="bib.bib34.2.2.m1.1.1.cmml" xref="bib.bib34.2.2.m1.1.1"><plus id="bib.bib34.2.2.m1.1.1.1.cmml" xref="bib.bib34.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib34.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib34.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib34.7.7.2" style="font-size:90%;"> [22]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.9.1" style="font-size:90%;">
Susan Zhang, Stephen Roller, Naman Goyal, Mikel Artetxe, Moya Chen, Shuohui
Chen, Christopher Dewan, Mona Diab, Xian Li, Xi¬†Victoria Lin, et¬†al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.10.1" style="font-size:90%;">Opt: Open pre-trained transformer language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib34.11.1" style="font-size:90%;">arXiv preprint arXiv:2205.01068</span><span class="ltx_text" id="bib.bib34.12.2" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib35.6.6.1" style="font-size:90%;">ZSZ</span><math alttext="{}^{+}" class="ltx_Math" display="inline" id="bib.bib35.2.2.m1.1"><semantics id="bib.bib35.2.2.m1.1a"><msup id="bib.bib35.2.2.m1.1.1" xref="bib.bib35.2.2.m1.1.1.cmml"><mi id="bib.bib35.2.2.m1.1.1a" xref="bib.bib35.2.2.m1.1.1.cmml"></mi><mo id="bib.bib35.2.2.m1.1.1.1" mathsize="90%" xref="bib.bib35.2.2.m1.1.1.1.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib35.2.2.m1.1b"><apply id="bib.bib35.2.2.m1.1.1.cmml" xref="bib.bib35.2.2.m1.1.1"><plus id="bib.bib35.2.2.m1.1.1.1.cmml" xref="bib.bib35.2.2.m1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib35.2.2.m1.1c">{}^{+}</annotation><annotation encoding="application/x-llamapun" id="bib.bib35.2.2.m1.1d">start_FLOATSUPERSCRIPT + end_FLOATSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="bib.bib35.7.7.2" style="font-size:90%;"> [20]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.9.1" style="font-size:90%;">
Jeffrey¬†O Zhang, Alexander Sax, Amir Zamir, Leonidas Guibas, and Jitendra
Malik.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.10.1" style="font-size:90%;">Side-tuning: a baseline for network adaptation via additive side
networks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.11.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib35.12.2" style="font-size:90%;">Computer Vision‚ÄìECCV 2020: 16th European Conference,
Glasgow, UK, August 23‚Äì28, 2020, Proceedings, Part III 16</span><span class="ltx_text" id="bib.bib35.13.3" style="font-size:90%;">, pages 698‚Äì714.
Springer, 2020.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Inference Efficiency and GPU-Memory Efficiency</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">When the model is required to comprehend long sequences, the proposed method <span class="ltx_text ltx_font_smallcaps" id="A1.p1.1.1">LongMem</span> can load the out-of-boundary inputs into the cached memory as previous context. Thus, the memory usage and inference speed can be significantly improved compared with vanilla self-attention-based models. The detailed statistics in terms of the efficiency is presented in Table¬†<a class="ltx_ref" href="#A1.T6" title="Table 6 ‚Ä£ Appendix A Inference Efficiency and GPU-Memory Efficiency ‚Ä£ Augmenting Language Models with Long-Term Memory"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<figure class="ltx_table" id="A1.T6">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T6.2" style="width:275.4pt;height:108pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1.0,1.0) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T6.2.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T6.2.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="A1.T6.2.2.3.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="A1.T6.2.2.3.1.1.1" style="font-size:90%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="A1.T6.2.2.3.1.2"><span class="ltx_text ltx_font_bold" id="A1.T6.2.2.3.1.2.1" style="font-size:90%;">In-Context</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_border_t" id="A1.T6.2.2.3.1.3"><span class="ltx_text ltx_font_bold" id="A1.T6.2.2.3.1.3.1" style="font-size:90%;">In-Memory</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="A1.T6.2.2.3.1.4"><span class="ltx_text ltx_font_bold" id="A1.T6.2.2.3.1.4.1" style="font-size:90%;">Inference Speed</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="A1.T6.2.2.3.1.5"><span class="ltx_text ltx_font_bold" id="A1.T6.2.2.3.1.5.1" style="font-size:90%;">GPU-Memory Usage</span></th>
</tr>
<tr class="ltx_tr" id="A1.T6.2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T6.2.2.2.3"><span class="ltx_text ltx_font_bold" id="A1.T6.2.2.2.3.1" style="font-size:90%;">Len.</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="A1.T6.2.2.2.4"><span class="ltx_text ltx_font_bold" id="A1.T6.2.2.2.4.1" style="font-size:90%;">Len.</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T6.1.1.1.1">
<span class="ltx_text" id="A1.T6.1.1.1.1.1" style="font-size:90%;">(tokens/s)</span><math alttext="\uparrow" class="ltx_Math" display="inline" id="A1.T6.1.1.1.1.m1.1"><semantics id="A1.T6.1.1.1.1.m1.1a"><mo id="A1.T6.1.1.1.1.m1.1.1" mathsize="90%" stretchy="false" xref="A1.T6.1.1.1.1.m1.1.1.cmml">‚Üë</mo><annotation-xml encoding="MathML-Content" id="A1.T6.1.1.1.1.m1.1b"><ci id="A1.T6.1.1.1.1.m1.1.1.cmml" xref="A1.T6.1.1.1.1.m1.1.1">‚Üë</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.1.1.1.1.m1.1d">‚Üë</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A1.T6.2.2.2.2">
<span class="ltx_text" id="A1.T6.2.2.2.2.1" style="font-size:90%;">(MBs)</span><math alttext="\downarrow" class="ltx_Math" display="inline" id="A1.T6.2.2.2.2.m1.1"><semantics id="A1.T6.2.2.2.2.m1.1a"><mo id="A1.T6.2.2.2.2.m1.1.1" mathsize="90%" stretchy="false" xref="A1.T6.2.2.2.2.m1.1.1.cmml">‚Üì</mo><annotation-xml encoding="MathML-Content" id="A1.T6.2.2.2.2.m1.1b"><ci id="A1.T6.2.2.2.2.m1.1.1.cmml" xref="A1.T6.2.2.2.2.m1.1.1">‚Üì</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.2.2.2.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="A1.T6.2.2.2.2.m1.1d">‚Üì</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T6.2.2.4.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T6.2.2.4.1.1"><span class="ltx_text" id="A1.T6.2.2.4.1.1.1" style="font-size:90%;">GPT-2*</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.2.2.4.1.2"><span class="ltx_text" id="A1.T6.2.2.4.1.2.1" style="font-size:90%;">4k</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T6.2.2.4.1.3"><span class="ltx_text" id="A1.T6.2.2.4.1.3.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.2.2.4.1.4"><span class="ltx_text" id="A1.T6.2.2.4.1.4.1" style="font-size:90%;">14666</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.2.2.4.1.5"><span class="ltx_text" id="A1.T6.2.2.4.1.5.1" style="font-size:90%;">20671</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.2.2.5.2">
<td class="ltx_td ltx_align_left" id="A1.T6.2.2.5.2.1"><span class="ltx_text ltx_font_smallcaps" id="A1.T6.2.2.5.2.1.1" style="font-size:90%;">LongMem</span></td>
<td class="ltx_td ltx_align_center" id="A1.T6.2.2.5.2.2"><span class="ltx_text" id="A1.T6.2.2.5.2.2.1" style="font-size:90%;">1k</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T6.2.2.5.2.3"><span class="ltx_text" id="A1.T6.2.2.5.2.3.1" style="font-size:90%;">3k</span></td>
<td class="ltx_td ltx_align_center" id="A1.T6.2.2.5.2.4"><span class="ltx_text" id="A1.T6.2.2.5.2.4.1" style="font-size:90%;">22638</span></td>
<td class="ltx_td ltx_align_center" id="A1.T6.2.2.5.2.5"><span class="ltx_text" id="A1.T6.2.2.5.2.5.1" style="font-size:90%;">13335</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.2.2.6.3">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T6.2.2.6.3.1"><span class="ltx_text" id="A1.T6.2.2.6.3.1.1" style="font-size:90%;">GPT-2*</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.2.2.6.3.2"><span class="ltx_text" id="A1.T6.2.2.6.3.2.1" style="font-size:90%;">8k</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T6.2.2.6.3.3"><span class="ltx_text" id="A1.T6.2.2.6.3.3.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.2.2.6.3.4"><span class="ltx_text" id="A1.T6.2.2.6.3.4.1" style="font-size:90%;">8417</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.2.2.6.3.5"><span class="ltx_text" id="A1.T6.2.2.6.3.5.1" style="font-size:90%;">54195</span></td>
</tr>
<tr class="ltx_tr" id="A1.T6.2.2.7.4">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_b" id="A1.T6.2.2.7.4.1"><span class="ltx_text ltx_font_smallcaps" id="A1.T6.2.2.7.4.1.1" style="font-size:90%;">LongMem</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="A1.T6.2.2.7.4.2"><span class="ltx_text" id="A1.T6.2.2.7.4.2.1" style="font-size:90%;">1k</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_r" id="A1.T6.2.2.7.4.3"><span class="ltx_text" id="A1.T6.2.2.7.4.3.1" style="font-size:90%;">7k</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="A1.T6.2.2.7.4.4"><span class="ltx_text" id="A1.T6.2.2.7.4.4.1" style="font-size:90%;">21343</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="A1.T6.2.2.7.4.5"><span class="ltx_text" id="A1.T6.2.2.7.4.5.1" style="font-size:90%;">13437</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 6: </span>The superiority of our method over fully dense self-attention (GPT-2*) in terms of inference speed and GPU-memory utilization.
</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Training Details</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">The pre-training of reproduced GPT-2* iterates on 117B tokens in total, with 512 batch-size and 1024-token fixed segment-length. The Adam optimizer¬†<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="#bib.bib9" title=""><span class="ltx_text" style="font-size:90%;">9</span></a>]</cite> is adopted in memory-augmented adaptation training. The pre-training and adaptation are trained on 16 32GB-Tesla-V100 GPUs. Other detailed training hypperparamters and settings are presented in Table¬†<a class="ltx_ref" href="#A2.T7" title="Table 7 ‚Ä£ Appendix B Training Details ‚Ä£ Augmenting Language Models with Long-Term Memory"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<figure class="ltx_table" id="A2.T7">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T7.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T7.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt ltx_border_t" id="A2.T7.1.2.1.1"><span class="ltx_text ltx_font_bold" id="A2.T7.1.2.1.1.1" style="font-size:90%;">Hyperparameter</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="A2.T7.1.2.1.2"><span class="ltx_text ltx_font_smallcaps" id="A2.T7.1.2.1.2.1" style="font-size:90%;">LongMem</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="2" id="A2.T7.1.3.2.1">
<span class="ltx_text ltx_font_bold" id="A2.T7.1.3.2.1.1" style="font-size:90%;">Reproduced GPT-2* Backbone LLM Hyperparameters</span><span class="ltx_text" id="A2.T7.1.3.2.1.2" style="font-size:90%;"></span>
</th>
</tr>
<tr class="ltx_tr" id="A2.T7.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.4.3.1"><span class="ltx_text" id="A2.T7.1.4.3.1.1" style="font-size:90%;">Parameters</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.4.3.2"><span class="ltx_text" id="A2.T7.1.4.3.2.1" style="font-size:90%;">407M</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.5.4.1"><span class="ltx_text" id="A2.T7.1.5.4.1.1" style="font-size:90%;">Precision</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.5.4.2"><span class="ltx_text ltx_font_typewriter" id="A2.T7.1.5.4.2.1" style="font-size:90%;">float16</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.6.5.1"><span class="ltx_text" id="A2.T7.1.6.5.1.1" style="font-size:90%;">Layers</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.6.5.2"><span class="ltx_text" id="A2.T7.1.6.5.2.1" style="font-size:90%;">24</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.7.6.1"><span class="ltx_text" id="A2.T7.1.7.6.1.1" style="font-size:90%;">Hidden dim.</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.7.6.2"><span class="ltx_text" id="A2.T7.1.7.6.2.1" style="font-size:90%;">1024</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.8.7.1"><span class="ltx_text" id="A2.T7.1.8.7.1.1" style="font-size:90%;">Attention heads</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.8.7.2"><span class="ltx_text" id="A2.T7.1.8.7.2.1" style="font-size:90%;">16</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.9.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.9.8.1"><span class="ltx_text" id="A2.T7.1.9.8.1.1" style="font-size:90%;">Head Dim</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.9.8.2"><span class="ltx_text" id="A2.T7.1.9.8.2.1" style="font-size:90%;">64</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.10.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.10.9.1"><span class="ltx_text" id="A2.T7.1.10.9.1.1" style="font-size:90%;">Vocab size</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.10.9.2"><span class="ltx_text" id="A2.T7.1.10.9.2.1" style="font-size:90%;">52k</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.11.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.11.10.1"><span class="ltx_text" id="A2.T7.1.11.10.1.1" style="font-size:90%;">Sequence length</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.11.10.2"><span class="ltx_text" id="A2.T7.1.11.10.2.1" style="font-size:90%;">1024</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.12.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.12.11.1"><span class="ltx_text" id="A2.T7.1.12.11.1.1" style="font-size:90%;">Position emb.</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.12.11.2"><span class="ltx_text ltx_font_typewriter" id="A2.T7.1.12.11.2.1" style="font-size:90%;">Alibi</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.13.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.13.12.1"><span class="ltx_text" id="A2.T7.1.13.12.1.1" style="font-size:90%;">Tied embedding</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.13.12.2"><span class="ltx_text ltx_font_typewriter" id="A2.T7.1.13.12.2.1" style="font-size:90%;">False</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.14.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="2" id="A2.T7.1.14.13.1">
<span class="ltx_text ltx_font_bold" id="A2.T7.1.14.13.1.1" style="font-size:90%;">SideNet Hyperparameters</span><span class="ltx_text" id="A2.T7.1.14.13.1.2" style="font-size:90%;"></span>
</th>
</tr>
<tr class="ltx_tr" id="A2.T7.1.15.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.15.14.1"><span class="ltx_text" id="A2.T7.1.15.14.1.1" style="font-size:90%;">Parameters</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.15.14.2"><span class="ltx_text" id="A2.T7.1.15.14.2.1" style="font-size:90%;">151M</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.16.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.16.15.1"><span class="ltx_text" id="A2.T7.1.16.15.1.1" style="font-size:90%;">Precision</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.16.15.2"><span class="ltx_text ltx_font_typewriter" id="A2.T7.1.16.15.2.1" style="font-size:90%;">float16</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.17.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.17.16.1"><span class="ltx_text" id="A2.T7.1.17.16.1.1" style="font-size:90%;">Layers</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.17.16.2"><span class="ltx_text" id="A2.T7.1.17.16.2.1" style="font-size:90%;">12</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.18.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.18.17.1"><span class="ltx_text" id="A2.T7.1.18.17.1.1" style="font-size:90%;">Hidden dim.</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.18.17.2"><span class="ltx_text" id="A2.T7.1.18.17.2.1" style="font-size:90%;">1024</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.19.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.19.18.1"><span class="ltx_text" id="A2.T7.1.19.18.1.1" style="font-size:90%;">Attention heads</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.19.18.2"><span class="ltx_text" id="A2.T7.1.19.18.2.1" style="font-size:90%;">16</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.20.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.20.19.1"><span class="ltx_text" id="A2.T7.1.20.19.1.1" style="font-size:90%;">Head Dim</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.20.19.2"><span class="ltx_text" id="A2.T7.1.20.19.2.1" style="font-size:90%;">64</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.21.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.21.20.1"><span class="ltx_text" id="A2.T7.1.21.20.1.1" style="font-size:90%;">Sequence length</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.21.20.2"><span class="ltx_text" id="A2.T7.1.21.20.2.1" style="font-size:90%;">1024</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.22.21">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="2" id="A2.T7.1.22.21.1">
<span class="ltx_text ltx_font_bold" id="A2.T7.1.22.21.1.1" style="font-size:90%;">Memory-Augmented Adaptation Hyperparameters</span><span class="ltx_text" id="A2.T7.1.22.21.1.2" style="font-size:90%;"></span>
</th>
</tr>
<tr class="ltx_tr" id="A2.T7.1.23.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.23.22.1"><span class="ltx_text" id="A2.T7.1.23.22.1.1" style="font-size:90%;">Global Batch Size</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.23.22.2"><span class="ltx_text" id="A2.T7.1.23.22.2.1" style="font-size:90%;">256</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.24.23">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.24.23.1"><span class="ltx_text" id="A2.T7.1.24.23.1.1" style="font-size:90%;">Learning rate</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.24.23.2"><span class="ltx_text" id="A2.T7.1.24.23.2.1" style="font-size:90%;">2.0e-4</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.25.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.25.24.1"><span class="ltx_text" id="A2.T7.1.25.24.1.1" style="font-size:90%;">Total tokens</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.25.24.2"><span class="ltx_text" id="A2.T7.1.25.24.2.1" style="font-size:90%;">26B</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.26.25">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.26.25.1"><span class="ltx_text" id="A2.T7.1.26.25.1.1" style="font-size:90%;">Warmup tokens</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.26.25.2"><span class="ltx_text" id="A2.T7.1.26.25.2.1" style="font-size:90%;">0</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.27.26">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.27.26.1"><span class="ltx_text" id="A2.T7.1.27.26.1.1" style="font-size:90%;">LR Decay style</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.27.26.2"><span class="ltx_text" id="A2.T7.1.27.26.2.1" style="font-size:90%;">polynomial</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.1.1">
<span class="ltx_text" id="A2.T7.1.1.1.1" style="font-size:90%;">Adam </span><math alttext="(\beta_{1},\beta_{2})" class="ltx_Math" display="inline" id="A2.T7.1.1.1.m1.2"><semantics id="A2.T7.1.1.1.m1.2a"><mrow id="A2.T7.1.1.1.m1.2.2.2" xref="A2.T7.1.1.1.m1.2.2.3.cmml"><mo id="A2.T7.1.1.1.m1.2.2.2.3" maxsize="90%" minsize="90%" xref="A2.T7.1.1.1.m1.2.2.3.cmml">(</mo><msub id="A2.T7.1.1.1.m1.1.1.1.1" xref="A2.T7.1.1.1.m1.1.1.1.1.cmml"><mi id="A2.T7.1.1.1.m1.1.1.1.1.2" mathsize="90%" xref="A2.T7.1.1.1.m1.1.1.1.1.2.cmml">Œ≤</mi><mn id="A2.T7.1.1.1.m1.1.1.1.1.3" mathsize="90%" xref="A2.T7.1.1.1.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="A2.T7.1.1.1.m1.2.2.2.4" mathsize="90%" xref="A2.T7.1.1.1.m1.2.2.3.cmml">,</mo><msub id="A2.T7.1.1.1.m1.2.2.2.2" xref="A2.T7.1.1.1.m1.2.2.2.2.cmml"><mi id="A2.T7.1.1.1.m1.2.2.2.2.2" mathsize="90%" xref="A2.T7.1.1.1.m1.2.2.2.2.2.cmml">Œ≤</mi><mn id="A2.T7.1.1.1.m1.2.2.2.2.3" mathsize="90%" xref="A2.T7.1.1.1.m1.2.2.2.2.3.cmml">2</mn></msub><mo id="A2.T7.1.1.1.m1.2.2.2.5" maxsize="90%" minsize="90%" xref="A2.T7.1.1.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.T7.1.1.1.m1.2b"><interval closure="open" id="A2.T7.1.1.1.m1.2.2.3.cmml" xref="A2.T7.1.1.1.m1.2.2.2"><apply id="A2.T7.1.1.1.m1.1.1.1.1.cmml" xref="A2.T7.1.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A2.T7.1.1.1.m1.1.1.1.1.1.cmml" xref="A2.T7.1.1.1.m1.1.1.1.1">subscript</csymbol><ci id="A2.T7.1.1.1.m1.1.1.1.1.2.cmml" xref="A2.T7.1.1.1.m1.1.1.1.1.2">ùõΩ</ci><cn id="A2.T7.1.1.1.m1.1.1.1.1.3.cmml" type="integer" xref="A2.T7.1.1.1.m1.1.1.1.1.3">1</cn></apply><apply id="A2.T7.1.1.1.m1.2.2.2.2.cmml" xref="A2.T7.1.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A2.T7.1.1.1.m1.2.2.2.2.1.cmml" xref="A2.T7.1.1.1.m1.2.2.2.2">subscript</csymbol><ci id="A2.T7.1.1.1.m1.2.2.2.2.2.cmml" xref="A2.T7.1.1.1.m1.2.2.2.2.2">ùõΩ</ci><cn id="A2.T7.1.1.1.m1.2.2.2.2.3.cmml" type="integer" xref="A2.T7.1.1.1.m1.2.2.2.2.3">2</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.1.1.1.m1.2c">(\beta_{1},\beta_{2})</annotation><annotation encoding="application/x-llamapun" id="A2.T7.1.1.1.m1.2d">( italic_Œ≤ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_Œ≤ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.1.2"><span class="ltx_text" id="A2.T7.1.1.2.1" style="font-size:90%;">(0.9, 0.98)</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.28.27">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.28.27.1"><span class="ltx_text" id="A2.T7.1.28.27.1.1" style="font-size:90%;">Adam eps</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.28.27.2"><span class="ltx_text" id="A2.T7.1.28.27.2.1" style="font-size:90%;">1e-06</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.29.28">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A2.T7.1.29.28.1"><span class="ltx_text" id="A2.T7.1.29.28.1.1" style="font-size:90%;">Weight decay</span></th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.29.28.2"><span class="ltx_text" id="A2.T7.1.29.28.2.1" style="font-size:90%;">0.01</span></td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.30.29">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_b ltx_border_r" id="A2.T7.1.30.29.1"><span class="ltx_text" id="A2.T7.1.30.29.1.1" style="font-size:90%;">Gradient clipping</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="A2.T7.1.30.29.2"><span class="ltx_text" id="A2.T7.1.30.29.2.1" style="font-size:90%;">2.0</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 7: </span>Memory-Augmented Adaptation and Architectural Hyperparameters.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Prompting Templates</h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">We present all hand-crafted in-context learning prompting templates and labels for 5 NLU datasets and Squad QA dataset in Tabel¬†<a class="ltx_ref" href="#A3.T8" title="Table 8 ‚Ä£ Appendix C Prompting Templates ‚Ä£ Augmenting Language Models with Long-Term Memory"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure class="ltx_table" id="A3.T8">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A3.T8.1" style="width:388.4pt;height:126pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1.0,1.0) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A3.T8.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T8.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt ltx_border_t" id="A3.T8.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="A3.T8.1.1.2.1.1.1" style="font-size:90%;">Task</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="A3.T8.1.1.2.1.2"><span class="ltx_text ltx_font_bold" id="A3.T8.1.1.2.1.2.1" style="font-size:90%;">Prompt</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="A3.T8.1.1.2.1.3"><span class="ltx_text ltx_font_bold" id="A3.T8.1.1.2.1.3.1" style="font-size:90%;">Labels</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T8.1.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T8.1.1.3.1.1"><span class="ltx_text ltx_font_bold" id="A3.T8.1.1.3.1.1.1" style="font-size:90%;">SST-2</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T8.1.1.3.1.2"><span class="ltx_text" id="A3.T8.1.1.3.1.2.1" style="font-size:90%;">Review: [Sentence] Sentiment: [Label]</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T8.1.1.3.1.3"><span class="ltx_text" id="A3.T8.1.1.3.1.3.1" style="font-size:90%;">{positive, negative}</span></td>
</tr>
<tr class="ltx_tr" id="A3.T8.1.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T8.1.1.4.2.1"><span class="ltx_text ltx_font_bold" id="A3.T8.1.1.4.2.1.1" style="font-size:90%;">MR</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T8.1.1.4.2.2"><span class="ltx_text" id="A3.T8.1.1.4.2.2.1" style="font-size:90%;">Review: [Sentence] Sentiment: [Label]</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T8.1.1.4.2.3"><span class="ltx_text" id="A3.T8.1.1.4.2.3.1" style="font-size:90%;">{positive, negative}</span></td>
</tr>
<tr class="ltx_tr" id="A3.T8.1.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T8.1.1.5.3.1"><span class="ltx_text ltx_font_bold" id="A3.T8.1.1.5.3.1.1" style="font-size:90%;">MPQA</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T8.1.1.5.3.2"><span class="ltx_text" id="A3.T8.1.1.5.3.2.1" style="font-size:90%;">Review: [Sentence] Sentiment: [Label]</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T8.1.1.5.3.3"><span class="ltx_text" id="A3.T8.1.1.5.3.3.1" style="font-size:90%;">{positive, negative}</span></td>
</tr>
<tr class="ltx_tr" id="A3.T8.1.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T8.1.1.6.4.1"><span class="ltx_text ltx_font_bold" id="A3.T8.1.1.6.4.1.1" style="font-size:90%;">SST-5</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T8.1.1.6.4.2"><span class="ltx_text" id="A3.T8.1.1.6.4.2.1" style="font-size:90%;">input: [Sentence] type: [Label]</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T8.1.1.6.4.3"><span class="ltx_text" id="A3.T8.1.1.6.4.3.1" style="font-size:90%;">{terrible,bad,okay,good,great}</span></td>
</tr>
<tr class="ltx_tr" id="A3.T8.1.1.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T8.1.1.7.5.1"><span class="ltx_text ltx_font_bold" id="A3.T8.1.1.7.5.1.1" style="font-size:90%;">Subj</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T8.1.1.7.5.2"><span class="ltx_text" id="A3.T8.1.1.7.5.2.1" style="font-size:90%;">input: [Sentence] type: [Label]</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T8.1.1.7.5.3"><span class="ltx_text" id="A3.T8.1.1.7.5.3.1" style="font-size:90%;">{objective, subjective}</span></td>
</tr>
<tr class="ltx_tr" id="A3.T8.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_b ltx_border_r ltx_border_t" id="A3.T8.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A3.T8.1.1.1.2.1" style="font-size:90%;">Squad</span></th>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_b ltx_border_t" id="A3.T8.1.1.1.1">
<span class="ltx_text" id="A3.T8.1.1.1.1.1" style="font-size:90%;">Passage: [Passage]</span><math alttext="\backslash" class="ltx_Math" display="inline" id="A3.T8.1.1.1.1.m1.1"><semantics id="A3.T8.1.1.1.1.m1.1a"><mo id="A3.T8.1.1.1.1.m1.1.1" mathsize="90%" xref="A3.T8.1.1.1.1.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="A3.T8.1.1.1.1.m1.1b"><ci id="A3.T8.1.1.1.1.m1.1.1.cmml" xref="A3.T8.1.1.1.1.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T8.1.1.1.1.m1.1c">\backslash</annotation><annotation encoding="application/x-llamapun" id="A3.T8.1.1.1.1.m1.1d">\</annotation></semantics></math><span class="ltx_text" id="A3.T8.1.1.1.1.2" style="font-size:90%;">n Question: [Question] Answer: [Answer]</span>
</td>
<td class="ltx_td ltx_border_bb ltx_border_b ltx_border_t" id="A3.T8.1.1.1.3"></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 8: </span>The hand-crafted prompts used to query the model predictions on the zero-shot evaluation of 5 NLU datasets and one question-answering dataset Squad.
</figcaption>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Jul 13 18:32:51 2023 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span style="font-size:70%;position:relative; bottom:2.2pt;">A</span>T<span style="position:relative; bottom:-0.4ex;">E</span></span><span class="ltx_font_smallcaps">xml</span><img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
