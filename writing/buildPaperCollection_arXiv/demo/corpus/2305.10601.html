<!DOCTYPE html>

<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Tree of Thoughts: Deliberate Problem Solving with Large Language Models</title>
<!--Generated on Sun Dec  3 22:50:51 2023 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv_0.7.4.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2305.10601v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="#S1" title="1 Introduction â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="#S2" title="2 Background â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Background</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="#S3" title="3 Tree of Thoughts: Deliberate Problem Solving with LM â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Tree of Thoughts: Deliberate Problem Solving with LM</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="#S4" title="4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="#S4.SS1" title="4.1 Game of 24 â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Game of 24</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="#S4.SS2" title="4.2 Creative writing â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Creative writing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="#S4.SS3" title="4.3 Mini crosswords â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Mini crosswords</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="#S5" title="5 Related Work â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="#S6" title="6 Discussion â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="#A1" title="Appendix A Code, Prompts, Trajectories â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Code, Prompts, Trajectories</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="#A2" title="Appendix B Additional Experiment Results â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Additional Experiment Results</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="#A2.SS1" title="B.1 Extension to new tasks (GSM8k, StrategyQA) with zero-shot ToT â€£ Appendix B Additional Experiment Results â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Extension to new tasks (GSM8k, StrategyQA) with zero-shot ToT</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="#A2.SS2" title="B.2 Extension to new LMs (GPT-3.5) â€£ Appendix B Additional Experiment Results â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Extension to new LMs (GPT-3.5)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="#A2.SS3" title="B.3 Cost and efficiency â€£ Appendix B Additional Experiment Results â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span>Cost and efficiency</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<div class="package-alerts ltx_document" role="alert">
<button aria-label="Dismiss alert" onclick="closePopup()">
<span aria-hidden="true"><svg aria-hidden="true" focusable="false" height="20" role="presentation" viewbox="0 0 44 44" width="20">
<path d="M0.549989 4.44999L4.44999 0.549988L43.45 39.55L39.55 43.45L0.549989 4.44999Z"></path>
<path d="M39.55 0.549988L43.45 4.44999L4.44999 43.45L0.549988 39.55L39.55 0.549988Z"></path>
</svg></span>
</button>
<p>HTML conversions <a href="https://info.dev.arxiv.org/about/accessibility_html_error_messages.html" target="_blank">sometimes display errors</a> due to content that did not convert correctly from the source. This paper uses the following packages that are not yet supported by the HTML conversion tool. Feedback on these issues are not necessary; they are known and are being worked on.</p>
<ul arial-label="Unsupported packages used in this paper">
<li>failed: forest</li>
<li>failed: qtree</li>
</ul>
<p>Authors: achieve the best HTML results from your LaTeX submissions by selecting from this list of <a href="https://corpora.mathweb.org/corpus/arxmliv/tex_to_html/info/loaded_file" target="_blank">supported packages</a>.</p>
</div><div class="section" id="target-section"><div id="license-tr">License: CC BY 4.0</div><div id="watermark-tr">arXiv:2305.10601v2 [cs.CL] 03 Dec 2023</div></div>
<script>
            function closePopup() {
                document.querySelector('.package-alerts').style.display = 'none';
            }
        </script>
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Tree of Thoughts: Deliberate Problem Solving 
<br class="ltx_break"/>with Large Language Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shunyu Yao

<br class="ltx_break"/>Princeton University
Dian Yu 
<br class="ltx_break"/>Google DeepMind
Jeffrey Zhao 
<br class="ltx_break"/>Google DeepMind
Izhak Shafran 
<br class="ltx_break"/>Google DeepMind
Thomas L. Griffiths 
<br class="ltx_break"/>Princeton University
Yuan Cao 
<br class="ltx_break"/>Google DeepMind
Karthik Narasimhan 
<br class="ltx_break"/>Princeton University
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Language models are increasingly being deployed for general problem solving across a wide range of tasks, but are still confined to token-level, left-to-right decision-making processes during inference. This means they can fall short in tasks that require exploration, strategic lookahead, or where initial decisions play a pivotal role.
To surmount these challenges, we introduce a new framework for language model inference, â€œTree of Thoughtsâ€ (ToT), which generalizes over the popular â€œChain of Thoughtâ€ approach to prompting language models, and enables exploration over coherent units of text (â€œthoughtsâ€) that serve as intermediate steps toward problem solving.
ToT allows LMs to perform deliberate decision making by considering multiple different reasoning paths and self-evaluating choices to decide the next course of action, as well as looking ahead or backtracking when necessary to make global choices.
Our experiments show that ToT significantly enhances language modelsâ€™ problem-solving abilities on three novel tasks requiring non-trivial planning or search: Game of 24, Creative Writing, and Mini Crosswords.
For instance, in Game of 24, while GPT-4 with chain-of-thought prompting only solved 4% of tasks, our method achieved a success rate of 74%. Code repo with all prompts: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/princeton-nlp/tree-of-thought-llm" title="">https://github.com/princeton-nlp/tree-of-thought-llm</a>.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Originally designed to generate text, scaled-up versions of language models (LMs) such as GPTÂ <cite class="ltx_cite ltx_citemacro_cite">Radford etÂ al. (<a class="ltx_ref" href="#bib.bib25" title="">2018</a>, <a class="ltx_ref" href="#bib.bib26" title="">2019</a>); Brown etÂ al. (<a class="ltx_ref" href="#bib.bib1" title="">2020</a>); OpenAI (<a class="ltx_ref" href="#bib.bib23" title="">2023</a>)</cite> and PaLMÂ <cite class="ltx_cite ltx_citemacro_cite">Chowdhery etÂ al. (<a class="ltx_ref" href="#bib.bib5" title="">2022</a>)</cite> have been shown to be increasingly capable of performing an ever wider range of tasks requiring mathematical, symbolic, commonsense, and knowledge reasoning. It is perhaps surprising that underlying all this progress is still the original autoregressive mechanism for generating text, which makes token-level decisions one by one and in a left-to-right fashion.
Is such a simple mechanism sufficient for a LM to be built toward a general problem solver?
If not, what problems would challenge the current paradigm, and what should be alternative mechanisms?</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">The literature on human cognition provides some clues to answer these questions.
Research on â€œdual processâ€ models suggests that people have two modes in which they engage with decisions â€“ a fast, automatic, unconscious mode (â€œSystem 1â€) and a slow, deliberate, conscious mode (â€œSystem 2â€) <cite class="ltx_cite ltx_citemacro_cite">Sloman (<a class="ltx_ref" href="#bib.bib30" title="">1996</a>); Stanovich (<a class="ltx_ref" href="#bib.bib31" title="">1999</a>); Kahneman etÂ al. (<a class="ltx_ref" href="#bib.bib16" title="">2002</a>); Kahneman (<a class="ltx_ref" href="#bib.bib15" title="">2011</a>)</cite>.
These two modes have previously been connected to a variety of mathematical models used in machine learning. For example, research on reinforcement learning in humans and other animals has explored the circumstances under which they engage in associative â€œmodel freeâ€ learning or more deliberative â€œmodel basedâ€ planning <cite class="ltx_cite ltx_citemacro_cite">Daw etÂ al. (<a class="ltx_ref" href="#bib.bib7" title="">2005</a>)</cite>.
The simple associative token-level choices of LMs are also reminiscent of â€œSystem 1â€, and thus might benefit from augmentation by a more deliberate â€œSystem 2â€ planning process that (1) maintains and explores diverse alternatives for current choices instead of just picking one, and (2) evaluates its current status and actively looks ahead or backtracks to make more global decisions.
</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To design such a planning process, we return to the origins of artificial intelligence (and cognitive science), drawing inspiration from the planning processes explored by Newell, Shaw, and Simon starting in the 1950sÂ <cite class="ltx_cite ltx_citemacro_cite">Newell etÂ al. (<a class="ltx_ref" href="#bib.bib21" title="">1959</a>, <a class="ltx_ref" href="#bib.bib22" title="">1972</a>)</cite>. Newell and colleagues characterized
problem solvingÂ <cite class="ltx_cite ltx_citemacro_cite">Newell etÂ al. (<a class="ltx_ref" href="#bib.bib21" title="">1959</a>)</cite>
as search through a combinatorial problem space, represented as a tree. We thus propose the Tree of Thoughts (ToT) framework for general problem solving with language models. As FigureÂ <a class="ltx_ref" href="#S1.F1" title="Figure 1 â€£ 1 Introduction â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates, while existing methods (detailed below) sample continuous language sequences for problem solving, ToT actively maintains a tree of thoughts, where each <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">thought</span> is a coherent language sequence that serves as an intermediate step toward problem solving (TableÂ <a class="ltx_ref" href="#S4.T1" title="Table 1 â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>). Such a high-level semantic unit allows the LM to self-evaluate the progress different intermediate thoughts make towards solving the problem through a deliberate reasoning process that is also instantiated in language (FiguresÂ <a class="ltx_ref" href="#S4.F2" title="Figure 2 â€£ 4.1 Game of 24 â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>,<a class="ltx_ref" href="#S4.F4" title="Figure 4 â€£ 4.2 Creative writing â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>,<a class="ltx_ref" href="#S4.F6" title="Figure 6 â€£ 4.3 Mini crosswords â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>). This implementation of search heuristics via LM self-evaluation and deliberation is novel, as previous search heuristics are either programmed or learned. Finally, we combine this language-based capability to generate and evaluate diverse thoughts with search algorithms, such as breadth-first search (BFS) or depth-first search (DFS), which allow systematic exploration of the tree of thoughts with lookahead and backtracking.
</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Empirically, we propose three new problems that challenge existing LM inference methods even with the state-of-the-art language model, GPT-4Â <cite class="ltx_cite ltx_citemacro_cite">OpenAI (<a class="ltx_ref" href="#bib.bib23" title="">2023</a>)</cite>: Game of 24, Creative Writing, and Crosswords (TableÂ <a class="ltx_ref" href="#S4.T1" title="Table 1 â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>).
These tasks require deductive, mathematical, commonsense, lexical reasoning abilities, and a way to incorporate systematic planning or search.
We show ToT obtains superior results on all three tasks by being general and flexible enough to support different levels of thoughts, different ways to generate and evaluate thoughts, and different search algorithms that adapt to the nature of different problems. We also analyze how such choices affect model performances via systematic ablations and discuss future directions to better train and use LMs.
</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="327" id="S1.F1.g1" src="x1.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Schematic illustrating various approaches to problem solving with LLMs. Each rectangle box represents a <span class="ltx_text ltx_font_italic" id="S1.F1.2.1">thought</span>, which is a coherent language sequence that serves as an intermediate step toward problem solving. See concrete examples of how thoughts are generated, evaluated, and searched in FiguresÂ <a class="ltx_ref" href="#S4.F2" title="Figure 2 â€£ 4.1 Game of 24 â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>,<a class="ltx_ref" href="#S4.F4" title="Figure 4 â€£ 4.2 Creative writing â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>,<a class="ltx_ref" href="#S4.F6" title="Figure 6 â€£ 4.3 Mini crosswords â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>.
</figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.7">We first formalize some existing methods that use large language models for problem-solving, which our approach is inspired by and later compared with.
We use <math alttext="p_{\theta}" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><msub id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml"><mi id="S2.p1.1.m1.1.1.2" xref="S2.p1.1.m1.1.1.2.cmml">p</mi><mi id="S2.p1.1.m1.1.1.3" xref="S2.p1.1.m1.1.1.3.cmml">Î¸</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><apply id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.1.cmml" xref="S2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.p1.1.m1.1.1.2.cmml" xref="S2.p1.1.m1.1.1.2">ğ‘</ci><ci id="S2.p1.1.m1.1.1.3.cmml" xref="S2.p1.1.m1.1.1.3">ğœƒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">p_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT</annotation></semantics></math> to denote a pre-trained LM with parameters <math alttext="\theta" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">italic_Î¸</annotation></semantics></math>, and <span class="ltx_text ltx_font_bold" id="S2.p1.3.1">lowercase letters <math alttext="x,y,z,s,\cdots" class="ltx_Math" display="inline" id="S2.p1.3.1.m1.5"><semantics id="S2.p1.3.1.m1.5a"><mrow id="S2.p1.3.1.m1.5.6.2" xref="S2.p1.3.1.m1.5.6.1.cmml"><mi id="S2.p1.3.1.m1.1.1" xref="S2.p1.3.1.m1.1.1.cmml">x</mi><mo id="S2.p1.3.1.m1.5.6.2.1" mathvariant="normal" xref="S2.p1.3.1.m1.5.6.1.cmml">,</mo><mi id="S2.p1.3.1.m1.2.2" xref="S2.p1.3.1.m1.2.2.cmml">y</mi><mo id="S2.p1.3.1.m1.5.6.2.2" mathvariant="normal" xref="S2.p1.3.1.m1.5.6.1.cmml">,</mo><mi id="S2.p1.3.1.m1.3.3" xref="S2.p1.3.1.m1.3.3.cmml">z</mi><mo id="S2.p1.3.1.m1.5.6.2.3" mathvariant="normal" xref="S2.p1.3.1.m1.5.6.1.cmml">,</mo><mi id="S2.p1.3.1.m1.4.4" xref="S2.p1.3.1.m1.4.4.cmml">s</mi><mo id="S2.p1.3.1.m1.5.6.2.4" mathvariant="normal" xref="S2.p1.3.1.m1.5.6.1.cmml">,</mo><mi id="S2.p1.3.1.m1.5.5" mathvariant="normal" xref="S2.p1.3.1.m1.5.5.cmml">â‹¯</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.1.m1.5b"><list id="S2.p1.3.1.m1.5.6.1.cmml" xref="S2.p1.3.1.m1.5.6.2"><ci id="S2.p1.3.1.m1.1.1.cmml" xref="S2.p1.3.1.m1.1.1">ğ‘¥</ci><ci id="S2.p1.3.1.m1.2.2.cmml" xref="S2.p1.3.1.m1.2.2">ğ‘¦</ci><ci id="S2.p1.3.1.m1.3.3.cmml" xref="S2.p1.3.1.m1.3.3">ğ‘§</ci><ci id="S2.p1.3.1.m1.4.4.cmml" xref="S2.p1.3.1.m1.4.4">ğ‘ </ci><ci id="S2.p1.3.1.m1.5.5.cmml" xref="S2.p1.3.1.m1.5.5">normal-â‹¯</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.1.m1.5c">x,y,z,s,\cdots</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.1.m1.5d">italic_x , italic_y , italic_z , italic_s , â‹¯</annotation></semantics></math> to denote a language sequence</span>, i.e.â€‰<math alttext="x=(x[1],\cdots,x[n])" class="ltx_Math" display="inline" id="S2.p1.4.m3.5"><semantics id="S2.p1.4.m3.5a"><mrow id="S2.p1.4.m3.5.5" xref="S2.p1.4.m3.5.5.cmml"><mi id="S2.p1.4.m3.5.5.4" xref="S2.p1.4.m3.5.5.4.cmml">x</mi><mo id="S2.p1.4.m3.5.5.3" xref="S2.p1.4.m3.5.5.3.cmml">=</mo><mrow id="S2.p1.4.m3.5.5.2.2" xref="S2.p1.4.m3.5.5.2.3.cmml"><mo id="S2.p1.4.m3.5.5.2.2.3" stretchy="false" xref="S2.p1.4.m3.5.5.2.3.cmml">(</mo><mrow id="S2.p1.4.m3.4.4.1.1.1" xref="S2.p1.4.m3.4.4.1.1.1.cmml"><mi id="S2.p1.4.m3.4.4.1.1.1.2" xref="S2.p1.4.m3.4.4.1.1.1.2.cmml">x</mi><mo id="S2.p1.4.m3.4.4.1.1.1.1" xref="S2.p1.4.m3.4.4.1.1.1.1.cmml">â¢</mo><mrow id="S2.p1.4.m3.4.4.1.1.1.3.2" xref="S2.p1.4.m3.4.4.1.1.1.3.1.cmml"><mo id="S2.p1.4.m3.4.4.1.1.1.3.2.1" stretchy="false" xref="S2.p1.4.m3.4.4.1.1.1.3.1.1.cmml">[</mo><mn id="S2.p1.4.m3.1.1" xref="S2.p1.4.m3.1.1.cmml">1</mn><mo id="S2.p1.4.m3.4.4.1.1.1.3.2.2" stretchy="false" xref="S2.p1.4.m3.4.4.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S2.p1.4.m3.5.5.2.2.4" xref="S2.p1.4.m3.5.5.2.3.cmml">,</mo><mi id="S2.p1.4.m3.3.3" mathvariant="normal" xref="S2.p1.4.m3.3.3.cmml">â‹¯</mi><mo id="S2.p1.4.m3.5.5.2.2.5" xref="S2.p1.4.m3.5.5.2.3.cmml">,</mo><mrow id="S2.p1.4.m3.5.5.2.2.2" xref="S2.p1.4.m3.5.5.2.2.2.cmml"><mi id="S2.p1.4.m3.5.5.2.2.2.2" xref="S2.p1.4.m3.5.5.2.2.2.2.cmml">x</mi><mo id="S2.p1.4.m3.5.5.2.2.2.1" xref="S2.p1.4.m3.5.5.2.2.2.1.cmml">â¢</mo><mrow id="S2.p1.4.m3.5.5.2.2.2.3.2" xref="S2.p1.4.m3.5.5.2.2.2.3.1.cmml"><mo id="S2.p1.4.m3.5.5.2.2.2.3.2.1" stretchy="false" xref="S2.p1.4.m3.5.5.2.2.2.3.1.1.cmml">[</mo><mi id="S2.p1.4.m3.2.2" xref="S2.p1.4.m3.2.2.cmml">n</mi><mo id="S2.p1.4.m3.5.5.2.2.2.3.2.2" stretchy="false" xref="S2.p1.4.m3.5.5.2.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S2.p1.4.m3.5.5.2.2.6" stretchy="false" xref="S2.p1.4.m3.5.5.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m3.5b"><apply id="S2.p1.4.m3.5.5.cmml" xref="S2.p1.4.m3.5.5"><eq id="S2.p1.4.m3.5.5.3.cmml" xref="S2.p1.4.m3.5.5.3"></eq><ci id="S2.p1.4.m3.5.5.4.cmml" xref="S2.p1.4.m3.5.5.4">ğ‘¥</ci><vector id="S2.p1.4.m3.5.5.2.3.cmml" xref="S2.p1.4.m3.5.5.2.2"><apply id="S2.p1.4.m3.4.4.1.1.1.cmml" xref="S2.p1.4.m3.4.4.1.1.1"><times id="S2.p1.4.m3.4.4.1.1.1.1.cmml" xref="S2.p1.4.m3.4.4.1.1.1.1"></times><ci id="S2.p1.4.m3.4.4.1.1.1.2.cmml" xref="S2.p1.4.m3.4.4.1.1.1.2">ğ‘¥</ci><apply id="S2.p1.4.m3.4.4.1.1.1.3.1.cmml" xref="S2.p1.4.m3.4.4.1.1.1.3.2"><csymbol cd="latexml" id="S2.p1.4.m3.4.4.1.1.1.3.1.1.cmml" xref="S2.p1.4.m3.4.4.1.1.1.3.2.1">delimited-[]</csymbol><cn id="S2.p1.4.m3.1.1.cmml" type="integer" xref="S2.p1.4.m3.1.1">1</cn></apply></apply><ci id="S2.p1.4.m3.3.3.cmml" xref="S2.p1.4.m3.3.3">â‹¯</ci><apply id="S2.p1.4.m3.5.5.2.2.2.cmml" xref="S2.p1.4.m3.5.5.2.2.2"><times id="S2.p1.4.m3.5.5.2.2.2.1.cmml" xref="S2.p1.4.m3.5.5.2.2.2.1"></times><ci id="S2.p1.4.m3.5.5.2.2.2.2.cmml" xref="S2.p1.4.m3.5.5.2.2.2.2">ğ‘¥</ci><apply id="S2.p1.4.m3.5.5.2.2.2.3.1.cmml" xref="S2.p1.4.m3.5.5.2.2.2.3.2"><csymbol cd="latexml" id="S2.p1.4.m3.5.5.2.2.2.3.1.1.cmml" xref="S2.p1.4.m3.5.5.2.2.2.3.2.1">delimited-[]</csymbol><ci id="S2.p1.4.m3.2.2.cmml" xref="S2.p1.4.m3.2.2">ğ‘›</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m3.5c">x=(x[1],\cdots,x[n])</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m3.5d">italic_x = ( italic_x [ 1 ] , â‹¯ , italic_x [ italic_n ] )</annotation></semantics></math> where each <math alttext="x[i]" class="ltx_Math" display="inline" id="S2.p1.5.m4.1"><semantics id="S2.p1.5.m4.1a"><mrow id="S2.p1.5.m4.1.2" xref="S2.p1.5.m4.1.2.cmml"><mi id="S2.p1.5.m4.1.2.2" xref="S2.p1.5.m4.1.2.2.cmml">x</mi><mo id="S2.p1.5.m4.1.2.1" xref="S2.p1.5.m4.1.2.1.cmml">â¢</mo><mrow id="S2.p1.5.m4.1.2.3.2" xref="S2.p1.5.m4.1.2.3.1.cmml"><mo id="S2.p1.5.m4.1.2.3.2.1" stretchy="false" xref="S2.p1.5.m4.1.2.3.1.1.cmml">[</mo><mi id="S2.p1.5.m4.1.1" xref="S2.p1.5.m4.1.1.cmml">i</mi><mo id="S2.p1.5.m4.1.2.3.2.2" stretchy="false" xref="S2.p1.5.m4.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m4.1b"><apply id="S2.p1.5.m4.1.2.cmml" xref="S2.p1.5.m4.1.2"><times id="S2.p1.5.m4.1.2.1.cmml" xref="S2.p1.5.m4.1.2.1"></times><ci id="S2.p1.5.m4.1.2.2.cmml" xref="S2.p1.5.m4.1.2.2">ğ‘¥</ci><apply id="S2.p1.5.m4.1.2.3.1.cmml" xref="S2.p1.5.m4.1.2.3.2"><csymbol cd="latexml" id="S2.p1.5.m4.1.2.3.1.1.cmml" xref="S2.p1.5.m4.1.2.3.2.1">delimited-[]</csymbol><ci id="S2.p1.5.m4.1.1.cmml" xref="S2.p1.5.m4.1.1">ğ‘–</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m4.1c">x[i]</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m4.1d">italic_x [ italic_i ]</annotation></semantics></math> is a token, so that <math alttext="p_{\theta}(x)=\prod_{i=1}^{n}p_{\theta}(x[i]|x[1...i])" class="ltx_Math" display="inline" id="S2.p1.6.m5.3"><semantics id="S2.p1.6.m5.3a"><mrow id="S2.p1.6.m5.3.3" xref="S2.p1.6.m5.3.3.cmml"><mrow id="S2.p1.6.m5.3.3.3" xref="S2.p1.6.m5.3.3.3.cmml"><msub id="S2.p1.6.m5.3.3.3.2" xref="S2.p1.6.m5.3.3.3.2.cmml"><mi id="S2.p1.6.m5.3.3.3.2.2" xref="S2.p1.6.m5.3.3.3.2.2.cmml">p</mi><mi id="S2.p1.6.m5.3.3.3.2.3" xref="S2.p1.6.m5.3.3.3.2.3.cmml">Î¸</mi></msub><mo id="S2.p1.6.m5.3.3.3.1" xref="S2.p1.6.m5.3.3.3.1.cmml">â¢</mo><mrow id="S2.p1.6.m5.3.3.3.3.2" xref="S2.p1.6.m5.3.3.3.cmml"><mo id="S2.p1.6.m5.3.3.3.3.2.1" stretchy="false" xref="S2.p1.6.m5.3.3.3.cmml">(</mo><mi id="S2.p1.6.m5.1.1" xref="S2.p1.6.m5.1.1.cmml">x</mi><mo id="S2.p1.6.m5.3.3.3.3.2.2" stretchy="false" xref="S2.p1.6.m5.3.3.3.cmml">)</mo></mrow></mrow><mo id="S2.p1.6.m5.3.3.2" rspace="0.111em" xref="S2.p1.6.m5.3.3.2.cmml">=</mo><mrow id="S2.p1.6.m5.3.3.1" xref="S2.p1.6.m5.3.3.1.cmml"><msubsup id="S2.p1.6.m5.3.3.1.2" xref="S2.p1.6.m5.3.3.1.2.cmml"><mo id="S2.p1.6.m5.3.3.1.2.2.2" xref="S2.p1.6.m5.3.3.1.2.2.2.cmml">âˆ</mo><mrow id="S2.p1.6.m5.3.3.1.2.2.3" xref="S2.p1.6.m5.3.3.1.2.2.3.cmml"><mi id="S2.p1.6.m5.3.3.1.2.2.3.2" xref="S2.p1.6.m5.3.3.1.2.2.3.2.cmml">i</mi><mo id="S2.p1.6.m5.3.3.1.2.2.3.1" xref="S2.p1.6.m5.3.3.1.2.2.3.1.cmml">=</mo><mn id="S2.p1.6.m5.3.3.1.2.2.3.3" xref="S2.p1.6.m5.3.3.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.p1.6.m5.3.3.1.2.3" xref="S2.p1.6.m5.3.3.1.2.3.cmml">n</mi></msubsup><mrow id="S2.p1.6.m5.3.3.1.1" xref="S2.p1.6.m5.3.3.1.1.cmml"><msub id="S2.p1.6.m5.3.3.1.1.3" xref="S2.p1.6.m5.3.3.1.1.3.cmml"><mi id="S2.p1.6.m5.3.3.1.1.3.2" xref="S2.p1.6.m5.3.3.1.1.3.2.cmml">p</mi><mi id="S2.p1.6.m5.3.3.1.1.3.3" xref="S2.p1.6.m5.3.3.1.1.3.3.cmml">Î¸</mi></msub><mo id="S2.p1.6.m5.3.3.1.1.2" xref="S2.p1.6.m5.3.3.1.1.2.cmml">â¢</mo><mrow id="S2.p1.6.m5.3.3.1.1.1.1" xref="S2.p1.6.m5.3.3.1.1.1.1.1.cmml"><mo id="S2.p1.6.m5.3.3.1.1.1.1.2" stretchy="false" xref="S2.p1.6.m5.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S2.p1.6.m5.3.3.1.1.1.1.1" xref="S2.p1.6.m5.3.3.1.1.1.1.1.cmml"><mrow id="S2.p1.6.m5.3.3.1.1.1.1.1.3" xref="S2.p1.6.m5.3.3.1.1.1.1.1.3.cmml"><mi id="S2.p1.6.m5.3.3.1.1.1.1.1.3.2" xref="S2.p1.6.m5.3.3.1.1.1.1.1.3.2.cmml">x</mi><mo id="S2.p1.6.m5.3.3.1.1.1.1.1.3.1" xref="S2.p1.6.m5.3.3.1.1.1.1.1.3.1.cmml">â¢</mo><mrow id="S2.p1.6.m5.3.3.1.1.1.1.1.3.3.2" xref="S2.p1.6.m5.3.3.1.1.1.1.1.3.3.1.cmml"><mo id="S2.p1.6.m5.3.3.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S2.p1.6.m5.3.3.1.1.1.1.1.3.3.1.1.cmml">[</mo><mi id="S2.p1.6.m5.2.2" xref="S2.p1.6.m5.2.2.cmml">i</mi><mo id="S2.p1.6.m5.3.3.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S2.p1.6.m5.3.3.1.1.1.1.1.3.3.1.1.cmml">]</mo></mrow></mrow><mo fence="false" id="S2.p1.6.m5.3.3.1.1.1.1.1.2" xref="S2.p1.6.m5.3.3.1.1.1.1.1.2.cmml">|</mo><mrow id="S2.p1.6.m5.3.3.1.1.1.1.1.1" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.cmml"><mi id="S2.p1.6.m5.3.3.1.1.1.1.1.1.3" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.3.cmml">x</mi><mo id="S2.p1.6.m5.3.3.1.1.1.1.1.1.2" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.2.cmml"><mo id="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.cmml"><mn id="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.2" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.1.cmml">â¢</mo><mi id="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.3" mathvariant="normal" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.3.cmml">â€¦</mi><mo id="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.1a" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.1.cmml">â¢</mo><mi id="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.4" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.4.cmml">i</mi></mrow><mo id="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.p1.6.m5.3.3.1.1.1.1.3" stretchy="false" xref="S2.p1.6.m5.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.6.m5.3b"><apply id="S2.p1.6.m5.3.3.cmml" xref="S2.p1.6.m5.3.3"><eq id="S2.p1.6.m5.3.3.2.cmml" xref="S2.p1.6.m5.3.3.2"></eq><apply id="S2.p1.6.m5.3.3.3.cmml" xref="S2.p1.6.m5.3.3.3"><times id="S2.p1.6.m5.3.3.3.1.cmml" xref="S2.p1.6.m5.3.3.3.1"></times><apply id="S2.p1.6.m5.3.3.3.2.cmml" xref="S2.p1.6.m5.3.3.3.2"><csymbol cd="ambiguous" id="S2.p1.6.m5.3.3.3.2.1.cmml" xref="S2.p1.6.m5.3.3.3.2">subscript</csymbol><ci id="S2.p1.6.m5.3.3.3.2.2.cmml" xref="S2.p1.6.m5.3.3.3.2.2">ğ‘</ci><ci id="S2.p1.6.m5.3.3.3.2.3.cmml" xref="S2.p1.6.m5.3.3.3.2.3">ğœƒ</ci></apply><ci id="S2.p1.6.m5.1.1.cmml" xref="S2.p1.6.m5.1.1">ğ‘¥</ci></apply><apply id="S2.p1.6.m5.3.3.1.cmml" xref="S2.p1.6.m5.3.3.1"><apply id="S2.p1.6.m5.3.3.1.2.cmml" xref="S2.p1.6.m5.3.3.1.2"><csymbol cd="ambiguous" id="S2.p1.6.m5.3.3.1.2.1.cmml" xref="S2.p1.6.m5.3.3.1.2">superscript</csymbol><apply id="S2.p1.6.m5.3.3.1.2.2.cmml" xref="S2.p1.6.m5.3.3.1.2"><csymbol cd="ambiguous" id="S2.p1.6.m5.3.3.1.2.2.1.cmml" xref="S2.p1.6.m5.3.3.1.2">subscript</csymbol><csymbol cd="latexml" id="S2.p1.6.m5.3.3.1.2.2.2.cmml" xref="S2.p1.6.m5.3.3.1.2.2.2">product</csymbol><apply id="S2.p1.6.m5.3.3.1.2.2.3.cmml" xref="S2.p1.6.m5.3.3.1.2.2.3"><eq id="S2.p1.6.m5.3.3.1.2.2.3.1.cmml" xref="S2.p1.6.m5.3.3.1.2.2.3.1"></eq><ci id="S2.p1.6.m5.3.3.1.2.2.3.2.cmml" xref="S2.p1.6.m5.3.3.1.2.2.3.2">ğ‘–</ci><cn id="S2.p1.6.m5.3.3.1.2.2.3.3.cmml" type="integer" xref="S2.p1.6.m5.3.3.1.2.2.3.3">1</cn></apply></apply><ci id="S2.p1.6.m5.3.3.1.2.3.cmml" xref="S2.p1.6.m5.3.3.1.2.3">ğ‘›</ci></apply><apply id="S2.p1.6.m5.3.3.1.1.cmml" xref="S2.p1.6.m5.3.3.1.1"><times id="S2.p1.6.m5.3.3.1.1.2.cmml" xref="S2.p1.6.m5.3.3.1.1.2"></times><apply id="S2.p1.6.m5.3.3.1.1.3.cmml" xref="S2.p1.6.m5.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.p1.6.m5.3.3.1.1.3.1.cmml" xref="S2.p1.6.m5.3.3.1.1.3">subscript</csymbol><ci id="S2.p1.6.m5.3.3.1.1.3.2.cmml" xref="S2.p1.6.m5.3.3.1.1.3.2">ğ‘</ci><ci id="S2.p1.6.m5.3.3.1.1.3.3.cmml" xref="S2.p1.6.m5.3.3.1.1.3.3">ğœƒ</ci></apply><apply id="S2.p1.6.m5.3.3.1.1.1.1.1.cmml" xref="S2.p1.6.m5.3.3.1.1.1.1"><csymbol cd="latexml" id="S2.p1.6.m5.3.3.1.1.1.1.1.2.cmml" xref="S2.p1.6.m5.3.3.1.1.1.1.1.2">conditional</csymbol><apply id="S2.p1.6.m5.3.3.1.1.1.1.1.3.cmml" xref="S2.p1.6.m5.3.3.1.1.1.1.1.3"><times id="S2.p1.6.m5.3.3.1.1.1.1.1.3.1.cmml" xref="S2.p1.6.m5.3.3.1.1.1.1.1.3.1"></times><ci id="S2.p1.6.m5.3.3.1.1.1.1.1.3.2.cmml" xref="S2.p1.6.m5.3.3.1.1.1.1.1.3.2">ğ‘¥</ci><apply id="S2.p1.6.m5.3.3.1.1.1.1.1.3.3.1.cmml" xref="S2.p1.6.m5.3.3.1.1.1.1.1.3.3.2"><csymbol cd="latexml" id="S2.p1.6.m5.3.3.1.1.1.1.1.3.3.1.1.cmml" xref="S2.p1.6.m5.3.3.1.1.1.1.1.3.3.2.1">delimited-[]</csymbol><ci id="S2.p1.6.m5.2.2.cmml" xref="S2.p1.6.m5.2.2">ğ‘–</ci></apply></apply><apply id="S2.p1.6.m5.3.3.1.1.1.1.1.1.cmml" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1"><times id="S2.p1.6.m5.3.3.1.1.1.1.1.1.2.cmml" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.2"></times><ci id="S2.p1.6.m5.3.3.1.1.1.1.1.1.3.cmml" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.3">ğ‘¥</ci><apply id="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1"><times id="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.1"></times><cn id="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.3">â€¦</ci><ci id="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.p1.6.m5.3.3.1.1.1.1.1.1.1.1.1.4">ğ‘–</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m5.3c">p_{\theta}(x)=\prod_{i=1}^{n}p_{\theta}(x[i]|x[1...i])</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m5.3d">italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT ( italic_x ) = âˆ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT ( italic_x [ italic_i ] | italic_x [ 1 â€¦ italic_i ] )</annotation></semantics></math>. We use uppercase letters <math alttext="S,\cdots" class="ltx_Math" display="inline" id="S2.p1.7.m6.2"><semantics id="S2.p1.7.m6.2a"><mrow id="S2.p1.7.m6.2.3.2" xref="S2.p1.7.m6.2.3.1.cmml"><mi id="S2.p1.7.m6.1.1" xref="S2.p1.7.m6.1.1.cmml">S</mi><mo id="S2.p1.7.m6.2.3.2.1" xref="S2.p1.7.m6.2.3.1.cmml">,</mo><mi id="S2.p1.7.m6.2.2" mathvariant="normal" xref="S2.p1.7.m6.2.2.cmml">â‹¯</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.7.m6.2b"><list id="S2.p1.7.m6.2.3.1.cmml" xref="S2.p1.7.m6.2.3.2"><ci id="S2.p1.7.m6.1.1.cmml" xref="S2.p1.7.m6.1.1">ğ‘†</ci><ci id="S2.p1.7.m6.2.2.cmml" xref="S2.p1.7.m6.2.2">â‹¯</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m6.2c">S,\cdots</annotation><annotation encoding="application/x-llamapun" id="S2.p1.7.m6.2d">italic_S , â‹¯</annotation></semantics></math> to denote a collection of language sequences.
</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.7"><span class="ltx_text ltx_font_bold" id="S2.p2.7.1">Input-output (IO) prompting</span> is the most common way to turn a problem input <math alttext="x" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">ğ‘¥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">italic_x</annotation></semantics></math> into output <math alttext="y" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">ğ‘¦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">italic_y</annotation></semantics></math> with LM: <math alttext="y\sim p_{\theta}(y|\texttt{prompt}_{{IO}}(x))" class="ltx_Math" display="inline" id="S2.p2.3.m3.2"><semantics id="S2.p2.3.m3.2a"><mrow id="S2.p2.3.m3.2.2" xref="S2.p2.3.m3.2.2.cmml"><mi id="S2.p2.3.m3.2.2.3" xref="S2.p2.3.m3.2.2.3.cmml">y</mi><mo id="S2.p2.3.m3.2.2.2" xref="S2.p2.3.m3.2.2.2.cmml">âˆ¼</mo><mrow id="S2.p2.3.m3.2.2.1" xref="S2.p2.3.m3.2.2.1.cmml"><msub id="S2.p2.3.m3.2.2.1.3" xref="S2.p2.3.m3.2.2.1.3.cmml"><mi id="S2.p2.3.m3.2.2.1.3.2" xref="S2.p2.3.m3.2.2.1.3.2.cmml">p</mi><mi id="S2.p2.3.m3.2.2.1.3.3" xref="S2.p2.3.m3.2.2.1.3.3.cmml">Î¸</mi></msub><mo id="S2.p2.3.m3.2.2.1.2" xref="S2.p2.3.m3.2.2.1.2.cmml">â¢</mo><mrow id="S2.p2.3.m3.2.2.1.1.1" xref="S2.p2.3.m3.2.2.1.1.1.1.cmml"><mo id="S2.p2.3.m3.2.2.1.1.1.2" stretchy="false" xref="S2.p2.3.m3.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.p2.3.m3.2.2.1.1.1.1" xref="S2.p2.3.m3.2.2.1.1.1.1.cmml"><mi id="S2.p2.3.m3.2.2.1.1.1.1.2" xref="S2.p2.3.m3.2.2.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.p2.3.m3.2.2.1.1.1.1.1" xref="S2.p2.3.m3.2.2.1.1.1.1.1.cmml">|</mo><mrow id="S2.p2.3.m3.2.2.1.1.1.1.3" xref="S2.p2.3.m3.2.2.1.1.1.1.3.cmml"><msub id="S2.p2.3.m3.2.2.1.1.1.1.3.2" xref="S2.p2.3.m3.2.2.1.1.1.1.3.2.cmml"><mtext id="S2.p2.3.m3.2.2.1.1.1.1.3.2.2" xref="S2.p2.3.m3.2.2.1.1.1.1.3.2.2a.cmml">ğš™ğš›ğš˜ğš–ğš™ğš</mtext><mrow id="S2.p2.3.m3.2.2.1.1.1.1.3.2.3" xref="S2.p2.3.m3.2.2.1.1.1.1.3.2.3.cmml"><mi id="S2.p2.3.m3.2.2.1.1.1.1.3.2.3.2" xref="S2.p2.3.m3.2.2.1.1.1.1.3.2.3.2.cmml">I</mi><mo id="S2.p2.3.m3.2.2.1.1.1.1.3.2.3.1" xref="S2.p2.3.m3.2.2.1.1.1.1.3.2.3.1.cmml">â¢</mo><mi id="S2.p2.3.m3.2.2.1.1.1.1.3.2.3.3" xref="S2.p2.3.m3.2.2.1.1.1.1.3.2.3.3.cmml">O</mi></mrow></msub><mo id="S2.p2.3.m3.2.2.1.1.1.1.3.1" xref="S2.p2.3.m3.2.2.1.1.1.1.3.1.cmml">â¢</mo><mrow id="S2.p2.3.m3.2.2.1.1.1.1.3.3.2" xref="S2.p2.3.m3.2.2.1.1.1.1.3.cmml"><mo id="S2.p2.3.m3.2.2.1.1.1.1.3.3.2.1" stretchy="false" xref="S2.p2.3.m3.2.2.1.1.1.1.3.cmml">(</mo><mi id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">x</mi><mo id="S2.p2.3.m3.2.2.1.1.1.1.3.3.2.2" stretchy="false" xref="S2.p2.3.m3.2.2.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.p2.3.m3.2.2.1.1.1.3" stretchy="false" xref="S2.p2.3.m3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.2b"><apply id="S2.p2.3.m3.2.2.cmml" xref="S2.p2.3.m3.2.2"><csymbol cd="latexml" id="S2.p2.3.m3.2.2.2.cmml" xref="S2.p2.3.m3.2.2.2">similar-to</csymbol><ci id="S2.p2.3.m3.2.2.3.cmml" xref="S2.p2.3.m3.2.2.3">ğ‘¦</ci><apply id="S2.p2.3.m3.2.2.1.cmml" xref="S2.p2.3.m3.2.2.1"><times id="S2.p2.3.m3.2.2.1.2.cmml" xref="S2.p2.3.m3.2.2.1.2"></times><apply id="S2.p2.3.m3.2.2.1.3.cmml" xref="S2.p2.3.m3.2.2.1.3"><csymbol cd="ambiguous" id="S2.p2.3.m3.2.2.1.3.1.cmml" xref="S2.p2.3.m3.2.2.1.3">subscript</csymbol><ci id="S2.p2.3.m3.2.2.1.3.2.cmml" xref="S2.p2.3.m3.2.2.1.3.2">ğ‘</ci><ci id="S2.p2.3.m3.2.2.1.3.3.cmml" xref="S2.p2.3.m3.2.2.1.3.3">ğœƒ</ci></apply><apply id="S2.p2.3.m3.2.2.1.1.1.1.cmml" xref="S2.p2.3.m3.2.2.1.1.1"><csymbol cd="latexml" id="S2.p2.3.m3.2.2.1.1.1.1.1.cmml" xref="S2.p2.3.m3.2.2.1.1.1.1.1">conditional</csymbol><ci id="S2.p2.3.m3.2.2.1.1.1.1.2.cmml" xref="S2.p2.3.m3.2.2.1.1.1.1.2">ğ‘¦</ci><apply id="S2.p2.3.m3.2.2.1.1.1.1.3.cmml" xref="S2.p2.3.m3.2.2.1.1.1.1.3"><times id="S2.p2.3.m3.2.2.1.1.1.1.3.1.cmml" xref="S2.p2.3.m3.2.2.1.1.1.1.3.1"></times><apply id="S2.p2.3.m3.2.2.1.1.1.1.3.2.cmml" xref="S2.p2.3.m3.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.p2.3.m3.2.2.1.1.1.1.3.2.1.cmml" xref="S2.p2.3.m3.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S2.p2.3.m3.2.2.1.1.1.1.3.2.2a.cmml" xref="S2.p2.3.m3.2.2.1.1.1.1.3.2.2"><mtext id="S2.p2.3.m3.2.2.1.1.1.1.3.2.2.cmml" xref="S2.p2.3.m3.2.2.1.1.1.1.3.2.2">ğš™ğš›ğš˜ğš–ğš™ğš</mtext></ci><apply id="S2.p2.3.m3.2.2.1.1.1.1.3.2.3.cmml" xref="S2.p2.3.m3.2.2.1.1.1.1.3.2.3"><times id="S2.p2.3.m3.2.2.1.1.1.1.3.2.3.1.cmml" xref="S2.p2.3.m3.2.2.1.1.1.1.3.2.3.1"></times><ci id="S2.p2.3.m3.2.2.1.1.1.1.3.2.3.2.cmml" xref="S2.p2.3.m3.2.2.1.1.1.1.3.2.3.2">ğ¼</ci><ci id="S2.p2.3.m3.2.2.1.1.1.1.3.2.3.3.cmml" xref="S2.p2.3.m3.2.2.1.1.1.1.3.2.3.3">ğ‘‚</ci></apply></apply><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">ğ‘¥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.2c">y\sim p_{\theta}(y|\texttt{prompt}_{{IO}}(x))</annotation><annotation encoding="application/x-llamapun" id="S2.p2.3.m3.2d">italic_y âˆ¼ italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT ( italic_y | prompt start_POSTSUBSCRIPT italic_I italic_O end_POSTSUBSCRIPT ( italic_x ) )</annotation></semantics></math>, where <math alttext="\texttt{prompt}_{IO}(x)" class="ltx_Math" display="inline" id="S2.p2.4.m4.1"><semantics id="S2.p2.4.m4.1a"><mrow id="S2.p2.4.m4.1.2" xref="S2.p2.4.m4.1.2.cmml"><msub id="S2.p2.4.m4.1.2.2" xref="S2.p2.4.m4.1.2.2.cmml"><mtext id="S2.p2.4.m4.1.2.2.2" xref="S2.p2.4.m4.1.2.2.2a.cmml">ğš™ğš›ğš˜ğš–ğš™ğš</mtext><mrow id="S2.p2.4.m4.1.2.2.3" xref="S2.p2.4.m4.1.2.2.3.cmml"><mi id="S2.p2.4.m4.1.2.2.3.2" xref="S2.p2.4.m4.1.2.2.3.2.cmml">I</mi><mo id="S2.p2.4.m4.1.2.2.3.1" xref="S2.p2.4.m4.1.2.2.3.1.cmml">â¢</mo><mi id="S2.p2.4.m4.1.2.2.3.3" xref="S2.p2.4.m4.1.2.2.3.3.cmml">O</mi></mrow></msub><mo id="S2.p2.4.m4.1.2.1" xref="S2.p2.4.m4.1.2.1.cmml">â¢</mo><mrow id="S2.p2.4.m4.1.2.3.2" xref="S2.p2.4.m4.1.2.cmml"><mo id="S2.p2.4.m4.1.2.3.2.1" stretchy="false" xref="S2.p2.4.m4.1.2.cmml">(</mo><mi id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml">x</mi><mo id="S2.p2.4.m4.1.2.3.2.2" stretchy="false" xref="S2.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><apply id="S2.p2.4.m4.1.2.cmml" xref="S2.p2.4.m4.1.2"><times id="S2.p2.4.m4.1.2.1.cmml" xref="S2.p2.4.m4.1.2.1"></times><apply id="S2.p2.4.m4.1.2.2.cmml" xref="S2.p2.4.m4.1.2.2"><csymbol cd="ambiguous" id="S2.p2.4.m4.1.2.2.1.cmml" xref="S2.p2.4.m4.1.2.2">subscript</csymbol><ci id="S2.p2.4.m4.1.2.2.2a.cmml" xref="S2.p2.4.m4.1.2.2.2"><mtext id="S2.p2.4.m4.1.2.2.2.cmml" xref="S2.p2.4.m4.1.2.2.2">ğš™ğš›ğš˜ğš–ğš™ğš</mtext></ci><apply id="S2.p2.4.m4.1.2.2.3.cmml" xref="S2.p2.4.m4.1.2.2.3"><times id="S2.p2.4.m4.1.2.2.3.1.cmml" xref="S2.p2.4.m4.1.2.2.3.1"></times><ci id="S2.p2.4.m4.1.2.2.3.2.cmml" xref="S2.p2.4.m4.1.2.2.3.2">ğ¼</ci><ci id="S2.p2.4.m4.1.2.2.3.3.cmml" xref="S2.p2.4.m4.1.2.2.3.3">ğ‘‚</ci></apply></apply><ci id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1">ğ‘¥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">\texttt{prompt}_{IO}(x)</annotation><annotation encoding="application/x-llamapun" id="S2.p2.4.m4.1d">prompt start_POSTSUBSCRIPT italic_I italic_O end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> wraps input <math alttext="x" class="ltx_Math" display="inline" id="S2.p2.5.m5.1"><semantics id="S2.p2.5.m5.1a"><mi id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><ci id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1">ğ‘¥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.p2.5.m5.1d">italic_x</annotation></semantics></math> with task instructions and/or few-shot input-output examples. For simplicity, let us denote <math alttext="p_{\theta}^{{\rm prompt}}(\texttt{output}\mid\texttt{input})=p_{\theta}(%
\texttt{output}\mid\texttt{prompt}(\texttt{input}))" class="ltx_Math" display="inline" id="S2.p2.6.m6.3"><semantics id="S2.p2.6.m6.3a"><mrow id="S2.p2.6.m6.3.3" xref="S2.p2.6.m6.3.3.cmml"><mrow id="S2.p2.6.m6.2.2.1" xref="S2.p2.6.m6.2.2.1.cmml"><msubsup id="S2.p2.6.m6.2.2.1.3" xref="S2.p2.6.m6.2.2.1.3.cmml"><mi id="S2.p2.6.m6.2.2.1.3.2.2" xref="S2.p2.6.m6.2.2.1.3.2.2.cmml">p</mi><mi id="S2.p2.6.m6.2.2.1.3.2.3" xref="S2.p2.6.m6.2.2.1.3.2.3.cmml">Î¸</mi><mi id="S2.p2.6.m6.2.2.1.3.3" xref="S2.p2.6.m6.2.2.1.3.3.cmml">prompt</mi></msubsup><mo id="S2.p2.6.m6.2.2.1.2" xref="S2.p2.6.m6.2.2.1.2.cmml">â¢</mo><mrow id="S2.p2.6.m6.2.2.1.1.1" xref="S2.p2.6.m6.2.2.1.1.1.1.cmml"><mo id="S2.p2.6.m6.2.2.1.1.1.2" stretchy="false" xref="S2.p2.6.m6.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.p2.6.m6.2.2.1.1.1.1" xref="S2.p2.6.m6.2.2.1.1.1.1.cmml"><mtext id="S2.p2.6.m6.2.2.1.1.1.1.2" xref="S2.p2.6.m6.2.2.1.1.1.1.2a.cmml">ğš˜ğšğšğš™ğšğš</mtext><mo id="S2.p2.6.m6.2.2.1.1.1.1.1" xref="S2.p2.6.m6.2.2.1.1.1.1.1.cmml">âˆ£</mo><mtext id="S2.p2.6.m6.2.2.1.1.1.1.3" xref="S2.p2.6.m6.2.2.1.1.1.1.3a.cmml">ğš’ğš—ğš™ğšğš</mtext></mrow><mo id="S2.p2.6.m6.2.2.1.1.1.3" stretchy="false" xref="S2.p2.6.m6.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.p2.6.m6.3.3.3" xref="S2.p2.6.m6.3.3.3.cmml">=</mo><mrow id="S2.p2.6.m6.3.3.2" xref="S2.p2.6.m6.3.3.2.cmml"><msub id="S2.p2.6.m6.3.3.2.3" xref="S2.p2.6.m6.3.3.2.3.cmml"><mi id="S2.p2.6.m6.3.3.2.3.2" xref="S2.p2.6.m6.3.3.2.3.2.cmml">p</mi><mi id="S2.p2.6.m6.3.3.2.3.3" xref="S2.p2.6.m6.3.3.2.3.3.cmml">Î¸</mi></msub><mo id="S2.p2.6.m6.3.3.2.2" xref="S2.p2.6.m6.3.3.2.2.cmml">â¢</mo><mrow id="S2.p2.6.m6.3.3.2.1.1" xref="S2.p2.6.m6.3.3.2.1.1.1.cmml"><mo id="S2.p2.6.m6.3.3.2.1.1.2" stretchy="false" xref="S2.p2.6.m6.3.3.2.1.1.1.cmml">(</mo><mrow id="S2.p2.6.m6.3.3.2.1.1.1" xref="S2.p2.6.m6.3.3.2.1.1.1.cmml"><mtext id="S2.p2.6.m6.3.3.2.1.1.1.2" xref="S2.p2.6.m6.3.3.2.1.1.1.2a.cmml">ğš˜ğšğšğš™ğšğš</mtext><mo id="S2.p2.6.m6.3.3.2.1.1.1.1" xref="S2.p2.6.m6.3.3.2.1.1.1.1.cmml">âˆ£</mo><mrow id="S2.p2.6.m6.3.3.2.1.1.1.3" xref="S2.p2.6.m6.3.3.2.1.1.1.3.cmml"><mtext id="S2.p2.6.m6.3.3.2.1.1.1.3.2" xref="S2.p2.6.m6.3.3.2.1.1.1.3.2a.cmml">ğš™ğš›ğš˜ğš–ğš™ğš</mtext><mo id="S2.p2.6.m6.3.3.2.1.1.1.3.1" xref="S2.p2.6.m6.3.3.2.1.1.1.3.1.cmml">â¢</mo><mrow id="S2.p2.6.m6.3.3.2.1.1.1.3.3.2" xref="S2.p2.6.m6.1.1a.cmml"><mo id="S2.p2.6.m6.3.3.2.1.1.1.3.3.2.1" stretchy="false" xref="S2.p2.6.m6.1.1a.cmml">(</mo><mtext id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml">ğš’ğš—ğš™ğšğš</mtext><mo id="S2.p2.6.m6.3.3.2.1.1.1.3.3.2.2" stretchy="false" xref="S2.p2.6.m6.1.1a.cmml">)</mo></mrow></mrow></mrow><mo id="S2.p2.6.m6.3.3.2.1.1.3" stretchy="false" xref="S2.p2.6.m6.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.3b"><apply id="S2.p2.6.m6.3.3.cmml" xref="S2.p2.6.m6.3.3"><eq id="S2.p2.6.m6.3.3.3.cmml" xref="S2.p2.6.m6.3.3.3"></eq><apply id="S2.p2.6.m6.2.2.1.cmml" xref="S2.p2.6.m6.2.2.1"><times id="S2.p2.6.m6.2.2.1.2.cmml" xref="S2.p2.6.m6.2.2.1.2"></times><apply id="S2.p2.6.m6.2.2.1.3.cmml" xref="S2.p2.6.m6.2.2.1.3"><csymbol cd="ambiguous" id="S2.p2.6.m6.2.2.1.3.1.cmml" xref="S2.p2.6.m6.2.2.1.3">superscript</csymbol><apply id="S2.p2.6.m6.2.2.1.3.2.cmml" xref="S2.p2.6.m6.2.2.1.3"><csymbol cd="ambiguous" id="S2.p2.6.m6.2.2.1.3.2.1.cmml" xref="S2.p2.6.m6.2.2.1.3">subscript</csymbol><ci id="S2.p2.6.m6.2.2.1.3.2.2.cmml" xref="S2.p2.6.m6.2.2.1.3.2.2">ğ‘</ci><ci id="S2.p2.6.m6.2.2.1.3.2.3.cmml" xref="S2.p2.6.m6.2.2.1.3.2.3">ğœƒ</ci></apply><ci id="S2.p2.6.m6.2.2.1.3.3.cmml" xref="S2.p2.6.m6.2.2.1.3.3">prompt</ci></apply><apply id="S2.p2.6.m6.2.2.1.1.1.1.cmml" xref="S2.p2.6.m6.2.2.1.1.1"><csymbol cd="latexml" id="S2.p2.6.m6.2.2.1.1.1.1.1.cmml" xref="S2.p2.6.m6.2.2.1.1.1.1.1">conditional</csymbol><ci id="S2.p2.6.m6.2.2.1.1.1.1.2a.cmml" xref="S2.p2.6.m6.2.2.1.1.1.1.2"><mtext id="S2.p2.6.m6.2.2.1.1.1.1.2.cmml" xref="S2.p2.6.m6.2.2.1.1.1.1.2">ğš˜ğšğšğš™ğšğš</mtext></ci><ci id="S2.p2.6.m6.2.2.1.1.1.1.3a.cmml" xref="S2.p2.6.m6.2.2.1.1.1.1.3"><mtext id="S2.p2.6.m6.2.2.1.1.1.1.3.cmml" xref="S2.p2.6.m6.2.2.1.1.1.1.3">ğš’ğš—ğš™ğšğš</mtext></ci></apply></apply><apply id="S2.p2.6.m6.3.3.2.cmml" xref="S2.p2.6.m6.3.3.2"><times id="S2.p2.6.m6.3.3.2.2.cmml" xref="S2.p2.6.m6.3.3.2.2"></times><apply id="S2.p2.6.m6.3.3.2.3.cmml" xref="S2.p2.6.m6.3.3.2.3"><csymbol cd="ambiguous" id="S2.p2.6.m6.3.3.2.3.1.cmml" xref="S2.p2.6.m6.3.3.2.3">subscript</csymbol><ci id="S2.p2.6.m6.3.3.2.3.2.cmml" xref="S2.p2.6.m6.3.3.2.3.2">ğ‘</ci><ci id="S2.p2.6.m6.3.3.2.3.3.cmml" xref="S2.p2.6.m6.3.3.2.3.3">ğœƒ</ci></apply><apply id="S2.p2.6.m6.3.3.2.1.1.1.cmml" xref="S2.p2.6.m6.3.3.2.1.1"><csymbol cd="latexml" id="S2.p2.6.m6.3.3.2.1.1.1.1.cmml" xref="S2.p2.6.m6.3.3.2.1.1.1.1">conditional</csymbol><ci id="S2.p2.6.m6.3.3.2.1.1.1.2a.cmml" xref="S2.p2.6.m6.3.3.2.1.1.1.2"><mtext id="S2.p2.6.m6.3.3.2.1.1.1.2.cmml" xref="S2.p2.6.m6.3.3.2.1.1.1.2">ğš˜ğšğšğš™ğšğš</mtext></ci><apply id="S2.p2.6.m6.3.3.2.1.1.1.3.cmml" xref="S2.p2.6.m6.3.3.2.1.1.1.3"><times id="S2.p2.6.m6.3.3.2.1.1.1.3.1.cmml" xref="S2.p2.6.m6.3.3.2.1.1.1.3.1"></times><ci id="S2.p2.6.m6.3.3.2.1.1.1.3.2a.cmml" xref="S2.p2.6.m6.3.3.2.1.1.1.3.2"><mtext id="S2.p2.6.m6.3.3.2.1.1.1.3.2.cmml" xref="S2.p2.6.m6.3.3.2.1.1.1.3.2">ğš™ğš›ğš˜ğš–ğš™ğš</mtext></ci><ci id="S2.p2.6.m6.1.1a.cmml" xref="S2.p2.6.m6.3.3.2.1.1.1.3.3.2"><mtext id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1">ğš’ğš—ğš™ğšğš</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.3c">p_{\theta}^{{\rm prompt}}(\texttt{output}\mid\texttt{input})=p_{\theta}(%
\texttt{output}\mid\texttt{prompt}(\texttt{input}))</annotation><annotation encoding="application/x-llamapun" id="S2.p2.6.m6.3d">italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_prompt end_POSTSUPERSCRIPT ( output âˆ£ input ) = italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT ( output âˆ£ prompt ( input ) )</annotation></semantics></math>, so that IO prompting can be formulated as <math alttext="y\sim p_{\theta}^{IO}(y|x)" class="ltx_Math" display="inline" id="S2.p2.7.m7.1"><semantics id="S2.p2.7.m7.1a"><mrow id="S2.p2.7.m7.1.1" xref="S2.p2.7.m7.1.1.cmml"><mi id="S2.p2.7.m7.1.1.3" xref="S2.p2.7.m7.1.1.3.cmml">y</mi><mo id="S2.p2.7.m7.1.1.2" xref="S2.p2.7.m7.1.1.2.cmml">âˆ¼</mo><mrow id="S2.p2.7.m7.1.1.1" xref="S2.p2.7.m7.1.1.1.cmml"><msubsup id="S2.p2.7.m7.1.1.1.3" xref="S2.p2.7.m7.1.1.1.3.cmml"><mi id="S2.p2.7.m7.1.1.1.3.2.2" xref="S2.p2.7.m7.1.1.1.3.2.2.cmml">p</mi><mi id="S2.p2.7.m7.1.1.1.3.2.3" xref="S2.p2.7.m7.1.1.1.3.2.3.cmml">Î¸</mi><mrow id="S2.p2.7.m7.1.1.1.3.3" xref="S2.p2.7.m7.1.1.1.3.3.cmml"><mi id="S2.p2.7.m7.1.1.1.3.3.2" xref="S2.p2.7.m7.1.1.1.3.3.2.cmml">I</mi><mo id="S2.p2.7.m7.1.1.1.3.3.1" xref="S2.p2.7.m7.1.1.1.3.3.1.cmml">â¢</mo><mi id="S2.p2.7.m7.1.1.1.3.3.3" xref="S2.p2.7.m7.1.1.1.3.3.3.cmml">O</mi></mrow></msubsup><mo id="S2.p2.7.m7.1.1.1.2" xref="S2.p2.7.m7.1.1.1.2.cmml">â¢</mo><mrow id="S2.p2.7.m7.1.1.1.1.1" xref="S2.p2.7.m7.1.1.1.1.1.1.cmml"><mo id="S2.p2.7.m7.1.1.1.1.1.2" stretchy="false" xref="S2.p2.7.m7.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p2.7.m7.1.1.1.1.1.1" xref="S2.p2.7.m7.1.1.1.1.1.1.cmml"><mi id="S2.p2.7.m7.1.1.1.1.1.1.2" xref="S2.p2.7.m7.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.p2.7.m7.1.1.1.1.1.1.1" xref="S2.p2.7.m7.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p2.7.m7.1.1.1.1.1.1.3" xref="S2.p2.7.m7.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.p2.7.m7.1.1.1.1.1.3" stretchy="false" xref="S2.p2.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.7.m7.1b"><apply id="S2.p2.7.m7.1.1.cmml" xref="S2.p2.7.m7.1.1"><csymbol cd="latexml" id="S2.p2.7.m7.1.1.2.cmml" xref="S2.p2.7.m7.1.1.2">similar-to</csymbol><ci id="S2.p2.7.m7.1.1.3.cmml" xref="S2.p2.7.m7.1.1.3">ğ‘¦</ci><apply id="S2.p2.7.m7.1.1.1.cmml" xref="S2.p2.7.m7.1.1.1"><times id="S2.p2.7.m7.1.1.1.2.cmml" xref="S2.p2.7.m7.1.1.1.2"></times><apply id="S2.p2.7.m7.1.1.1.3.cmml" xref="S2.p2.7.m7.1.1.1.3"><csymbol cd="ambiguous" id="S2.p2.7.m7.1.1.1.3.1.cmml" xref="S2.p2.7.m7.1.1.1.3">superscript</csymbol><apply id="S2.p2.7.m7.1.1.1.3.2.cmml" xref="S2.p2.7.m7.1.1.1.3"><csymbol cd="ambiguous" id="S2.p2.7.m7.1.1.1.3.2.1.cmml" xref="S2.p2.7.m7.1.1.1.3">subscript</csymbol><ci id="S2.p2.7.m7.1.1.1.3.2.2.cmml" xref="S2.p2.7.m7.1.1.1.3.2.2">ğ‘</ci><ci id="S2.p2.7.m7.1.1.1.3.2.3.cmml" xref="S2.p2.7.m7.1.1.1.3.2.3">ğœƒ</ci></apply><apply id="S2.p2.7.m7.1.1.1.3.3.cmml" xref="S2.p2.7.m7.1.1.1.3.3"><times id="S2.p2.7.m7.1.1.1.3.3.1.cmml" xref="S2.p2.7.m7.1.1.1.3.3.1"></times><ci id="S2.p2.7.m7.1.1.1.3.3.2.cmml" xref="S2.p2.7.m7.1.1.1.3.3.2">ğ¼</ci><ci id="S2.p2.7.m7.1.1.1.3.3.3.cmml" xref="S2.p2.7.m7.1.1.1.3.3.3">ğ‘‚</ci></apply></apply><apply id="S2.p2.7.m7.1.1.1.1.1.1.cmml" xref="S2.p2.7.m7.1.1.1.1.1"><csymbol cd="latexml" id="S2.p2.7.m7.1.1.1.1.1.1.1.cmml" xref="S2.p2.7.m7.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p2.7.m7.1.1.1.1.1.1.2.cmml" xref="S2.p2.7.m7.1.1.1.1.1.1.2">ğ‘¦</ci><ci id="S2.p2.7.m7.1.1.1.1.1.1.3.cmml" xref="S2.p2.7.m7.1.1.1.1.1.1.3">ğ‘¥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m7.1c">y\sim p_{\theta}^{IO}(y|x)</annotation><annotation encoding="application/x-llamapun" id="S2.p2.7.m7.1d">italic_y âˆ¼ italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_I italic_O end_POSTSUPERSCRIPT ( italic_y | italic_x )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.13"><span class="ltx_text ltx_font_bold" id="S2.p3.13.1">Chain-of-thought (CoT) prompting</span>Â <cite class="ltx_cite ltx_citemacro_citep">(Wei etÂ al., <a class="ltx_ref" href="#bib.bib38" title="">2022</a>)</cite> was proposed to address cases where the mapping of input <math alttext="x" class="ltx_Math" display="inline" id="S2.p3.1.m1.1"><semantics id="S2.p3.1.m1.1a"><mi id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><ci id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">ğ‘¥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.1d">italic_x</annotation></semantics></math> to output <math alttext="y" class="ltx_Math" display="inline" id="S2.p3.2.m2.1"><semantics id="S2.p3.2.m2.1a"><mi id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><ci id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1">ğ‘¦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.1d">italic_y</annotation></semantics></math> is non-trivial (e.g.â€‰when <math alttext="x" class="ltx_Math" display="inline" id="S2.p3.3.m3.1"><semantics id="S2.p3.3.m3.1a"><mi id="S2.p3.3.m3.1.1" xref="S2.p3.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><ci id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1">ğ‘¥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.p3.3.m3.1d">italic_x</annotation></semantics></math> is a math question and <math alttext="y" class="ltx_Math" display="inline" id="S2.p3.4.m4.1"><semantics id="S2.p3.4.m4.1a"><mi id="S2.p3.4.m4.1.1" xref="S2.p3.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.p3.4.m4.1b"><ci id="S2.p3.4.m4.1.1.cmml" xref="S2.p3.4.m4.1.1">ğ‘¦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m4.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.p3.4.m4.1d">italic_y</annotation></semantics></math> is the final numerical answer). The key idea is to introduce a chain of <span class="ltx_text ltx_font_italic" id="S2.p3.13.2">thoughts</span> <math alttext="z_{1},\cdots,z_{n}" class="ltx_Math" display="inline" id="S2.p3.5.m5.3"><semantics id="S2.p3.5.m5.3a"><mrow id="S2.p3.5.m5.3.3.2" xref="S2.p3.5.m5.3.3.3.cmml"><msub id="S2.p3.5.m5.2.2.1.1" xref="S2.p3.5.m5.2.2.1.1.cmml"><mi id="S2.p3.5.m5.2.2.1.1.2" xref="S2.p3.5.m5.2.2.1.1.2.cmml">z</mi><mn id="S2.p3.5.m5.2.2.1.1.3" xref="S2.p3.5.m5.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.p3.5.m5.3.3.2.3" xref="S2.p3.5.m5.3.3.3.cmml">,</mo><mi id="S2.p3.5.m5.1.1" mathvariant="normal" xref="S2.p3.5.m5.1.1.cmml">â‹¯</mi><mo id="S2.p3.5.m5.3.3.2.4" xref="S2.p3.5.m5.3.3.3.cmml">,</mo><msub id="S2.p3.5.m5.3.3.2.2" xref="S2.p3.5.m5.3.3.2.2.cmml"><mi id="S2.p3.5.m5.3.3.2.2.2" xref="S2.p3.5.m5.3.3.2.2.2.cmml">z</mi><mi id="S2.p3.5.m5.3.3.2.2.3" xref="S2.p3.5.m5.3.3.2.2.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.5.m5.3b"><list id="S2.p3.5.m5.3.3.3.cmml" xref="S2.p3.5.m5.3.3.2"><apply id="S2.p3.5.m5.2.2.1.1.cmml" xref="S2.p3.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S2.p3.5.m5.2.2.1.1.1.cmml" xref="S2.p3.5.m5.2.2.1.1">subscript</csymbol><ci id="S2.p3.5.m5.2.2.1.1.2.cmml" xref="S2.p3.5.m5.2.2.1.1.2">ğ‘§</ci><cn id="S2.p3.5.m5.2.2.1.1.3.cmml" type="integer" xref="S2.p3.5.m5.2.2.1.1.3">1</cn></apply><ci id="S2.p3.5.m5.1.1.cmml" xref="S2.p3.5.m5.1.1">â‹¯</ci><apply id="S2.p3.5.m5.3.3.2.2.cmml" xref="S2.p3.5.m5.3.3.2.2"><csymbol cd="ambiguous" id="S2.p3.5.m5.3.3.2.2.1.cmml" xref="S2.p3.5.m5.3.3.2.2">subscript</csymbol><ci id="S2.p3.5.m5.3.3.2.2.2.cmml" xref="S2.p3.5.m5.3.3.2.2.2">ğ‘§</ci><ci id="S2.p3.5.m5.3.3.2.2.3.cmml" xref="S2.p3.5.m5.3.3.2.2.3">ğ‘›</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m5.3c">z_{1},\cdots,z_{n}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.5.m5.3d">italic_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , â‹¯ , italic_z start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> to bridge <math alttext="x" class="ltx_Math" display="inline" id="S2.p3.6.m6.1"><semantics id="S2.p3.6.m6.1a"><mi id="S2.p3.6.m6.1.1" xref="S2.p3.6.m6.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p3.6.m6.1b"><ci id="S2.p3.6.m6.1.1.cmml" xref="S2.p3.6.m6.1.1">ğ‘¥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.6.m6.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.p3.6.m6.1d">italic_x</annotation></semantics></math> and <math alttext="y" class="ltx_Math" display="inline" id="S2.p3.7.m7.1"><semantics id="S2.p3.7.m7.1a"><mi id="S2.p3.7.m7.1.1" xref="S2.p3.7.m7.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.p3.7.m7.1b"><ci id="S2.p3.7.m7.1.1.cmml" xref="S2.p3.7.m7.1.1">ğ‘¦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.7.m7.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.p3.7.m7.1d">italic_y</annotation></semantics></math>, where each <math alttext="z_{i}" class="ltx_Math" display="inline" id="S2.p3.8.m8.1"><semantics id="S2.p3.8.m8.1a"><msub id="S2.p3.8.m8.1.1" xref="S2.p3.8.m8.1.1.cmml"><mi id="S2.p3.8.m8.1.1.2" xref="S2.p3.8.m8.1.1.2.cmml">z</mi><mi id="S2.p3.8.m8.1.1.3" xref="S2.p3.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.8.m8.1b"><apply id="S2.p3.8.m8.1.1.cmml" xref="S2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S2.p3.8.m8.1.1.1.cmml" xref="S2.p3.8.m8.1.1">subscript</csymbol><ci id="S2.p3.8.m8.1.1.2.cmml" xref="S2.p3.8.m8.1.1.2">ğ‘§</ci><ci id="S2.p3.8.m8.1.1.3.cmml" xref="S2.p3.8.m8.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.8.m8.1c">z_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.8.m8.1d">italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is a coherent language sequence that serves as a meaningful intermediate step toward problem solving (e.g.â€‰<math alttext="z_{i}" class="ltx_Math" display="inline" id="S2.p3.9.m9.1"><semantics id="S2.p3.9.m9.1a"><msub id="S2.p3.9.m9.1.1" xref="S2.p3.9.m9.1.1.cmml"><mi id="S2.p3.9.m9.1.1.2" xref="S2.p3.9.m9.1.1.2.cmml">z</mi><mi id="S2.p3.9.m9.1.1.3" xref="S2.p3.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.9.m9.1b"><apply id="S2.p3.9.m9.1.1.cmml" xref="S2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S2.p3.9.m9.1.1.1.cmml" xref="S2.p3.9.m9.1.1">subscript</csymbol><ci id="S2.p3.9.m9.1.1.2.cmml" xref="S2.p3.9.m9.1.1.2">ğ‘§</ci><ci id="S2.p3.9.m9.1.1.3.cmml" xref="S2.p3.9.m9.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.9.m9.1c">z_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.9.m9.1d">italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> could be an intermediate equation for math QA). To solve problems with CoT, each thought <math alttext="z_{i}\sim p_{\theta}^{CoT}(z_{i}\mid x,z_{1\cdots i-1})" class="ltx_Math" display="inline" id="S2.p3.10.m10.2"><semantics id="S2.p3.10.m10.2a"><mrow id="S2.p3.10.m10.2.2" xref="S2.p3.10.m10.2.2.cmml"><msub id="S2.p3.10.m10.2.2.3" xref="S2.p3.10.m10.2.2.3.cmml"><mi id="S2.p3.10.m10.2.2.3.2" xref="S2.p3.10.m10.2.2.3.2.cmml">z</mi><mi id="S2.p3.10.m10.2.2.3.3" xref="S2.p3.10.m10.2.2.3.3.cmml">i</mi></msub><mo id="S2.p3.10.m10.2.2.2" xref="S2.p3.10.m10.2.2.2.cmml">âˆ¼</mo><mrow id="S2.p3.10.m10.2.2.1" xref="S2.p3.10.m10.2.2.1.cmml"><msubsup id="S2.p3.10.m10.2.2.1.3" xref="S2.p3.10.m10.2.2.1.3.cmml"><mi id="S2.p3.10.m10.2.2.1.3.2.2" xref="S2.p3.10.m10.2.2.1.3.2.2.cmml">p</mi><mi id="S2.p3.10.m10.2.2.1.3.2.3" xref="S2.p3.10.m10.2.2.1.3.2.3.cmml">Î¸</mi><mrow id="S2.p3.10.m10.2.2.1.3.3" xref="S2.p3.10.m10.2.2.1.3.3.cmml"><mi id="S2.p3.10.m10.2.2.1.3.3.2" xref="S2.p3.10.m10.2.2.1.3.3.2.cmml">C</mi><mo id="S2.p3.10.m10.2.2.1.3.3.1" xref="S2.p3.10.m10.2.2.1.3.3.1.cmml">â¢</mo><mi id="S2.p3.10.m10.2.2.1.3.3.3" xref="S2.p3.10.m10.2.2.1.3.3.3.cmml">o</mi><mo id="S2.p3.10.m10.2.2.1.3.3.1a" xref="S2.p3.10.m10.2.2.1.3.3.1.cmml">â¢</mo><mi id="S2.p3.10.m10.2.2.1.3.3.4" xref="S2.p3.10.m10.2.2.1.3.3.4.cmml">T</mi></mrow></msubsup><mo id="S2.p3.10.m10.2.2.1.2" xref="S2.p3.10.m10.2.2.1.2.cmml">â¢</mo><mrow id="S2.p3.10.m10.2.2.1.1.1" xref="S2.p3.10.m10.2.2.1.1.1.1.cmml"><mo id="S2.p3.10.m10.2.2.1.1.1.2" stretchy="false" xref="S2.p3.10.m10.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.p3.10.m10.2.2.1.1.1.1" xref="S2.p3.10.m10.2.2.1.1.1.1.cmml"><msub id="S2.p3.10.m10.2.2.1.1.1.1.3" xref="S2.p3.10.m10.2.2.1.1.1.1.3.cmml"><mi id="S2.p3.10.m10.2.2.1.1.1.1.3.2" xref="S2.p3.10.m10.2.2.1.1.1.1.3.2.cmml">z</mi><mi id="S2.p3.10.m10.2.2.1.1.1.1.3.3" xref="S2.p3.10.m10.2.2.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S2.p3.10.m10.2.2.1.1.1.1.2" xref="S2.p3.10.m10.2.2.1.1.1.1.2.cmml">âˆ£</mo><mrow id="S2.p3.10.m10.2.2.1.1.1.1.1.1" xref="S2.p3.10.m10.2.2.1.1.1.1.1.2.cmml"><mi id="S2.p3.10.m10.1.1" xref="S2.p3.10.m10.1.1.cmml">x</mi><mo id="S2.p3.10.m10.2.2.1.1.1.1.1.1.2" xref="S2.p3.10.m10.2.2.1.1.1.1.1.2.cmml">,</mo><msub id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.2" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.cmml"><mrow id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.cmml"><mn id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.2" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.2.cmml">1</mn><mo id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.1" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.1.cmml">â¢</mo><mi id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.3" mathvariant="normal" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.3.cmml">â‹¯</mi><mo id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.1a" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.1.cmml">â¢</mo><mi id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.4" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.4.cmml">i</mi></mrow><mo id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.1" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.1.cmml">âˆ’</mo><mn id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.3" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S2.p3.10.m10.2.2.1.1.1.3" stretchy="false" xref="S2.p3.10.m10.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.10.m10.2b"><apply id="S2.p3.10.m10.2.2.cmml" xref="S2.p3.10.m10.2.2"><csymbol cd="latexml" id="S2.p3.10.m10.2.2.2.cmml" xref="S2.p3.10.m10.2.2.2">similar-to</csymbol><apply id="S2.p3.10.m10.2.2.3.cmml" xref="S2.p3.10.m10.2.2.3"><csymbol cd="ambiguous" id="S2.p3.10.m10.2.2.3.1.cmml" xref="S2.p3.10.m10.2.2.3">subscript</csymbol><ci id="S2.p3.10.m10.2.2.3.2.cmml" xref="S2.p3.10.m10.2.2.3.2">ğ‘§</ci><ci id="S2.p3.10.m10.2.2.3.3.cmml" xref="S2.p3.10.m10.2.2.3.3">ğ‘–</ci></apply><apply id="S2.p3.10.m10.2.2.1.cmml" xref="S2.p3.10.m10.2.2.1"><times id="S2.p3.10.m10.2.2.1.2.cmml" xref="S2.p3.10.m10.2.2.1.2"></times><apply id="S2.p3.10.m10.2.2.1.3.cmml" xref="S2.p3.10.m10.2.2.1.3"><csymbol cd="ambiguous" id="S2.p3.10.m10.2.2.1.3.1.cmml" xref="S2.p3.10.m10.2.2.1.3">superscript</csymbol><apply id="S2.p3.10.m10.2.2.1.3.2.cmml" xref="S2.p3.10.m10.2.2.1.3"><csymbol cd="ambiguous" id="S2.p3.10.m10.2.2.1.3.2.1.cmml" xref="S2.p3.10.m10.2.2.1.3">subscript</csymbol><ci id="S2.p3.10.m10.2.2.1.3.2.2.cmml" xref="S2.p3.10.m10.2.2.1.3.2.2">ğ‘</ci><ci id="S2.p3.10.m10.2.2.1.3.2.3.cmml" xref="S2.p3.10.m10.2.2.1.3.2.3">ğœƒ</ci></apply><apply id="S2.p3.10.m10.2.2.1.3.3.cmml" xref="S2.p3.10.m10.2.2.1.3.3"><times id="S2.p3.10.m10.2.2.1.3.3.1.cmml" xref="S2.p3.10.m10.2.2.1.3.3.1"></times><ci id="S2.p3.10.m10.2.2.1.3.3.2.cmml" xref="S2.p3.10.m10.2.2.1.3.3.2">ğ¶</ci><ci id="S2.p3.10.m10.2.2.1.3.3.3.cmml" xref="S2.p3.10.m10.2.2.1.3.3.3">ğ‘œ</ci><ci id="S2.p3.10.m10.2.2.1.3.3.4.cmml" xref="S2.p3.10.m10.2.2.1.3.3.4">ğ‘‡</ci></apply></apply><apply id="S2.p3.10.m10.2.2.1.1.1.1.cmml" xref="S2.p3.10.m10.2.2.1.1.1"><csymbol cd="latexml" id="S2.p3.10.m10.2.2.1.1.1.1.2.cmml" xref="S2.p3.10.m10.2.2.1.1.1.1.2">conditional</csymbol><apply id="S2.p3.10.m10.2.2.1.1.1.1.3.cmml" xref="S2.p3.10.m10.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p3.10.m10.2.2.1.1.1.1.3.1.cmml" xref="S2.p3.10.m10.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.p3.10.m10.2.2.1.1.1.1.3.2.cmml" xref="S2.p3.10.m10.2.2.1.1.1.1.3.2">ğ‘§</ci><ci id="S2.p3.10.m10.2.2.1.1.1.1.3.3.cmml" xref="S2.p3.10.m10.2.2.1.1.1.1.3.3">ğ‘–</ci></apply><list id="S2.p3.10.m10.2.2.1.1.1.1.1.2.cmml" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1"><ci id="S2.p3.10.m10.1.1.cmml" xref="S2.p3.10.m10.1.1">ğ‘¥</ci><apply id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.cmml" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.2">ğ‘§</ci><apply id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3"><minus id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.1"></minus><apply id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2"><times id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.1"></times><cn id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.2.cmml" type="integer" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.2">1</cn><ci id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.3">â‹¯</ci><ci id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.4.cmml" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.2.4">ğ‘–</ci></apply><cn id="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.p3.10.m10.2.2.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.10.m10.2c">z_{i}\sim p_{\theta}^{CoT}(z_{i}\mid x,z_{1\cdots i-1})</annotation><annotation encoding="application/x-llamapun" id="S2.p3.10.m10.2d">italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ¼ italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_C italic_o italic_T end_POSTSUPERSCRIPT ( italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ£ italic_x , italic_z start_POSTSUBSCRIPT 1 â‹¯ italic_i - 1 end_POSTSUBSCRIPT )</annotation></semantics></math> is sampled sequentially, then the output <math alttext="y\sim p_{\theta}^{CoT}(y|x,z_{1\cdots n})" class="ltx_Math" display="inline" id="S2.p3.11.m11.2"><semantics id="S2.p3.11.m11.2a"><mrow id="S2.p3.11.m11.2.2" xref="S2.p3.11.m11.2.2.cmml"><mi id="S2.p3.11.m11.2.2.3" xref="S2.p3.11.m11.2.2.3.cmml">y</mi><mo id="S2.p3.11.m11.2.2.2" xref="S2.p3.11.m11.2.2.2.cmml">âˆ¼</mo><mrow id="S2.p3.11.m11.2.2.1" xref="S2.p3.11.m11.2.2.1.cmml"><msubsup id="S2.p3.11.m11.2.2.1.3" xref="S2.p3.11.m11.2.2.1.3.cmml"><mi id="S2.p3.11.m11.2.2.1.3.2.2" xref="S2.p3.11.m11.2.2.1.3.2.2.cmml">p</mi><mi id="S2.p3.11.m11.2.2.1.3.2.3" xref="S2.p3.11.m11.2.2.1.3.2.3.cmml">Î¸</mi><mrow id="S2.p3.11.m11.2.2.1.3.3" xref="S2.p3.11.m11.2.2.1.3.3.cmml"><mi id="S2.p3.11.m11.2.2.1.3.3.2" xref="S2.p3.11.m11.2.2.1.3.3.2.cmml">C</mi><mo id="S2.p3.11.m11.2.2.1.3.3.1" xref="S2.p3.11.m11.2.2.1.3.3.1.cmml">â¢</mo><mi id="S2.p3.11.m11.2.2.1.3.3.3" xref="S2.p3.11.m11.2.2.1.3.3.3.cmml">o</mi><mo id="S2.p3.11.m11.2.2.1.3.3.1a" xref="S2.p3.11.m11.2.2.1.3.3.1.cmml">â¢</mo><mi id="S2.p3.11.m11.2.2.1.3.3.4" xref="S2.p3.11.m11.2.2.1.3.3.4.cmml">T</mi></mrow></msubsup><mo id="S2.p3.11.m11.2.2.1.2" xref="S2.p3.11.m11.2.2.1.2.cmml">â¢</mo><mrow id="S2.p3.11.m11.2.2.1.1.1" xref="S2.p3.11.m11.2.2.1.1.1.1.cmml"><mo id="S2.p3.11.m11.2.2.1.1.1.2" stretchy="false" xref="S2.p3.11.m11.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.p3.11.m11.2.2.1.1.1.1" xref="S2.p3.11.m11.2.2.1.1.1.1.cmml"><mi id="S2.p3.11.m11.2.2.1.1.1.1.3" xref="S2.p3.11.m11.2.2.1.1.1.1.3.cmml">y</mi><mo fence="false" id="S2.p3.11.m11.2.2.1.1.1.1.2" xref="S2.p3.11.m11.2.2.1.1.1.1.2.cmml">|</mo><mrow id="S2.p3.11.m11.2.2.1.1.1.1.1.1" xref="S2.p3.11.m11.2.2.1.1.1.1.1.2.cmml"><mi id="S2.p3.11.m11.1.1" xref="S2.p3.11.m11.1.1.cmml">x</mi><mo id="S2.p3.11.m11.2.2.1.1.1.1.1.1.2" xref="S2.p3.11.m11.2.2.1.1.1.1.1.2.cmml">,</mo><msub id="S2.p3.11.m11.2.2.1.1.1.1.1.1.1" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.2" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.cmml"><mn id="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.2" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.1" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.1.cmml">â¢</mo><mi id="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.3" mathvariant="normal" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.3.cmml">â‹¯</mi><mo id="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.1a" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.1.cmml">â¢</mo><mi id="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.4" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.4.cmml">n</mi></mrow></msub></mrow></mrow><mo id="S2.p3.11.m11.2.2.1.1.1.3" stretchy="false" xref="S2.p3.11.m11.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.11.m11.2b"><apply id="S2.p3.11.m11.2.2.cmml" xref="S2.p3.11.m11.2.2"><csymbol cd="latexml" id="S2.p3.11.m11.2.2.2.cmml" xref="S2.p3.11.m11.2.2.2">similar-to</csymbol><ci id="S2.p3.11.m11.2.2.3.cmml" xref="S2.p3.11.m11.2.2.3">ğ‘¦</ci><apply id="S2.p3.11.m11.2.2.1.cmml" xref="S2.p3.11.m11.2.2.1"><times id="S2.p3.11.m11.2.2.1.2.cmml" xref="S2.p3.11.m11.2.2.1.2"></times><apply id="S2.p3.11.m11.2.2.1.3.cmml" xref="S2.p3.11.m11.2.2.1.3"><csymbol cd="ambiguous" id="S2.p3.11.m11.2.2.1.3.1.cmml" xref="S2.p3.11.m11.2.2.1.3">superscript</csymbol><apply id="S2.p3.11.m11.2.2.1.3.2.cmml" xref="S2.p3.11.m11.2.2.1.3"><csymbol cd="ambiguous" id="S2.p3.11.m11.2.2.1.3.2.1.cmml" xref="S2.p3.11.m11.2.2.1.3">subscript</csymbol><ci id="S2.p3.11.m11.2.2.1.3.2.2.cmml" xref="S2.p3.11.m11.2.2.1.3.2.2">ğ‘</ci><ci id="S2.p3.11.m11.2.2.1.3.2.3.cmml" xref="S2.p3.11.m11.2.2.1.3.2.3">ğœƒ</ci></apply><apply id="S2.p3.11.m11.2.2.1.3.3.cmml" xref="S2.p3.11.m11.2.2.1.3.3"><times id="S2.p3.11.m11.2.2.1.3.3.1.cmml" xref="S2.p3.11.m11.2.2.1.3.3.1"></times><ci id="S2.p3.11.m11.2.2.1.3.3.2.cmml" xref="S2.p3.11.m11.2.2.1.3.3.2">ğ¶</ci><ci id="S2.p3.11.m11.2.2.1.3.3.3.cmml" xref="S2.p3.11.m11.2.2.1.3.3.3">ğ‘œ</ci><ci id="S2.p3.11.m11.2.2.1.3.3.4.cmml" xref="S2.p3.11.m11.2.2.1.3.3.4">ğ‘‡</ci></apply></apply><apply id="S2.p3.11.m11.2.2.1.1.1.1.cmml" xref="S2.p3.11.m11.2.2.1.1.1"><csymbol cd="latexml" id="S2.p3.11.m11.2.2.1.1.1.1.2.cmml" xref="S2.p3.11.m11.2.2.1.1.1.1.2">conditional</csymbol><ci id="S2.p3.11.m11.2.2.1.1.1.1.3.cmml" xref="S2.p3.11.m11.2.2.1.1.1.1.3">ğ‘¦</ci><list id="S2.p3.11.m11.2.2.1.1.1.1.1.2.cmml" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1"><ci id="S2.p3.11.m11.1.1.cmml" xref="S2.p3.11.m11.1.1">ğ‘¥</ci><apply id="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.cmml" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.2">ğ‘§</ci><apply id="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3"><times id="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.1"></times><cn id="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.2">1</cn><ci id="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.3">â‹¯</ci><ci id="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.4.cmml" xref="S2.p3.11.m11.2.2.1.1.1.1.1.1.1.3.4">ğ‘›</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.11.m11.2c">y\sim p_{\theta}^{CoT}(y|x,z_{1\cdots n})</annotation><annotation encoding="application/x-llamapun" id="S2.p3.11.m11.2d">italic_y âˆ¼ italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_C italic_o italic_T end_POSTSUPERSCRIPT ( italic_y | italic_x , italic_z start_POSTSUBSCRIPT 1 â‹¯ italic_n end_POSTSUBSCRIPT )</annotation></semantics></math>. In practice, <math alttext="[z_{1\cdots n},y]\sim p_{\theta}^{CoT}(z_{1\cdots n},y|x)" class="ltx_Math" display="inline" id="S2.p3.12.m12.4"><semantics id="S2.p3.12.m12.4a"><mrow id="S2.p3.12.m12.4.4" xref="S2.p3.12.m12.4.4.cmml"><mrow id="S2.p3.12.m12.2.2.1.1" xref="S2.p3.12.m12.2.2.1.2.cmml"><mo id="S2.p3.12.m12.2.2.1.1.2" stretchy="false" xref="S2.p3.12.m12.2.2.1.2.cmml">[</mo><msub id="S2.p3.12.m12.2.2.1.1.1" xref="S2.p3.12.m12.2.2.1.1.1.cmml"><mi id="S2.p3.12.m12.2.2.1.1.1.2" xref="S2.p3.12.m12.2.2.1.1.1.2.cmml">z</mi><mrow id="S2.p3.12.m12.2.2.1.1.1.3" xref="S2.p3.12.m12.2.2.1.1.1.3.cmml"><mn id="S2.p3.12.m12.2.2.1.1.1.3.2" xref="S2.p3.12.m12.2.2.1.1.1.3.2.cmml">1</mn><mo id="S2.p3.12.m12.2.2.1.1.1.3.1" xref="S2.p3.12.m12.2.2.1.1.1.3.1.cmml">â¢</mo><mi id="S2.p3.12.m12.2.2.1.1.1.3.3" mathvariant="normal" xref="S2.p3.12.m12.2.2.1.1.1.3.3.cmml">â‹¯</mi><mo id="S2.p3.12.m12.2.2.1.1.1.3.1a" xref="S2.p3.12.m12.2.2.1.1.1.3.1.cmml">â¢</mo><mi id="S2.p3.12.m12.2.2.1.1.1.3.4" xref="S2.p3.12.m12.2.2.1.1.1.3.4.cmml">n</mi></mrow></msub><mo id="S2.p3.12.m12.2.2.1.1.3" xref="S2.p3.12.m12.2.2.1.2.cmml">,</mo><mi id="S2.p3.12.m12.1.1" xref="S2.p3.12.m12.1.1.cmml">y</mi><mo id="S2.p3.12.m12.2.2.1.1.4" stretchy="false" xref="S2.p3.12.m12.2.2.1.2.cmml">]</mo></mrow><mo id="S2.p3.12.m12.4.4.4" xref="S2.p3.12.m12.4.4.4.cmml">âˆ¼</mo><mrow id="S2.p3.12.m12.4.4.3" xref="S2.p3.12.m12.4.4.3.cmml"><msubsup id="S2.p3.12.m12.4.4.3.4" xref="S2.p3.12.m12.4.4.3.4.cmml"><mi id="S2.p3.12.m12.4.4.3.4.2.2" xref="S2.p3.12.m12.4.4.3.4.2.2.cmml">p</mi><mi id="S2.p3.12.m12.4.4.3.4.2.3" xref="S2.p3.12.m12.4.4.3.4.2.3.cmml">Î¸</mi><mrow id="S2.p3.12.m12.4.4.3.4.3" xref="S2.p3.12.m12.4.4.3.4.3.cmml"><mi id="S2.p3.12.m12.4.4.3.4.3.2" xref="S2.p3.12.m12.4.4.3.4.3.2.cmml">C</mi><mo id="S2.p3.12.m12.4.4.3.4.3.1" xref="S2.p3.12.m12.4.4.3.4.3.1.cmml">â¢</mo><mi id="S2.p3.12.m12.4.4.3.4.3.3" xref="S2.p3.12.m12.4.4.3.4.3.3.cmml">o</mi><mo id="S2.p3.12.m12.4.4.3.4.3.1a" xref="S2.p3.12.m12.4.4.3.4.3.1.cmml">â¢</mo><mi id="S2.p3.12.m12.4.4.3.4.3.4" xref="S2.p3.12.m12.4.4.3.4.3.4.cmml">T</mi></mrow></msubsup><mo id="S2.p3.12.m12.4.4.3.3" xref="S2.p3.12.m12.4.4.3.3.cmml">â¢</mo><mrow id="S2.p3.12.m12.4.4.3.2.2" xref="S2.p3.12.m12.4.4.3.2.3.cmml"><mo id="S2.p3.12.m12.4.4.3.2.2.3" stretchy="false" xref="S2.p3.12.m12.4.4.3.2.3.cmml">(</mo><msub id="S2.p3.12.m12.3.3.2.1.1.1" xref="S2.p3.12.m12.3.3.2.1.1.1.cmml"><mi id="S2.p3.12.m12.3.3.2.1.1.1.2" xref="S2.p3.12.m12.3.3.2.1.1.1.2.cmml">z</mi><mrow id="S2.p3.12.m12.3.3.2.1.1.1.3" xref="S2.p3.12.m12.3.3.2.1.1.1.3.cmml"><mn id="S2.p3.12.m12.3.3.2.1.1.1.3.2" xref="S2.p3.12.m12.3.3.2.1.1.1.3.2.cmml">1</mn><mo id="S2.p3.12.m12.3.3.2.1.1.1.3.1" xref="S2.p3.12.m12.3.3.2.1.1.1.3.1.cmml">â¢</mo><mi id="S2.p3.12.m12.3.3.2.1.1.1.3.3" mathvariant="normal" xref="S2.p3.12.m12.3.3.2.1.1.1.3.3.cmml">â‹¯</mi><mo id="S2.p3.12.m12.3.3.2.1.1.1.3.1a" xref="S2.p3.12.m12.3.3.2.1.1.1.3.1.cmml">â¢</mo><mi id="S2.p3.12.m12.3.3.2.1.1.1.3.4" xref="S2.p3.12.m12.3.3.2.1.1.1.3.4.cmml">n</mi></mrow></msub><mo id="S2.p3.12.m12.4.4.3.2.2.4" xref="S2.p3.12.m12.4.4.3.2.3.cmml">,</mo><mrow id="S2.p3.12.m12.4.4.3.2.2.2" xref="S2.p3.12.m12.4.4.3.2.2.2.cmml"><mi id="S2.p3.12.m12.4.4.3.2.2.2.2" xref="S2.p3.12.m12.4.4.3.2.2.2.2.cmml">y</mi><mo fence="false" id="S2.p3.12.m12.4.4.3.2.2.2.1" xref="S2.p3.12.m12.4.4.3.2.2.2.1.cmml">|</mo><mi id="S2.p3.12.m12.4.4.3.2.2.2.3" xref="S2.p3.12.m12.4.4.3.2.2.2.3.cmml">x</mi></mrow><mo id="S2.p3.12.m12.4.4.3.2.2.5" stretchy="false" xref="S2.p3.12.m12.4.4.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.12.m12.4b"><apply id="S2.p3.12.m12.4.4.cmml" xref="S2.p3.12.m12.4.4"><csymbol cd="latexml" id="S2.p3.12.m12.4.4.4.cmml" xref="S2.p3.12.m12.4.4.4">similar-to</csymbol><interval closure="closed" id="S2.p3.12.m12.2.2.1.2.cmml" xref="S2.p3.12.m12.2.2.1.1"><apply id="S2.p3.12.m12.2.2.1.1.1.cmml" xref="S2.p3.12.m12.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.p3.12.m12.2.2.1.1.1.1.cmml" xref="S2.p3.12.m12.2.2.1.1.1">subscript</csymbol><ci id="S2.p3.12.m12.2.2.1.1.1.2.cmml" xref="S2.p3.12.m12.2.2.1.1.1.2">ğ‘§</ci><apply id="S2.p3.12.m12.2.2.1.1.1.3.cmml" xref="S2.p3.12.m12.2.2.1.1.1.3"><times id="S2.p3.12.m12.2.2.1.1.1.3.1.cmml" xref="S2.p3.12.m12.2.2.1.1.1.3.1"></times><cn id="S2.p3.12.m12.2.2.1.1.1.3.2.cmml" type="integer" xref="S2.p3.12.m12.2.2.1.1.1.3.2">1</cn><ci id="S2.p3.12.m12.2.2.1.1.1.3.3.cmml" xref="S2.p3.12.m12.2.2.1.1.1.3.3">â‹¯</ci><ci id="S2.p3.12.m12.2.2.1.1.1.3.4.cmml" xref="S2.p3.12.m12.2.2.1.1.1.3.4">ğ‘›</ci></apply></apply><ci id="S2.p3.12.m12.1.1.cmml" xref="S2.p3.12.m12.1.1">ğ‘¦</ci></interval><apply id="S2.p3.12.m12.4.4.3.cmml" xref="S2.p3.12.m12.4.4.3"><times id="S2.p3.12.m12.4.4.3.3.cmml" xref="S2.p3.12.m12.4.4.3.3"></times><apply id="S2.p3.12.m12.4.4.3.4.cmml" xref="S2.p3.12.m12.4.4.3.4"><csymbol cd="ambiguous" id="S2.p3.12.m12.4.4.3.4.1.cmml" xref="S2.p3.12.m12.4.4.3.4">superscript</csymbol><apply id="S2.p3.12.m12.4.4.3.4.2.cmml" xref="S2.p3.12.m12.4.4.3.4"><csymbol cd="ambiguous" id="S2.p3.12.m12.4.4.3.4.2.1.cmml" xref="S2.p3.12.m12.4.4.3.4">subscript</csymbol><ci id="S2.p3.12.m12.4.4.3.4.2.2.cmml" xref="S2.p3.12.m12.4.4.3.4.2.2">ğ‘</ci><ci id="S2.p3.12.m12.4.4.3.4.2.3.cmml" xref="S2.p3.12.m12.4.4.3.4.2.3">ğœƒ</ci></apply><apply id="S2.p3.12.m12.4.4.3.4.3.cmml" xref="S2.p3.12.m12.4.4.3.4.3"><times id="S2.p3.12.m12.4.4.3.4.3.1.cmml" xref="S2.p3.12.m12.4.4.3.4.3.1"></times><ci id="S2.p3.12.m12.4.4.3.4.3.2.cmml" xref="S2.p3.12.m12.4.4.3.4.3.2">ğ¶</ci><ci id="S2.p3.12.m12.4.4.3.4.3.3.cmml" xref="S2.p3.12.m12.4.4.3.4.3.3">ğ‘œ</ci><ci id="S2.p3.12.m12.4.4.3.4.3.4.cmml" xref="S2.p3.12.m12.4.4.3.4.3.4">ğ‘‡</ci></apply></apply><interval closure="open" id="S2.p3.12.m12.4.4.3.2.3.cmml" xref="S2.p3.12.m12.4.4.3.2.2"><apply id="S2.p3.12.m12.3.3.2.1.1.1.cmml" xref="S2.p3.12.m12.3.3.2.1.1.1"><csymbol cd="ambiguous" id="S2.p3.12.m12.3.3.2.1.1.1.1.cmml" xref="S2.p3.12.m12.3.3.2.1.1.1">subscript</csymbol><ci id="S2.p3.12.m12.3.3.2.1.1.1.2.cmml" xref="S2.p3.12.m12.3.3.2.1.1.1.2">ğ‘§</ci><apply id="S2.p3.12.m12.3.3.2.1.1.1.3.cmml" xref="S2.p3.12.m12.3.3.2.1.1.1.3"><times id="S2.p3.12.m12.3.3.2.1.1.1.3.1.cmml" xref="S2.p3.12.m12.3.3.2.1.1.1.3.1"></times><cn id="S2.p3.12.m12.3.3.2.1.1.1.3.2.cmml" type="integer" xref="S2.p3.12.m12.3.3.2.1.1.1.3.2">1</cn><ci id="S2.p3.12.m12.3.3.2.1.1.1.3.3.cmml" xref="S2.p3.12.m12.3.3.2.1.1.1.3.3">â‹¯</ci><ci id="S2.p3.12.m12.3.3.2.1.1.1.3.4.cmml" xref="S2.p3.12.m12.3.3.2.1.1.1.3.4">ğ‘›</ci></apply></apply><apply id="S2.p3.12.m12.4.4.3.2.2.2.cmml" xref="S2.p3.12.m12.4.4.3.2.2.2"><csymbol cd="latexml" id="S2.p3.12.m12.4.4.3.2.2.2.1.cmml" xref="S2.p3.12.m12.4.4.3.2.2.2.1">conditional</csymbol><ci id="S2.p3.12.m12.4.4.3.2.2.2.2.cmml" xref="S2.p3.12.m12.4.4.3.2.2.2.2">ğ‘¦</ci><ci id="S2.p3.12.m12.4.4.3.2.2.2.3.cmml" xref="S2.p3.12.m12.4.4.3.2.2.2.3">ğ‘¥</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.12.m12.4c">[z_{1\cdots n},y]\sim p_{\theta}^{CoT}(z_{1\cdots n},y|x)</annotation><annotation encoding="application/x-llamapun" id="S2.p3.12.m12.4d">[ italic_z start_POSTSUBSCRIPT 1 â‹¯ italic_n end_POSTSUBSCRIPT , italic_y ] âˆ¼ italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_C italic_o italic_T end_POSTSUPERSCRIPT ( italic_z start_POSTSUBSCRIPT 1 â‹¯ italic_n end_POSTSUBSCRIPT , italic_y | italic_x )</annotation></semantics></math> is sampled as a continuous language sequence, and the <span class="ltx_text ltx_font_bold" id="S2.p3.13.3">decomposition</span> of thoughts (e.g.â€‰is each <math alttext="z_{i}" class="ltx_Math" display="inline" id="S2.p3.13.m13.1"><semantics id="S2.p3.13.m13.1a"><msub id="S2.p3.13.m13.1.1" xref="S2.p3.13.m13.1.1.cmml"><mi id="S2.p3.13.m13.1.1.2" xref="S2.p3.13.m13.1.1.2.cmml">z</mi><mi id="S2.p3.13.m13.1.1.3" xref="S2.p3.13.m13.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.13.m13.1b"><apply id="S2.p3.13.m13.1.1.cmml" xref="S2.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S2.p3.13.m13.1.1.1.cmml" xref="S2.p3.13.m13.1.1">subscript</csymbol><ci id="S2.p3.13.m13.1.1.2.cmml" xref="S2.p3.13.m13.1.1.2">ğ‘§</ci><ci id="S2.p3.13.m13.1.1.3.cmml" xref="S2.p3.13.m13.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.13.m13.1c">z_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.13.m13.1d">italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> a phrase, a sentence, or a paragraph) is left ambiguous.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.3"><span class="ltx_text ltx_font_bold" id="S2.p4.3.1">Self-consistency with CoT (CoT-SC)</span>Â <cite class="ltx_cite ltx_citemacro_citep">(Wang etÂ al., <a class="ltx_ref" href="#bib.bib36" title="">2022</a>)</cite> is an ensemble approach that samples <math alttext="k" class="ltx_Math" display="inline" id="S2.p4.1.m1.1"><semantics id="S2.p4.1.m1.1a"><mi id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><ci id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.p4.1.m1.1d">italic_k</annotation></semantics></math> i.i.d.â€‰chains of thought: <math alttext="[z^{(i)}_{1\cdots n},y^{(i)}]\sim p_{\theta}^{CoT}(z_{1\cdots n},y|x)\ (i=1%
\cdots k)" class="ltx_Math" display="inline" id="S2.p4.2.m2.7"><semantics id="S2.p4.2.m2.7a"><mrow id="S2.p4.2.m2.7.7" xref="S2.p4.2.m2.7.7.cmml"><mrow id="S2.p4.2.m2.4.4.2.2" xref="S2.p4.2.m2.4.4.2.3.cmml"><mo id="S2.p4.2.m2.4.4.2.2.3" stretchy="false" xref="S2.p4.2.m2.4.4.2.3.cmml">[</mo><msubsup id="S2.p4.2.m2.3.3.1.1.1" xref="S2.p4.2.m2.3.3.1.1.1.cmml"><mi id="S2.p4.2.m2.3.3.1.1.1.2.2" xref="S2.p4.2.m2.3.3.1.1.1.2.2.cmml">z</mi><mrow id="S2.p4.2.m2.3.3.1.1.1.3" xref="S2.p4.2.m2.3.3.1.1.1.3.cmml"><mn id="S2.p4.2.m2.3.3.1.1.1.3.2" xref="S2.p4.2.m2.3.3.1.1.1.3.2.cmml">1</mn><mo id="S2.p4.2.m2.3.3.1.1.1.3.1" xref="S2.p4.2.m2.3.3.1.1.1.3.1.cmml">â¢</mo><mi id="S2.p4.2.m2.3.3.1.1.1.3.3" mathvariant="normal" xref="S2.p4.2.m2.3.3.1.1.1.3.3.cmml">â‹¯</mi><mo id="S2.p4.2.m2.3.3.1.1.1.3.1a" xref="S2.p4.2.m2.3.3.1.1.1.3.1.cmml">â¢</mo><mi id="S2.p4.2.m2.3.3.1.1.1.3.4" xref="S2.p4.2.m2.3.3.1.1.1.3.4.cmml">n</mi></mrow><mrow id="S2.p4.2.m2.1.1.1.3" xref="S2.p4.2.m2.3.3.1.1.1.cmml"><mo id="S2.p4.2.m2.1.1.1.3.1" stretchy="false" xref="S2.p4.2.m2.3.3.1.1.1.cmml">(</mo><mi id="S2.p4.2.m2.1.1.1.1" xref="S2.p4.2.m2.1.1.1.1.cmml">i</mi><mo id="S2.p4.2.m2.1.1.1.3.2" stretchy="false" xref="S2.p4.2.m2.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.p4.2.m2.4.4.2.2.4" xref="S2.p4.2.m2.4.4.2.3.cmml">,</mo><msup id="S2.p4.2.m2.4.4.2.2.2" xref="S2.p4.2.m2.4.4.2.2.2.cmml"><mi id="S2.p4.2.m2.4.4.2.2.2.2" xref="S2.p4.2.m2.4.4.2.2.2.2.cmml">y</mi><mrow id="S2.p4.2.m2.2.2.1.3" xref="S2.p4.2.m2.4.4.2.2.2.cmml"><mo id="S2.p4.2.m2.2.2.1.3.1" stretchy="false" xref="S2.p4.2.m2.4.4.2.2.2.cmml">(</mo><mi id="S2.p4.2.m2.2.2.1.1" xref="S2.p4.2.m2.2.2.1.1.cmml">i</mi><mo id="S2.p4.2.m2.2.2.1.3.2" stretchy="false" xref="S2.p4.2.m2.4.4.2.2.2.cmml">)</mo></mrow></msup><mo id="S2.p4.2.m2.4.4.2.2.5" stretchy="false" xref="S2.p4.2.m2.4.4.2.3.cmml">]</mo></mrow><mo id="S2.p4.2.m2.7.7.6" xref="S2.p4.2.m2.7.7.6.cmml">âˆ¼</mo><mrow id="S2.p4.2.m2.7.7.5" xref="S2.p4.2.m2.7.7.5.cmml"><msubsup id="S2.p4.2.m2.7.7.5.5" xref="S2.p4.2.m2.7.7.5.5.cmml"><mi id="S2.p4.2.m2.7.7.5.5.2.2" xref="S2.p4.2.m2.7.7.5.5.2.2.cmml">p</mi><mi id="S2.p4.2.m2.7.7.5.5.2.3" xref="S2.p4.2.m2.7.7.5.5.2.3.cmml">Î¸</mi><mrow id="S2.p4.2.m2.7.7.5.5.3" xref="S2.p4.2.m2.7.7.5.5.3.cmml"><mi id="S2.p4.2.m2.7.7.5.5.3.2" xref="S2.p4.2.m2.7.7.5.5.3.2.cmml">C</mi><mo id="S2.p4.2.m2.7.7.5.5.3.1" xref="S2.p4.2.m2.7.7.5.5.3.1.cmml">â¢</mo><mi id="S2.p4.2.m2.7.7.5.5.3.3" xref="S2.p4.2.m2.7.7.5.5.3.3.cmml">o</mi><mo id="S2.p4.2.m2.7.7.5.5.3.1a" xref="S2.p4.2.m2.7.7.5.5.3.1.cmml">â¢</mo><mi id="S2.p4.2.m2.7.7.5.5.3.4" xref="S2.p4.2.m2.7.7.5.5.3.4.cmml">T</mi></mrow></msubsup><mo id="S2.p4.2.m2.7.7.5.4" xref="S2.p4.2.m2.7.7.5.4.cmml">â¢</mo><mrow id="S2.p4.2.m2.6.6.4.2.2" xref="S2.p4.2.m2.6.6.4.2.3.cmml"><mo id="S2.p4.2.m2.6.6.4.2.2.3" stretchy="false" xref="S2.p4.2.m2.6.6.4.2.3.cmml">(</mo><msub id="S2.p4.2.m2.5.5.3.1.1.1" xref="S2.p4.2.m2.5.5.3.1.1.1.cmml"><mi id="S2.p4.2.m2.5.5.3.1.1.1.2" xref="S2.p4.2.m2.5.5.3.1.1.1.2.cmml">z</mi><mrow id="S2.p4.2.m2.5.5.3.1.1.1.3" xref="S2.p4.2.m2.5.5.3.1.1.1.3.cmml"><mn id="S2.p4.2.m2.5.5.3.1.1.1.3.2" xref="S2.p4.2.m2.5.5.3.1.1.1.3.2.cmml">1</mn><mo id="S2.p4.2.m2.5.5.3.1.1.1.3.1" xref="S2.p4.2.m2.5.5.3.1.1.1.3.1.cmml">â¢</mo><mi id="S2.p4.2.m2.5.5.3.1.1.1.3.3" mathvariant="normal" xref="S2.p4.2.m2.5.5.3.1.1.1.3.3.cmml">â‹¯</mi><mo id="S2.p4.2.m2.5.5.3.1.1.1.3.1a" xref="S2.p4.2.m2.5.5.3.1.1.1.3.1.cmml">â¢</mo><mi id="S2.p4.2.m2.5.5.3.1.1.1.3.4" xref="S2.p4.2.m2.5.5.3.1.1.1.3.4.cmml">n</mi></mrow></msub><mo id="S2.p4.2.m2.6.6.4.2.2.4" xref="S2.p4.2.m2.6.6.4.2.3.cmml">,</mo><mrow id="S2.p4.2.m2.6.6.4.2.2.2" xref="S2.p4.2.m2.6.6.4.2.2.2.cmml"><mi id="S2.p4.2.m2.6.6.4.2.2.2.2" xref="S2.p4.2.m2.6.6.4.2.2.2.2.cmml">y</mi><mo fence="false" id="S2.p4.2.m2.6.6.4.2.2.2.1" xref="S2.p4.2.m2.6.6.4.2.2.2.1.cmml">|</mo><mi id="S2.p4.2.m2.6.6.4.2.2.2.3" xref="S2.p4.2.m2.6.6.4.2.2.2.3.cmml">x</mi></mrow><mo id="S2.p4.2.m2.6.6.4.2.2.5" stretchy="false" xref="S2.p4.2.m2.6.6.4.2.3.cmml">)</mo></mrow><mo id="S2.p4.2.m2.7.7.5.4a" lspace="0.500em" xref="S2.p4.2.m2.7.7.5.4.cmml">â¢</mo><mrow id="S2.p4.2.m2.7.7.5.3.1" xref="S2.p4.2.m2.7.7.5.3.1.1.cmml"><mo id="S2.p4.2.m2.7.7.5.3.1.2" stretchy="false" xref="S2.p4.2.m2.7.7.5.3.1.1.cmml">(</mo><mrow id="S2.p4.2.m2.7.7.5.3.1.1" xref="S2.p4.2.m2.7.7.5.3.1.1.cmml"><mi id="S2.p4.2.m2.7.7.5.3.1.1.2" xref="S2.p4.2.m2.7.7.5.3.1.1.2.cmml">i</mi><mo id="S2.p4.2.m2.7.7.5.3.1.1.1" xref="S2.p4.2.m2.7.7.5.3.1.1.1.cmml">=</mo><mrow id="S2.p4.2.m2.7.7.5.3.1.1.3" xref="S2.p4.2.m2.7.7.5.3.1.1.3.cmml"><mn id="S2.p4.2.m2.7.7.5.3.1.1.3.2" xref="S2.p4.2.m2.7.7.5.3.1.1.3.2.cmml">1</mn><mo id="S2.p4.2.m2.7.7.5.3.1.1.3.1" xref="S2.p4.2.m2.7.7.5.3.1.1.3.1.cmml">â¢</mo><mi id="S2.p4.2.m2.7.7.5.3.1.1.3.3" mathvariant="normal" xref="S2.p4.2.m2.7.7.5.3.1.1.3.3.cmml">â‹¯</mi><mo id="S2.p4.2.m2.7.7.5.3.1.1.3.1a" xref="S2.p4.2.m2.7.7.5.3.1.1.3.1.cmml">â¢</mo><mi id="S2.p4.2.m2.7.7.5.3.1.1.3.4" xref="S2.p4.2.m2.7.7.5.3.1.1.3.4.cmml">k</mi></mrow></mrow><mo id="S2.p4.2.m2.7.7.5.3.1.3" stretchy="false" xref="S2.p4.2.m2.7.7.5.3.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.2.m2.7b"><apply id="S2.p4.2.m2.7.7.cmml" xref="S2.p4.2.m2.7.7"><csymbol cd="latexml" id="S2.p4.2.m2.7.7.6.cmml" xref="S2.p4.2.m2.7.7.6">similar-to</csymbol><interval closure="closed" id="S2.p4.2.m2.4.4.2.3.cmml" xref="S2.p4.2.m2.4.4.2.2"><apply id="S2.p4.2.m2.3.3.1.1.1.cmml" xref="S2.p4.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.p4.2.m2.3.3.1.1.1.1.cmml" xref="S2.p4.2.m2.3.3.1.1.1">subscript</csymbol><apply id="S2.p4.2.m2.3.3.1.1.1.2.cmml" xref="S2.p4.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.p4.2.m2.3.3.1.1.1.2.1.cmml" xref="S2.p4.2.m2.3.3.1.1.1">superscript</csymbol><ci id="S2.p4.2.m2.3.3.1.1.1.2.2.cmml" xref="S2.p4.2.m2.3.3.1.1.1.2.2">ğ‘§</ci><ci id="S2.p4.2.m2.1.1.1.1.cmml" xref="S2.p4.2.m2.1.1.1.1">ğ‘–</ci></apply><apply id="S2.p4.2.m2.3.3.1.1.1.3.cmml" xref="S2.p4.2.m2.3.3.1.1.1.3"><times id="S2.p4.2.m2.3.3.1.1.1.3.1.cmml" xref="S2.p4.2.m2.3.3.1.1.1.3.1"></times><cn id="S2.p4.2.m2.3.3.1.1.1.3.2.cmml" type="integer" xref="S2.p4.2.m2.3.3.1.1.1.3.2">1</cn><ci id="S2.p4.2.m2.3.3.1.1.1.3.3.cmml" xref="S2.p4.2.m2.3.3.1.1.1.3.3">â‹¯</ci><ci id="S2.p4.2.m2.3.3.1.1.1.3.4.cmml" xref="S2.p4.2.m2.3.3.1.1.1.3.4">ğ‘›</ci></apply></apply><apply id="S2.p4.2.m2.4.4.2.2.2.cmml" xref="S2.p4.2.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.p4.2.m2.4.4.2.2.2.1.cmml" xref="S2.p4.2.m2.4.4.2.2.2">superscript</csymbol><ci id="S2.p4.2.m2.4.4.2.2.2.2.cmml" xref="S2.p4.2.m2.4.4.2.2.2.2">ğ‘¦</ci><ci id="S2.p4.2.m2.2.2.1.1.cmml" xref="S2.p4.2.m2.2.2.1.1">ğ‘–</ci></apply></interval><apply id="S2.p4.2.m2.7.7.5.cmml" xref="S2.p4.2.m2.7.7.5"><times id="S2.p4.2.m2.7.7.5.4.cmml" xref="S2.p4.2.m2.7.7.5.4"></times><apply id="S2.p4.2.m2.7.7.5.5.cmml" xref="S2.p4.2.m2.7.7.5.5"><csymbol cd="ambiguous" id="S2.p4.2.m2.7.7.5.5.1.cmml" xref="S2.p4.2.m2.7.7.5.5">superscript</csymbol><apply id="S2.p4.2.m2.7.7.5.5.2.cmml" xref="S2.p4.2.m2.7.7.5.5"><csymbol cd="ambiguous" id="S2.p4.2.m2.7.7.5.5.2.1.cmml" xref="S2.p4.2.m2.7.7.5.5">subscript</csymbol><ci id="S2.p4.2.m2.7.7.5.5.2.2.cmml" xref="S2.p4.2.m2.7.7.5.5.2.2">ğ‘</ci><ci id="S2.p4.2.m2.7.7.5.5.2.3.cmml" xref="S2.p4.2.m2.7.7.5.5.2.3">ğœƒ</ci></apply><apply id="S2.p4.2.m2.7.7.5.5.3.cmml" xref="S2.p4.2.m2.7.7.5.5.3"><times id="S2.p4.2.m2.7.7.5.5.3.1.cmml" xref="S2.p4.2.m2.7.7.5.5.3.1"></times><ci id="S2.p4.2.m2.7.7.5.5.3.2.cmml" xref="S2.p4.2.m2.7.7.5.5.3.2">ğ¶</ci><ci id="S2.p4.2.m2.7.7.5.5.3.3.cmml" xref="S2.p4.2.m2.7.7.5.5.3.3">ğ‘œ</ci><ci id="S2.p4.2.m2.7.7.5.5.3.4.cmml" xref="S2.p4.2.m2.7.7.5.5.3.4">ğ‘‡</ci></apply></apply><interval closure="open" id="S2.p4.2.m2.6.6.4.2.3.cmml" xref="S2.p4.2.m2.6.6.4.2.2"><apply id="S2.p4.2.m2.5.5.3.1.1.1.cmml" xref="S2.p4.2.m2.5.5.3.1.1.1"><csymbol cd="ambiguous" id="S2.p4.2.m2.5.5.3.1.1.1.1.cmml" xref="S2.p4.2.m2.5.5.3.1.1.1">subscript</csymbol><ci id="S2.p4.2.m2.5.5.3.1.1.1.2.cmml" xref="S2.p4.2.m2.5.5.3.1.1.1.2">ğ‘§</ci><apply id="S2.p4.2.m2.5.5.3.1.1.1.3.cmml" xref="S2.p4.2.m2.5.5.3.1.1.1.3"><times id="S2.p4.2.m2.5.5.3.1.1.1.3.1.cmml" xref="S2.p4.2.m2.5.5.3.1.1.1.3.1"></times><cn id="S2.p4.2.m2.5.5.3.1.1.1.3.2.cmml" type="integer" xref="S2.p4.2.m2.5.5.3.1.1.1.3.2">1</cn><ci id="S2.p4.2.m2.5.5.3.1.1.1.3.3.cmml" xref="S2.p4.2.m2.5.5.3.1.1.1.3.3">â‹¯</ci><ci id="S2.p4.2.m2.5.5.3.1.1.1.3.4.cmml" xref="S2.p4.2.m2.5.5.3.1.1.1.3.4">ğ‘›</ci></apply></apply><apply id="S2.p4.2.m2.6.6.4.2.2.2.cmml" xref="S2.p4.2.m2.6.6.4.2.2.2"><csymbol cd="latexml" id="S2.p4.2.m2.6.6.4.2.2.2.1.cmml" xref="S2.p4.2.m2.6.6.4.2.2.2.1">conditional</csymbol><ci id="S2.p4.2.m2.6.6.4.2.2.2.2.cmml" xref="S2.p4.2.m2.6.6.4.2.2.2.2">ğ‘¦</ci><ci id="S2.p4.2.m2.6.6.4.2.2.2.3.cmml" xref="S2.p4.2.m2.6.6.4.2.2.2.3">ğ‘¥</ci></apply></interval><apply id="S2.p4.2.m2.7.7.5.3.1.1.cmml" xref="S2.p4.2.m2.7.7.5.3.1"><eq id="S2.p4.2.m2.7.7.5.3.1.1.1.cmml" xref="S2.p4.2.m2.7.7.5.3.1.1.1"></eq><ci id="S2.p4.2.m2.7.7.5.3.1.1.2.cmml" xref="S2.p4.2.m2.7.7.5.3.1.1.2">ğ‘–</ci><apply id="S2.p4.2.m2.7.7.5.3.1.1.3.cmml" xref="S2.p4.2.m2.7.7.5.3.1.1.3"><times id="S2.p4.2.m2.7.7.5.3.1.1.3.1.cmml" xref="S2.p4.2.m2.7.7.5.3.1.1.3.1"></times><cn id="S2.p4.2.m2.7.7.5.3.1.1.3.2.cmml" type="integer" xref="S2.p4.2.m2.7.7.5.3.1.1.3.2">1</cn><ci id="S2.p4.2.m2.7.7.5.3.1.1.3.3.cmml" xref="S2.p4.2.m2.7.7.5.3.1.1.3.3">â‹¯</ci><ci id="S2.p4.2.m2.7.7.5.3.1.1.3.4.cmml" xref="S2.p4.2.m2.7.7.5.3.1.1.3.4">ğ‘˜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m2.7c">[z^{(i)}_{1\cdots n},y^{(i)}]\sim p_{\theta}^{CoT}(z_{1\cdots n},y|x)\ (i=1%
\cdots k)</annotation><annotation encoding="application/x-llamapun" id="S2.p4.2.m2.7d">[ italic_z start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 â‹¯ italic_n end_POSTSUBSCRIPT , italic_y start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ] âˆ¼ italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_C italic_o italic_T end_POSTSUPERSCRIPT ( italic_z start_POSTSUBSCRIPT 1 â‹¯ italic_n end_POSTSUBSCRIPT , italic_y | italic_x ) ( italic_i = 1 â‹¯ italic_k )</annotation></semantics></math>, then returns the most frequent output: <math alttext="\arg\max_{y}\#\{i\mid y^{(i)}=y\}" class="ltx_Math" display="inline" id="S2.p4.3.m3.3"><semantics id="S2.p4.3.m3.3a"><mrow id="S2.p4.3.m3.3.3" xref="S2.p4.3.m3.3.3.cmml"><mrow id="S2.p4.3.m3.3.3.3" xref="S2.p4.3.m3.3.3.3.cmml"><mi id="S2.p4.3.m3.3.3.3.1" xref="S2.p4.3.m3.3.3.3.1.cmml">arg</mi><mo id="S2.p4.3.m3.3.3.3a" lspace="0.167em" xref="S2.p4.3.m3.3.3.3.cmml">â¡</mo><mrow id="S2.p4.3.m3.3.3.3.2" xref="S2.p4.3.m3.3.3.3.2.cmml"><msub id="S2.p4.3.m3.3.3.3.2.1" xref="S2.p4.3.m3.3.3.3.2.1.cmml"><mi id="S2.p4.3.m3.3.3.3.2.1.2" xref="S2.p4.3.m3.3.3.3.2.1.2.cmml">max</mi><mi id="S2.p4.3.m3.3.3.3.2.1.3" xref="S2.p4.3.m3.3.3.3.2.1.3.cmml">y</mi></msub><mo id="S2.p4.3.m3.3.3.3.2a" lspace="0.167em" xref="S2.p4.3.m3.3.3.3.2.cmml">â¡</mo><mi id="S2.p4.3.m3.3.3.3.2.2" mathvariant="normal" xref="S2.p4.3.m3.3.3.3.2.2.cmml">#</mi></mrow></mrow><mo id="S2.p4.3.m3.3.3.2" xref="S2.p4.3.m3.3.3.2.cmml">â¢</mo><mrow id="S2.p4.3.m3.3.3.1.1" xref="S2.p4.3.m3.3.3.1.2.cmml"><mo id="S2.p4.3.m3.3.3.1.1.2" stretchy="false" xref="S2.p4.3.m3.3.3.1.2.1.cmml">{</mo><mi id="S2.p4.3.m3.2.2" xref="S2.p4.3.m3.2.2.cmml">i</mi><mo fence="true" id="S2.p4.3.m3.3.3.1.1.3" lspace="0em" rspace="0em" xref="S2.p4.3.m3.3.3.1.2.1.cmml">âˆ£</mo><mrow id="S2.p4.3.m3.3.3.1.1.1" xref="S2.p4.3.m3.3.3.1.1.1.cmml"><msup id="S2.p4.3.m3.3.3.1.1.1.2" xref="S2.p4.3.m3.3.3.1.1.1.2.cmml"><mi id="S2.p4.3.m3.3.3.1.1.1.2.2" xref="S2.p4.3.m3.3.3.1.1.1.2.2.cmml">y</mi><mrow id="S2.p4.3.m3.1.1.1.3" xref="S2.p4.3.m3.3.3.1.1.1.2.cmml"><mo id="S2.p4.3.m3.1.1.1.3.1" stretchy="false" xref="S2.p4.3.m3.3.3.1.1.1.2.cmml">(</mo><mi id="S2.p4.3.m3.1.1.1.1" xref="S2.p4.3.m3.1.1.1.1.cmml">i</mi><mo id="S2.p4.3.m3.1.1.1.3.2" stretchy="false" xref="S2.p4.3.m3.3.3.1.1.1.2.cmml">)</mo></mrow></msup><mo id="S2.p4.3.m3.3.3.1.1.1.1" xref="S2.p4.3.m3.3.3.1.1.1.1.cmml">=</mo><mi id="S2.p4.3.m3.3.3.1.1.1.3" xref="S2.p4.3.m3.3.3.1.1.1.3.cmml">y</mi></mrow><mo id="S2.p4.3.m3.3.3.1.1.4" stretchy="false" xref="S2.p4.3.m3.3.3.1.2.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.3.m3.3b"><apply id="S2.p4.3.m3.3.3.cmml" xref="S2.p4.3.m3.3.3"><times id="S2.p4.3.m3.3.3.2.cmml" xref="S2.p4.3.m3.3.3.2"></times><apply id="S2.p4.3.m3.3.3.3.cmml" xref="S2.p4.3.m3.3.3.3"><arg id="S2.p4.3.m3.3.3.3.1.cmml" xref="S2.p4.3.m3.3.3.3.1"></arg><apply id="S2.p4.3.m3.3.3.3.2.cmml" xref="S2.p4.3.m3.3.3.3.2"><apply id="S2.p4.3.m3.3.3.3.2.1.cmml" xref="S2.p4.3.m3.3.3.3.2.1"><csymbol cd="ambiguous" id="S2.p4.3.m3.3.3.3.2.1.1.cmml" xref="S2.p4.3.m3.3.3.3.2.1">subscript</csymbol><max id="S2.p4.3.m3.3.3.3.2.1.2.cmml" xref="S2.p4.3.m3.3.3.3.2.1.2"></max><ci id="S2.p4.3.m3.3.3.3.2.1.3.cmml" xref="S2.p4.3.m3.3.3.3.2.1.3">ğ‘¦</ci></apply><ci id="S2.p4.3.m3.3.3.3.2.2.cmml" xref="S2.p4.3.m3.3.3.3.2.2">#</ci></apply></apply><apply id="S2.p4.3.m3.3.3.1.2.cmml" xref="S2.p4.3.m3.3.3.1.1"><csymbol cd="latexml" id="S2.p4.3.m3.3.3.1.2.1.cmml" xref="S2.p4.3.m3.3.3.1.1.2">conditional-set</csymbol><ci id="S2.p4.3.m3.2.2.cmml" xref="S2.p4.3.m3.2.2">ğ‘–</ci><apply id="S2.p4.3.m3.3.3.1.1.1.cmml" xref="S2.p4.3.m3.3.3.1.1.1"><eq id="S2.p4.3.m3.3.3.1.1.1.1.cmml" xref="S2.p4.3.m3.3.3.1.1.1.1"></eq><apply id="S2.p4.3.m3.3.3.1.1.1.2.cmml" xref="S2.p4.3.m3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S2.p4.3.m3.3.3.1.1.1.2.1.cmml" xref="S2.p4.3.m3.3.3.1.1.1.2">superscript</csymbol><ci id="S2.p4.3.m3.3.3.1.1.1.2.2.cmml" xref="S2.p4.3.m3.3.3.1.1.1.2.2">ğ‘¦</ci><ci id="S2.p4.3.m3.1.1.1.1.cmml" xref="S2.p4.3.m3.1.1.1.1">ğ‘–</ci></apply><ci id="S2.p4.3.m3.3.3.1.1.1.3.cmml" xref="S2.p4.3.m3.3.3.1.1.1.3">ğ‘¦</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.m3.3c">\arg\max_{y}\#\{i\mid y^{(i)}=y\}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.3.m3.3d">roman_arg roman_max start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT # { italic_i âˆ£ italic_y start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = italic_y }</annotation></semantics></math>. CoT-SC improves upon CoT, because there are generally different thought processes for the same problem (e.g.â€‰different ways to prove the same theorem), and the output decision can be more faithful by exploring a richer set of thoughts. However, within each chain there is no local exploration of different thought steps, and the â€œmost frequentâ€ heuristic only applies when the output space is limited (e.g.â€‰multi-choice QA).</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Tree of Thoughts: Deliberate Problem Solving with LM</h2>
<div class="ltx_para" id="S3.p1">
<blockquote class="ltx_quote" id="S3.p1.1">
<p class="ltx_p" id="S3.p1.1.1"><span class="ltx_text ltx_font_italic" id="S3.p1.1.1.1">A genuine problem-solving process involves the repeated use of available information to initiate exploration, which discloses, in turn, more information until a way to attain the solution is finally discovered.â€”â€” <cite class="ltx_cite ltx_citemacro_citet">Newell etÂ al. (<a class="ltx_ref" href="#bib.bib21" title="">1959</a>)</cite></span></p>
</blockquote>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">Research on human problem-solving suggests that people search through a combinatorial problem-space â€“ a tree where the nodes represent partial solutions, and the branches correspond to operators that modify them <cite class="ltx_cite ltx_citemacro_cite">Newell etÂ al. (<a class="ltx_ref" href="#bib.bib21" title="">1959</a>, <a class="ltx_ref" href="#bib.bib22" title="">1972</a>)</cite>. Which branch to take is determined by heuristics that help to navigate the problem-space and guide the problem-solver towards a solution. This perspective highlights two key shortcomings of existing approaches that use LMs to solve general problems: 1) Locally, they do not explore <span class="ltx_text ltx_font_italic" id="S3.p2.1.1">different</span> continuations within a thought process â€“ the branches of the tree. 2) Globally, they do not incorporate any type of planning, lookahead, or backtracking to help evaluate these different options â€“ the kind of heuristic-guided search that seems characteristic of human problem-solving.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.1">To address these shortcomings, we introduce <em class="ltx_emph ltx_font_italic" id="S3.p3.1.1">Tree of Thoughts (ToT)</em>, a paradigm that allows LMs to explore multiple reasoning paths over thoughts (FigureÂ <a class="ltx_ref" href="#S1.F1" title="Figure 1 â€£ 1 Introduction â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>(c)). ToT frames any problem as a search over a tree, where each node is a <span class="ltx_text ltx_font_bold" id="S3.p3.1.2">state</span> <math alttext="s=[x,z_{1\cdots i}]" class="ltx_Math" display="inline" id="S3.p3.1.m1.2"><semantics id="S3.p3.1.m1.2a"><mrow id="S3.p3.1.m1.2.2" xref="S3.p3.1.m1.2.2.cmml"><mi id="S3.p3.1.m1.2.2.3" xref="S3.p3.1.m1.2.2.3.cmml">s</mi><mo id="S3.p3.1.m1.2.2.2" xref="S3.p3.1.m1.2.2.2.cmml">=</mo><mrow id="S3.p3.1.m1.2.2.1.1" xref="S3.p3.1.m1.2.2.1.2.cmml"><mo id="S3.p3.1.m1.2.2.1.1.2" stretchy="false" xref="S3.p3.1.m1.2.2.1.2.cmml">[</mo><mi id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">x</mi><mo id="S3.p3.1.m1.2.2.1.1.3" xref="S3.p3.1.m1.2.2.1.2.cmml">,</mo><msub id="S3.p3.1.m1.2.2.1.1.1" xref="S3.p3.1.m1.2.2.1.1.1.cmml"><mi id="S3.p3.1.m1.2.2.1.1.1.2" xref="S3.p3.1.m1.2.2.1.1.1.2.cmml">z</mi><mrow id="S3.p3.1.m1.2.2.1.1.1.3" xref="S3.p3.1.m1.2.2.1.1.1.3.cmml"><mn id="S3.p3.1.m1.2.2.1.1.1.3.2" xref="S3.p3.1.m1.2.2.1.1.1.3.2.cmml">1</mn><mo id="S3.p3.1.m1.2.2.1.1.1.3.1" xref="S3.p3.1.m1.2.2.1.1.1.3.1.cmml">â¢</mo><mi id="S3.p3.1.m1.2.2.1.1.1.3.3" mathvariant="normal" xref="S3.p3.1.m1.2.2.1.1.1.3.3.cmml">â‹¯</mi><mo id="S3.p3.1.m1.2.2.1.1.1.3.1a" xref="S3.p3.1.m1.2.2.1.1.1.3.1.cmml">â¢</mo><mi id="S3.p3.1.m1.2.2.1.1.1.3.4" xref="S3.p3.1.m1.2.2.1.1.1.3.4.cmml">i</mi></mrow></msub><mo id="S3.p3.1.m1.2.2.1.1.4" stretchy="false" xref="S3.p3.1.m1.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.2b"><apply id="S3.p3.1.m1.2.2.cmml" xref="S3.p3.1.m1.2.2"><eq id="S3.p3.1.m1.2.2.2.cmml" xref="S3.p3.1.m1.2.2.2"></eq><ci id="S3.p3.1.m1.2.2.3.cmml" xref="S3.p3.1.m1.2.2.3">ğ‘ </ci><interval closure="closed" id="S3.p3.1.m1.2.2.1.2.cmml" xref="S3.p3.1.m1.2.2.1.1"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">ğ‘¥</ci><apply id="S3.p3.1.m1.2.2.1.1.1.cmml" xref="S3.p3.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.2.2.1.1.1.1.cmml" xref="S3.p3.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.2.2.1.1.1.2.cmml" xref="S3.p3.1.m1.2.2.1.1.1.2">ğ‘§</ci><apply id="S3.p3.1.m1.2.2.1.1.1.3.cmml" xref="S3.p3.1.m1.2.2.1.1.1.3"><times id="S3.p3.1.m1.2.2.1.1.1.3.1.cmml" xref="S3.p3.1.m1.2.2.1.1.1.3.1"></times><cn id="S3.p3.1.m1.2.2.1.1.1.3.2.cmml" type="integer" xref="S3.p3.1.m1.2.2.1.1.1.3.2">1</cn><ci id="S3.p3.1.m1.2.2.1.1.1.3.3.cmml" xref="S3.p3.1.m1.2.2.1.1.1.3.3">â‹¯</ci><ci id="S3.p3.1.m1.2.2.1.1.1.3.4.cmml" xref="S3.p3.1.m1.2.2.1.1.1.3.4">ğ‘–</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.2c">s=[x,z_{1\cdots i}]</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.2d">italic_s = [ italic_x , italic_z start_POSTSUBSCRIPT 1 â‹¯ italic_i end_POSTSUBSCRIPT ]</annotation></semantics></math> representing a partial solution with the input and the sequence of thoughts so far. A specific instantiation of ToT involves answering four questions: 1. How to <span class="ltx_text ltx_font_bold" id="S3.p3.1.3">decompose</span> the intermediate process into thought steps; 2. How to <span class="ltx_text ltx_font_bold" id="S3.p3.1.4">generate</span> potential thoughts from each state; 3. How to heuristically <span class="ltx_text ltx_font_bold" id="S3.p3.1.5">evaluate</span> states; 4. What <span class="ltx_text ltx_font_bold" id="S3.p3.1.6">search</span> algorithm to use.
</p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.1"><span class="ltx_text ltx_font_bold" id="S3.p4.1.1">1.â€‰Thought decomposition.</span> While CoT samples thoughts coherently without explicit decomposition, ToT leverages problem properties to design and decompose intermediate thought steps. As TableÂ <a class="ltx_ref" href="#S4.T1" title="Table 1 â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a> shows, depending on different problems, a thought could be a couple of words (Crosswords), a line of equation (Game of 24), or a whole paragraph of writing plan (Creative Writing). In general, a thought should be â€œsmallâ€ enough so that LMs can generate promising and diverse samples (e.g.â€‰generating a whole book is usually too â€œbigâ€ to be coherent), yet â€œbigâ€ enough so that LMs can evaluate its prospect toward problem solving (e.g.â€‰generating one token is usually too â€œsmallâ€ to evaluate). </p>
</div>
<div class="ltx_para" id="S3.p5">
<p class="ltx_p" id="S3.p5.3"><span class="ltx_text ltx_font_bold" id="S3.p5.1.1">2.â€‰Thought generator <math alttext="G(p_{\theta},s,k)" class="ltx_Math" display="inline" id="S3.p5.1.1.m1.3"><semantics id="S3.p5.1.1.m1.3a"><mrow id="S3.p5.1.1.m1.3.3" xref="S3.p5.1.1.m1.3.3.cmml"><mi id="S3.p5.1.1.m1.3.3.3" xref="S3.p5.1.1.m1.3.3.3.cmml">G</mi><mo id="S3.p5.1.1.m1.3.3.2" mathvariant="bold" xref="S3.p5.1.1.m1.3.3.2.cmml">â¢</mo><mrow id="S3.p5.1.1.m1.3.3.1.1" xref="S3.p5.1.1.m1.3.3.1.2.cmml"><mo id="S3.p5.1.1.m1.3.3.1.1.2" mathvariant="normal" stretchy="false" xref="S3.p5.1.1.m1.3.3.1.2.cmml">(</mo><msub id="S3.p5.1.1.m1.3.3.1.1.1" xref="S3.p5.1.1.m1.3.3.1.1.1.cmml"><mi id="S3.p5.1.1.m1.3.3.1.1.1.2" xref="S3.p5.1.1.m1.3.3.1.1.1.2.cmml">p</mi><mi id="S3.p5.1.1.m1.3.3.1.1.1.3" xref="S3.p5.1.1.m1.3.3.1.1.1.3.cmml">Î¸</mi></msub><mo id="S3.p5.1.1.m1.3.3.1.1.3" mathvariant="normal" xref="S3.p5.1.1.m1.3.3.1.2.cmml">,</mo><mi id="S3.p5.1.1.m1.1.1" xref="S3.p5.1.1.m1.1.1.cmml">s</mi><mo id="S3.p5.1.1.m1.3.3.1.1.4" mathvariant="normal" xref="S3.p5.1.1.m1.3.3.1.2.cmml">,</mo><mi id="S3.p5.1.1.m1.2.2" xref="S3.p5.1.1.m1.2.2.cmml">k</mi><mo id="S3.p5.1.1.m1.3.3.1.1.5" mathvariant="normal" stretchy="false" xref="S3.p5.1.1.m1.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.1.1.m1.3b"><apply id="S3.p5.1.1.m1.3.3.cmml" xref="S3.p5.1.1.m1.3.3"><times id="S3.p5.1.1.m1.3.3.2.cmml" xref="S3.p5.1.1.m1.3.3.2"></times><ci id="S3.p5.1.1.m1.3.3.3.cmml" xref="S3.p5.1.1.m1.3.3.3">ğº</ci><vector id="S3.p5.1.1.m1.3.3.1.2.cmml" xref="S3.p5.1.1.m1.3.3.1.1"><apply id="S3.p5.1.1.m1.3.3.1.1.1.cmml" xref="S3.p5.1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.p5.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.p5.1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.p5.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.p5.1.1.m1.3.3.1.1.1.2">ğ‘</ci><ci id="S3.p5.1.1.m1.3.3.1.1.1.3.cmml" xref="S3.p5.1.1.m1.3.3.1.1.1.3">ğœƒ</ci></apply><ci id="S3.p5.1.1.m1.1.1.cmml" xref="S3.p5.1.1.m1.1.1">ğ‘ </ci><ci id="S3.p5.1.1.m1.2.2.cmml" xref="S3.p5.1.1.m1.2.2">ğ‘˜</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.1.m1.3c">G(p_{\theta},s,k)</annotation><annotation encoding="application/x-llamapun" id="S3.p5.1.1.m1.3d">italic_G ( italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT , italic_s , italic_k )</annotation></semantics></math>.</span> Given a tree state <math alttext="s=[x,z_{1\cdots i}]" class="ltx_Math" display="inline" id="S3.p5.2.m1.2"><semantics id="S3.p5.2.m1.2a"><mrow id="S3.p5.2.m1.2.2" xref="S3.p5.2.m1.2.2.cmml"><mi id="S3.p5.2.m1.2.2.3" xref="S3.p5.2.m1.2.2.3.cmml">s</mi><mo id="S3.p5.2.m1.2.2.2" xref="S3.p5.2.m1.2.2.2.cmml">=</mo><mrow id="S3.p5.2.m1.2.2.1.1" xref="S3.p5.2.m1.2.2.1.2.cmml"><mo id="S3.p5.2.m1.2.2.1.1.2" stretchy="false" xref="S3.p5.2.m1.2.2.1.2.cmml">[</mo><mi id="S3.p5.2.m1.1.1" xref="S3.p5.2.m1.1.1.cmml">x</mi><mo id="S3.p5.2.m1.2.2.1.1.3" xref="S3.p5.2.m1.2.2.1.2.cmml">,</mo><msub id="S3.p5.2.m1.2.2.1.1.1" xref="S3.p5.2.m1.2.2.1.1.1.cmml"><mi id="S3.p5.2.m1.2.2.1.1.1.2" xref="S3.p5.2.m1.2.2.1.1.1.2.cmml">z</mi><mrow id="S3.p5.2.m1.2.2.1.1.1.3" xref="S3.p5.2.m1.2.2.1.1.1.3.cmml"><mn id="S3.p5.2.m1.2.2.1.1.1.3.2" xref="S3.p5.2.m1.2.2.1.1.1.3.2.cmml">1</mn><mo id="S3.p5.2.m1.2.2.1.1.1.3.1" xref="S3.p5.2.m1.2.2.1.1.1.3.1.cmml">â¢</mo><mi id="S3.p5.2.m1.2.2.1.1.1.3.3" mathvariant="normal" xref="S3.p5.2.m1.2.2.1.1.1.3.3.cmml">â‹¯</mi><mo id="S3.p5.2.m1.2.2.1.1.1.3.1a" xref="S3.p5.2.m1.2.2.1.1.1.3.1.cmml">â¢</mo><mi id="S3.p5.2.m1.2.2.1.1.1.3.4" xref="S3.p5.2.m1.2.2.1.1.1.3.4.cmml">i</mi></mrow></msub><mo id="S3.p5.2.m1.2.2.1.1.4" stretchy="false" xref="S3.p5.2.m1.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.2.m1.2b"><apply id="S3.p5.2.m1.2.2.cmml" xref="S3.p5.2.m1.2.2"><eq id="S3.p5.2.m1.2.2.2.cmml" xref="S3.p5.2.m1.2.2.2"></eq><ci id="S3.p5.2.m1.2.2.3.cmml" xref="S3.p5.2.m1.2.2.3">ğ‘ </ci><interval closure="closed" id="S3.p5.2.m1.2.2.1.2.cmml" xref="S3.p5.2.m1.2.2.1.1"><ci id="S3.p5.2.m1.1.1.cmml" xref="S3.p5.2.m1.1.1">ğ‘¥</ci><apply id="S3.p5.2.m1.2.2.1.1.1.cmml" xref="S3.p5.2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p5.2.m1.2.2.1.1.1.1.cmml" xref="S3.p5.2.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.p5.2.m1.2.2.1.1.1.2.cmml" xref="S3.p5.2.m1.2.2.1.1.1.2">ğ‘§</ci><apply id="S3.p5.2.m1.2.2.1.1.1.3.cmml" xref="S3.p5.2.m1.2.2.1.1.1.3"><times id="S3.p5.2.m1.2.2.1.1.1.3.1.cmml" xref="S3.p5.2.m1.2.2.1.1.1.3.1"></times><cn id="S3.p5.2.m1.2.2.1.1.1.3.2.cmml" type="integer" xref="S3.p5.2.m1.2.2.1.1.1.3.2">1</cn><ci id="S3.p5.2.m1.2.2.1.1.1.3.3.cmml" xref="S3.p5.2.m1.2.2.1.1.1.3.3">â‹¯</ci><ci id="S3.p5.2.m1.2.2.1.1.1.3.4.cmml" xref="S3.p5.2.m1.2.2.1.1.1.3.4">ğ‘–</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m1.2c">s=[x,z_{1\cdots i}]</annotation><annotation encoding="application/x-llamapun" id="S3.p5.2.m1.2d">italic_s = [ italic_x , italic_z start_POSTSUBSCRIPT 1 â‹¯ italic_i end_POSTSUBSCRIPT ]</annotation></semantics></math>, we consider two strategies to generate <math alttext="k" class="ltx_Math" display="inline" id="S3.p5.3.m2.1"><semantics id="S3.p5.3.m2.1a"><mi id="S3.p5.3.m2.1.1" xref="S3.p5.3.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p5.3.m2.1b"><ci id="S3.p5.3.m2.1.1.cmml" xref="S3.p5.3.m2.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.p5.3.m2.1d">italic_k</annotation></semantics></math> candidates for the next thought step:</p>
<ol class="ltx_enumerate" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(a)</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.1.1">Sample</span> i.i.d.â€‰thoughts from a CoT prompt (Creative Writing, FigureÂ <a class="ltx_ref" href="#S4.F4" title="Figure 4 â€£ 4.2 Creative writing â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>): <math alttext="z^{(j)}\sim p_{\theta}^{CoT}(z_{i+1}|s)=p_{\theta}^{CoT}(z_{i+1}|x,z_{1\cdots i%
})\ (j=1\cdots k)" class="ltx_Math" display="inline" id="S3.I1.i1.p1.1.m1.5"><semantics id="S3.I1.i1.p1.1.m1.5a"><mrow id="S3.I1.i1.p1.1.m1.5.5" xref="S3.I1.i1.p1.1.m1.5.5.cmml"><msup id="S3.I1.i1.p1.1.m1.5.5.5" xref="S3.I1.i1.p1.1.m1.5.5.5.cmml"><mi id="S3.I1.i1.p1.1.m1.5.5.5.2" xref="S3.I1.i1.p1.1.m1.5.5.5.2.cmml">z</mi><mrow id="S3.I1.i1.p1.1.m1.1.1.1.3" xref="S3.I1.i1.p1.1.m1.5.5.5.cmml"><mo id="S3.I1.i1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.I1.i1.p1.1.m1.5.5.5.cmml">(</mo><mi id="S3.I1.i1.p1.1.m1.1.1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.1.1.cmml">j</mi><mo id="S3.I1.i1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.I1.i1.p1.1.m1.5.5.5.cmml">)</mo></mrow></msup><mo id="S3.I1.i1.p1.1.m1.5.5.6" xref="S3.I1.i1.p1.1.m1.5.5.6.cmml">âˆ¼</mo><mrow id="S3.I1.i1.p1.1.m1.3.3.1" xref="S3.I1.i1.p1.1.m1.3.3.1.cmml"><msubsup id="S3.I1.i1.p1.1.m1.3.3.1.3" xref="S3.I1.i1.p1.1.m1.3.3.1.3.cmml"><mi id="S3.I1.i1.p1.1.m1.3.3.1.3.2.2" xref="S3.I1.i1.p1.1.m1.3.3.1.3.2.2.cmml">p</mi><mi id="S3.I1.i1.p1.1.m1.3.3.1.3.2.3" xref="S3.I1.i1.p1.1.m1.3.3.1.3.2.3.cmml">Î¸</mi><mrow id="S3.I1.i1.p1.1.m1.3.3.1.3.3" xref="S3.I1.i1.p1.1.m1.3.3.1.3.3.cmml"><mi id="S3.I1.i1.p1.1.m1.3.3.1.3.3.2" xref="S3.I1.i1.p1.1.m1.3.3.1.3.3.2.cmml">C</mi><mo id="S3.I1.i1.p1.1.m1.3.3.1.3.3.1" xref="S3.I1.i1.p1.1.m1.3.3.1.3.3.1.cmml">â¢</mo><mi id="S3.I1.i1.p1.1.m1.3.3.1.3.3.3" xref="S3.I1.i1.p1.1.m1.3.3.1.3.3.3.cmml">o</mi><mo id="S3.I1.i1.p1.1.m1.3.3.1.3.3.1a" xref="S3.I1.i1.p1.1.m1.3.3.1.3.3.1.cmml">â¢</mo><mi id="S3.I1.i1.p1.1.m1.3.3.1.3.3.4" xref="S3.I1.i1.p1.1.m1.3.3.1.3.3.4.cmml">T</mi></mrow></msubsup><mo id="S3.I1.i1.p1.1.m1.3.3.1.2" xref="S3.I1.i1.p1.1.m1.3.3.1.2.cmml">â¢</mo><mrow id="S3.I1.i1.p1.1.m1.3.3.1.1.1" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.cmml"><mo id="S3.I1.i1.p1.1.m1.3.3.1.1.1.2" stretchy="false" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.cmml"><msub id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.cmml"><mi id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.2" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.2.cmml">z</mi><mrow id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.3" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.3.cmml"><mi id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.3.2" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.3.1" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.3.3" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.1" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.1.cmml">|</mo><mi id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.3" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.3.cmml">s</mi></mrow><mo id="S3.I1.i1.p1.1.m1.3.3.1.1.1.3" stretchy="false" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.I1.i1.p1.1.m1.5.5.7" xref="S3.I1.i1.p1.1.m1.5.5.7.cmml">=</mo><mrow id="S3.I1.i1.p1.1.m1.5.5.3" xref="S3.I1.i1.p1.1.m1.5.5.3.cmml"><msubsup id="S3.I1.i1.p1.1.m1.5.5.3.4" xref="S3.I1.i1.p1.1.m1.5.5.3.4.cmml"><mi id="S3.I1.i1.p1.1.m1.5.5.3.4.2.2" xref="S3.I1.i1.p1.1.m1.5.5.3.4.2.2.cmml">p</mi><mi id="S3.I1.i1.p1.1.m1.5.5.3.4.2.3" xref="S3.I1.i1.p1.1.m1.5.5.3.4.2.3.cmml">Î¸</mi><mrow id="S3.I1.i1.p1.1.m1.5.5.3.4.3" xref="S3.I1.i1.p1.1.m1.5.5.3.4.3.cmml"><mi id="S3.I1.i1.p1.1.m1.5.5.3.4.3.2" xref="S3.I1.i1.p1.1.m1.5.5.3.4.3.2.cmml">C</mi><mo id="S3.I1.i1.p1.1.m1.5.5.3.4.3.1" xref="S3.I1.i1.p1.1.m1.5.5.3.4.3.1.cmml">â¢</mo><mi id="S3.I1.i1.p1.1.m1.5.5.3.4.3.3" xref="S3.I1.i1.p1.1.m1.5.5.3.4.3.3.cmml">o</mi><mo id="S3.I1.i1.p1.1.m1.5.5.3.4.3.1a" xref="S3.I1.i1.p1.1.m1.5.5.3.4.3.1.cmml">â¢</mo><mi id="S3.I1.i1.p1.1.m1.5.5.3.4.3.4" xref="S3.I1.i1.p1.1.m1.5.5.3.4.3.4.cmml">T</mi></mrow></msubsup><mo id="S3.I1.i1.p1.1.m1.5.5.3.3" xref="S3.I1.i1.p1.1.m1.5.5.3.3.cmml">â¢</mo><mrow id="S3.I1.i1.p1.1.m1.4.4.2.1.1" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.cmml"><mo id="S3.I1.i1.p1.1.m1.4.4.2.1.1.2" stretchy="false" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.cmml">(</mo><mrow id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.cmml"><msub id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.cmml"><mi id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.2" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.2.cmml">z</mi><mrow id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.3" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.3.cmml"><mi id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.3.2" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.3.2.cmml">i</mi><mo id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.3.1" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.3.1.cmml">+</mo><mn id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.3.3" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.2" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.2.cmml">|</mo><mrow id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.2.cmml"><mi id="S3.I1.i1.p1.1.m1.2.2" xref="S3.I1.i1.p1.1.m1.2.2.cmml">x</mi><mo id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.2" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.2.cmml">,</mo><msub id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.cmml"><mi id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.2" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.cmml"><mn id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.2" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.1" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.1.cmml">â¢</mo><mi id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.3" mathvariant="normal" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.3.cmml">â‹¯</mi><mo id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.1a" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.1.cmml">â¢</mo><mi id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.4" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.4.cmml">i</mi></mrow></msub></mrow></mrow><mo id="S3.I1.i1.p1.1.m1.4.4.2.1.1.3" stretchy="false" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.cmml">)</mo></mrow><mo id="S3.I1.i1.p1.1.m1.5.5.3.3a" lspace="0.500em" xref="S3.I1.i1.p1.1.m1.5.5.3.3.cmml">â¢</mo><mrow id="S3.I1.i1.p1.1.m1.5.5.3.2.1" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.cmml"><mo id="S3.I1.i1.p1.1.m1.5.5.3.2.1.2" stretchy="false" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.cmml">(</mo><mrow id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.cmml"><mi id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.2" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.2.cmml">j</mi><mo id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.1" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.1.cmml">=</mo><mrow id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.cmml"><mn id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.2" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.2.cmml">1</mn><mo id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.1" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.1.cmml">â¢</mo><mi id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.3" mathvariant="normal" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.3.cmml">â‹¯</mi><mo id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.1a" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.1.cmml">â¢</mo><mi id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.4" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.4.cmml">k</mi></mrow></mrow><mo id="S3.I1.i1.p1.1.m1.5.5.3.2.1.3" stretchy="false" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.5b"><apply id="S3.I1.i1.p1.1.m1.5.5.cmml" xref="S3.I1.i1.p1.1.m1.5.5"><and id="S3.I1.i1.p1.1.m1.5.5a.cmml" xref="S3.I1.i1.p1.1.m1.5.5"></and><apply id="S3.I1.i1.p1.1.m1.5.5b.cmml" xref="S3.I1.i1.p1.1.m1.5.5"><csymbol cd="latexml" id="S3.I1.i1.p1.1.m1.5.5.6.cmml" xref="S3.I1.i1.p1.1.m1.5.5.6">similar-to</csymbol><apply id="S3.I1.i1.p1.1.m1.5.5.5.cmml" xref="S3.I1.i1.p1.1.m1.5.5.5"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.5.5.5.1.cmml" xref="S3.I1.i1.p1.1.m1.5.5.5">superscript</csymbol><ci id="S3.I1.i1.p1.1.m1.5.5.5.2.cmml" xref="S3.I1.i1.p1.1.m1.5.5.5.2">ğ‘§</ci><ci id="S3.I1.i1.p1.1.m1.1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.1.1">ğ‘—</ci></apply><apply id="S3.I1.i1.p1.1.m1.3.3.1.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1"><times id="S3.I1.i1.p1.1.m1.3.3.1.2.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.2"></times><apply id="S3.I1.i1.p1.1.m1.3.3.1.3.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.3.3.1.3.1.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.3">superscript</csymbol><apply id="S3.I1.i1.p1.1.m1.3.3.1.3.2.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.3.3.1.3.2.1.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.3">subscript</csymbol><ci id="S3.I1.i1.p1.1.m1.3.3.1.3.2.2.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.3.2.2">ğ‘</ci><ci id="S3.I1.i1.p1.1.m1.3.3.1.3.2.3.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.3.2.3">ğœƒ</ci></apply><apply id="S3.I1.i1.p1.1.m1.3.3.1.3.3.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.3.3"><times id="S3.I1.i1.p1.1.m1.3.3.1.3.3.1.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.3.3.1"></times><ci id="S3.I1.i1.p1.1.m1.3.3.1.3.3.2.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.3.3.2">ğ¶</ci><ci id="S3.I1.i1.p1.1.m1.3.3.1.3.3.3.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.3.3.3">ğ‘œ</ci><ci id="S3.I1.i1.p1.1.m1.3.3.1.3.3.4.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.3.3.4">ğ‘‡</ci></apply></apply><apply id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1"><csymbol cd="latexml" id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.1">conditional</csymbol><apply id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.2">ğ‘§</ci><apply id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.3"><plus id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.3.1.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.3.1"></plus><ci id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.3.2.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.3.2">ğ‘–</ci><cn id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.3.cmml" xref="S3.I1.i1.p1.1.m1.3.3.1.1.1.1.3">ğ‘ </ci></apply></apply></apply><apply id="S3.I1.i1.p1.1.m1.5.5c.cmml" xref="S3.I1.i1.p1.1.m1.5.5"><eq id="S3.I1.i1.p1.1.m1.5.5.7.cmml" xref="S3.I1.i1.p1.1.m1.5.5.7"></eq><share href="#S3.I1.i1.p1.1.m1.3.3.1.cmml" id="S3.I1.i1.p1.1.m1.5.5d.cmml" xref="S3.I1.i1.p1.1.m1.5.5"></share><apply id="S3.I1.i1.p1.1.m1.5.5.3.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3"><times id="S3.I1.i1.p1.1.m1.5.5.3.3.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.3"></times><apply id="S3.I1.i1.p1.1.m1.5.5.3.4.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.4"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.5.5.3.4.1.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.4">superscript</csymbol><apply id="S3.I1.i1.p1.1.m1.5.5.3.4.2.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.4"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.5.5.3.4.2.1.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.4">subscript</csymbol><ci id="S3.I1.i1.p1.1.m1.5.5.3.4.2.2.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.4.2.2">ğ‘</ci><ci id="S3.I1.i1.p1.1.m1.5.5.3.4.2.3.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.4.2.3">ğœƒ</ci></apply><apply id="S3.I1.i1.p1.1.m1.5.5.3.4.3.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.4.3"><times id="S3.I1.i1.p1.1.m1.5.5.3.4.3.1.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.4.3.1"></times><ci id="S3.I1.i1.p1.1.m1.5.5.3.4.3.2.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.4.3.2">ğ¶</ci><ci id="S3.I1.i1.p1.1.m1.5.5.3.4.3.3.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.4.3.3">ğ‘œ</ci><ci id="S3.I1.i1.p1.1.m1.5.5.3.4.3.4.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.4.3.4">ğ‘‡</ci></apply></apply><apply id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1"><csymbol cd="latexml" id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.2">conditional</csymbol><apply id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.cmml" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.1.cmml" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3">subscript</csymbol><ci id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.2.cmml" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.2">ğ‘§</ci><apply id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.3.cmml" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.3"><plus id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.3.1.cmml" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.3.1"></plus><ci id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.3.2.cmml" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.3.2">ğ‘–</ci><cn id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.3.3.cmml" type="integer" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.3.3.3">1</cn></apply></apply><list id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1"><ci id="S3.I1.i1.p1.1.m1.2.2.cmml" xref="S3.I1.i1.p1.1.m1.2.2">ğ‘¥</ci><apply id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.2">ğ‘§</ci><apply id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.cmml" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3"><times id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.1.cmml" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.1"></times><cn id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.2">1</cn><ci id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.3.cmml" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.3">â‹¯</ci><ci id="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.4.cmml" xref="S3.I1.i1.p1.1.m1.4.4.2.1.1.1.1.1.1.3.4">ğ‘–</ci></apply></apply></list></apply><apply id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1"><eq id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.1"></eq><ci id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.2">ğ‘—</ci><apply id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3"><times id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.1.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.1"></times><cn id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.2.cmml" type="integer" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.2">1</cn><ci id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.3.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.3">â‹¯</ci><ci id="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.4.cmml" xref="S3.I1.i1.p1.1.m1.5.5.3.2.1.1.3.4">ğ‘˜</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.5c">z^{(j)}\sim p_{\theta}^{CoT}(z_{i+1}|s)=p_{\theta}^{CoT}(z_{i+1}|x,z_{1\cdots i%
})\ (j=1\cdots k)</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.1.m1.5d">italic_z start_POSTSUPERSCRIPT ( italic_j ) end_POSTSUPERSCRIPT âˆ¼ italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_C italic_o italic_T end_POSTSUPERSCRIPT ( italic_z start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT | italic_s ) = italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_C italic_o italic_T end_POSTSUPERSCRIPT ( italic_z start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT | italic_x , italic_z start_POSTSUBSCRIPT 1 â‹¯ italic_i end_POSTSUBSCRIPT ) ( italic_j = 1 â‹¯ italic_k )</annotation></semantics></math>. This works better when the thought space is rich (e.g.â€‰each thought is a paragraph), and i.i.d.â€‰samples lead to diversity;
</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(b)</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.1.1">Propose</span> thoughts sequentially using a â€œpropose promptâ€ (Game of 24, FigureÂ <a class="ltx_ref" href="#S4.F2" title="Figure 2 â€£ 4.1 Game of 24 â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>; Crosswords, FigureÂ <a class="ltx_ref" href="#S4.F6" title="Figure 6 â€£ 4.3 Mini crosswords â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>): <math alttext="[z^{(1)},\cdots,z^{(k)}]\sim p_{\theta}^{propose}(z_{i+1}^{(1\cdots k)}\mid s)" class="ltx_Math" display="inline" id="S3.I1.i2.p1.1.m1.7"><semantics id="S3.I1.i2.p1.1.m1.7a"><mrow id="S3.I1.i2.p1.1.m1.7.7" xref="S3.I1.i2.p1.1.m1.7.7.cmml"><mrow id="S3.I1.i2.p1.1.m1.6.6.2.2" xref="S3.I1.i2.p1.1.m1.6.6.2.3.cmml"><mo id="S3.I1.i2.p1.1.m1.6.6.2.2.3" stretchy="false" xref="S3.I1.i2.p1.1.m1.6.6.2.3.cmml">[</mo><msup id="S3.I1.i2.p1.1.m1.5.5.1.1.1" xref="S3.I1.i2.p1.1.m1.5.5.1.1.1.cmml"><mi id="S3.I1.i2.p1.1.m1.5.5.1.1.1.2" xref="S3.I1.i2.p1.1.m1.5.5.1.1.1.2.cmml">z</mi><mrow id="S3.I1.i2.p1.1.m1.1.1.1.3" xref="S3.I1.i2.p1.1.m1.5.5.1.1.1.cmml"><mo id="S3.I1.i2.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.I1.i2.p1.1.m1.5.5.1.1.1.cmml">(</mo><mn id="S3.I1.i2.p1.1.m1.1.1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.1.1.cmml">1</mn><mo id="S3.I1.i2.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.I1.i2.p1.1.m1.5.5.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.I1.i2.p1.1.m1.6.6.2.2.4" xref="S3.I1.i2.p1.1.m1.6.6.2.3.cmml">,</mo><mi id="S3.I1.i2.p1.1.m1.4.4" mathvariant="normal" xref="S3.I1.i2.p1.1.m1.4.4.cmml">â‹¯</mi><mo id="S3.I1.i2.p1.1.m1.6.6.2.2.5" xref="S3.I1.i2.p1.1.m1.6.6.2.3.cmml">,</mo><msup id="S3.I1.i2.p1.1.m1.6.6.2.2.2" xref="S3.I1.i2.p1.1.m1.6.6.2.2.2.cmml"><mi id="S3.I1.i2.p1.1.m1.6.6.2.2.2.2" xref="S3.I1.i2.p1.1.m1.6.6.2.2.2.2.cmml">z</mi><mrow id="S3.I1.i2.p1.1.m1.2.2.1.3" xref="S3.I1.i2.p1.1.m1.6.6.2.2.2.cmml"><mo id="S3.I1.i2.p1.1.m1.2.2.1.3.1" stretchy="false" xref="S3.I1.i2.p1.1.m1.6.6.2.2.2.cmml">(</mo><mi id="S3.I1.i2.p1.1.m1.2.2.1.1" xref="S3.I1.i2.p1.1.m1.2.2.1.1.cmml">k</mi><mo id="S3.I1.i2.p1.1.m1.2.2.1.3.2" stretchy="false" xref="S3.I1.i2.p1.1.m1.6.6.2.2.2.cmml">)</mo></mrow></msup><mo id="S3.I1.i2.p1.1.m1.6.6.2.2.6" stretchy="false" xref="S3.I1.i2.p1.1.m1.6.6.2.3.cmml">]</mo></mrow><mo id="S3.I1.i2.p1.1.m1.7.7.4" xref="S3.I1.i2.p1.1.m1.7.7.4.cmml">âˆ¼</mo><mrow id="S3.I1.i2.p1.1.m1.7.7.3" xref="S3.I1.i2.p1.1.m1.7.7.3.cmml"><msubsup id="S3.I1.i2.p1.1.m1.7.7.3.3" xref="S3.I1.i2.p1.1.m1.7.7.3.3.cmml"><mi id="S3.I1.i2.p1.1.m1.7.7.3.3.2.2" xref="S3.I1.i2.p1.1.m1.7.7.3.3.2.2.cmml">p</mi><mi id="S3.I1.i2.p1.1.m1.7.7.3.3.2.3" xref="S3.I1.i2.p1.1.m1.7.7.3.3.2.3.cmml">Î¸</mi><mrow id="S3.I1.i2.p1.1.m1.7.7.3.3.3" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.cmml"><mi id="S3.I1.i2.p1.1.m1.7.7.3.3.3.2" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.2.cmml">p</mi><mo id="S3.I1.i2.p1.1.m1.7.7.3.3.3.1" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.1.cmml">â¢</mo><mi id="S3.I1.i2.p1.1.m1.7.7.3.3.3.3" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.3.cmml">r</mi><mo id="S3.I1.i2.p1.1.m1.7.7.3.3.3.1a" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.1.cmml">â¢</mo><mi id="S3.I1.i2.p1.1.m1.7.7.3.3.3.4" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.4.cmml">o</mi><mo id="S3.I1.i2.p1.1.m1.7.7.3.3.3.1b" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.1.cmml">â¢</mo><mi id="S3.I1.i2.p1.1.m1.7.7.3.3.3.5" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.5.cmml">p</mi><mo id="S3.I1.i2.p1.1.m1.7.7.3.3.3.1c" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.1.cmml">â¢</mo><mi id="S3.I1.i2.p1.1.m1.7.7.3.3.3.6" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.6.cmml">o</mi><mo id="S3.I1.i2.p1.1.m1.7.7.3.3.3.1d" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.1.cmml">â¢</mo><mi id="S3.I1.i2.p1.1.m1.7.7.3.3.3.7" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.7.cmml">s</mi><mo id="S3.I1.i2.p1.1.m1.7.7.3.3.3.1e" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.1.cmml">â¢</mo><mi id="S3.I1.i2.p1.1.m1.7.7.3.3.3.8" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.8.cmml">e</mi></mrow></msubsup><mo id="S3.I1.i2.p1.1.m1.7.7.3.2" xref="S3.I1.i2.p1.1.m1.7.7.3.2.cmml">â¢</mo><mrow id="S3.I1.i2.p1.1.m1.7.7.3.1.1" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.cmml"><mo id="S3.I1.i2.p1.1.m1.7.7.3.1.1.2" stretchy="false" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.cmml">(</mo><mrow id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.cmml"><msubsup id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.cmml"><mi id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.2" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.2.cmml">z</mi><mrow id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.3" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.3.cmml"><mi id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.3.2" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.3.1" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.3.1.cmml">+</mo><mn id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.3.3" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.I1.i2.p1.1.m1.3.3.1.1" xref="S3.I1.i2.p1.1.m1.3.3.1.1.1.cmml"><mo id="S3.I1.i2.p1.1.m1.3.3.1.1.2" stretchy="false" xref="S3.I1.i2.p1.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.I1.i2.p1.1.m1.3.3.1.1.1" xref="S3.I1.i2.p1.1.m1.3.3.1.1.1.cmml"><mn id="S3.I1.i2.p1.1.m1.3.3.1.1.1.2" xref="S3.I1.i2.p1.1.m1.3.3.1.1.1.2.cmml">1</mn><mo id="S3.I1.i2.p1.1.m1.3.3.1.1.1.1" xref="S3.I1.i2.p1.1.m1.3.3.1.1.1.1.cmml">â¢</mo><mi id="S3.I1.i2.p1.1.m1.3.3.1.1.1.3" mathvariant="normal" xref="S3.I1.i2.p1.1.m1.3.3.1.1.1.3.cmml">â‹¯</mi><mo id="S3.I1.i2.p1.1.m1.3.3.1.1.1.1a" xref="S3.I1.i2.p1.1.m1.3.3.1.1.1.1.cmml">â¢</mo><mi id="S3.I1.i2.p1.1.m1.3.3.1.1.1.4" xref="S3.I1.i2.p1.1.m1.3.3.1.1.1.4.cmml">k</mi></mrow><mo id="S3.I1.i2.p1.1.m1.3.3.1.1.3" stretchy="false" xref="S3.I1.i2.p1.1.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.1" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.1.cmml">âˆ£</mo><mi id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.3" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.3.cmml">s</mi></mrow><mo id="S3.I1.i2.p1.1.m1.7.7.3.1.1.3" stretchy="false" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.7b"><apply id="S3.I1.i2.p1.1.m1.7.7.cmml" xref="S3.I1.i2.p1.1.m1.7.7"><csymbol cd="latexml" id="S3.I1.i2.p1.1.m1.7.7.4.cmml" xref="S3.I1.i2.p1.1.m1.7.7.4">similar-to</csymbol><list id="S3.I1.i2.p1.1.m1.6.6.2.3.cmml" xref="S3.I1.i2.p1.1.m1.6.6.2.2"><apply id="S3.I1.i2.p1.1.m1.5.5.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.5.5.1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.5.5.1.1.1">superscript</csymbol><ci id="S3.I1.i2.p1.1.m1.5.5.1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.5.5.1.1.1.2">ğ‘§</ci><cn id="S3.I1.i2.p1.1.m1.1.1.1.1.cmml" type="integer" xref="S3.I1.i2.p1.1.m1.1.1.1.1">1</cn></apply><ci id="S3.I1.i2.p1.1.m1.4.4.cmml" xref="S3.I1.i2.p1.1.m1.4.4">â‹¯</ci><apply id="S3.I1.i2.p1.1.m1.6.6.2.2.2.cmml" xref="S3.I1.i2.p1.1.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.6.6.2.2.2.1.cmml" xref="S3.I1.i2.p1.1.m1.6.6.2.2.2">superscript</csymbol><ci id="S3.I1.i2.p1.1.m1.6.6.2.2.2.2.cmml" xref="S3.I1.i2.p1.1.m1.6.6.2.2.2.2">ğ‘§</ci><ci id="S3.I1.i2.p1.1.m1.2.2.1.1.cmml" xref="S3.I1.i2.p1.1.m1.2.2.1.1">ğ‘˜</ci></apply></list><apply id="S3.I1.i2.p1.1.m1.7.7.3.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3"><times id="S3.I1.i2.p1.1.m1.7.7.3.2.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.2"></times><apply id="S3.I1.i2.p1.1.m1.7.7.3.3.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.3"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.7.7.3.3.1.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.3">superscript</csymbol><apply id="S3.I1.i2.p1.1.m1.7.7.3.3.2.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.3"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.7.7.3.3.2.1.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.3">subscript</csymbol><ci id="S3.I1.i2.p1.1.m1.7.7.3.3.2.2.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.3.2.2">ğ‘</ci><ci id="S3.I1.i2.p1.1.m1.7.7.3.3.2.3.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.3.2.3">ğœƒ</ci></apply><apply id="S3.I1.i2.p1.1.m1.7.7.3.3.3.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3"><times id="S3.I1.i2.p1.1.m1.7.7.3.3.3.1.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.1"></times><ci id="S3.I1.i2.p1.1.m1.7.7.3.3.3.2.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.2">ğ‘</ci><ci id="S3.I1.i2.p1.1.m1.7.7.3.3.3.3.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.3">ğ‘Ÿ</ci><ci id="S3.I1.i2.p1.1.m1.7.7.3.3.3.4.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.4">ğ‘œ</ci><ci id="S3.I1.i2.p1.1.m1.7.7.3.3.3.5.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.5">ğ‘</ci><ci id="S3.I1.i2.p1.1.m1.7.7.3.3.3.6.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.6">ğ‘œ</ci><ci id="S3.I1.i2.p1.1.m1.7.7.3.3.3.7.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.7">ğ‘ </ci><ci id="S3.I1.i2.p1.1.m1.7.7.3.3.3.8.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.3.3.8">ğ‘’</ci></apply></apply><apply id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1"><csymbol cd="latexml" id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.1">conditional</csymbol><apply id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.1.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2">superscript</csymbol><apply id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.1.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2">subscript</csymbol><ci id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.2.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.2">ğ‘§</ci><apply id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.3.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.3"><plus id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.3.1.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.3.1"></plus><ci id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.3.2.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.3.2">ğ‘–</ci><cn id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.I1.i2.p1.1.m1.3.3.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.3.3.1.1"><times id="S3.I1.i2.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.3.3.1.1.1.1"></times><cn id="S3.I1.i2.p1.1.m1.3.3.1.1.1.2.cmml" type="integer" xref="S3.I1.i2.p1.1.m1.3.3.1.1.1.2">1</cn><ci id="S3.I1.i2.p1.1.m1.3.3.1.1.1.3.cmml" xref="S3.I1.i2.p1.1.m1.3.3.1.1.1.3">â‹¯</ci><ci id="S3.I1.i2.p1.1.m1.3.3.1.1.1.4.cmml" xref="S3.I1.i2.p1.1.m1.3.3.1.1.1.4">ğ‘˜</ci></apply></apply><ci id="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.3.cmml" xref="S3.I1.i2.p1.1.m1.7.7.3.1.1.1.3">ğ‘ </ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.7c">[z^{(1)},\cdots,z^{(k)}]\sim p_{\theta}^{propose}(z_{i+1}^{(1\cdots k)}\mid s)</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.1.m1.7d">[ italic_z start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT , â‹¯ , italic_z start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT ] âˆ¼ italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p italic_r italic_o italic_p italic_o italic_s italic_e end_POSTSUPERSCRIPT ( italic_z start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 â‹¯ italic_k ) end_POSTSUPERSCRIPT âˆ£ italic_s )</annotation></semantics></math>. This works better when the thought space is more constrained (e.g.â€‰each thought is just a word or a line), so proposing different thoughts in the same context avoids duplication.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S3.p6">
<p class="ltx_p" id="S3.p6.1"><span class="ltx_text ltx_font_bold" id="S3.p6.1.1">3.â€‰State evaluator <math alttext="V(p_{\theta},S)" class="ltx_Math" display="inline" id="S3.p6.1.1.m1.2"><semantics id="S3.p6.1.1.m1.2a"><mrow id="S3.p6.1.1.m1.2.2" xref="S3.p6.1.1.m1.2.2.cmml"><mi id="S3.p6.1.1.m1.2.2.3" xref="S3.p6.1.1.m1.2.2.3.cmml">V</mi><mo id="S3.p6.1.1.m1.2.2.2" mathvariant="bold" xref="S3.p6.1.1.m1.2.2.2.cmml">â¢</mo><mrow id="S3.p6.1.1.m1.2.2.1.1" xref="S3.p6.1.1.m1.2.2.1.2.cmml"><mo id="S3.p6.1.1.m1.2.2.1.1.2" mathvariant="normal" stretchy="false" xref="S3.p6.1.1.m1.2.2.1.2.cmml">(</mo><msub id="S3.p6.1.1.m1.2.2.1.1.1" xref="S3.p6.1.1.m1.2.2.1.1.1.cmml"><mi id="S3.p6.1.1.m1.2.2.1.1.1.2" xref="S3.p6.1.1.m1.2.2.1.1.1.2.cmml">p</mi><mi id="S3.p6.1.1.m1.2.2.1.1.1.3" xref="S3.p6.1.1.m1.2.2.1.1.1.3.cmml">Î¸</mi></msub><mo id="S3.p6.1.1.m1.2.2.1.1.3" mathvariant="normal" xref="S3.p6.1.1.m1.2.2.1.2.cmml">,</mo><mi id="S3.p6.1.1.m1.1.1" xref="S3.p6.1.1.m1.1.1.cmml">S</mi><mo id="S3.p6.1.1.m1.2.2.1.1.4" mathvariant="normal" stretchy="false" xref="S3.p6.1.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.1.1.m1.2b"><apply id="S3.p6.1.1.m1.2.2.cmml" xref="S3.p6.1.1.m1.2.2"><times id="S3.p6.1.1.m1.2.2.2.cmml" xref="S3.p6.1.1.m1.2.2.2"></times><ci id="S3.p6.1.1.m1.2.2.3.cmml" xref="S3.p6.1.1.m1.2.2.3">ğ‘‰</ci><interval closure="open" id="S3.p6.1.1.m1.2.2.1.2.cmml" xref="S3.p6.1.1.m1.2.2.1.1"><apply id="S3.p6.1.1.m1.2.2.1.1.1.cmml" xref="S3.p6.1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p6.1.1.m1.2.2.1.1.1.1.cmml" xref="S3.p6.1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.p6.1.1.m1.2.2.1.1.1.2.cmml" xref="S3.p6.1.1.m1.2.2.1.1.1.2">ğ‘</ci><ci id="S3.p6.1.1.m1.2.2.1.1.1.3.cmml" xref="S3.p6.1.1.m1.2.2.1.1.1.3">ğœƒ</ci></apply><ci id="S3.p6.1.1.m1.1.1.cmml" xref="S3.p6.1.1.m1.1.1">ğ‘†</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.1.1.m1.2c">V(p_{\theta},S)</annotation><annotation encoding="application/x-llamapun" id="S3.p6.1.1.m1.2d">italic_V ( italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT , italic_S )</annotation></semantics></math>.</span>
Given a frontier of different states, the state evaluator evaluates the progress they make towards solving the problem, serving as a <span class="ltx_text ltx_font_italic" id="S3.p6.1.2">heuristic</span> for the search algorithm to determine which states to keep exploring and in which order. While heuristics are a standard approach to solving search problems, they are typically either programmed (e.g.â€‰DeepBlueÂ <cite class="ltx_cite ltx_citemacro_citep">(Campbell etÂ al., <a class="ltx_ref" href="#bib.bib3" title="">2002</a>)</cite>) or learned (e.g.â€‰AlphaGoÂ <cite class="ltx_cite ltx_citemacro_cite">Silver etÂ al. (<a class="ltx_ref" href="#bib.bib29" title="">2017</a>)</cite>). We propose a third alternative, by using the LM to deliberately reason about states. When applicable, such a deliberate heuristic can be more flexible than programmed rules, and more sample-efficient than learned models.
Similar to the thought generator, we consider two strategies to evaluate states either independently or together:
</p>
<ol class="ltx_enumerate" id="S3.I2">
<li class="ltx_item" id="S3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(a)</span>
<div class="ltx_para" id="S3.I2.i1.p1">
<p class="ltx_p" id="S3.I2.i1.p1.3"><span class="ltx_text ltx_font_bold" id="S3.I2.i1.p1.3.1">Value</span> each state independently: <math alttext="V(p_{\theta},S)(s)\sim p_{\theta}^{value}(v|s)\ \forall s\in S" class="ltx_Math" display="inline" id="S3.I2.i1.p1.1.m1.4"><semantics id="S3.I2.i1.p1.1.m1.4a"><mrow id="S3.I2.i1.p1.1.m1.4.4" xref="S3.I2.i1.p1.1.m1.4.4.cmml"><mrow id="S3.I2.i1.p1.1.m1.3.3.1" xref="S3.I2.i1.p1.1.m1.3.3.1.cmml"><mi id="S3.I2.i1.p1.1.m1.3.3.1.3" xref="S3.I2.i1.p1.1.m1.3.3.1.3.cmml">V</mi><mo id="S3.I2.i1.p1.1.m1.3.3.1.2" xref="S3.I2.i1.p1.1.m1.3.3.1.2.cmml">â¢</mo><mrow id="S3.I2.i1.p1.1.m1.3.3.1.1.1" xref="S3.I2.i1.p1.1.m1.3.3.1.1.2.cmml"><mo id="S3.I2.i1.p1.1.m1.3.3.1.1.1.2" stretchy="false" xref="S3.I2.i1.p1.1.m1.3.3.1.1.2.cmml">(</mo><msub id="S3.I2.i1.p1.1.m1.3.3.1.1.1.1" xref="S3.I2.i1.p1.1.m1.3.3.1.1.1.1.cmml"><mi id="S3.I2.i1.p1.1.m1.3.3.1.1.1.1.2" xref="S3.I2.i1.p1.1.m1.3.3.1.1.1.1.2.cmml">p</mi><mi id="S3.I2.i1.p1.1.m1.3.3.1.1.1.1.3" xref="S3.I2.i1.p1.1.m1.3.3.1.1.1.1.3.cmml">Î¸</mi></msub><mo id="S3.I2.i1.p1.1.m1.3.3.1.1.1.3" xref="S3.I2.i1.p1.1.m1.3.3.1.1.2.cmml">,</mo><mi id="S3.I2.i1.p1.1.m1.1.1" xref="S3.I2.i1.p1.1.m1.1.1.cmml">S</mi><mo id="S3.I2.i1.p1.1.m1.3.3.1.1.1.4" stretchy="false" xref="S3.I2.i1.p1.1.m1.3.3.1.1.2.cmml">)</mo></mrow><mo id="S3.I2.i1.p1.1.m1.3.3.1.2a" xref="S3.I2.i1.p1.1.m1.3.3.1.2.cmml">â¢</mo><mrow id="S3.I2.i1.p1.1.m1.3.3.1.4.2" xref="S3.I2.i1.p1.1.m1.3.3.1.cmml"><mo id="S3.I2.i1.p1.1.m1.3.3.1.4.2.1" stretchy="false" xref="S3.I2.i1.p1.1.m1.3.3.1.cmml">(</mo><mi id="S3.I2.i1.p1.1.m1.2.2" xref="S3.I2.i1.p1.1.m1.2.2.cmml">s</mi><mo id="S3.I2.i1.p1.1.m1.3.3.1.4.2.2" stretchy="false" xref="S3.I2.i1.p1.1.m1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.I2.i1.p1.1.m1.4.4.4" xref="S3.I2.i1.p1.1.m1.4.4.4.cmml">âˆ¼</mo><mrow id="S3.I2.i1.p1.1.m1.4.4.2" xref="S3.I2.i1.p1.1.m1.4.4.2.cmml"><msubsup id="S3.I2.i1.p1.1.m1.4.4.2.3" xref="S3.I2.i1.p1.1.m1.4.4.2.3.cmml"><mi id="S3.I2.i1.p1.1.m1.4.4.2.3.2.2" xref="S3.I2.i1.p1.1.m1.4.4.2.3.2.2.cmml">p</mi><mi id="S3.I2.i1.p1.1.m1.4.4.2.3.2.3" xref="S3.I2.i1.p1.1.m1.4.4.2.3.2.3.cmml">Î¸</mi><mrow id="S3.I2.i1.p1.1.m1.4.4.2.3.3" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3.cmml"><mi id="S3.I2.i1.p1.1.m1.4.4.2.3.3.2" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3.2.cmml">v</mi><mo id="S3.I2.i1.p1.1.m1.4.4.2.3.3.1" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3.1.cmml">â¢</mo><mi id="S3.I2.i1.p1.1.m1.4.4.2.3.3.3" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3.3.cmml">a</mi><mo id="S3.I2.i1.p1.1.m1.4.4.2.3.3.1a" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3.1.cmml">â¢</mo><mi id="S3.I2.i1.p1.1.m1.4.4.2.3.3.4" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3.4.cmml">l</mi><mo id="S3.I2.i1.p1.1.m1.4.4.2.3.3.1b" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3.1.cmml">â¢</mo><mi id="S3.I2.i1.p1.1.m1.4.4.2.3.3.5" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3.5.cmml">u</mi><mo id="S3.I2.i1.p1.1.m1.4.4.2.3.3.1c" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3.1.cmml">â¢</mo><mi id="S3.I2.i1.p1.1.m1.4.4.2.3.3.6" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3.6.cmml">e</mi></mrow></msubsup><mo id="S3.I2.i1.p1.1.m1.4.4.2.2" xref="S3.I2.i1.p1.1.m1.4.4.2.2.cmml">â¢</mo><mrow id="S3.I2.i1.p1.1.m1.4.4.2.1.1" xref="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.cmml"><mo id="S3.I2.i1.p1.1.m1.4.4.2.1.1.2" stretchy="false" xref="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.cmml">(</mo><mrow id="S3.I2.i1.p1.1.m1.4.4.2.1.1.1" xref="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.cmml"><mi id="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.2" xref="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.2.cmml">v</mi><mo fence="false" id="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.1" xref="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.1.cmml">|</mo><mi id="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.3" xref="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.3.cmml">s</mi></mrow><mo id="S3.I2.i1.p1.1.m1.4.4.2.1.1.3" stretchy="false" xref="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.cmml">)</mo></mrow><mo id="S3.I2.i1.p1.1.m1.4.4.2.2a" lspace="0.667em" xref="S3.I2.i1.p1.1.m1.4.4.2.2.cmml">â¢</mo><mrow id="S3.I2.i1.p1.1.m1.4.4.2.4" xref="S3.I2.i1.p1.1.m1.4.4.2.4.cmml"><mo id="S3.I2.i1.p1.1.m1.4.4.2.4.1" rspace="0.167em" xref="S3.I2.i1.p1.1.m1.4.4.2.4.1.cmml">âˆ€</mo><mi id="S3.I2.i1.p1.1.m1.4.4.2.4.2" xref="S3.I2.i1.p1.1.m1.4.4.2.4.2.cmml">s</mi></mrow></mrow><mo id="S3.I2.i1.p1.1.m1.4.4.5" xref="S3.I2.i1.p1.1.m1.4.4.5.cmml">âˆˆ</mo><mi id="S3.I2.i1.p1.1.m1.4.4.6" xref="S3.I2.i1.p1.1.m1.4.4.6.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.1.m1.4b"><apply id="S3.I2.i1.p1.1.m1.4.4.cmml" xref="S3.I2.i1.p1.1.m1.4.4"><and id="S3.I2.i1.p1.1.m1.4.4a.cmml" xref="S3.I2.i1.p1.1.m1.4.4"></and><apply id="S3.I2.i1.p1.1.m1.4.4b.cmml" xref="S3.I2.i1.p1.1.m1.4.4"><csymbol cd="latexml" id="S3.I2.i1.p1.1.m1.4.4.4.cmml" xref="S3.I2.i1.p1.1.m1.4.4.4">similar-to</csymbol><apply id="S3.I2.i1.p1.1.m1.3.3.1.cmml" xref="S3.I2.i1.p1.1.m1.3.3.1"><times id="S3.I2.i1.p1.1.m1.3.3.1.2.cmml" xref="S3.I2.i1.p1.1.m1.3.3.1.2"></times><ci id="S3.I2.i1.p1.1.m1.3.3.1.3.cmml" xref="S3.I2.i1.p1.1.m1.3.3.1.3">ğ‘‰</ci><interval closure="open" id="S3.I2.i1.p1.1.m1.3.3.1.1.2.cmml" xref="S3.I2.i1.p1.1.m1.3.3.1.1.1"><apply id="S3.I2.i1.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.I2.i1.p1.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S3.I2.i1.p1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.I2.i1.p1.1.m1.3.3.1.1.1.1.2">ğ‘</ci><ci id="S3.I2.i1.p1.1.m1.3.3.1.1.1.1.3.cmml" xref="S3.I2.i1.p1.1.m1.3.3.1.1.1.1.3">ğœƒ</ci></apply><ci id="S3.I2.i1.p1.1.m1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1">ğ‘†</ci></interval><ci id="S3.I2.i1.p1.1.m1.2.2.cmml" xref="S3.I2.i1.p1.1.m1.2.2">ğ‘ </ci></apply><apply id="S3.I2.i1.p1.1.m1.4.4.2.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2"><times id="S3.I2.i1.p1.1.m1.4.4.2.2.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.2"></times><apply id="S3.I2.i1.p1.1.m1.4.4.2.3.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.I2.i1.p1.1.m1.4.4.2.3.1.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.3">superscript</csymbol><apply id="S3.I2.i1.p1.1.m1.4.4.2.3.2.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.I2.i1.p1.1.m1.4.4.2.3.2.1.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.3">subscript</csymbol><ci id="S3.I2.i1.p1.1.m1.4.4.2.3.2.2.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.3.2.2">ğ‘</ci><ci id="S3.I2.i1.p1.1.m1.4.4.2.3.2.3.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.3.2.3">ğœƒ</ci></apply><apply id="S3.I2.i1.p1.1.m1.4.4.2.3.3.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3"><times id="S3.I2.i1.p1.1.m1.4.4.2.3.3.1.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3.1"></times><ci id="S3.I2.i1.p1.1.m1.4.4.2.3.3.2.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3.2">ğ‘£</ci><ci id="S3.I2.i1.p1.1.m1.4.4.2.3.3.3.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3.3">ğ‘</ci><ci id="S3.I2.i1.p1.1.m1.4.4.2.3.3.4.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3.4">ğ‘™</ci><ci id="S3.I2.i1.p1.1.m1.4.4.2.3.3.5.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3.5">ğ‘¢</ci><ci id="S3.I2.i1.p1.1.m1.4.4.2.3.3.6.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.3.3.6">ğ‘’</ci></apply></apply><apply id="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.1.1"><csymbol cd="latexml" id="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.1">conditional</csymbol><ci id="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.2.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.2">ğ‘£</ci><ci id="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.3.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.1.1.1.3">ğ‘ </ci></apply><apply id="S3.I2.i1.p1.1.m1.4.4.2.4.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.4"><csymbol cd="latexml" id="S3.I2.i1.p1.1.m1.4.4.2.4.1.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.4.1">for-all</csymbol><ci id="S3.I2.i1.p1.1.m1.4.4.2.4.2.cmml" xref="S3.I2.i1.p1.1.m1.4.4.2.4.2">ğ‘ </ci></apply></apply></apply><apply id="S3.I2.i1.p1.1.m1.4.4c.cmml" xref="S3.I2.i1.p1.1.m1.4.4"><in id="S3.I2.i1.p1.1.m1.4.4.5.cmml" xref="S3.I2.i1.p1.1.m1.4.4.5"></in><share href="#S3.I2.i1.p1.1.m1.4.4.2.cmml" id="S3.I2.i1.p1.1.m1.4.4d.cmml" xref="S3.I2.i1.p1.1.m1.4.4"></share><ci id="S3.I2.i1.p1.1.m1.4.4.6.cmml" xref="S3.I2.i1.p1.1.m1.4.4.6">ğ‘†</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.1.m1.4c">V(p_{\theta},S)(s)\sim p_{\theta}^{value}(v|s)\ \forall s\in S</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.1.m1.4d">italic_V ( italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT , italic_S ) ( italic_s ) âˆ¼ italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_v italic_a italic_l italic_u italic_e end_POSTSUPERSCRIPT ( italic_v | italic_s ) âˆ€ italic_s âˆˆ italic_S</annotation></semantics></math>, where a value prompt reasons about the state <math alttext="s" class="ltx_Math" display="inline" id="S3.I2.i1.p1.2.m2.1"><semantics id="S3.I2.i1.p1.2.m2.1a"><mi id="S3.I2.i1.p1.2.m2.1.1" xref="S3.I2.i1.p1.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.2.m2.1b"><ci id="S3.I2.i1.p1.2.m2.1.1.cmml" xref="S3.I2.i1.p1.2.m2.1.1">ğ‘ </ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.2.m2.1d">italic_s</annotation></semantics></math> to generate a scalar value <math alttext="v" class="ltx_Math" display="inline" id="S3.I2.i1.p1.3.m3.1"><semantics id="S3.I2.i1.p1.3.m3.1a"><mi id="S3.I2.i1.p1.3.m3.1.1" xref="S3.I2.i1.p1.3.m3.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.3.m3.1b"><ci id="S3.I2.i1.p1.3.m3.1.1.cmml" xref="S3.I2.i1.p1.3.m3.1.1">ğ‘£</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.3.m3.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.3.m3.1d">italic_v</annotation></semantics></math> (e.g.â€‰1-10) or a classification (e.g.â€‰sure/likely/impossible) that could be heuristically turned into a value. The basis of such evaluative reasoning can vary across problems and thought steps. In this work, we explore evaluation via few <span class="ltx_text ltx_font_italic" id="S3.I2.i1.p1.3.2">lookahead</span> simulations (e.g.â€‰quickly confirm that 5, 5, 14 can reach 24 via 5 + 5 + 14, or â€œhot_lâ€ can mean â€œinnâ€ via filling â€œeâ€ in â€œ_â€) plus commonsense (e.g.â€‰1 2 3 are too small to reach 24, or no word can start with â€œtzxcâ€). While the former might promote â€œgoodâ€ states, the latter could help eliminate â€œbadâ€ states. Such valuations do not need to be perfect, and only need to be approximately helpful for decision making.
</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(b)</span>
<div class="ltx_para" id="S3.I2.i2.p1">
<p class="ltx_p" id="S3.I2.i2.p1.3"><span class="ltx_text ltx_font_bold" id="S3.I2.i2.p1.3.1">Vote</span> across states: <math alttext="V(p_{\theta},S)(s)=\mathds{1}[s=s^{*}]" class="ltx_Math" display="inline" id="S3.I2.i2.p1.1.m1.4"><semantics id="S3.I2.i2.p1.1.m1.4a"><mrow id="S3.I2.i2.p1.1.m1.4.4" xref="S3.I2.i2.p1.1.m1.4.4.cmml"><mrow id="S3.I2.i2.p1.1.m1.3.3.1" xref="S3.I2.i2.p1.1.m1.3.3.1.cmml"><mi id="S3.I2.i2.p1.1.m1.3.3.1.3" xref="S3.I2.i2.p1.1.m1.3.3.1.3.cmml">V</mi><mo id="S3.I2.i2.p1.1.m1.3.3.1.2" xref="S3.I2.i2.p1.1.m1.3.3.1.2.cmml">â¢</mo><mrow id="S3.I2.i2.p1.1.m1.3.3.1.1.1" xref="S3.I2.i2.p1.1.m1.3.3.1.1.2.cmml"><mo id="S3.I2.i2.p1.1.m1.3.3.1.1.1.2" stretchy="false" xref="S3.I2.i2.p1.1.m1.3.3.1.1.2.cmml">(</mo><msub id="S3.I2.i2.p1.1.m1.3.3.1.1.1.1" xref="S3.I2.i2.p1.1.m1.3.3.1.1.1.1.cmml"><mi id="S3.I2.i2.p1.1.m1.3.3.1.1.1.1.2" xref="S3.I2.i2.p1.1.m1.3.3.1.1.1.1.2.cmml">p</mi><mi id="S3.I2.i2.p1.1.m1.3.3.1.1.1.1.3" xref="S3.I2.i2.p1.1.m1.3.3.1.1.1.1.3.cmml">Î¸</mi></msub><mo id="S3.I2.i2.p1.1.m1.3.3.1.1.1.3" xref="S3.I2.i2.p1.1.m1.3.3.1.1.2.cmml">,</mo><mi id="S3.I2.i2.p1.1.m1.1.1" xref="S3.I2.i2.p1.1.m1.1.1.cmml">S</mi><mo id="S3.I2.i2.p1.1.m1.3.3.1.1.1.4" stretchy="false" xref="S3.I2.i2.p1.1.m1.3.3.1.1.2.cmml">)</mo></mrow><mo id="S3.I2.i2.p1.1.m1.3.3.1.2a" xref="S3.I2.i2.p1.1.m1.3.3.1.2.cmml">â¢</mo><mrow id="S3.I2.i2.p1.1.m1.3.3.1.4.2" xref="S3.I2.i2.p1.1.m1.3.3.1.cmml"><mo id="S3.I2.i2.p1.1.m1.3.3.1.4.2.1" stretchy="false" xref="S3.I2.i2.p1.1.m1.3.3.1.cmml">(</mo><mi id="S3.I2.i2.p1.1.m1.2.2" xref="S3.I2.i2.p1.1.m1.2.2.cmml">s</mi><mo id="S3.I2.i2.p1.1.m1.3.3.1.4.2.2" stretchy="false" xref="S3.I2.i2.p1.1.m1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.I2.i2.p1.1.m1.4.4.3" xref="S3.I2.i2.p1.1.m1.4.4.3.cmml">=</mo><mrow id="S3.I2.i2.p1.1.m1.4.4.2" xref="S3.I2.i2.p1.1.m1.4.4.2.cmml"><mn id="S3.I2.i2.p1.1.m1.4.4.2.3" xref="S3.I2.i2.p1.1.m1.4.4.2.3.cmml">ğŸ™</mn><mo id="S3.I2.i2.p1.1.m1.4.4.2.2" xref="S3.I2.i2.p1.1.m1.4.4.2.2.cmml">â¢</mo><mrow id="S3.I2.i2.p1.1.m1.4.4.2.1.1" xref="S3.I2.i2.p1.1.m1.4.4.2.1.2.cmml"><mo id="S3.I2.i2.p1.1.m1.4.4.2.1.1.2" stretchy="false" xref="S3.I2.i2.p1.1.m1.4.4.2.1.2.1.cmml">[</mo><mrow id="S3.I2.i2.p1.1.m1.4.4.2.1.1.1" xref="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.cmml"><mi id="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.2" xref="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.2.cmml">s</mi><mo id="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.1" xref="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.1.cmml">=</mo><msup id="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.3" xref="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.3.cmml"><mi id="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.3.2" xref="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.3.2.cmml">s</mi><mo id="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.3.3" xref="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.3.3.cmml">*</mo></msup></mrow><mo id="S3.I2.i2.p1.1.m1.4.4.2.1.1.3" stretchy="false" xref="S3.I2.i2.p1.1.m1.4.4.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.1.m1.4b"><apply id="S3.I2.i2.p1.1.m1.4.4.cmml" xref="S3.I2.i2.p1.1.m1.4.4"><eq id="S3.I2.i2.p1.1.m1.4.4.3.cmml" xref="S3.I2.i2.p1.1.m1.4.4.3"></eq><apply id="S3.I2.i2.p1.1.m1.3.3.1.cmml" xref="S3.I2.i2.p1.1.m1.3.3.1"><times id="S3.I2.i2.p1.1.m1.3.3.1.2.cmml" xref="S3.I2.i2.p1.1.m1.3.3.1.2"></times><ci id="S3.I2.i2.p1.1.m1.3.3.1.3.cmml" xref="S3.I2.i2.p1.1.m1.3.3.1.3">ğ‘‰</ci><interval closure="open" id="S3.I2.i2.p1.1.m1.3.3.1.1.2.cmml" xref="S3.I2.i2.p1.1.m1.3.3.1.1.1"><apply id="S3.I2.i2.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.I2.i2.p1.1.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.I2.i2.p1.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.I2.i2.p1.1.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S3.I2.i2.p1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.I2.i2.p1.1.m1.3.3.1.1.1.1.2">ğ‘</ci><ci id="S3.I2.i2.p1.1.m1.3.3.1.1.1.1.3.cmml" xref="S3.I2.i2.p1.1.m1.3.3.1.1.1.1.3">ğœƒ</ci></apply><ci id="S3.I2.i2.p1.1.m1.1.1.cmml" xref="S3.I2.i2.p1.1.m1.1.1">ğ‘†</ci></interval><ci id="S3.I2.i2.p1.1.m1.2.2.cmml" xref="S3.I2.i2.p1.1.m1.2.2">ğ‘ </ci></apply><apply id="S3.I2.i2.p1.1.m1.4.4.2.cmml" xref="S3.I2.i2.p1.1.m1.4.4.2"><times id="S3.I2.i2.p1.1.m1.4.4.2.2.cmml" xref="S3.I2.i2.p1.1.m1.4.4.2.2"></times><cn id="S3.I2.i2.p1.1.m1.4.4.2.3.cmml" type="integer" xref="S3.I2.i2.p1.1.m1.4.4.2.3">1</cn><apply id="S3.I2.i2.p1.1.m1.4.4.2.1.2.cmml" xref="S3.I2.i2.p1.1.m1.4.4.2.1.1"><csymbol cd="latexml" id="S3.I2.i2.p1.1.m1.4.4.2.1.2.1.cmml" xref="S3.I2.i2.p1.1.m1.4.4.2.1.1.2">delimited-[]</csymbol><apply id="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.cmml" xref="S3.I2.i2.p1.1.m1.4.4.2.1.1.1"><eq id="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.1.cmml" xref="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.1"></eq><ci id="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.2.cmml" xref="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.2">ğ‘ </ci><apply id="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.3.cmml" xref="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.3.1.cmml" xref="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.3">superscript</csymbol><ci id="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.3.2.cmml" xref="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.3.2">ğ‘ </ci><times id="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.3.3.cmml" xref="S3.I2.i2.p1.1.m1.4.4.2.1.1.1.3.3"></times></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.1.m1.4c">V(p_{\theta},S)(s)=\mathds{1}[s=s^{*}]</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.1.m1.4d">italic_V ( italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT , italic_S ) ( italic_s ) = blackboard_1 [ italic_s = italic_s start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT ]</annotation></semantics></math>, where a â€œgoodâ€ state <math alttext="s^{*}\sim p_{\theta}^{vote}(s^{*}|S)" class="ltx_Math" display="inline" id="S3.I2.i2.p1.2.m2.1"><semantics id="S3.I2.i2.p1.2.m2.1a"><mrow id="S3.I2.i2.p1.2.m2.1.1" xref="S3.I2.i2.p1.2.m2.1.1.cmml"><msup id="S3.I2.i2.p1.2.m2.1.1.3" xref="S3.I2.i2.p1.2.m2.1.1.3.cmml"><mi id="S3.I2.i2.p1.2.m2.1.1.3.2" xref="S3.I2.i2.p1.2.m2.1.1.3.2.cmml">s</mi><mo id="S3.I2.i2.p1.2.m2.1.1.3.3" xref="S3.I2.i2.p1.2.m2.1.1.3.3.cmml">*</mo></msup><mo id="S3.I2.i2.p1.2.m2.1.1.2" xref="S3.I2.i2.p1.2.m2.1.1.2.cmml">âˆ¼</mo><mrow id="S3.I2.i2.p1.2.m2.1.1.1" xref="S3.I2.i2.p1.2.m2.1.1.1.cmml"><msubsup id="S3.I2.i2.p1.2.m2.1.1.1.3" xref="S3.I2.i2.p1.2.m2.1.1.1.3.cmml"><mi id="S3.I2.i2.p1.2.m2.1.1.1.3.2.2" xref="S3.I2.i2.p1.2.m2.1.1.1.3.2.2.cmml">p</mi><mi id="S3.I2.i2.p1.2.m2.1.1.1.3.2.3" xref="S3.I2.i2.p1.2.m2.1.1.1.3.2.3.cmml">Î¸</mi><mrow id="S3.I2.i2.p1.2.m2.1.1.1.3.3" xref="S3.I2.i2.p1.2.m2.1.1.1.3.3.cmml"><mi id="S3.I2.i2.p1.2.m2.1.1.1.3.3.2" xref="S3.I2.i2.p1.2.m2.1.1.1.3.3.2.cmml">v</mi><mo id="S3.I2.i2.p1.2.m2.1.1.1.3.3.1" xref="S3.I2.i2.p1.2.m2.1.1.1.3.3.1.cmml">â¢</mo><mi id="S3.I2.i2.p1.2.m2.1.1.1.3.3.3" xref="S3.I2.i2.p1.2.m2.1.1.1.3.3.3.cmml">o</mi><mo id="S3.I2.i2.p1.2.m2.1.1.1.3.3.1a" xref="S3.I2.i2.p1.2.m2.1.1.1.3.3.1.cmml">â¢</mo><mi id="S3.I2.i2.p1.2.m2.1.1.1.3.3.4" xref="S3.I2.i2.p1.2.m2.1.1.1.3.3.4.cmml">t</mi><mo id="S3.I2.i2.p1.2.m2.1.1.1.3.3.1b" xref="S3.I2.i2.p1.2.m2.1.1.1.3.3.1.cmml">â¢</mo><mi id="S3.I2.i2.p1.2.m2.1.1.1.3.3.5" xref="S3.I2.i2.p1.2.m2.1.1.1.3.3.5.cmml">e</mi></mrow></msubsup><mo id="S3.I2.i2.p1.2.m2.1.1.1.2" xref="S3.I2.i2.p1.2.m2.1.1.1.2.cmml">â¢</mo><mrow id="S3.I2.i2.p1.2.m2.1.1.1.1.1" xref="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.cmml"><mo id="S3.I2.i2.p1.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.I2.i2.p1.2.m2.1.1.1.1.1.1" xref="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.cmml"><msup id="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.2" xref="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.2.cmml"><mi id="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.2.2" xref="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.2.2.cmml">s</mi><mo id="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.2.3" xref="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.2.3.cmml">*</mo></msup><mo fence="false" id="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.1" xref="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.3" xref="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.3.cmml">S</mi></mrow><mo id="S3.I2.i2.p1.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.2.m2.1b"><apply id="S3.I2.i2.p1.2.m2.1.1.cmml" xref="S3.I2.i2.p1.2.m2.1.1"><csymbol cd="latexml" id="S3.I2.i2.p1.2.m2.1.1.2.cmml" xref="S3.I2.i2.p1.2.m2.1.1.2">similar-to</csymbol><apply id="S3.I2.i2.p1.2.m2.1.1.3.cmml" xref="S3.I2.i2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.I2.i2.p1.2.m2.1.1.3.1.cmml" xref="S3.I2.i2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.I2.i2.p1.2.m2.1.1.3.2.cmml" xref="S3.I2.i2.p1.2.m2.1.1.3.2">ğ‘ </ci><times id="S3.I2.i2.p1.2.m2.1.1.3.3.cmml" xref="S3.I2.i2.p1.2.m2.1.1.3.3"></times></apply><apply id="S3.I2.i2.p1.2.m2.1.1.1.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1"><times id="S3.I2.i2.p1.2.m2.1.1.1.2.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.2"></times><apply id="S3.I2.i2.p1.2.m2.1.1.1.3.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.I2.i2.p1.2.m2.1.1.1.3.1.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.3">superscript</csymbol><apply id="S3.I2.i2.p1.2.m2.1.1.1.3.2.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.I2.i2.p1.2.m2.1.1.1.3.2.1.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.3">subscript</csymbol><ci id="S3.I2.i2.p1.2.m2.1.1.1.3.2.2.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.3.2.2">ğ‘</ci><ci id="S3.I2.i2.p1.2.m2.1.1.1.3.2.3.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.3.2.3">ğœƒ</ci></apply><apply id="S3.I2.i2.p1.2.m2.1.1.1.3.3.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.3.3"><times id="S3.I2.i2.p1.2.m2.1.1.1.3.3.1.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.3.3.1"></times><ci id="S3.I2.i2.p1.2.m2.1.1.1.3.3.2.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.3.3.2">ğ‘£</ci><ci id="S3.I2.i2.p1.2.m2.1.1.1.3.3.3.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.3.3.3">ğ‘œ</ci><ci id="S3.I2.i2.p1.2.m2.1.1.1.3.3.4.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.3.3.4">ğ‘¡</ci><ci id="S3.I2.i2.p1.2.m2.1.1.1.3.3.5.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.3.3.5">ğ‘’</ci></apply></apply><apply id="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.2.2.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.2.2">ğ‘ </ci><times id="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.2.3.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.2.3"></times></apply><ci id="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.I2.i2.p1.2.m2.1.1.1.1.1.1.3">ğ‘†</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.2.m2.1c">s^{*}\sim p_{\theta}^{vote}(s^{*}|S)</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.2.m2.1d">italic_s start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT âˆ¼ italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_v italic_o italic_t italic_e end_POSTSUPERSCRIPT ( italic_s start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT | italic_S )</annotation></semantics></math> is voted out based on deliberately comparing different states in <math alttext="S" class="ltx_Math" display="inline" id="S3.I2.i2.p1.3.m3.1"><semantics id="S3.I2.i2.p1.3.m3.1a"><mi id="S3.I2.i2.p1.3.m3.1.1" xref="S3.I2.i2.p1.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.3.m3.1b"><ci id="S3.I2.i2.p1.3.m3.1.1.cmml" xref="S3.I2.i2.p1.3.m3.1.1">ğ‘†</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.3.m3.1d">italic_S</annotation></semantics></math> in a vote prompt.
When problem success is harder to directly value (e.g.â€‰passage coherency), it is natural to to instead compare different partial solutions and vote for the most promising one. This is similar in spirit to a â€œstep-wiseâ€ self-consistency strategy, i.e.â€‰cast â€œwhich state to exploreâ€ as a multi-choice QA, and use LM samples to vote for it.</p>
</div>
</li>
</ol>
<p class="ltx_p" id="S3.p6.2">For both strategies, we could prompt the LM multiple times to aggregate the value or vote results to trade time/resource/cost for more faithful/robust heuristics.</p>
</div>
<figure class="ltx_figure" id="S3.fig1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_float ltx_minipage ltx_flex_size_2 ltx_align_middle ltx_framed_top" id="alg1" style="width:216.8pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.4.1.1">Algorithm 1</span> </span> ToT-BFS(<math alttext="x,p_{\theta},G,k,V,T,b" class="ltx_Math" display="inline" id="alg1.2.m1.7"><semantics id="alg1.2.m1.7b"><mrow id="alg1.2.m1.7.7.1" xref="alg1.2.m1.7.7.2.cmml"><mi id="alg1.2.m1.1.1" xref="alg1.2.m1.1.1.cmml">x</mi><mo id="alg1.2.m1.7.7.1.2" xref="alg1.2.m1.7.7.2.cmml">,</mo><msub id="alg1.2.m1.7.7.1.1" xref="alg1.2.m1.7.7.1.1.cmml"><mi id="alg1.2.m1.7.7.1.1.2" xref="alg1.2.m1.7.7.1.1.2.cmml">p</mi><mi id="alg1.2.m1.7.7.1.1.3" xref="alg1.2.m1.7.7.1.1.3.cmml">Î¸</mi></msub><mo id="alg1.2.m1.7.7.1.3" xref="alg1.2.m1.7.7.2.cmml">,</mo><mi id="alg1.2.m1.2.2" xref="alg1.2.m1.2.2.cmml">G</mi><mo id="alg1.2.m1.7.7.1.4" xref="alg1.2.m1.7.7.2.cmml">,</mo><mi id="alg1.2.m1.3.3" xref="alg1.2.m1.3.3.cmml">k</mi><mo id="alg1.2.m1.7.7.1.5" xref="alg1.2.m1.7.7.2.cmml">,</mo><mi id="alg1.2.m1.4.4" xref="alg1.2.m1.4.4.cmml">V</mi><mo id="alg1.2.m1.7.7.1.6" xref="alg1.2.m1.7.7.2.cmml">,</mo><mi id="alg1.2.m1.5.5" xref="alg1.2.m1.5.5.cmml">T</mi><mo id="alg1.2.m1.7.7.1.7" xref="alg1.2.m1.7.7.2.cmml">,</mo><mi id="alg1.2.m1.6.6" xref="alg1.2.m1.6.6.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.2.m1.7c"><list id="alg1.2.m1.7.7.2.cmml" xref="alg1.2.m1.7.7.1"><ci id="alg1.2.m1.1.1.cmml" xref="alg1.2.m1.1.1">ğ‘¥</ci><apply id="alg1.2.m1.7.7.1.1.cmml" xref="alg1.2.m1.7.7.1.1"><csymbol cd="ambiguous" id="alg1.2.m1.7.7.1.1.1.cmml" xref="alg1.2.m1.7.7.1.1">subscript</csymbol><ci id="alg1.2.m1.7.7.1.1.2.cmml" xref="alg1.2.m1.7.7.1.1.2">ğ‘</ci><ci id="alg1.2.m1.7.7.1.1.3.cmml" xref="alg1.2.m1.7.7.1.1.3">ğœƒ</ci></apply><ci id="alg1.2.m1.2.2.cmml" xref="alg1.2.m1.2.2">ğº</ci><ci id="alg1.2.m1.3.3.cmml" xref="alg1.2.m1.3.3">ğ‘˜</ci><ci id="alg1.2.m1.4.4.cmml" xref="alg1.2.m1.4.4">ğ‘‰</ci><ci id="alg1.2.m1.5.5.cmml" xref="alg1.2.m1.5.5">ğ‘‡</ci><ci id="alg1.2.m1.6.6.cmml" xref="alg1.2.m1.6.6">ğ‘</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m1.7d">x,p_{\theta},G,k,V,T,b</annotation><annotation encoding="application/x-llamapun" id="alg1.2.m1.7e">italic_x , italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT , italic_G , italic_k , italic_V , italic_T , italic_b</annotation></semantics></math>)</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.5">
<div class="ltx_listingline" id="alg1.l1">Input <math alttext="x" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">ğ‘¥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_x</annotation></semantics></math>, LM <math alttext="p_{\theta}" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><msub id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">p</mi><mi id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">Î¸</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">ğ‘</ci><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">ğœƒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">p_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT</annotation></semantics></math>, thought generator <math alttext="G()" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mrow id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">G</mi><mo id="alg1.l1.m3.1.1.1" xref="alg1.l1.m3.1.1.1.cmml">â¢</mo><mrow id="alg1.l1.m3.1.1.3.2" xref="alg1.l1.m3.1.1.cmml"><mo id="alg1.l1.m3.1.1.3.2.1" stretchy="false" xref="alg1.l1.m3.1.1.3.1.cmml">(</mo><mo id="alg1.l1.m3.1.1.3.2.2" stretchy="false" xref="alg1.l1.m3.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><times id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1.1"></times><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">ğº</ci><list id="alg1.l1.m3.1.1.3.1.cmml" xref="alg1.l1.m3.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">G()</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_G ( )</annotation></semantics></math> &amp; size limit <math alttext="k" class="ltx_Math" display="inline" id="alg1.l1.m4.1"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m4.1d">italic_k</annotation></semantics></math>, states evaluator <math alttext="V()" class="ltx_Math" display="inline" id="alg1.l1.m5.1"><semantics id="alg1.l1.m5.1a"><mrow id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml"><mi id="alg1.l1.m5.1.1.2" xref="alg1.l1.m5.1.1.2.cmml">V</mi><mo id="alg1.l1.m5.1.1.1" xref="alg1.l1.m5.1.1.1.cmml">â¢</mo><mrow id="alg1.l1.m5.1.1.3.2" xref="alg1.l1.m5.1.1.cmml"><mo id="alg1.l1.m5.1.1.3.2.1" stretchy="false" xref="alg1.l1.m5.1.1.3.1.cmml">(</mo><mo id="alg1.l1.m5.1.1.3.2.2" stretchy="false" xref="alg1.l1.m5.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><apply id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1"><times id="alg1.l1.m5.1.1.1.cmml" xref="alg1.l1.m5.1.1.1"></times><ci id="alg1.l1.m5.1.1.2.cmml" xref="alg1.l1.m5.1.1.2">ğ‘‰</ci><list id="alg1.l1.m5.1.1.3.1.cmml" xref="alg1.l1.m5.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">V()</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m5.1d">italic_V ( )</annotation></semantics></math>, step limit <math alttext="T" class="ltx_Math" display="inline" id="alg1.l1.m6.1"><semantics id="alg1.l1.m6.1a"><mi id="alg1.l1.m6.1.1" xref="alg1.l1.m6.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.1b"><ci id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1">ğ‘‡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m6.1d">italic_T</annotation></semantics></math>, breadth limit <math alttext="b" class="ltx_Math" display="inline" id="alg1.l1.m7.1"><semantics id="alg1.l1.m7.1a"><mi id="alg1.l1.m7.1.1" xref="alg1.l1.m7.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m7.1b"><ci id="alg1.l1.m7.1.1.cmml" xref="alg1.l1.m7.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m7.1c">b</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m7.1d">italic_b</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l2">
<math alttext="S_{0}\leftarrow\{x\}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.2" xref="alg1.l2.m1.1.2.cmml"><msub id="alg1.l2.m1.1.2.2" xref="alg1.l2.m1.1.2.2.cmml"><mi id="alg1.l2.m1.1.2.2.2" xref="alg1.l2.m1.1.2.2.2.cmml">S</mi><mn id="alg1.l2.m1.1.2.2.3" xref="alg1.l2.m1.1.2.2.3.cmml">0</mn></msub><mo id="alg1.l2.m1.1.2.1" stretchy="false" xref="alg1.l2.m1.1.2.1.cmml">â†</mo><mrow id="alg1.l2.m1.1.2.3.2" xref="alg1.l2.m1.1.2.3.1.cmml"><mo id="alg1.l2.m1.1.2.3.2.1" stretchy="false" xref="alg1.l2.m1.1.2.3.1.cmml">{</mo><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">x</mi><mo id="alg1.l2.m1.1.2.3.2.2" stretchy="false" xref="alg1.l2.m1.1.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.2.cmml" xref="alg1.l2.m1.1.2"><ci id="alg1.l2.m1.1.2.1.cmml" xref="alg1.l2.m1.1.2.1">â†</ci><apply id="alg1.l2.m1.1.2.2.cmml" xref="alg1.l2.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.2.2.1.cmml" xref="alg1.l2.m1.1.2.2">subscript</csymbol><ci id="alg1.l2.m1.1.2.2.2.cmml" xref="alg1.l2.m1.1.2.2.2">ğ‘†</ci><cn id="alg1.l2.m1.1.2.2.3.cmml" type="integer" xref="alg1.l2.m1.1.2.2.3">0</cn></apply><set id="alg1.l2.m1.1.2.3.1.cmml" xref="alg1.l2.m1.1.2.3.2"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">ğ‘¥</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">S_{0}\leftarrow\{x\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_S start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT â† { italic_x }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_text ltx_font_bold" id="alg1.l3.1">for</span>Â <math alttext="t=1,\cdots,T" class="ltx_Math" display="inline" id="alg1.l3.m1.3"><semantics id="alg1.l3.m1.3a"><mrow id="alg1.l3.m1.3.4" xref="alg1.l3.m1.3.4.cmml"><mi id="alg1.l3.m1.3.4.2" xref="alg1.l3.m1.3.4.2.cmml">t</mi><mo id="alg1.l3.m1.3.4.1" xref="alg1.l3.m1.3.4.1.cmml">=</mo><mrow id="alg1.l3.m1.3.4.3.2" xref="alg1.l3.m1.3.4.3.1.cmml"><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">1</mn><mo id="alg1.l3.m1.3.4.3.2.1" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l3.m1.2.2" mathvariant="normal" xref="alg1.l3.m1.2.2.cmml">â‹¯</mi><mo id="alg1.l3.m1.3.4.3.2.2" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.3b"><apply id="alg1.l3.m1.3.4.cmml" xref="alg1.l3.m1.3.4"><eq id="alg1.l3.m1.3.4.1.cmml" xref="alg1.l3.m1.3.4.1"></eq><ci id="alg1.l3.m1.3.4.2.cmml" xref="alg1.l3.m1.3.4.2">ğ‘¡</ci><list id="alg1.l3.m1.3.4.3.1.cmml" xref="alg1.l3.m1.3.4.3.2"><cn id="alg1.l3.m1.1.1.cmml" type="integer" xref="alg1.l3.m1.1.1">1</cn><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">â‹¯</ci><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">ğ‘‡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.3c">t=1,\cdots,T</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.3d">italic_t = 1 , â‹¯ , italic_T</annotation></semantics></math>Â <span class="ltx_text ltx_font_bold" id="alg1.l3.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l4">Â Â Â Â Â <math alttext="S^{\prime}_{t}\leftarrow\{[s,z]\mid s\in S_{t-1},z_{t}\in{\color[rgb]{0,0,0}%
\definecolor[named]{pgfstrokecolor}{rgb}{0,0,0}\pgfsys@color@gray@stroke{0}%
\pgfsys@color@gray@fill{0}\mathrm{G}}(p_{\theta},s,k)\}" class="ltx_Math" display="inline" id="alg1.l4.m1.6"><semantics id="alg1.l4.m1.6a"><mrow id="alg1.l4.m1.6.6" xref="alg1.l4.m1.6.6.cmml"><msubsup id="alg1.l4.m1.6.6.4" xref="alg1.l4.m1.6.6.4.cmml"><mi id="alg1.l4.m1.6.6.4.2.2" xref="alg1.l4.m1.6.6.4.2.2.cmml">S</mi><mi id="alg1.l4.m1.6.6.4.3" xref="alg1.l4.m1.6.6.4.3.cmml">t</mi><mo id="alg1.l4.m1.6.6.4.2.3" xref="alg1.l4.m1.6.6.4.2.3.cmml">â€²</mo></msubsup><mo id="alg1.l4.m1.6.6.3" stretchy="false" xref="alg1.l4.m1.6.6.3.cmml">â†</mo><mrow id="alg1.l4.m1.6.6.2.2" xref="alg1.l4.m1.6.6.2.3.cmml"><mo id="alg1.l4.m1.6.6.2.2.3" stretchy="false" xref="alg1.l4.m1.6.6.2.3.1.cmml">{</mo><mrow id="alg1.l4.m1.5.5.1.1.1.2" xref="alg1.l4.m1.5.5.1.1.1.1.cmml"><mo id="alg1.l4.m1.5.5.1.1.1.2.1" stretchy="false" xref="alg1.l4.m1.5.5.1.1.1.1.cmml">[</mo><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">s</mi><mo id="alg1.l4.m1.5.5.1.1.1.2.2" xref="alg1.l4.m1.5.5.1.1.1.1.cmml">,</mo><mi id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">z</mi><mo id="alg1.l4.m1.5.5.1.1.1.2.3" stretchy="false" xref="alg1.l4.m1.5.5.1.1.1.1.cmml">]</mo></mrow><mo fence="true" id="alg1.l4.m1.6.6.2.2.4" lspace="0em" rspace="0em" xref="alg1.l4.m1.6.6.2.3.1.cmml">âˆ£</mo><mrow id="alg1.l4.m1.6.6.2.2.2.2" xref="alg1.l4.m1.6.6.2.2.2.3.cmml"><mrow id="alg1.l4.m1.6.6.2.2.2.1.1" xref="alg1.l4.m1.6.6.2.2.2.1.1.cmml"><mi id="alg1.l4.m1.6.6.2.2.2.1.1.2" xref="alg1.l4.m1.6.6.2.2.2.1.1.2.cmml">s</mi><mo id="alg1.l4.m1.6.6.2.2.2.1.1.1" xref="alg1.l4.m1.6.6.2.2.2.1.1.1.cmml">âˆˆ</mo><msub id="alg1.l4.m1.6.6.2.2.2.1.1.3" xref="alg1.l4.m1.6.6.2.2.2.1.1.3.cmml"><mi id="alg1.l4.m1.6.6.2.2.2.1.1.3.2" xref="alg1.l4.m1.6.6.2.2.2.1.1.3.2.cmml">S</mi><mrow id="alg1.l4.m1.6.6.2.2.2.1.1.3.3" xref="alg1.l4.m1.6.6.2.2.2.1.1.3.3.cmml"><mi id="alg1.l4.m1.6.6.2.2.2.1.1.3.3.2" xref="alg1.l4.m1.6.6.2.2.2.1.1.3.3.2.cmml">t</mi><mo id="alg1.l4.m1.6.6.2.2.2.1.1.3.3.1" xref="alg1.l4.m1.6.6.2.2.2.1.1.3.3.1.cmml">âˆ’</mo><mn id="alg1.l4.m1.6.6.2.2.2.1.1.3.3.3" xref="alg1.l4.m1.6.6.2.2.2.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="alg1.l4.m1.6.6.2.2.2.2.3" xref="alg1.l4.m1.6.6.2.2.2.3a.cmml">,</mo><mrow id="alg1.l4.m1.6.6.2.2.2.2.2" xref="alg1.l4.m1.6.6.2.2.2.2.2.cmml"><msub id="alg1.l4.m1.6.6.2.2.2.2.2.3" xref="alg1.l4.m1.6.6.2.2.2.2.2.3.cmml"><mi id="alg1.l4.m1.6.6.2.2.2.2.2.3.2" xref="alg1.l4.m1.6.6.2.2.2.2.2.3.2.cmml">z</mi><mi id="alg1.l4.m1.6.6.2.2.2.2.2.3.3" xref="alg1.l4.m1.6.6.2.2.2.2.2.3.3.cmml">t</mi></msub><mo id="alg1.l4.m1.6.6.2.2.2.2.2.2" xref="alg1.l4.m1.6.6.2.2.2.2.2.2.cmml">âˆˆ</mo><mrow id="alg1.l4.m1.6.6.2.2.2.2.2.1" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.cmml"><mi id="alg1.l4.m1.6.6.2.2.2.2.2.1.3" mathcolor="#000000" mathvariant="normal" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.3.cmml">G</mi><mo id="alg1.l4.m1.6.6.2.2.2.2.2.1.2" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.2.cmml">â¢</mo><mrow id="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.1.2.cmml"><mo id="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.2" stretchy="false" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.1.2.cmml">(</mo><msub id="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.1" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.1.cmml"><mi id="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.1.2" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.1.2.cmml">p</mi><mi id="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.1.3" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.1.3.cmml">Î¸</mi></msub><mo id="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.3" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.1.2.cmml">,</mo><mi id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml">s</mi><mo id="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.4" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.1.2.cmml">,</mo><mi id="alg1.l4.m1.4.4" xref="alg1.l4.m1.4.4.cmml">k</mi><mo id="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.5" stretchy="false" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="alg1.l4.m1.6.6.2.2.5" stretchy="false" xref="alg1.l4.m1.6.6.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.6b"><apply id="alg1.l4.m1.6.6.cmml" xref="alg1.l4.m1.6.6"><ci id="alg1.l4.m1.6.6.3.cmml" xref="alg1.l4.m1.6.6.3">â†</ci><apply id="alg1.l4.m1.6.6.4.cmml" xref="alg1.l4.m1.6.6.4"><csymbol cd="ambiguous" id="alg1.l4.m1.6.6.4.1.cmml" xref="alg1.l4.m1.6.6.4">subscript</csymbol><apply id="alg1.l4.m1.6.6.4.2.cmml" xref="alg1.l4.m1.6.6.4"><csymbol cd="ambiguous" id="alg1.l4.m1.6.6.4.2.1.cmml" xref="alg1.l4.m1.6.6.4">superscript</csymbol><ci id="alg1.l4.m1.6.6.4.2.2.cmml" xref="alg1.l4.m1.6.6.4.2.2">ğ‘†</ci><ci id="alg1.l4.m1.6.6.4.2.3.cmml" xref="alg1.l4.m1.6.6.4.2.3">â€²</ci></apply><ci id="alg1.l4.m1.6.6.4.3.cmml" xref="alg1.l4.m1.6.6.4.3">ğ‘¡</ci></apply><apply id="alg1.l4.m1.6.6.2.3.cmml" xref="alg1.l4.m1.6.6.2.2"><csymbol cd="latexml" id="alg1.l4.m1.6.6.2.3.1.cmml" xref="alg1.l4.m1.6.6.2.2.3">conditional-set</csymbol><interval closure="closed" id="alg1.l4.m1.5.5.1.1.1.1.cmml" xref="alg1.l4.m1.5.5.1.1.1.2"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">ğ‘ </ci><ci id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2">ğ‘§</ci></interval><apply id="alg1.l4.m1.6.6.2.2.2.3.cmml" xref="alg1.l4.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.6.6.2.2.2.3a.cmml" xref="alg1.l4.m1.6.6.2.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l4.m1.6.6.2.2.2.1.1.cmml" xref="alg1.l4.m1.6.6.2.2.2.1.1"><in id="alg1.l4.m1.6.6.2.2.2.1.1.1.cmml" xref="alg1.l4.m1.6.6.2.2.2.1.1.1"></in><ci id="alg1.l4.m1.6.6.2.2.2.1.1.2.cmml" xref="alg1.l4.m1.6.6.2.2.2.1.1.2">ğ‘ </ci><apply id="alg1.l4.m1.6.6.2.2.2.1.1.3.cmml" xref="alg1.l4.m1.6.6.2.2.2.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.6.6.2.2.2.1.1.3.1.cmml" xref="alg1.l4.m1.6.6.2.2.2.1.1.3">subscript</csymbol><ci id="alg1.l4.m1.6.6.2.2.2.1.1.3.2.cmml" xref="alg1.l4.m1.6.6.2.2.2.1.1.3.2">ğ‘†</ci><apply id="alg1.l4.m1.6.6.2.2.2.1.1.3.3.cmml" xref="alg1.l4.m1.6.6.2.2.2.1.1.3.3"><minus id="alg1.l4.m1.6.6.2.2.2.1.1.3.3.1.cmml" xref="alg1.l4.m1.6.6.2.2.2.1.1.3.3.1"></minus><ci id="alg1.l4.m1.6.6.2.2.2.1.1.3.3.2.cmml" xref="alg1.l4.m1.6.6.2.2.2.1.1.3.3.2">ğ‘¡</ci><cn id="alg1.l4.m1.6.6.2.2.2.1.1.3.3.3.cmml" type="integer" xref="alg1.l4.m1.6.6.2.2.2.1.1.3.3.3">1</cn></apply></apply></apply><apply id="alg1.l4.m1.6.6.2.2.2.2.2.cmml" xref="alg1.l4.m1.6.6.2.2.2.2.2"><in id="alg1.l4.m1.6.6.2.2.2.2.2.2.cmml" xref="alg1.l4.m1.6.6.2.2.2.2.2.2"></in><apply id="alg1.l4.m1.6.6.2.2.2.2.2.3.cmml" xref="alg1.l4.m1.6.6.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l4.m1.6.6.2.2.2.2.2.3.1.cmml" xref="alg1.l4.m1.6.6.2.2.2.2.2.3">subscript</csymbol><ci id="alg1.l4.m1.6.6.2.2.2.2.2.3.2.cmml" xref="alg1.l4.m1.6.6.2.2.2.2.2.3.2">ğ‘§</ci><ci id="alg1.l4.m1.6.6.2.2.2.2.2.3.3.cmml" xref="alg1.l4.m1.6.6.2.2.2.2.2.3.3">ğ‘¡</ci></apply><apply id="alg1.l4.m1.6.6.2.2.2.2.2.1.cmml" xref="alg1.l4.m1.6.6.2.2.2.2.2.1"><times id="alg1.l4.m1.6.6.2.2.2.2.2.1.2.cmml" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.2"></times><ci id="alg1.l4.m1.6.6.2.2.2.2.2.1.3.cmml" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.3">G</ci><vector id="alg1.l4.m1.6.6.2.2.2.2.2.1.1.2.cmml" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1"><apply id="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.1.cmml" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.1.1.cmml" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.1.2.cmml" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.1.2">ğ‘</ci><ci id="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.1.3.cmml" xref="alg1.l4.m1.6.6.2.2.2.2.2.1.1.1.1.3">ğœƒ</ci></apply><ci id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3">ğ‘ </ci><ci id="alg1.l4.m1.4.4.cmml" xref="alg1.l4.m1.4.4">ğ‘˜</ci></vector></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.6c">S^{\prime}_{t}\leftarrow\{[s,z]\mid s\in S_{t-1},z_{t}\in{\color[rgb]{0,0,0}%
\definecolor[named]{pgfstrokecolor}{rgb}{0,0,0}\pgfsys@color@gray@stroke{0}%
\pgfsys@color@gray@fill{0}\mathrm{G}}(p_{\theta},s,k)\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.6d">italic_S start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT â† { [ italic_s , italic_z ] âˆ£ italic_s âˆˆ italic_S start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆˆ roman_G ( italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT , italic_s , italic_k ) }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l5">Â Â Â Â Â <math alttext="V_{t}\leftarrow V(p_{\theta},S^{\prime}_{t})" class="ltx_Math" display="inline" id="alg1.l5.m1.2"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml"><msub id="alg1.l5.m1.2.2.4" xref="alg1.l5.m1.2.2.4.cmml"><mi id="alg1.l5.m1.2.2.4.2" xref="alg1.l5.m1.2.2.4.2.cmml">V</mi><mi id="alg1.l5.m1.2.2.4.3" xref="alg1.l5.m1.2.2.4.3.cmml">t</mi></msub><mo id="alg1.l5.m1.2.2.3" stretchy="false" xref="alg1.l5.m1.2.2.3.cmml">â†</mo><mrow id="alg1.l5.m1.2.2.2" xref="alg1.l5.m1.2.2.2.cmml"><mi id="alg1.l5.m1.2.2.2.4" xref="alg1.l5.m1.2.2.2.4.cmml">V</mi><mo id="alg1.l5.m1.2.2.2.3" xref="alg1.l5.m1.2.2.2.3.cmml">â¢</mo><mrow id="alg1.l5.m1.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.3.cmml"><mo id="alg1.l5.m1.2.2.2.2.2.3" stretchy="false" xref="alg1.l5.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.l5.m1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.1.2.cmml">p</mi><mi id="alg1.l5.m1.1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.1.3.cmml">Î¸</mi></msub><mo id="alg1.l5.m1.2.2.2.2.2.4" xref="alg1.l5.m1.2.2.2.2.3.cmml">,</mo><msubsup id="alg1.l5.m1.2.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l5.m1.2.2.2.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.2.2.2.cmml">S</mi><mi id="alg1.l5.m1.2.2.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.2.2.3.cmml">t</mi><mo id="alg1.l5.m1.2.2.2.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.2.2.2.3.cmml">â€²</mo></msubsup><mo id="alg1.l5.m1.2.2.2.2.2.5" stretchy="false" xref="alg1.l5.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><apply id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2"><ci id="alg1.l5.m1.2.2.3.cmml" xref="alg1.l5.m1.2.2.3">â†</ci><apply id="alg1.l5.m1.2.2.4.cmml" xref="alg1.l5.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.4.1.cmml" xref="alg1.l5.m1.2.2.4">subscript</csymbol><ci id="alg1.l5.m1.2.2.4.2.cmml" xref="alg1.l5.m1.2.2.4.2">ğ‘‰</ci><ci id="alg1.l5.m1.2.2.4.3.cmml" xref="alg1.l5.m1.2.2.4.3">ğ‘¡</ci></apply><apply id="alg1.l5.m1.2.2.2.cmml" xref="alg1.l5.m1.2.2.2"><times id="alg1.l5.m1.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.3"></times><ci id="alg1.l5.m1.2.2.2.4.cmml" xref="alg1.l5.m1.2.2.2.4">ğ‘‰</ci><interval closure="open" id="alg1.l5.m1.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.2"><apply id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2">ğ‘</ci><ci id="alg1.l5.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3">ğœƒ</ci></apply><apply id="alg1.l5.m1.2.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l5.m1.2.2.2.2.2.2">subscript</csymbol><apply id="alg1.l5.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l5.m1.2.2.2.2.2.2">superscript</csymbol><ci id="alg1.l5.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.2">ğ‘†</ci><ci id="alg1.l5.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.3">â€²</ci></apply><ci id="alg1.l5.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.3">ğ‘¡</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">V_{t}\leftarrow V(p_{\theta},S^{\prime}_{t})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.2d">italic_V start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT â† italic_V ( italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT , italic_S start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">Â Â Â Â Â <math alttext="S_{t}\leftarrow\arg\max_{S\subset S^{\prime}_{t},|S|=b}\sum_{s\in S}V_{t}(s)" class="ltx_Math" display="inline" id="alg1.l6.m1.4"><semantics id="alg1.l6.m1.4a"><mrow id="alg1.l6.m1.4.5" xref="alg1.l6.m1.4.5.cmml"><msub id="alg1.l6.m1.4.5.2" xref="alg1.l6.m1.4.5.2.cmml"><mi id="alg1.l6.m1.4.5.2.2" xref="alg1.l6.m1.4.5.2.2.cmml">S</mi><mi id="alg1.l6.m1.4.5.2.3" xref="alg1.l6.m1.4.5.2.3.cmml">t</mi></msub><mo id="alg1.l6.m1.4.5.1" stretchy="false" xref="alg1.l6.m1.4.5.1.cmml">â†</mo><mrow id="alg1.l6.m1.4.5.3" xref="alg1.l6.m1.4.5.3.cmml"><mrow id="alg1.l6.m1.4.5.3.2" xref="alg1.l6.m1.4.5.3.2.cmml"><mi id="alg1.l6.m1.4.5.3.2.1" xref="alg1.l6.m1.4.5.3.2.1.cmml">arg</mi><mo id="alg1.l6.m1.4.5.3.2a" lspace="0.167em" xref="alg1.l6.m1.4.5.3.2.cmml">â¡</mo><msub id="alg1.l6.m1.4.5.3.2.2" xref="alg1.l6.m1.4.5.3.2.2.cmml"><mi id="alg1.l6.m1.4.5.3.2.2.2" xref="alg1.l6.m1.4.5.3.2.2.2.cmml">max</mi><mrow id="alg1.l6.m1.3.3.3.3" xref="alg1.l6.m1.3.3.3.4.cmml"><mrow id="alg1.l6.m1.2.2.2.2.1" xref="alg1.l6.m1.2.2.2.2.1.cmml"><mi id="alg1.l6.m1.2.2.2.2.1.2" xref="alg1.l6.m1.2.2.2.2.1.2.cmml">S</mi><mo id="alg1.l6.m1.2.2.2.2.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.cmml">âŠ‚</mo><msubsup id="alg1.l6.m1.2.2.2.2.1.3" xref="alg1.l6.m1.2.2.2.2.1.3.cmml"><mi id="alg1.l6.m1.2.2.2.2.1.3.2.2" xref="alg1.l6.m1.2.2.2.2.1.3.2.2.cmml">S</mi><mi id="alg1.l6.m1.2.2.2.2.1.3.3" xref="alg1.l6.m1.2.2.2.2.1.3.3.cmml">t</mi><mo id="alg1.l6.m1.2.2.2.2.1.3.2.3" xref="alg1.l6.m1.2.2.2.2.1.3.2.3.cmml">â€²</mo></msubsup></mrow><mo id="alg1.l6.m1.3.3.3.3.3" xref="alg1.l6.m1.3.3.3.4a.cmml">,</mo><mrow id="alg1.l6.m1.3.3.3.3.2" xref="alg1.l6.m1.3.3.3.3.2.cmml"><mrow id="alg1.l6.m1.3.3.3.3.2.2.2" xref="alg1.l6.m1.3.3.3.3.2.2.1.cmml"><mo id="alg1.l6.m1.3.3.3.3.2.2.2.1" stretchy="false" xref="alg1.l6.m1.3.3.3.3.2.2.1.1.cmml">|</mo><mi id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml">S</mi><mo id="alg1.l6.m1.3.3.3.3.2.2.2.2" stretchy="false" xref="alg1.l6.m1.3.3.3.3.2.2.1.1.cmml">|</mo></mrow><mo id="alg1.l6.m1.3.3.3.3.2.1" xref="alg1.l6.m1.3.3.3.3.2.1.cmml">=</mo><mi id="alg1.l6.m1.3.3.3.3.2.3" xref="alg1.l6.m1.3.3.3.3.2.3.cmml">b</mi></mrow></mrow></msub></mrow><mo id="alg1.l6.m1.4.5.3.1" xref="alg1.l6.m1.4.5.3.1.cmml">â¢</mo><mrow id="alg1.l6.m1.4.5.3.3" xref="alg1.l6.m1.4.5.3.3.cmml"><msub id="alg1.l6.m1.4.5.3.3.1" xref="alg1.l6.m1.4.5.3.3.1.cmml"><mo id="alg1.l6.m1.4.5.3.3.1.2" xref="alg1.l6.m1.4.5.3.3.1.2.cmml">âˆ‘</mo><mrow id="alg1.l6.m1.4.5.3.3.1.3" xref="alg1.l6.m1.4.5.3.3.1.3.cmml"><mi id="alg1.l6.m1.4.5.3.3.1.3.2" xref="alg1.l6.m1.4.5.3.3.1.3.2.cmml">s</mi><mo id="alg1.l6.m1.4.5.3.3.1.3.1" xref="alg1.l6.m1.4.5.3.3.1.3.1.cmml">âˆˆ</mo><mi id="alg1.l6.m1.4.5.3.3.1.3.3" xref="alg1.l6.m1.4.5.3.3.1.3.3.cmml">S</mi></mrow></msub><mrow id="alg1.l6.m1.4.5.3.3.2" xref="alg1.l6.m1.4.5.3.3.2.cmml"><msub id="alg1.l6.m1.4.5.3.3.2.2" xref="alg1.l6.m1.4.5.3.3.2.2.cmml"><mi id="alg1.l6.m1.4.5.3.3.2.2.2" xref="alg1.l6.m1.4.5.3.3.2.2.2.cmml">V</mi><mi id="alg1.l6.m1.4.5.3.3.2.2.3" xref="alg1.l6.m1.4.5.3.3.2.2.3.cmml">t</mi></msub><mo id="alg1.l6.m1.4.5.3.3.2.1" xref="alg1.l6.m1.4.5.3.3.2.1.cmml">â¢</mo><mrow id="alg1.l6.m1.4.5.3.3.2.3.2" xref="alg1.l6.m1.4.5.3.3.2.cmml"><mo id="alg1.l6.m1.4.5.3.3.2.3.2.1" stretchy="false" xref="alg1.l6.m1.4.5.3.3.2.cmml">(</mo><mi id="alg1.l6.m1.4.4" xref="alg1.l6.m1.4.4.cmml">s</mi><mo id="alg1.l6.m1.4.5.3.3.2.3.2.2" stretchy="false" xref="alg1.l6.m1.4.5.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.4b"><apply id="alg1.l6.m1.4.5.cmml" xref="alg1.l6.m1.4.5"><ci id="alg1.l6.m1.4.5.1.cmml" xref="alg1.l6.m1.4.5.1">â†</ci><apply id="alg1.l6.m1.4.5.2.cmml" xref="alg1.l6.m1.4.5.2"><csymbol cd="ambiguous" id="alg1.l6.m1.4.5.2.1.cmml" xref="alg1.l6.m1.4.5.2">subscript</csymbol><ci id="alg1.l6.m1.4.5.2.2.cmml" xref="alg1.l6.m1.4.5.2.2">ğ‘†</ci><ci id="alg1.l6.m1.4.5.2.3.cmml" xref="alg1.l6.m1.4.5.2.3">ğ‘¡</ci></apply><apply id="alg1.l6.m1.4.5.3.cmml" xref="alg1.l6.m1.4.5.3"><times id="alg1.l6.m1.4.5.3.1.cmml" xref="alg1.l6.m1.4.5.3.1"></times><apply id="alg1.l6.m1.4.5.3.2.cmml" xref="alg1.l6.m1.4.5.3.2"><arg id="alg1.l6.m1.4.5.3.2.1.cmml" xref="alg1.l6.m1.4.5.3.2.1"></arg><apply id="alg1.l6.m1.4.5.3.2.2.cmml" xref="alg1.l6.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.4.5.3.2.2.1.cmml" xref="alg1.l6.m1.4.5.3.2.2">subscript</csymbol><max id="alg1.l6.m1.4.5.3.2.2.2.cmml" xref="alg1.l6.m1.4.5.3.2.2.2"></max><apply id="alg1.l6.m1.3.3.3.4.cmml" xref="alg1.l6.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.3.4a.cmml" xref="alg1.l6.m1.3.3.3.3.3">formulae-sequence</csymbol><apply id="alg1.l6.m1.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.1"><subset id="alg1.l6.m1.2.2.2.2.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1"></subset><ci id="alg1.l6.m1.2.2.2.2.1.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.2">ğ‘†</ci><apply id="alg1.l6.m1.2.2.2.2.1.3.cmml" xref="alg1.l6.m1.2.2.2.2.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.1.3.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.3">subscript</csymbol><apply id="alg1.l6.m1.2.2.2.2.1.3.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.1.3.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.3">superscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.1.3.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.3.2.2">ğ‘†</ci><ci id="alg1.l6.m1.2.2.2.2.1.3.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.1.3.2.3">â€²</ci></apply><ci id="alg1.l6.m1.2.2.2.2.1.3.3.cmml" xref="alg1.l6.m1.2.2.2.2.1.3.3">ğ‘¡</ci></apply></apply><apply id="alg1.l6.m1.3.3.3.3.2.cmml" xref="alg1.l6.m1.3.3.3.3.2"><eq id="alg1.l6.m1.3.3.3.3.2.1.cmml" xref="alg1.l6.m1.3.3.3.3.2.1"></eq><apply id="alg1.l6.m1.3.3.3.3.2.2.1.cmml" xref="alg1.l6.m1.3.3.3.3.2.2.2"><abs id="alg1.l6.m1.3.3.3.3.2.2.1.1.cmml" xref="alg1.l6.m1.3.3.3.3.2.2.2.1"></abs><ci id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1">ğ‘†</ci></apply><ci id="alg1.l6.m1.3.3.3.3.2.3.cmml" xref="alg1.l6.m1.3.3.3.3.2.3">ğ‘</ci></apply></apply></apply></apply><apply id="alg1.l6.m1.4.5.3.3.cmml" xref="alg1.l6.m1.4.5.3.3"><apply id="alg1.l6.m1.4.5.3.3.1.cmml" xref="alg1.l6.m1.4.5.3.3.1"><csymbol cd="ambiguous" id="alg1.l6.m1.4.5.3.3.1.1.cmml" xref="alg1.l6.m1.4.5.3.3.1">subscript</csymbol><sum id="alg1.l6.m1.4.5.3.3.1.2.cmml" xref="alg1.l6.m1.4.5.3.3.1.2"></sum><apply id="alg1.l6.m1.4.5.3.3.1.3.cmml" xref="alg1.l6.m1.4.5.3.3.1.3"><in id="alg1.l6.m1.4.5.3.3.1.3.1.cmml" xref="alg1.l6.m1.4.5.3.3.1.3.1"></in><ci id="alg1.l6.m1.4.5.3.3.1.3.2.cmml" xref="alg1.l6.m1.4.5.3.3.1.3.2">ğ‘ </ci><ci id="alg1.l6.m1.4.5.3.3.1.3.3.cmml" xref="alg1.l6.m1.4.5.3.3.1.3.3">ğ‘†</ci></apply></apply><apply id="alg1.l6.m1.4.5.3.3.2.cmml" xref="alg1.l6.m1.4.5.3.3.2"><times id="alg1.l6.m1.4.5.3.3.2.1.cmml" xref="alg1.l6.m1.4.5.3.3.2.1"></times><apply id="alg1.l6.m1.4.5.3.3.2.2.cmml" xref="alg1.l6.m1.4.5.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.4.5.3.3.2.2.1.cmml" xref="alg1.l6.m1.4.5.3.3.2.2">subscript</csymbol><ci id="alg1.l6.m1.4.5.3.3.2.2.2.cmml" xref="alg1.l6.m1.4.5.3.3.2.2.2">ğ‘‰</ci><ci id="alg1.l6.m1.4.5.3.3.2.2.3.cmml" xref="alg1.l6.m1.4.5.3.3.2.2.3">ğ‘¡</ci></apply><ci id="alg1.l6.m1.4.4.cmml" xref="alg1.l6.m1.4.4">ğ‘ </ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.4c">S_{t}\leftarrow\arg\max_{S\subset S^{\prime}_{t},|S|=b}\sum_{s\in S}V_{t}(s)</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.4d">italic_S start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT â† roman_arg roman_max start_POSTSUBSCRIPT italic_S âŠ‚ italic_S start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , | italic_S | = italic_b end_POSTSUBSCRIPT âˆ‘ start_POSTSUBSCRIPT italic_s âˆˆ italic_S end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_s )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_text ltx_font_bold" id="alg1.l7.1">end</span>Â <span class="ltx_text ltx_font_bold" id="alg1.l7.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_text ltx_font_bold" id="alg1.l8.1">return</span> <math alttext="G(p_{\theta},\arg\max_{s\in S_{T}}V_{T}(s),1)" class="ltx_Math" display="inline" id="alg1.l8.m1.4"><semantics id="alg1.l8.m1.4a"><mrow id="alg1.l8.m1.4.4" xref="alg1.l8.m1.4.4.cmml"><mi id="alg1.l8.m1.4.4.4" xref="alg1.l8.m1.4.4.4.cmml">G</mi><mo id="alg1.l8.m1.4.4.3" xref="alg1.l8.m1.4.4.3.cmml">â¢</mo><mrow id="alg1.l8.m1.4.4.2.2" xref="alg1.l8.m1.4.4.2.3.cmml"><mo id="alg1.l8.m1.4.4.2.2.3" stretchy="false" xref="alg1.l8.m1.4.4.2.3.cmml">(</mo><msub id="alg1.l8.m1.3.3.1.1.1" xref="alg1.l8.m1.3.3.1.1.1.cmml"><mi id="alg1.l8.m1.3.3.1.1.1.2" xref="alg1.l8.m1.3.3.1.1.1.2.cmml">p</mi><mi id="alg1.l8.m1.3.3.1.1.1.3" xref="alg1.l8.m1.3.3.1.1.1.3.cmml">Î¸</mi></msub><mo id="alg1.l8.m1.4.4.2.2.4" xref="alg1.l8.m1.4.4.2.3.cmml">,</mo><mrow id="alg1.l8.m1.4.4.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.cmml"><mrow id="alg1.l8.m1.4.4.2.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.cmml"><mi id="alg1.l8.m1.4.4.2.2.2.2.1" xref="alg1.l8.m1.4.4.2.2.2.2.1.cmml">arg</mi><mo id="alg1.l8.m1.4.4.2.2.2.2a" lspace="0.167em" xref="alg1.l8.m1.4.4.2.2.2.2.cmml">â¡</mo><mrow id="alg1.l8.m1.4.4.2.2.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.2.cmml"><msub id="alg1.l8.m1.4.4.2.2.2.2.2.1" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.cmml"><mi id="alg1.l8.m1.4.4.2.2.2.2.2.1.2" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.2.cmml">max</mi><mrow id="alg1.l8.m1.4.4.2.2.2.2.2.1.3" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.3.cmml"><mi id="alg1.l8.m1.4.4.2.2.2.2.2.1.3.2" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.3.2.cmml">s</mi><mo id="alg1.l8.m1.4.4.2.2.2.2.2.1.3.1" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.3.1.cmml">âˆˆ</mo><msub id="alg1.l8.m1.4.4.2.2.2.2.2.1.3.3" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.3.3.cmml"><mi id="alg1.l8.m1.4.4.2.2.2.2.2.1.3.3.2" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.3.3.2.cmml">S</mi><mi id="alg1.l8.m1.4.4.2.2.2.2.2.1.3.3.3" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.3.3.3.cmml">T</mi></msub></mrow></msub><mo id="alg1.l8.m1.4.4.2.2.2.2.2a" lspace="0.167em" xref="alg1.l8.m1.4.4.2.2.2.2.2.cmml">â¡</mo><msub id="alg1.l8.m1.4.4.2.2.2.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.cmml"><mi id="alg1.l8.m1.4.4.2.2.2.2.2.2.2" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.2.cmml">V</mi><mi id="alg1.l8.m1.4.4.2.2.2.2.2.2.3" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.3.cmml">T</mi></msub></mrow></mrow><mo id="alg1.l8.m1.4.4.2.2.2.1" xref="alg1.l8.m1.4.4.2.2.2.1.cmml">â¢</mo><mrow id="alg1.l8.m1.4.4.2.2.2.3.2" xref="alg1.l8.m1.4.4.2.2.2.cmml"><mo id="alg1.l8.m1.4.4.2.2.2.3.2.1" stretchy="false" xref="alg1.l8.m1.4.4.2.2.2.cmml">(</mo><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">s</mi><mo id="alg1.l8.m1.4.4.2.2.2.3.2.2" stretchy="false" xref="alg1.l8.m1.4.4.2.2.2.cmml">)</mo></mrow></mrow><mo id="alg1.l8.m1.4.4.2.2.5" xref="alg1.l8.m1.4.4.2.3.cmml">,</mo><mn id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml">1</mn><mo id="alg1.l8.m1.4.4.2.2.6" stretchy="false" xref="alg1.l8.m1.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.4b"><apply id="alg1.l8.m1.4.4.cmml" xref="alg1.l8.m1.4.4"><times id="alg1.l8.m1.4.4.3.cmml" xref="alg1.l8.m1.4.4.3"></times><ci id="alg1.l8.m1.4.4.4.cmml" xref="alg1.l8.m1.4.4.4">ğº</ci><vector id="alg1.l8.m1.4.4.2.3.cmml" xref="alg1.l8.m1.4.4.2.2"><apply id="alg1.l8.m1.3.3.1.1.1.cmml" xref="alg1.l8.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.1.1.1.1.cmml" xref="alg1.l8.m1.3.3.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.3.3.1.1.1.2.cmml" xref="alg1.l8.m1.3.3.1.1.1.2">ğ‘</ci><ci id="alg1.l8.m1.3.3.1.1.1.3.cmml" xref="alg1.l8.m1.3.3.1.1.1.3">ğœƒ</ci></apply><apply id="alg1.l8.m1.4.4.2.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2"><times id="alg1.l8.m1.4.4.2.2.2.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.1"></times><apply id="alg1.l8.m1.4.4.2.2.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2"><arg id="alg1.l8.m1.4.4.2.2.2.2.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.1"></arg><apply id="alg1.l8.m1.4.4.2.2.2.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2"><apply id="alg1.l8.m1.4.4.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.1"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.2.2.2.2.2.1.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.1">subscript</csymbol><max id="alg1.l8.m1.4.4.2.2.2.2.2.1.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.2"></max><apply id="alg1.l8.m1.4.4.2.2.2.2.2.1.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.3"><in id="alg1.l8.m1.4.4.2.2.2.2.2.1.3.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.3.1"></in><ci id="alg1.l8.m1.4.4.2.2.2.2.2.1.3.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.3.2">ğ‘ </ci><apply id="alg1.l8.m1.4.4.2.2.2.2.2.1.3.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.2.2.2.2.2.1.3.3.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.3.3">subscript</csymbol><ci id="alg1.l8.m1.4.4.2.2.2.2.2.1.3.3.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.3.3.2">ğ‘†</ci><ci id="alg1.l8.m1.4.4.2.2.2.2.2.1.3.3.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.1.3.3.3">ğ‘‡</ci></apply></apply></apply><apply id="alg1.l8.m1.4.4.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.2.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l8.m1.4.4.2.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.2">ğ‘‰</ci><ci id="alg1.l8.m1.4.4.2.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.4.4.2.2.2.2.2.2.3">ğ‘‡</ci></apply></apply></apply><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">ğ‘ </ci></apply><cn id="alg1.l8.m1.2.2.cmml" type="integer" xref="alg1.l8.m1.2.2">1</cn></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.4c">G(p_{\theta},\arg\max_{s\in S_{T}}V_{T}(s),1)</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.4d">italic_G ( italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT , roman_arg roman_max start_POSTSUBSCRIPT italic_s âˆˆ italic_S start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ( italic_s ) , 1 )</annotation></semantics></math>
</div>
</div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_float ltx_minipage ltx_flex_size_2 ltx_align_middle ltx_framed_top" id="alg2" style="width:212.5pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.4.1.1">Algorithm 2</span> </span> ToT-DFS(<math alttext="s,t,p_{\theta},G,k,V,T,v_{\small th}" class="ltx_Math" display="inline" id="alg2.2.m1.8"><semantics id="alg2.2.m1.8b"><mrow id="alg2.2.m1.8.8.2" xref="alg2.2.m1.8.8.3.cmml"><mi id="alg2.2.m1.1.1" xref="alg2.2.m1.1.1.cmml">s</mi><mo id="alg2.2.m1.8.8.2.3" xref="alg2.2.m1.8.8.3.cmml">,</mo><mi id="alg2.2.m1.2.2" xref="alg2.2.m1.2.2.cmml">t</mi><mo id="alg2.2.m1.8.8.2.4" xref="alg2.2.m1.8.8.3.cmml">,</mo><msub id="alg2.2.m1.7.7.1.1" xref="alg2.2.m1.7.7.1.1.cmml"><mi id="alg2.2.m1.7.7.1.1.2" xref="alg2.2.m1.7.7.1.1.2.cmml">p</mi><mi id="alg2.2.m1.7.7.1.1.3" xref="alg2.2.m1.7.7.1.1.3.cmml">Î¸</mi></msub><mo id="alg2.2.m1.8.8.2.5" xref="alg2.2.m1.8.8.3.cmml">,</mo><mi id="alg2.2.m1.3.3" xref="alg2.2.m1.3.3.cmml">G</mi><mo id="alg2.2.m1.8.8.2.6" xref="alg2.2.m1.8.8.3.cmml">,</mo><mi id="alg2.2.m1.4.4" xref="alg2.2.m1.4.4.cmml">k</mi><mo id="alg2.2.m1.8.8.2.7" xref="alg2.2.m1.8.8.3.cmml">,</mo><mi id="alg2.2.m1.5.5" xref="alg2.2.m1.5.5.cmml">V</mi><mo id="alg2.2.m1.8.8.2.8" xref="alg2.2.m1.8.8.3.cmml">,</mo><mi id="alg2.2.m1.6.6" xref="alg2.2.m1.6.6.cmml">T</mi><mo id="alg2.2.m1.8.8.2.9" xref="alg2.2.m1.8.8.3.cmml">,</mo><msub id="alg2.2.m1.8.8.2.2" xref="alg2.2.m1.8.8.2.2.cmml"><mi id="alg2.2.m1.8.8.2.2.2" xref="alg2.2.m1.8.8.2.2.2.cmml">v</mi><mrow id="alg2.2.m1.8.8.2.2.3" xref="alg2.2.m1.8.8.2.2.3.cmml"><mi id="alg2.2.m1.8.8.2.2.3.2" mathsize="128%" xref="alg2.2.m1.8.8.2.2.3.2.cmml">t</mi><mo id="alg2.2.m1.8.8.2.2.3.1" xref="alg2.2.m1.8.8.2.2.3.1.cmml">â¢</mo><mi id="alg2.2.m1.8.8.2.2.3.3" mathsize="128%" xref="alg2.2.m1.8.8.2.2.3.3.cmml">h</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.2.m1.8c"><list id="alg2.2.m1.8.8.3.cmml" xref="alg2.2.m1.8.8.2"><ci id="alg2.2.m1.1.1.cmml" xref="alg2.2.m1.1.1">ğ‘ </ci><ci id="alg2.2.m1.2.2.cmml" xref="alg2.2.m1.2.2">ğ‘¡</ci><apply id="alg2.2.m1.7.7.1.1.cmml" xref="alg2.2.m1.7.7.1.1"><csymbol cd="ambiguous" id="alg2.2.m1.7.7.1.1.1.cmml" xref="alg2.2.m1.7.7.1.1">subscript</csymbol><ci id="alg2.2.m1.7.7.1.1.2.cmml" xref="alg2.2.m1.7.7.1.1.2">ğ‘</ci><ci id="alg2.2.m1.7.7.1.1.3.cmml" xref="alg2.2.m1.7.7.1.1.3">ğœƒ</ci></apply><ci id="alg2.2.m1.3.3.cmml" xref="alg2.2.m1.3.3">ğº</ci><ci id="alg2.2.m1.4.4.cmml" xref="alg2.2.m1.4.4">ğ‘˜</ci><ci id="alg2.2.m1.5.5.cmml" xref="alg2.2.m1.5.5">ğ‘‰</ci><ci id="alg2.2.m1.6.6.cmml" xref="alg2.2.m1.6.6">ğ‘‡</ci><apply id="alg2.2.m1.8.8.2.2.cmml" xref="alg2.2.m1.8.8.2.2"><csymbol cd="ambiguous" id="alg2.2.m1.8.8.2.2.1.cmml" xref="alg2.2.m1.8.8.2.2">subscript</csymbol><ci id="alg2.2.m1.8.8.2.2.2.cmml" xref="alg2.2.m1.8.8.2.2.2">ğ‘£</ci><apply id="alg2.2.m1.8.8.2.2.3.cmml" xref="alg2.2.m1.8.8.2.2.3"><times id="alg2.2.m1.8.8.2.2.3.1.cmml" xref="alg2.2.m1.8.8.2.2.3.1"></times><ci id="alg2.2.m1.8.8.2.2.3.2.cmml" xref="alg2.2.m1.8.8.2.2.3.2">ğ‘¡</ci><ci id="alg2.2.m1.8.8.2.2.3.3.cmml" xref="alg2.2.m1.8.8.2.2.3.3">â„</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.m1.8d">s,t,p_{\theta},G,k,V,T,v_{\small th}</annotation><annotation encoding="application/x-llamapun" id="alg2.2.m1.8e">italic_s , italic_t , italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT , italic_G , italic_k , italic_V , italic_T , italic_v start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT</annotation></semantics></math>)</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.5">
<div class="ltx_listingline" id="alg2.l1">Current state <math alttext="s" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><mi id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">ğ‘ </ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">italic_s</annotation></semantics></math>, step <math alttext="t" class="ltx_Math" display="inline" id="alg2.l1.m2.1"><semantics id="alg2.l1.m2.1a"><mi id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><ci id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m2.1d">italic_t</annotation></semantics></math>, LM <math alttext="p_{\theta}" class="ltx_Math" display="inline" id="alg2.l1.m3.1"><semantics id="alg2.l1.m3.1a"><msub id="alg2.l1.m3.1.1" xref="alg2.l1.m3.1.1.cmml"><mi id="alg2.l1.m3.1.1.2" xref="alg2.l1.m3.1.1.2.cmml">p</mi><mi id="alg2.l1.m3.1.1.3" xref="alg2.l1.m3.1.1.3.cmml">Î¸</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.1b"><apply id="alg2.l1.m3.1.1.cmml" xref="alg2.l1.m3.1.1"><csymbol cd="ambiguous" id="alg2.l1.m3.1.1.1.cmml" xref="alg2.l1.m3.1.1">subscript</csymbol><ci id="alg2.l1.m3.1.1.2.cmml" xref="alg2.l1.m3.1.1.2">ğ‘</ci><ci id="alg2.l1.m3.1.1.3.cmml" xref="alg2.l1.m3.1.1.3">ğœƒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">p_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m3.1d">italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT</annotation></semantics></math>, thought generator <math alttext="G()" class="ltx_Math" display="inline" id="alg2.l1.m4.1"><semantics id="alg2.l1.m4.1a"><mrow id="alg2.l1.m4.1.1" xref="alg2.l1.m4.1.1.cmml"><mi id="alg2.l1.m4.1.1.2" xref="alg2.l1.m4.1.1.2.cmml">G</mi><mo id="alg2.l1.m4.1.1.1" xref="alg2.l1.m4.1.1.1.cmml">â¢</mo><mrow id="alg2.l1.m4.1.1.3.2" xref="alg2.l1.m4.1.1.cmml"><mo id="alg2.l1.m4.1.1.3.2.1" stretchy="false" xref="alg2.l1.m4.1.1.3.1.cmml">(</mo><mo id="alg2.l1.m4.1.1.3.2.2" stretchy="false" xref="alg2.l1.m4.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m4.1b"><apply id="alg2.l1.m4.1.1.cmml" xref="alg2.l1.m4.1.1"><times id="alg2.l1.m4.1.1.1.cmml" xref="alg2.l1.m4.1.1.1"></times><ci id="alg2.l1.m4.1.1.2.cmml" xref="alg2.l1.m4.1.1.2">ğº</ci><list id="alg2.l1.m4.1.1.3.1.cmml" xref="alg2.l1.m4.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m4.1c">G()</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m4.1d">italic_G ( )</annotation></semantics></math> and size limit <math alttext="k" class="ltx_Math" display="inline" id="alg2.l1.m5.1"><semantics id="alg2.l1.m5.1a"><mi id="alg2.l1.m5.1.1" xref="alg2.l1.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m5.1b"><ci id="alg2.l1.m5.1.1.cmml" xref="alg2.l1.m5.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m5.1d">italic_k</annotation></semantics></math>, states evaluator <math alttext="V()" class="ltx_Math" display="inline" id="alg2.l1.m6.1"><semantics id="alg2.l1.m6.1a"><mrow id="alg2.l1.m6.1.1" xref="alg2.l1.m6.1.1.cmml"><mi id="alg2.l1.m6.1.1.2" xref="alg2.l1.m6.1.1.2.cmml">V</mi><mo id="alg2.l1.m6.1.1.1" xref="alg2.l1.m6.1.1.1.cmml">â¢</mo><mrow id="alg2.l1.m6.1.1.3.2" xref="alg2.l1.m6.1.1.cmml"><mo id="alg2.l1.m6.1.1.3.2.1" stretchy="false" xref="alg2.l1.m6.1.1.3.1.cmml">(</mo><mo id="alg2.l1.m6.1.1.3.2.2" stretchy="false" xref="alg2.l1.m6.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m6.1b"><apply id="alg2.l1.m6.1.1.cmml" xref="alg2.l1.m6.1.1"><times id="alg2.l1.m6.1.1.1.cmml" xref="alg2.l1.m6.1.1.1"></times><ci id="alg2.l1.m6.1.1.2.cmml" xref="alg2.l1.m6.1.1.2">ğ‘‰</ci><list id="alg2.l1.m6.1.1.3.1.cmml" xref="alg2.l1.m6.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m6.1c">V()</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m6.1d">italic_V ( )</annotation></semantics></math>, step limit <math alttext="T" class="ltx_Math" display="inline" id="alg2.l1.m7.1"><semantics id="alg2.l1.m7.1a"><mi id="alg2.l1.m7.1.1" xref="alg2.l1.m7.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m7.1b"><ci id="alg2.l1.m7.1.1.cmml" xref="alg2.l1.m7.1.1">ğ‘‡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m7.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m7.1d">italic_T</annotation></semantics></math>, threshold <math alttext="v_{\small th}" class="ltx_Math" display="inline" id="alg2.l1.m8.1"><semantics id="alg2.l1.m8.1a"><msub id="alg2.l1.m8.1.1" xref="alg2.l1.m8.1.1.cmml"><mi id="alg2.l1.m8.1.1.2" xref="alg2.l1.m8.1.1.2.cmml">v</mi><mrow id="alg2.l1.m8.1.1.3" xref="alg2.l1.m8.1.1.3.cmml"><mi id="alg2.l1.m8.1.1.3.2" mathsize="128%" xref="alg2.l1.m8.1.1.3.2.cmml">t</mi><mo id="alg2.l1.m8.1.1.3.1" xref="alg2.l1.m8.1.1.3.1.cmml">â¢</mo><mi id="alg2.l1.m8.1.1.3.3" mathsize="128%" xref="alg2.l1.m8.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m8.1b"><apply id="alg2.l1.m8.1.1.cmml" xref="alg2.l1.m8.1.1"><csymbol cd="ambiguous" id="alg2.l1.m8.1.1.1.cmml" xref="alg2.l1.m8.1.1">subscript</csymbol><ci id="alg2.l1.m8.1.1.2.cmml" xref="alg2.l1.m8.1.1.2">ğ‘£</ci><apply id="alg2.l1.m8.1.1.3.cmml" xref="alg2.l1.m8.1.1.3"><times id="alg2.l1.m8.1.1.3.1.cmml" xref="alg2.l1.m8.1.1.3.1"></times><ci id="alg2.l1.m8.1.1.3.2.cmml" xref="alg2.l1.m8.1.1.3.2">ğ‘¡</ci><ci id="alg2.l1.m8.1.1.3.3.cmml" xref="alg2.l1.m8.1.1.3.3">â„</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m8.1c">v_{\small th}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m8.1d">italic_v start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_text ltx_font_bold" id="alg2.l2.1">if</span>Â <math alttext="t&gt;T" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">t</mi><mo id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml">&gt;</mo><mi id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><gt id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1"></gt><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">ğ‘¡</ci><ci id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">ğ‘‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">t&gt;T</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">italic_t &gt; italic_T</annotation></semantics></math>Â <span class="ltx_text ltx_font_bold" id="alg2.l2.2">then</span>
record output <math alttext="G(p_{\theta},s,1)" class="ltx_Math" display="inline" id="alg2.l2.m2.3"><semantics id="alg2.l2.m2.3a"><mrow id="alg2.l2.m2.3.3" xref="alg2.l2.m2.3.3.cmml"><mi id="alg2.l2.m2.3.3.3" xref="alg2.l2.m2.3.3.3.cmml">G</mi><mo id="alg2.l2.m2.3.3.2" xref="alg2.l2.m2.3.3.2.cmml">â¢</mo><mrow id="alg2.l2.m2.3.3.1.1" xref="alg2.l2.m2.3.3.1.2.cmml"><mo id="alg2.l2.m2.3.3.1.1.2" stretchy="false" xref="alg2.l2.m2.3.3.1.2.cmml">(</mo><msub id="alg2.l2.m2.3.3.1.1.1" xref="alg2.l2.m2.3.3.1.1.1.cmml"><mi id="alg2.l2.m2.3.3.1.1.1.2" xref="alg2.l2.m2.3.3.1.1.1.2.cmml">p</mi><mi id="alg2.l2.m2.3.3.1.1.1.3" xref="alg2.l2.m2.3.3.1.1.1.3.cmml">Î¸</mi></msub><mo id="alg2.l2.m2.3.3.1.1.3" xref="alg2.l2.m2.3.3.1.2.cmml">,</mo><mi id="alg2.l2.m2.1.1" xref="alg2.l2.m2.1.1.cmml">s</mi><mo id="alg2.l2.m2.3.3.1.1.4" xref="alg2.l2.m2.3.3.1.2.cmml">,</mo><mn id="alg2.l2.m2.2.2" xref="alg2.l2.m2.2.2.cmml">1</mn><mo id="alg2.l2.m2.3.3.1.1.5" stretchy="false" xref="alg2.l2.m2.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m2.3b"><apply id="alg2.l2.m2.3.3.cmml" xref="alg2.l2.m2.3.3"><times id="alg2.l2.m2.3.3.2.cmml" xref="alg2.l2.m2.3.3.2"></times><ci id="alg2.l2.m2.3.3.3.cmml" xref="alg2.l2.m2.3.3.3">ğº</ci><vector id="alg2.l2.m2.3.3.1.2.cmml" xref="alg2.l2.m2.3.3.1.1"><apply id="alg2.l2.m2.3.3.1.1.1.cmml" xref="alg2.l2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m2.3.3.1.1.1.1.cmml" xref="alg2.l2.m2.3.3.1.1.1">subscript</csymbol><ci id="alg2.l2.m2.3.3.1.1.1.2.cmml" xref="alg2.l2.m2.3.3.1.1.1.2">ğ‘</ci><ci id="alg2.l2.m2.3.3.1.1.1.3.cmml" xref="alg2.l2.m2.3.3.1.1.1.3">ğœƒ</ci></apply><ci id="alg2.l2.m2.1.1.cmml" xref="alg2.l2.m2.1.1">ğ‘ </ci><cn id="alg2.l2.m2.2.2.cmml" type="integer" xref="alg2.l2.m2.2.2">1</cn></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m2.3c">G(p_{\theta},s,1)</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m2.3d">italic_G ( italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT , italic_s , 1 )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_text ltx_font_bold" id="alg2.l3.1">end</span>Â <span class="ltx_text ltx_font_bold" id="alg2.l3.2">if</span>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_text ltx_font_bold" id="alg2.l4.2">for</span>Â <math alttext="s^{\prime}\in G(p_{\theta},s,k)" class="ltx_Math" display="inline" id="alg2.l4.m1.3"><semantics id="alg2.l4.m1.3a"><mrow id="alg2.l4.m1.3.3" xref="alg2.l4.m1.3.3.cmml"><msup id="alg2.l4.m1.3.3.3" xref="alg2.l4.m1.3.3.3.cmml"><mi id="alg2.l4.m1.3.3.3.2" xref="alg2.l4.m1.3.3.3.2.cmml">s</mi><mo id="alg2.l4.m1.3.3.3.3" xref="alg2.l4.m1.3.3.3.3.cmml">â€²</mo></msup><mo id="alg2.l4.m1.3.3.2" xref="alg2.l4.m1.3.3.2.cmml">âˆˆ</mo><mrow id="alg2.l4.m1.3.3.1" xref="alg2.l4.m1.3.3.1.cmml"><mi id="alg2.l4.m1.3.3.1.3" xref="alg2.l4.m1.3.3.1.3.cmml">G</mi><mo id="alg2.l4.m1.3.3.1.2" xref="alg2.l4.m1.3.3.1.2.cmml">â¢</mo><mrow id="alg2.l4.m1.3.3.1.1.1" xref="alg2.l4.m1.3.3.1.1.2.cmml"><mo id="alg2.l4.m1.3.3.1.1.1.2" stretchy="false" xref="alg2.l4.m1.3.3.1.1.2.cmml">(</mo><msub id="alg2.l4.m1.3.3.1.1.1.1" xref="alg2.l4.m1.3.3.1.1.1.1.cmml"><mi id="alg2.l4.m1.3.3.1.1.1.1.2" xref="alg2.l4.m1.3.3.1.1.1.1.2.cmml">p</mi><mi id="alg2.l4.m1.3.3.1.1.1.1.3" xref="alg2.l4.m1.3.3.1.1.1.1.3.cmml">Î¸</mi></msub><mo id="alg2.l4.m1.3.3.1.1.1.3" xref="alg2.l4.m1.3.3.1.1.2.cmml">,</mo><mi id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml">s</mi><mo id="alg2.l4.m1.3.3.1.1.1.4" xref="alg2.l4.m1.3.3.1.1.2.cmml">,</mo><mi id="alg2.l4.m1.2.2" xref="alg2.l4.m1.2.2.cmml">k</mi><mo id="alg2.l4.m1.3.3.1.1.1.5" stretchy="false" xref="alg2.l4.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.3b"><apply id="alg2.l4.m1.3.3.cmml" xref="alg2.l4.m1.3.3"><in id="alg2.l4.m1.3.3.2.cmml" xref="alg2.l4.m1.3.3.2"></in><apply id="alg2.l4.m1.3.3.3.cmml" xref="alg2.l4.m1.3.3.3"><csymbol cd="ambiguous" id="alg2.l4.m1.3.3.3.1.cmml" xref="alg2.l4.m1.3.3.3">superscript</csymbol><ci id="alg2.l4.m1.3.3.3.2.cmml" xref="alg2.l4.m1.3.3.3.2">ğ‘ </ci><ci id="alg2.l4.m1.3.3.3.3.cmml" xref="alg2.l4.m1.3.3.3.3">â€²</ci></apply><apply id="alg2.l4.m1.3.3.1.cmml" xref="alg2.l4.m1.3.3.1"><times id="alg2.l4.m1.3.3.1.2.cmml" xref="alg2.l4.m1.3.3.1.2"></times><ci id="alg2.l4.m1.3.3.1.3.cmml" xref="alg2.l4.m1.3.3.1.3">ğº</ci><vector id="alg2.l4.m1.3.3.1.1.2.cmml" xref="alg2.l4.m1.3.3.1.1.1"><apply id="alg2.l4.m1.3.3.1.1.1.1.cmml" xref="alg2.l4.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.3.3.1.1.1.1.1.cmml" xref="alg2.l4.m1.3.3.1.1.1.1">subscript</csymbol><ci id="alg2.l4.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l4.m1.3.3.1.1.1.1.2">ğ‘</ci><ci id="alg2.l4.m1.3.3.1.1.1.1.3.cmml" xref="alg2.l4.m1.3.3.1.1.1.1.3">ğœƒ</ci></apply><ci id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1">ğ‘ </ci><ci id="alg2.l4.m1.2.2.cmml" xref="alg2.l4.m1.2.2">ğ‘˜</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.3c">s^{\prime}\in G(p_{\theta},s,k)</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.3d">italic_s start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ italic_G ( italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT , italic_s , italic_k )</annotation></semantics></math> Â <span class="ltx_text ltx_font_bold" id="alg2.l4.3">do</span> <span class="ltx_text" id="alg2.l4.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l4.1.m1.1"><semantics id="alg2.l4.1.m1.1a"><mo id="alg2.l4.1.m1.1.1" xref="alg2.l4.1.m1.1.1.cmml">â–·</mo><annotation-xml encoding="MathML-Content" id="alg2.l4.1.m1.1b"><ci id="alg2.l4.1.m1.1.1.cmml" xref="alg2.l4.1.m1.1.1">â–·</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.1.m1.1d">â–·</annotation></semantics></math> sorted candidates
</span>
</div>
<div class="ltx_listingline" id="alg2.l5">Â Â Â Â Â <span class="ltx_text ltx_font_bold" id="alg2.l5.2">if</span>Â <math alttext="V(p_{\theta},\{s^{\prime}\})(s)&gt;v_{\small thres}" class="ltx_Math" display="inline" id="alg2.l5.m1.3"><semantics id="alg2.l5.m1.3a"><mrow id="alg2.l5.m1.3.3" xref="alg2.l5.m1.3.3.cmml"><mrow id="alg2.l5.m1.3.3.2" xref="alg2.l5.m1.3.3.2.cmml"><mi id="alg2.l5.m1.3.3.2.4" xref="alg2.l5.m1.3.3.2.4.cmml">V</mi><mo id="alg2.l5.m1.3.3.2.3" xref="alg2.l5.m1.3.3.2.3.cmml">â¢</mo><mrow id="alg2.l5.m1.3.3.2.2.2" xref="alg2.l5.m1.3.3.2.2.3.cmml"><mo id="alg2.l5.m1.3.3.2.2.2.3" stretchy="false" xref="alg2.l5.m1.3.3.2.2.3.cmml">(</mo><msub id="alg2.l5.m1.2.2.1.1.1.1" xref="alg2.l5.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l5.m1.2.2.1.1.1.1.2" xref="alg2.l5.m1.2.2.1.1.1.1.2.cmml">p</mi><mi id="alg2.l5.m1.2.2.1.1.1.1.3" xref="alg2.l5.m1.2.2.1.1.1.1.3.cmml">Î¸</mi></msub><mo id="alg2.l5.m1.3.3.2.2.2.4" xref="alg2.l5.m1.3.3.2.2.3.cmml">,</mo><mrow id="alg2.l5.m1.3.3.2.2.2.2.1" xref="alg2.l5.m1.3.3.2.2.2.2.2.cmml"><mo id="alg2.l5.m1.3.3.2.2.2.2.1.2" stretchy="false" xref="alg2.l5.m1.3.3.2.2.2.2.2.cmml">{</mo><msup id="alg2.l5.m1.3.3.2.2.2.2.1.1" xref="alg2.l5.m1.3.3.2.2.2.2.1.1.cmml"><mi id="alg2.l5.m1.3.3.2.2.2.2.1.1.2" xref="alg2.l5.m1.3.3.2.2.2.2.1.1.2.cmml">s</mi><mo id="alg2.l5.m1.3.3.2.2.2.2.1.1.3" xref="alg2.l5.m1.3.3.2.2.2.2.1.1.3.cmml">â€²</mo></msup><mo id="alg2.l5.m1.3.3.2.2.2.2.1.3" stretchy="false" xref="alg2.l5.m1.3.3.2.2.2.2.2.cmml">}</mo></mrow><mo id="alg2.l5.m1.3.3.2.2.2.5" stretchy="false" xref="alg2.l5.m1.3.3.2.2.3.cmml">)</mo></mrow><mo id="alg2.l5.m1.3.3.2.3a" xref="alg2.l5.m1.3.3.2.3.cmml">â¢</mo><mrow id="alg2.l5.m1.3.3.2.5.2" xref="alg2.l5.m1.3.3.2.cmml"><mo id="alg2.l5.m1.3.3.2.5.2.1" stretchy="false" xref="alg2.l5.m1.3.3.2.cmml">(</mo><mi id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml">s</mi><mo id="alg2.l5.m1.3.3.2.5.2.2" stretchy="false" xref="alg2.l5.m1.3.3.2.cmml">)</mo></mrow></mrow><mo id="alg2.l5.m1.3.3.3" xref="alg2.l5.m1.3.3.3.cmml">&gt;</mo><msub id="alg2.l5.m1.3.3.4" xref="alg2.l5.m1.3.3.4.cmml"><mi id="alg2.l5.m1.3.3.4.2" xref="alg2.l5.m1.3.3.4.2.cmml">v</mi><mrow id="alg2.l5.m1.3.3.4.3" xref="alg2.l5.m1.3.3.4.3.cmml"><mi id="alg2.l5.m1.3.3.4.3.2" mathsize="128%" xref="alg2.l5.m1.3.3.4.3.2.cmml">t</mi><mo id="alg2.l5.m1.3.3.4.3.1" xref="alg2.l5.m1.3.3.4.3.1.cmml">â¢</mo><mi id="alg2.l5.m1.3.3.4.3.3" mathsize="128%" xref="alg2.l5.m1.3.3.4.3.3.cmml">h</mi><mo id="alg2.l5.m1.3.3.4.3.1a" xref="alg2.l5.m1.3.3.4.3.1.cmml">â¢</mo><mi id="alg2.l5.m1.3.3.4.3.4" mathsize="128%" xref="alg2.l5.m1.3.3.4.3.4.cmml">r</mi><mo id="alg2.l5.m1.3.3.4.3.1b" xref="alg2.l5.m1.3.3.4.3.1.cmml">â¢</mo><mi id="alg2.l5.m1.3.3.4.3.5" mathsize="128%" xref="alg2.l5.m1.3.3.4.3.5.cmml">e</mi><mo id="alg2.l5.m1.3.3.4.3.1c" xref="alg2.l5.m1.3.3.4.3.1.cmml">â¢</mo><mi id="alg2.l5.m1.3.3.4.3.6" mathsize="128%" xref="alg2.l5.m1.3.3.4.3.6.cmml">s</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.3b"><apply id="alg2.l5.m1.3.3.cmml" xref="alg2.l5.m1.3.3"><gt id="alg2.l5.m1.3.3.3.cmml" xref="alg2.l5.m1.3.3.3"></gt><apply id="alg2.l5.m1.3.3.2.cmml" xref="alg2.l5.m1.3.3.2"><times id="alg2.l5.m1.3.3.2.3.cmml" xref="alg2.l5.m1.3.3.2.3"></times><ci id="alg2.l5.m1.3.3.2.4.cmml" xref="alg2.l5.m1.3.3.2.4">ğ‘‰</ci><interval closure="open" id="alg2.l5.m1.3.3.2.2.3.cmml" xref="alg2.l5.m1.3.3.2.2.2"><apply id="alg2.l5.m1.2.2.1.1.1.1.cmml" xref="alg2.l5.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l5.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l5.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l5.m1.2.2.1.1.1.1.2">ğ‘</ci><ci id="alg2.l5.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l5.m1.2.2.1.1.1.1.3">ğœƒ</ci></apply><set id="alg2.l5.m1.3.3.2.2.2.2.2.cmml" xref="alg2.l5.m1.3.3.2.2.2.2.1"><apply id="alg2.l5.m1.3.3.2.2.2.2.1.1.cmml" xref="alg2.l5.m1.3.3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l5.m1.3.3.2.2.2.2.1.1.1.cmml" xref="alg2.l5.m1.3.3.2.2.2.2.1.1">superscript</csymbol><ci id="alg2.l5.m1.3.3.2.2.2.2.1.1.2.cmml" xref="alg2.l5.m1.3.3.2.2.2.2.1.1.2">ğ‘ </ci><ci id="alg2.l5.m1.3.3.2.2.2.2.1.1.3.cmml" xref="alg2.l5.m1.3.3.2.2.2.2.1.1.3">â€²</ci></apply></set></interval><ci id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1">ğ‘ </ci></apply><apply id="alg2.l5.m1.3.3.4.cmml" xref="alg2.l5.m1.3.3.4"><csymbol cd="ambiguous" id="alg2.l5.m1.3.3.4.1.cmml" xref="alg2.l5.m1.3.3.4">subscript</csymbol><ci id="alg2.l5.m1.3.3.4.2.cmml" xref="alg2.l5.m1.3.3.4.2">ğ‘£</ci><apply id="alg2.l5.m1.3.3.4.3.cmml" xref="alg2.l5.m1.3.3.4.3"><times id="alg2.l5.m1.3.3.4.3.1.cmml" xref="alg2.l5.m1.3.3.4.3.1"></times><ci id="alg2.l5.m1.3.3.4.3.2.cmml" xref="alg2.l5.m1.3.3.4.3.2">ğ‘¡</ci><ci id="alg2.l5.m1.3.3.4.3.3.cmml" xref="alg2.l5.m1.3.3.4.3.3">â„</ci><ci id="alg2.l5.m1.3.3.4.3.4.cmml" xref="alg2.l5.m1.3.3.4.3.4">ğ‘Ÿ</ci><ci id="alg2.l5.m1.3.3.4.3.5.cmml" xref="alg2.l5.m1.3.3.4.3.5">ğ‘’</ci><ci id="alg2.l5.m1.3.3.4.3.6.cmml" xref="alg2.l5.m1.3.3.4.3.6">ğ‘ </ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.3c">V(p_{\theta},\{s^{\prime}\})(s)&gt;v_{\small thres}</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.3d">italic_V ( italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT , { italic_s start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT } ) ( italic_s ) &gt; italic_v start_POSTSUBSCRIPT italic_t italic_h italic_r italic_e italic_s end_POSTSUBSCRIPT</annotation></semantics></math>Â <span class="ltx_text ltx_font_bold" id="alg2.l5.3">then</span> <span class="ltx_text" id="alg2.l5.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l5.1.m1.1"><semantics id="alg2.l5.1.m1.1a"><mo id="alg2.l5.1.m1.1.1" xref="alg2.l5.1.m1.1.1.cmml">â–·</mo><annotation-xml encoding="MathML-Content" id="alg2.l5.1.m1.1b"><ci id="alg2.l5.1.m1.1.1.cmml" xref="alg2.l5.1.m1.1.1">â–·</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.1.m1.1d">â–·</annotation></semantics></math> pruning
</span>
</div>
<div class="ltx_listingline" id="alg2.l6">Â Â Â Â Â Â Â Â Â DFS<math alttext="(s^{\prime},t+1)" class="ltx_Math" display="inline" id="alg2.l6.m1.2"><semantics id="alg2.l6.m1.2a"><mrow id="alg2.l6.m1.2.2.2" xref="alg2.l6.m1.2.2.3.cmml"><mo id="alg2.l6.m1.2.2.2.3" stretchy="false" xref="alg2.l6.m1.2.2.3.cmml">(</mo><msup id="alg2.l6.m1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.cmml"><mi id="alg2.l6.m1.1.1.1.1.2" xref="alg2.l6.m1.1.1.1.1.2.cmml">s</mi><mo id="alg2.l6.m1.1.1.1.1.3" xref="alg2.l6.m1.1.1.1.1.3.cmml">â€²</mo></msup><mo id="alg2.l6.m1.2.2.2.4" xref="alg2.l6.m1.2.2.3.cmml">,</mo><mrow id="alg2.l6.m1.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.cmml"><mi id="alg2.l6.m1.2.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.2.cmml">t</mi><mo id="alg2.l6.m1.2.2.2.2.1" xref="alg2.l6.m1.2.2.2.2.1.cmml">+</mo><mn id="alg2.l6.m1.2.2.2.2.3" xref="alg2.l6.m1.2.2.2.2.3.cmml">1</mn></mrow><mo id="alg2.l6.m1.2.2.2.5" stretchy="false" xref="alg2.l6.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.2b"><interval closure="open" id="alg2.l6.m1.2.2.3.cmml" xref="alg2.l6.m1.2.2.2"><apply id="alg2.l6.m1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1">superscript</csymbol><ci id="alg2.l6.m1.1.1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.1.2">ğ‘ </ci><ci id="alg2.l6.m1.1.1.1.1.3.cmml" xref="alg2.l6.m1.1.1.1.1.3">â€²</ci></apply><apply id="alg2.l6.m1.2.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.2"><plus id="alg2.l6.m1.2.2.2.2.1.cmml" xref="alg2.l6.m1.2.2.2.2.1"></plus><ci id="alg2.l6.m1.2.2.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.2.2">ğ‘¡</ci><cn id="alg2.l6.m1.2.2.2.2.3.cmml" type="integer" xref="alg2.l6.m1.2.2.2.2.3">1</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.2c">(s^{\prime},t+1)</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.2d">( italic_s start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT , italic_t + 1 )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l7">Â Â Â Â Â <span class="ltx_text ltx_font_bold" id="alg2.l7.1">end</span>Â <span class="ltx_text ltx_font_bold" id="alg2.l7.2">if</span>
</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_text ltx_font_bold" id="alg2.l8.1">end</span>Â <span class="ltx_text ltx_font_bold" id="alg2.l8.2">for</span>
</div>
</div>
</figure>
</div>
</div>
</figure>
<div class="ltx_para" id="S3.p7">
<p class="ltx_p" id="S3.p7.1"><span class="ltx_text ltx_font_bold" id="S3.p7.1.1">4. Search algorithm.</span> Finally, within the ToT framework, one can plug and play different search algorithms depending on the tree structure. We explore two relatively simple search algorithms and leave more advanced ones (e.g.â€‰A* <cite class="ltx_cite ltx_citemacro_cite">Hart etÂ al. (<a class="ltx_ref" href="#bib.bib11" title="">1968b</a>)</cite>, MCTSÂ <cite class="ltx_cite ltx_citemacro_cite">Browne etÂ al. (<a class="ltx_ref" href="#bib.bib2" title="">2012</a>)</cite>) for future work:</p>
<ol class="ltx_enumerate" id="S3.I3">
<li class="ltx_item" id="S3.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(a)</span>
<div class="ltx_para" id="S3.I3.i1.p1">
<p class="ltx_p" id="S3.I3.i1.p1.3"><span class="ltx_text ltx_font_bold" id="S3.I3.i1.p1.3.1">Breadth-first search (BFS)</span> (AlgorithmÂ <a class="ltx_ref" href="#alg1" title="Algorithm 1 â€£ 3 Tree of Thoughts: Deliberate Problem Solving with LM â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>) maintains a set of the <math alttext="b" class="ltx_Math" display="inline" id="S3.I3.i1.p1.1.m1.1"><semantics id="S3.I3.i1.p1.1.m1.1a"><mi id="S3.I3.i1.p1.1.m1.1.1" xref="S3.I3.i1.p1.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.I3.i1.p1.1.m1.1b"><ci id="S3.I3.i1.p1.1.m1.1.1.cmml" xref="S3.I3.i1.p1.1.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I3.i1.p1.1.m1.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.I3.i1.p1.1.m1.1d">italic_b</annotation></semantics></math> most promising states per step. This is used for Game of 24 and Creative Writing where the tree depth is limit (<math alttext="T\leq 3" class="ltx_Math" display="inline" id="S3.I3.i1.p1.2.m2.1"><semantics id="S3.I3.i1.p1.2.m2.1a"><mrow id="S3.I3.i1.p1.2.m2.1.1" xref="S3.I3.i1.p1.2.m2.1.1.cmml"><mi id="S3.I3.i1.p1.2.m2.1.1.2" xref="S3.I3.i1.p1.2.m2.1.1.2.cmml">T</mi><mo id="S3.I3.i1.p1.2.m2.1.1.1" xref="S3.I3.i1.p1.2.m2.1.1.1.cmml">â‰¤</mo><mn id="S3.I3.i1.p1.2.m2.1.1.3" xref="S3.I3.i1.p1.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I3.i1.p1.2.m2.1b"><apply id="S3.I3.i1.p1.2.m2.1.1.cmml" xref="S3.I3.i1.p1.2.m2.1.1"><leq id="S3.I3.i1.p1.2.m2.1.1.1.cmml" xref="S3.I3.i1.p1.2.m2.1.1.1"></leq><ci id="S3.I3.i1.p1.2.m2.1.1.2.cmml" xref="S3.I3.i1.p1.2.m2.1.1.2">ğ‘‡</ci><cn id="S3.I3.i1.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.I3.i1.p1.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I3.i1.p1.2.m2.1c">T\leq 3</annotation><annotation encoding="application/x-llamapun" id="S3.I3.i1.p1.2.m2.1d">italic_T â‰¤ 3</annotation></semantics></math>), and initial thought steps can be evaluated and pruned to a small set (<math alttext="b\leq 5" class="ltx_Math" display="inline" id="S3.I3.i1.p1.3.m3.1"><semantics id="S3.I3.i1.p1.3.m3.1a"><mrow id="S3.I3.i1.p1.3.m3.1.1" xref="S3.I3.i1.p1.3.m3.1.1.cmml"><mi id="S3.I3.i1.p1.3.m3.1.1.2" xref="S3.I3.i1.p1.3.m3.1.1.2.cmml">b</mi><mo id="S3.I3.i1.p1.3.m3.1.1.1" xref="S3.I3.i1.p1.3.m3.1.1.1.cmml">â‰¤</mo><mn id="S3.I3.i1.p1.3.m3.1.1.3" xref="S3.I3.i1.p1.3.m3.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I3.i1.p1.3.m3.1b"><apply id="S3.I3.i1.p1.3.m3.1.1.cmml" xref="S3.I3.i1.p1.3.m3.1.1"><leq id="S3.I3.i1.p1.3.m3.1.1.1.cmml" xref="S3.I3.i1.p1.3.m3.1.1.1"></leq><ci id="S3.I3.i1.p1.3.m3.1.1.2.cmml" xref="S3.I3.i1.p1.3.m3.1.1.2">ğ‘</ci><cn id="S3.I3.i1.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.I3.i1.p1.3.m3.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I3.i1.p1.3.m3.1c">b\leq 5</annotation><annotation encoding="application/x-llamapun" id="S3.I3.i1.p1.3.m3.1d">italic_b â‰¤ 5</annotation></semantics></math>).
</p>
</div>
</li>
<li class="ltx_item" id="S3.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(b)</span>
<div class="ltx_para" id="S3.I3.i2.p1">
<p class="ltx_p" id="S3.I3.i2.p1.6"><span class="ltx_text ltx_font_bold" id="S3.I3.i2.p1.6.1">Depth-first search (DFS)</span> (AlgorithmÂ <a class="ltx_ref" href="#alg2" title="Algorithm 2 â€£ 3 Tree of Thoughts: Deliberate Problem Solving with LM â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>) explores the most promising state first, until the final output is reached (<math alttext="t&gt;T" class="ltx_Math" display="inline" id="S3.I3.i2.p1.1.m1.1"><semantics id="S3.I3.i2.p1.1.m1.1a"><mrow id="S3.I3.i2.p1.1.m1.1.1" xref="S3.I3.i2.p1.1.m1.1.1.cmml"><mi id="S3.I3.i2.p1.1.m1.1.1.2" xref="S3.I3.i2.p1.1.m1.1.1.2.cmml">t</mi><mo id="S3.I3.i2.p1.1.m1.1.1.1" xref="S3.I3.i2.p1.1.m1.1.1.1.cmml">&gt;</mo><mi id="S3.I3.i2.p1.1.m1.1.1.3" xref="S3.I3.i2.p1.1.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.I3.i2.p1.1.m1.1b"><apply id="S3.I3.i2.p1.1.m1.1.1.cmml" xref="S3.I3.i2.p1.1.m1.1.1"><gt id="S3.I3.i2.p1.1.m1.1.1.1.cmml" xref="S3.I3.i2.p1.1.m1.1.1.1"></gt><ci id="S3.I3.i2.p1.1.m1.1.1.2.cmml" xref="S3.I3.i2.p1.1.m1.1.1.2">ğ‘¡</ci><ci id="S3.I3.i2.p1.1.m1.1.1.3.cmml" xref="S3.I3.i2.p1.1.m1.1.1.3">ğ‘‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I3.i2.p1.1.m1.1c">t&gt;T</annotation><annotation encoding="application/x-llamapun" id="S3.I3.i2.p1.1.m1.1d">italic_t &gt; italic_T</annotation></semantics></math>), or the state evaluator deems it impossible to solve the problem from the current <math alttext="s" class="ltx_Math" display="inline" id="S3.I3.i2.p1.2.m2.1"><semantics id="S3.I3.i2.p1.2.m2.1a"><mi id="S3.I3.i2.p1.2.m2.1.1" xref="S3.I3.i2.p1.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.I3.i2.p1.2.m2.1b"><ci id="S3.I3.i2.p1.2.m2.1.1.cmml" xref="S3.I3.i2.p1.2.m2.1.1">ğ‘ </ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I3.i2.p1.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.I3.i2.p1.2.m2.1d">italic_s</annotation></semantics></math> (<math alttext="V(p_{\theta},\{s\})(s)\leq v_{th}" class="ltx_Math" display="inline" id="S3.I3.i2.p1.3.m3.4"><semantics id="S3.I3.i2.p1.3.m3.4a"><mrow id="S3.I3.i2.p1.3.m3.4.4" xref="S3.I3.i2.p1.3.m3.4.4.cmml"><mrow id="S3.I3.i2.p1.3.m3.4.4.2" xref="S3.I3.i2.p1.3.m3.4.4.2.cmml"><mi id="S3.I3.i2.p1.3.m3.4.4.2.4" xref="S3.I3.i2.p1.3.m3.4.4.2.4.cmml">V</mi><mo id="S3.I3.i2.p1.3.m3.4.4.2.3" xref="S3.I3.i2.p1.3.m3.4.4.2.3.cmml">â¢</mo><mrow id="S3.I3.i2.p1.3.m3.4.4.2.2.2" xref="S3.I3.i2.p1.3.m3.4.4.2.2.3.cmml"><mo id="S3.I3.i2.p1.3.m3.4.4.2.2.2.3" stretchy="false" xref="S3.I3.i2.p1.3.m3.4.4.2.2.3.cmml">(</mo><msub id="S3.I3.i2.p1.3.m3.3.3.1.1.1.1" xref="S3.I3.i2.p1.3.m3.3.3.1.1.1.1.cmml"><mi id="S3.I3.i2.p1.3.m3.3.3.1.1.1.1.2" xref="S3.I3.i2.p1.3.m3.3.3.1.1.1.1.2.cmml">p</mi><mi id="S3.I3.i2.p1.3.m3.3.3.1.1.1.1.3" xref="S3.I3.i2.p1.3.m3.3.3.1.1.1.1.3.cmml">Î¸</mi></msub><mo id="S3.I3.i2.p1.3.m3.4.4.2.2.2.4" xref="S3.I3.i2.p1.3.m3.4.4.2.2.3.cmml">,</mo><mrow id="S3.I3.i2.p1.3.m3.4.4.2.2.2.2.2" xref="S3.I3.i2.p1.3.m3.4.4.2.2.2.2.1.cmml"><mo id="S3.I3.i2.p1.3.m3.4.4.2.2.2.2.2.1" stretchy="false" xref="S3.I3.i2.p1.3.m3.4.4.2.2.2.2.1.cmml">{</mo><mi id="S3.I3.i2.p1.3.m3.1.1" xref="S3.I3.i2.p1.3.m3.1.1.cmml">s</mi><mo id="S3.I3.i2.p1.3.m3.4.4.2.2.2.2.2.2" stretchy="false" xref="S3.I3.i2.p1.3.m3.4.4.2.2.2.2.1.cmml">}</mo></mrow><mo id="S3.I3.i2.p1.3.m3.4.4.2.2.2.5" stretchy="false" xref="S3.I3.i2.p1.3.m3.4.4.2.2.3.cmml">)</mo></mrow><mo id="S3.I3.i2.p1.3.m3.4.4.2.3a" xref="S3.I3.i2.p1.3.m3.4.4.2.3.cmml">â¢</mo><mrow id="S3.I3.i2.p1.3.m3.4.4.2.5.2" xref="S3.I3.i2.p1.3.m3.4.4.2.cmml"><mo id="S3.I3.i2.p1.3.m3.4.4.2.5.2.1" stretchy="false" xref="S3.I3.i2.p1.3.m3.4.4.2.cmml">(</mo><mi id="S3.I3.i2.p1.3.m3.2.2" xref="S3.I3.i2.p1.3.m3.2.2.cmml">s</mi><mo id="S3.I3.i2.p1.3.m3.4.4.2.5.2.2" stretchy="false" xref="S3.I3.i2.p1.3.m3.4.4.2.cmml">)</mo></mrow></mrow><mo id="S3.I3.i2.p1.3.m3.4.4.3" xref="S3.I3.i2.p1.3.m3.4.4.3.cmml">â‰¤</mo><msub id="S3.I3.i2.p1.3.m3.4.4.4" xref="S3.I3.i2.p1.3.m3.4.4.4.cmml"><mi id="S3.I3.i2.p1.3.m3.4.4.4.2" xref="S3.I3.i2.p1.3.m3.4.4.4.2.cmml">v</mi><mrow id="S3.I3.i2.p1.3.m3.4.4.4.3" xref="S3.I3.i2.p1.3.m3.4.4.4.3.cmml"><mi id="S3.I3.i2.p1.3.m3.4.4.4.3.2" xref="S3.I3.i2.p1.3.m3.4.4.4.3.2.cmml">t</mi><mo id="S3.I3.i2.p1.3.m3.4.4.4.3.1" xref="S3.I3.i2.p1.3.m3.4.4.4.3.1.cmml">â¢</mo><mi id="S3.I3.i2.p1.3.m3.4.4.4.3.3" xref="S3.I3.i2.p1.3.m3.4.4.4.3.3.cmml">h</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.I3.i2.p1.3.m3.4b"><apply id="S3.I3.i2.p1.3.m3.4.4.cmml" xref="S3.I3.i2.p1.3.m3.4.4"><leq id="S3.I3.i2.p1.3.m3.4.4.3.cmml" xref="S3.I3.i2.p1.3.m3.4.4.3"></leq><apply id="S3.I3.i2.p1.3.m3.4.4.2.cmml" xref="S3.I3.i2.p1.3.m3.4.4.2"><times id="S3.I3.i2.p1.3.m3.4.4.2.3.cmml" xref="S3.I3.i2.p1.3.m3.4.4.2.3"></times><ci id="S3.I3.i2.p1.3.m3.4.4.2.4.cmml" xref="S3.I3.i2.p1.3.m3.4.4.2.4">ğ‘‰</ci><interval closure="open" id="S3.I3.i2.p1.3.m3.4.4.2.2.3.cmml" xref="S3.I3.i2.p1.3.m3.4.4.2.2.2"><apply id="S3.I3.i2.p1.3.m3.3.3.1.1.1.1.cmml" xref="S3.I3.i2.p1.3.m3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.I3.i2.p1.3.m3.3.3.1.1.1.1.1.cmml" xref="S3.I3.i2.p1.3.m3.3.3.1.1.1.1">subscript</csymbol><ci id="S3.I3.i2.p1.3.m3.3.3.1.1.1.1.2.cmml" xref="S3.I3.i2.p1.3.m3.3.3.1.1.1.1.2">ğ‘</ci><ci id="S3.I3.i2.p1.3.m3.3.3.1.1.1.1.3.cmml" xref="S3.I3.i2.p1.3.m3.3.3.1.1.1.1.3">ğœƒ</ci></apply><set id="S3.I3.i2.p1.3.m3.4.4.2.2.2.2.1.cmml" xref="S3.I3.i2.p1.3.m3.4.4.2.2.2.2.2"><ci id="S3.I3.i2.p1.3.m3.1.1.cmml" xref="S3.I3.i2.p1.3.m3.1.1">ğ‘ </ci></set></interval><ci id="S3.I3.i2.p1.3.m3.2.2.cmml" xref="S3.I3.i2.p1.3.m3.2.2">ğ‘ </ci></apply><apply id="S3.I3.i2.p1.3.m3.4.4.4.cmml" xref="S3.I3.i2.p1.3.m3.4.4.4"><csymbol cd="ambiguous" id="S3.I3.i2.p1.3.m3.4.4.4.1.cmml" xref="S3.I3.i2.p1.3.m3.4.4.4">subscript</csymbol><ci id="S3.I3.i2.p1.3.m3.4.4.4.2.cmml" xref="S3.I3.i2.p1.3.m3.4.4.4.2">ğ‘£</ci><apply id="S3.I3.i2.p1.3.m3.4.4.4.3.cmml" xref="S3.I3.i2.p1.3.m3.4.4.4.3"><times id="S3.I3.i2.p1.3.m3.4.4.4.3.1.cmml" xref="S3.I3.i2.p1.3.m3.4.4.4.3.1"></times><ci id="S3.I3.i2.p1.3.m3.4.4.4.3.2.cmml" xref="S3.I3.i2.p1.3.m3.4.4.4.3.2">ğ‘¡</ci><ci id="S3.I3.i2.p1.3.m3.4.4.4.3.3.cmml" xref="S3.I3.i2.p1.3.m3.4.4.4.3.3">â„</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I3.i2.p1.3.m3.4c">V(p_{\theta},\{s\})(s)\leq v_{th}</annotation><annotation encoding="application/x-llamapun" id="S3.I3.i2.p1.3.m3.4d">italic_V ( italic_p start_POSTSUBSCRIPT italic_Î¸ end_POSTSUBSCRIPT , { italic_s } ) ( italic_s ) â‰¤ italic_v start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT</annotation></semantics></math> for a value threshold <math alttext="v_{th}" class="ltx_Math" display="inline" id="S3.I3.i2.p1.4.m4.1"><semantics id="S3.I3.i2.p1.4.m4.1a"><msub id="S3.I3.i2.p1.4.m4.1.1" xref="S3.I3.i2.p1.4.m4.1.1.cmml"><mi id="S3.I3.i2.p1.4.m4.1.1.2" xref="S3.I3.i2.p1.4.m4.1.1.2.cmml">v</mi><mrow id="S3.I3.i2.p1.4.m4.1.1.3" xref="S3.I3.i2.p1.4.m4.1.1.3.cmml"><mi id="S3.I3.i2.p1.4.m4.1.1.3.2" xref="S3.I3.i2.p1.4.m4.1.1.3.2.cmml">t</mi><mo id="S3.I3.i2.p1.4.m4.1.1.3.1" xref="S3.I3.i2.p1.4.m4.1.1.3.1.cmml">â¢</mo><mi id="S3.I3.i2.p1.4.m4.1.1.3.3" xref="S3.I3.i2.p1.4.m4.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.I3.i2.p1.4.m4.1b"><apply id="S3.I3.i2.p1.4.m4.1.1.cmml" xref="S3.I3.i2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.I3.i2.p1.4.m4.1.1.1.cmml" xref="S3.I3.i2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.I3.i2.p1.4.m4.1.1.2.cmml" xref="S3.I3.i2.p1.4.m4.1.1.2">ğ‘£</ci><apply id="S3.I3.i2.p1.4.m4.1.1.3.cmml" xref="S3.I3.i2.p1.4.m4.1.1.3"><times id="S3.I3.i2.p1.4.m4.1.1.3.1.cmml" xref="S3.I3.i2.p1.4.m4.1.1.3.1"></times><ci id="S3.I3.i2.p1.4.m4.1.1.3.2.cmml" xref="S3.I3.i2.p1.4.m4.1.1.3.2">ğ‘¡</ci><ci id="S3.I3.i2.p1.4.m4.1.1.3.3.cmml" xref="S3.I3.i2.p1.4.m4.1.1.3.3">â„</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I3.i2.p1.4.m4.1c">v_{th}</annotation><annotation encoding="application/x-llamapun" id="S3.I3.i2.p1.4.m4.1d">italic_v start_POSTSUBSCRIPT italic_t italic_h end_POSTSUBSCRIPT</annotation></semantics></math>). In the latter case, the subtree from <math alttext="s" class="ltx_Math" display="inline" id="S3.I3.i2.p1.5.m5.1"><semantics id="S3.I3.i2.p1.5.m5.1a"><mi id="S3.I3.i2.p1.5.m5.1.1" xref="S3.I3.i2.p1.5.m5.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.I3.i2.p1.5.m5.1b"><ci id="S3.I3.i2.p1.5.m5.1.1.cmml" xref="S3.I3.i2.p1.5.m5.1.1">ğ‘ </ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I3.i2.p1.5.m5.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.I3.i2.p1.5.m5.1d">italic_s</annotation></semantics></math> is <span class="ltx_text ltx_font_italic" id="S3.I3.i2.p1.6.2">pruned</span> to trade exploration for exploitation. In both cases, DFS <span class="ltx_text ltx_font_italic" id="S3.I3.i2.p1.6.3">backtracks</span> to the parent state of <math alttext="s" class="ltx_Math" display="inline" id="S3.I3.i2.p1.6.m6.1"><semantics id="S3.I3.i2.p1.6.m6.1a"><mi id="S3.I3.i2.p1.6.m6.1.1" xref="S3.I3.i2.p1.6.m6.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.I3.i2.p1.6.m6.1b"><ci id="S3.I3.i2.p1.6.m6.1.1.cmml" xref="S3.I3.i2.p1.6.m6.1.1">ğ‘ </ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I3.i2.p1.6.m6.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.I3.i2.p1.6.m6.1d">italic_s</annotation></semantics></math> to continue exploration.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S3.p8">
<p class="ltx_p" id="S3.p8.1">Conceptually, ToT has several benefits as a method for general problem-solving with LMs: (1) <span class="ltx_text ltx_font_italic" id="S3.p8.1.1">Generality.</span> IO, CoT, CoT-SC, and self-refinement can be seen as special cases of ToT (i.e. trees of limited depth and breadth; FigureÂ <a class="ltx_ref" href="#S1.F1" title="Figure 1 â€£ 1 Introduction â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>). (2) <span class="ltx_text ltx_font_italic" id="S3.p8.1.2">Modularity.</span> The base LM, as well as the thought decomposition, generation, evaluation, and search procedures can all be varied independently. (3) <span class="ltx_text ltx_font_italic" id="S3.p8.1.3">Adaptability</span>. Different problem properties, LM capabilities, and resource constraints can be accommodated. (4) <span class="ltx_text ltx_font_italic" id="S3.p8.1.4">Convenience.</span> No extra training is needed, just a pre-trained LM is sufficient. The next section will show how these conceptual benefits translate to strong empirical performance in different problems. </p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<figure class="ltx_table" id="S4.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.1.1.1">
<th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T1.1.1.1.1"></th>
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.2"><span class="ltx_text ltx_font_bold ltx_align_top" id="S4.T1.1.1.1.2.1">Game of 24</span></th>
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.3"><span class="ltx_text ltx_font_bold ltx_align_top" id="S4.T1.1.1.1.3.1">Creative Writing</span></th>
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.4"><span class="ltx_text ltx_font_bold ltx_align_top" id="S4.T1.1.1.1.4.1">5x5 Crosswords</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.2.1.1.1" style="font-size:90%;">Input</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S4.T1.1.2.1.2">
<p class="ltx_p ltx_align_top" id="S4.T1.1.2.1.2.1">4 numbers <span class="ltx_text" id="S4.T1.1.2.1.2.1.1" style="color:#0000FF;">(4 9 10 13)</span></p>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S4.T1.1.2.1.3">
<p class="ltx_p ltx_align_top" id="S4.T1.1.2.1.3.1">4 random sentences</p>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S4.T1.1.2.1.4">
<p class="ltx_p ltx_align_top" id="S4.T1.1.2.1.4.1">10 clues <span class="ltx_text" id="S4.T1.1.2.1.4.1.1" style="color:#0000FF;">(h1.â€‰presented;..)</span></p>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.1.3.2.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.3.2.1.1" style="font-size:90%;">Output</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S4.T1.1.3.2.2">
<p class="ltx_p ltx_align_top" id="S4.T1.1.3.2.2.1">An equation to reach 24 <span class="ltx_text" id="S4.T1.1.3.2.2.1.1" style="color:#0000FF;">(13-9)*(10-4)=24</span></p>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S4.T1.1.3.2.3">
<p class="ltx_p ltx_align_top" id="S4.T1.1.3.2.3.1">A passage of 4 paragraphs ending in the 4 sentences</p>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S4.T1.1.3.2.4">
<p class="ltx_p ltx_align_top" id="S4.T1.1.3.2.4.1">5x5 letters: <span class="ltx_text" id="S4.T1.1.3.2.4.1.1" style="color:#0000FF;">SHOWN; WIRRA; AVAIL; â€¦</span></p>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.1.4.3.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.4.3.1.1" style="font-size:90%;">Thoughts</span></th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S4.T1.1.4.3.2">
<p class="ltx_p ltx_align_top" id="S4.T1.1.4.3.2.1">3 intermediate equations <span class="ltx_text" id="S4.T1.1.4.3.2.1.1" style="color:#0000FF;">(13-9=4 (left 4,4,10); 10-4=6 (left 4,6); 4*6=24)</span></p>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S4.T1.1.4.3.3">
<p class="ltx_p ltx_align_top" id="S4.T1.1.4.3.3.1">A short writing plan <span class="ltx_text" id="S4.T1.1.4.3.3.1.1" style="color:#0000FF;">(1.â€‰Introduce a book that connectsâ€¦)</span></p>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S4.T1.1.4.3.4">
<p class="ltx_p ltx_align_top" id="S4.T1.1.4.3.4.1">Words to fill in for clues: <span class="ltx_text" id="S4.T1.1.4.3.4.1.1" style="color:#0000FF;">(h1.â€‰shown; v5.â€‰naled; â€¦)</span></p>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.1.5.4.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.5.4.1.1" style="font-size:90%;">#ToT steps</span></th>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_t" id="S4.T1.1.5.4.2">
<p class="ltx_p ltx_align_top" id="S4.T1.1.5.4.2.1">3</p>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_t" id="S4.T1.1.5.4.3">
<p class="ltx_p ltx_align_top" id="S4.T1.1.5.4.3.1">1</p>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_t" id="S4.T1.1.5.4.4">
<p class="ltx_p ltx_align_top" id="S4.T1.1.5.4.4.1">5-10 (variable)</p>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Task overview. Input, output, thought examples are in blue. </figcaption>
</figure>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We propose three tasks that are hard even when sampling from the state-of-the-art language model, GPT-4Â <cite class="ltx_cite ltx_citemacro_citep">(OpenAI, <a class="ltx_ref" href="#bib.bib23" title="">2023</a>)</cite>, using standard IO prompting or chain-of-thought (CoT) prompting. We show how deliberate search in trees of thoughts (ToT) produces better results, and more importantly, interesting and promising new ways to use language models to solve problems requiring search or planning.
Unless otherwise stated, we perform experiments using a Chat Completion mode GPT-4<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Experiments were done between May 5-16, 2023.</span></span></span> with a sampling temperature of 0.7.
</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Game of 24</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Game of 24 is a mathematical reasoning challenge, where the goal is to use 4 numbers and basic arithmetic operations (+-*/) to obtain 24.
For example, given input â€œ4 9 10 13â€, a solution output could be â€œ(10 - 4) * (13 - 9) = 24â€.</p>
</div>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="202" id="S4.F2.g1" src="x2.png" width="748"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>ToT in a game of 24. The LM is prompted for (a) thought generation and (b) valuation. </figcaption>
</figure>
<figure class="ltx_figure" id="S4.F3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 2: </span>Game of 24 Results.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_minipage ltx_flex_size_1 ltx_align_middle" id="S4.F3.3" style="width:125.7pt;">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.F3.3.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.F3.3.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.F3.3.1.1.1.1">Method</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.F3.3.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.F3.3.1.1.2.1">Success</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.F3.3.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.F3.3.2.1.1">IO prompt</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.F3.3.2.1.2">7.3%</td>
</tr>
<tr class="ltx_tr" id="S4.F3.3.3.2">
<td class="ltx_td ltx_align_left" id="S4.F3.3.3.2.1">CoT prompt</td>
<td class="ltx_td ltx_align_left" id="S4.F3.3.3.2.2">4.0%</td>
</tr>
<tr class="ltx_tr" id="S4.F3.3.4.3">
<td class="ltx_td ltx_align_left" id="S4.F3.3.4.3.1">CoT-SC <span class="ltx_text" id="S4.F3.3.4.3.1.1" style="font-size:70%;">(k=100)</span>
</td>
<td class="ltx_td ltx_align_left" id="S4.F3.3.4.3.2">9.0%</td>
</tr>
<tr class="ltx_tr" id="S4.F3.3.5.4">
<td class="ltx_td ltx_align_left" id="S4.F3.3.5.4.1">ToT (ours) <span class="ltx_text" id="S4.F3.3.5.4.1.1" style="font-size:70%;">(b=1)</span>
</td>
<td class="ltx_td ltx_align_left" id="S4.F3.3.5.4.2">45%</td>
</tr>
<tr class="ltx_tr" id="S4.F3.3.6.5">
<td class="ltx_td ltx_align_left" id="S4.F3.3.6.5.1">ToT (ours) <span class="ltx_text" id="S4.F3.3.6.5.1.1" style="font-size:70%;">(b=5)</span>
</td>
<td class="ltx_td ltx_align_left" id="S4.F3.3.6.5.2"><span class="ltx_text ltx_font_bold" id="S4.F3.3.6.5.2.1">74%</span></td>
</tr>
<tr class="ltx_tr" id="S4.F3.3.7.6">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.F3.3.7.6.1">IO + Refine <span class="ltx_text" id="S4.F3.3.7.6.1.1" style="font-size:70%;">(k=10)</span>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.F3.3.7.6.2">27%</td>
</tr>
<tr class="ltx_tr" id="S4.F3.3.8.7">
<td class="ltx_td ltx_align_left" id="S4.F3.3.8.7.1">IO <span class="ltx_text" id="S4.F3.3.8.7.1.1" style="font-size:70%;">(best of 100)</span>
</td>
<td class="ltx_td ltx_align_left" id="S4.F3.3.8.7.2">33%</td>
</tr>
<tr class="ltx_tr" id="S4.F3.3.9.8">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.F3.3.9.8.1">CoT <span class="ltx_text" id="S4.F3.3.9.8.1.1" style="font-size:70%;">(best of 100)</span>
</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.F3.3.9.8.2">49%</td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_inline-para ltx_minipage ltx_flex_size_1 ltx_align_center ltx_align_middle" id="S4.F3.2" style="width:303.5pt;">
<span class="ltx_para ltx_align_center" id="S4.F3.2.p1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="373" id="S4.F3.2.p1.g1" src="x3.png" width="373"/><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="373" id="S4.F3.2.p1.g2" src="x4.png" width="373"/>
</span></span></div>
<div class="ltx_flex_break"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 2: </span>Game of 24 Results.</figcaption>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Game of 24 (a) scale analysis &amp; (b) error analysis.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">Task Setup.</span>
We scrape data from <a class="ltx_ref ltx_href" href="https://www.4nums.com/game/difficulties/" title="">4nums.com</a>, which has 1,362 games that are sorted from easy to hard by human solving time, and use a subset of relatively hard games indexed 901-1,000 for testing. For each task, we consider the output as success if it is a valid equation that equals 24 and uses the input numbers each exactly once. We report the success rate across 100 games as the metric.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">Baselines.</span> We use a standard input-output (IO) prompt with 5 in-context examples. For chain-of-thought (CoT) prompting, we augment each input-output pair with 3 intermediate equations, each operating on two remaining numbers. For example, given input â€œ4 9 10 13â€, the thoughts could be â€œ13 - 9 = 4 (left: 4 4 10); 10 - 4 = 6 (left: 4 6); 4 * 6 = 24 (left: 24)â€. For each game, we sample IO and CoT prompting for 100 times for average performance.
We also consider a CoT self-consistency baseline, which takes the majority output from 100 CoT samples, and an iterative-refine approach on top of an IO sample for at most <math alttext="10" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mn id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><cn id="S4.SS1.p3.1.m1.1.1.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">10</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">10</annotation></semantics></math> iterations. At each iteration, the LM is conditioned on all previous history to â€œreflect on your mistakes and generate a refined answerâ€ if the output is incorrect. Note that it uses groundtruth feedback signals about equation correctness.</p>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.2"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.2.1">ToT Setup.</span>
To frame Game of 24 into ToT, it is natural to decompose the thoughts into 3 steps, each an intermediate equation. As shown in FigureÂ <a class="ltx_ref" href="#S4.F2" title="Figure 2 â€£ 4.1 Game of 24 â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(a), at each tree node, we exact the remaining numbers and prompt the LM to propose some possible next steps.
The same â€œpropose promptâ€ is used for all 3 thought steps, though it only has one example with 4 input numbers.
We perform a breadth-first search (BFS) in ToT, where at each step we keep the best <math alttext="b=5" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.1"><semantics id="S4.SS1.p4.1.m1.1a"><mrow id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">b</mi><mo id="S4.SS1.p4.1.m1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><eq id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1"></eq><ci id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2">ğ‘</ci><cn id="S4.SS1.p4.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p4.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">b=5</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.1d">italic_b = 5</annotation></semantics></math> candidates.
To perform deliberate BFS in ToT, as shown in FigureÂ <a class="ltx_ref" href="#S4.F2" title="Figure 2 â€£ 4.1 Game of 24 â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(b), we prompt LM to evaluate each thought candidate as â€œsure/maybe/impossibleâ€ with regard to reaching 24. The aim is to promote correct partial solutions that can be verdicted within few lookahead trials, and eliminate impossible partial solutions based on â€œtoo big/smallâ€ commonsense, and keep the rest â€œmaybeâ€. We sample values <math alttext="3" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.1"><semantics id="S4.SS1.p4.2.m2.1a"><mn id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><cn id="S4.SS1.p4.2.m2.1.1.cmml" type="integer" xref="S4.SS1.p4.2.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">3</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.2.m2.1d">3</annotation></semantics></math> times for each thought.</p>
</div>
<div class="ltx_para" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.11"><span class="ltx_text ltx_font_bold" id="S4.SS1.p5.11.1">Results.</span> As shown in TableÂ <a class="ltx_ref" href="#S4.F3" title="Figure 3 â€£ 4.1 Game of 24 â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>, IO, CoT, and CoT-SC prompting methods perform badly on the task, achieving only 7.3%, 4.0%, and 9.0% success rates. In contrast, ToT with a breadth of <math alttext="b=1" class="ltx_Math" display="inline" id="S4.SS1.p5.1.m1.1"><semantics id="S4.SS1.p5.1.m1.1a"><mrow id="S4.SS1.p5.1.m1.1.1" xref="S4.SS1.p5.1.m1.1.1.cmml"><mi id="S4.SS1.p5.1.m1.1.1.2" xref="S4.SS1.p5.1.m1.1.1.2.cmml">b</mi><mo id="S4.SS1.p5.1.m1.1.1.1" xref="S4.SS1.p5.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p5.1.m1.1.1.3" xref="S4.SS1.p5.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><apply id="S4.SS1.p5.1.m1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1"><eq id="S4.SS1.p5.1.m1.1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1.1"></eq><ci id="S4.SS1.p5.1.m1.1.1.2.cmml" xref="S4.SS1.p5.1.m1.1.1.2">ğ‘</ci><cn id="S4.SS1.p5.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p5.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">b=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.1.m1.1d">italic_b = 1</annotation></semantics></math> already achieves a success rate of <math alttext="45\%" class="ltx_Math" display="inline" id="S4.SS1.p5.2.m2.1"><semantics id="S4.SS1.p5.2.m2.1a"><mrow id="S4.SS1.p5.2.m2.1.1" xref="S4.SS1.p5.2.m2.1.1.cmml"><mn id="S4.SS1.p5.2.m2.1.1.2" xref="S4.SS1.p5.2.m2.1.1.2.cmml">45</mn><mo id="S4.SS1.p5.2.m2.1.1.1" xref="S4.SS1.p5.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m2.1b"><apply id="S4.SS1.p5.2.m2.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1"><csymbol cd="latexml" id="S4.SS1.p5.2.m2.1.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1.1">percent</csymbol><cn id="S4.SS1.p5.2.m2.1.1.2.cmml" type="integer" xref="S4.SS1.p5.2.m2.1.1.2">45</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.2.m2.1c">45\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.2.m2.1d">45 %</annotation></semantics></math>, while <math alttext="b=5" class="ltx_Math" display="inline" id="S4.SS1.p5.3.m3.1"><semantics id="S4.SS1.p5.3.m3.1a"><mrow id="S4.SS1.p5.3.m3.1.1" xref="S4.SS1.p5.3.m3.1.1.cmml"><mi id="S4.SS1.p5.3.m3.1.1.2" xref="S4.SS1.p5.3.m3.1.1.2.cmml">b</mi><mo id="S4.SS1.p5.3.m3.1.1.1" xref="S4.SS1.p5.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.p5.3.m3.1.1.3" xref="S4.SS1.p5.3.m3.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.3.m3.1b"><apply id="S4.SS1.p5.3.m3.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1"><eq id="S4.SS1.p5.3.m3.1.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1.1"></eq><ci id="S4.SS1.p5.3.m3.1.1.2.cmml" xref="S4.SS1.p5.3.m3.1.1.2">ğ‘</ci><cn id="S4.SS1.p5.3.m3.1.1.3.cmml" type="integer" xref="S4.SS1.p5.3.m3.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.3.m3.1c">b=5</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.3.m3.1d">italic_b = 5</annotation></semantics></math> achieves <math alttext="74\%" class="ltx_Math" display="inline" id="S4.SS1.p5.4.m4.1"><semantics id="S4.SS1.p5.4.m4.1a"><mrow id="S4.SS1.p5.4.m4.1.1" xref="S4.SS1.p5.4.m4.1.1.cmml"><mn id="S4.SS1.p5.4.m4.1.1.2" xref="S4.SS1.p5.4.m4.1.1.2.cmml">74</mn><mo id="S4.SS1.p5.4.m4.1.1.1" xref="S4.SS1.p5.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.4.m4.1b"><apply id="S4.SS1.p5.4.m4.1.1.cmml" xref="S4.SS1.p5.4.m4.1.1"><csymbol cd="latexml" id="S4.SS1.p5.4.m4.1.1.1.cmml" xref="S4.SS1.p5.4.m4.1.1.1">percent</csymbol><cn id="S4.SS1.p5.4.m4.1.1.2.cmml" type="integer" xref="S4.SS1.p5.4.m4.1.1.2">74</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.4.m4.1c">74\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.4.m4.1d">74 %</annotation></semantics></math>.
We also consider an oracle setup for IO/CoT, by calculating the success rate using best of <math alttext="k" class="ltx_Math" display="inline" id="S4.SS1.p5.5.m5.1"><semantics id="S4.SS1.p5.5.m5.1a"><mi id="S4.SS1.p5.5.m5.1.1" xref="S4.SS1.p5.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.5.m5.1b"><ci id="S4.SS1.p5.5.m5.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.5.m5.1d">italic_k</annotation></semantics></math> samples <math alttext="(1\leq k\leq 100)" class="ltx_Math" display="inline" id="S4.SS1.p5.6.m6.1"><semantics id="S4.SS1.p5.6.m6.1a"><mrow id="S4.SS1.p5.6.m6.1.1.1" xref="S4.SS1.p5.6.m6.1.1.1.1.cmml"><mo id="S4.SS1.p5.6.m6.1.1.1.2" stretchy="false" xref="S4.SS1.p5.6.m6.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p5.6.m6.1.1.1.1" xref="S4.SS1.p5.6.m6.1.1.1.1.cmml"><mn id="S4.SS1.p5.6.m6.1.1.1.1.2" xref="S4.SS1.p5.6.m6.1.1.1.1.2.cmml">1</mn><mo id="S4.SS1.p5.6.m6.1.1.1.1.3" xref="S4.SS1.p5.6.m6.1.1.1.1.3.cmml">â‰¤</mo><mi id="S4.SS1.p5.6.m6.1.1.1.1.4" xref="S4.SS1.p5.6.m6.1.1.1.1.4.cmml">k</mi><mo id="S4.SS1.p5.6.m6.1.1.1.1.5" xref="S4.SS1.p5.6.m6.1.1.1.1.5.cmml">â‰¤</mo><mn id="S4.SS1.p5.6.m6.1.1.1.1.6" xref="S4.SS1.p5.6.m6.1.1.1.1.6.cmml">100</mn></mrow><mo id="S4.SS1.p5.6.m6.1.1.1.3" stretchy="false" xref="S4.SS1.p5.6.m6.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.6.m6.1b"><apply id="S4.SS1.p5.6.m6.1.1.1.1.cmml" xref="S4.SS1.p5.6.m6.1.1.1"><and id="S4.SS1.p5.6.m6.1.1.1.1a.cmml" xref="S4.SS1.p5.6.m6.1.1.1"></and><apply id="S4.SS1.p5.6.m6.1.1.1.1b.cmml" xref="S4.SS1.p5.6.m6.1.1.1"><leq id="S4.SS1.p5.6.m6.1.1.1.1.3.cmml" xref="S4.SS1.p5.6.m6.1.1.1.1.3"></leq><cn id="S4.SS1.p5.6.m6.1.1.1.1.2.cmml" type="integer" xref="S4.SS1.p5.6.m6.1.1.1.1.2">1</cn><ci id="S4.SS1.p5.6.m6.1.1.1.1.4.cmml" xref="S4.SS1.p5.6.m6.1.1.1.1.4">ğ‘˜</ci></apply><apply id="S4.SS1.p5.6.m6.1.1.1.1c.cmml" xref="S4.SS1.p5.6.m6.1.1.1"><leq id="S4.SS1.p5.6.m6.1.1.1.1.5.cmml" xref="S4.SS1.p5.6.m6.1.1.1.1.5"></leq><share href="#S4.SS1.p5.6.m6.1.1.1.1.4.cmml" id="S4.SS1.p5.6.m6.1.1.1.1d.cmml" xref="S4.SS1.p5.6.m6.1.1.1"></share><cn id="S4.SS1.p5.6.m6.1.1.1.1.6.cmml" type="integer" xref="S4.SS1.p5.6.m6.1.1.1.1.6">100</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.6.m6.1c">(1\leq k\leq 100)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.6.m6.1d">( 1 â‰¤ italic_k â‰¤ 100 )</annotation></semantics></math>. To compare IO/CoT (best of k) with ToT, we consider calculating the tree nodes visited per task in ToT across <math alttext="b=1\cdots 5" class="ltx_Math" display="inline" id="S4.SS1.p5.7.m7.1"><semantics id="S4.SS1.p5.7.m7.1a"><mrow id="S4.SS1.p5.7.m7.1.1" xref="S4.SS1.p5.7.m7.1.1.cmml"><mi id="S4.SS1.p5.7.m7.1.1.2" xref="S4.SS1.p5.7.m7.1.1.2.cmml">b</mi><mo id="S4.SS1.p5.7.m7.1.1.1" xref="S4.SS1.p5.7.m7.1.1.1.cmml">=</mo><mrow id="S4.SS1.p5.7.m7.1.1.3" xref="S4.SS1.p5.7.m7.1.1.3.cmml"><mn id="S4.SS1.p5.7.m7.1.1.3.2" xref="S4.SS1.p5.7.m7.1.1.3.2.cmml">1</mn><mo id="S4.SS1.p5.7.m7.1.1.3.1" xref="S4.SS1.p5.7.m7.1.1.3.1.cmml">â¢</mo><mi id="S4.SS1.p5.7.m7.1.1.3.3" mathvariant="normal" xref="S4.SS1.p5.7.m7.1.1.3.3.cmml">â‹¯</mi><mo id="S4.SS1.p5.7.m7.1.1.3.1a" xref="S4.SS1.p5.7.m7.1.1.3.1.cmml">â¢</mo><mn id="S4.SS1.p5.7.m7.1.1.3.4" xref="S4.SS1.p5.7.m7.1.1.3.4.cmml">5</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.7.m7.1b"><apply id="S4.SS1.p5.7.m7.1.1.cmml" xref="S4.SS1.p5.7.m7.1.1"><eq id="S4.SS1.p5.7.m7.1.1.1.cmml" xref="S4.SS1.p5.7.m7.1.1.1"></eq><ci id="S4.SS1.p5.7.m7.1.1.2.cmml" xref="S4.SS1.p5.7.m7.1.1.2">ğ‘</ci><apply id="S4.SS1.p5.7.m7.1.1.3.cmml" xref="S4.SS1.p5.7.m7.1.1.3"><times id="S4.SS1.p5.7.m7.1.1.3.1.cmml" xref="S4.SS1.p5.7.m7.1.1.3.1"></times><cn id="S4.SS1.p5.7.m7.1.1.3.2.cmml" type="integer" xref="S4.SS1.p5.7.m7.1.1.3.2">1</cn><ci id="S4.SS1.p5.7.m7.1.1.3.3.cmml" xref="S4.SS1.p5.7.m7.1.1.3.3">â‹¯</ci><cn id="S4.SS1.p5.7.m7.1.1.3.4.cmml" type="integer" xref="S4.SS1.p5.7.m7.1.1.3.4">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.7.m7.1c">b=1\cdots 5</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.7.m7.1d">italic_b = 1 â‹¯ 5</annotation></semantics></math>, and map the 5 success rates in FigureÂ <a class="ltx_ref" href="#S4.F3" title="Figure 3 â€£ 4.1 Game of 24 â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>(a), treating IO/CoT (best of <math alttext="k" class="ltx_Math" display="inline" id="S4.SS1.p5.8.m8.1"><semantics id="S4.SS1.p5.8.m8.1a"><mi id="S4.SS1.p5.8.m8.1.1" xref="S4.SS1.p5.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.8.m8.1b"><ci id="S4.SS1.p5.8.m8.1.1.cmml" xref="S4.SS1.p5.8.m8.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.8.m8.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.8.m8.1d">italic_k</annotation></semantics></math>) as visiting <math alttext="k" class="ltx_Math" display="inline" id="S4.SS1.p5.9.m9.1"><semantics id="S4.SS1.p5.9.m9.1a"><mi id="S4.SS1.p5.9.m9.1.1" xref="S4.SS1.p5.9.m9.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.9.m9.1b"><ci id="S4.SS1.p5.9.m9.1.1.cmml" xref="S4.SS1.p5.9.m9.1.1">ğ‘˜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.9.m9.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.9.m9.1d">italic_k</annotation></semantics></math> nodes in a bandit. Not surprisingly, CoT scales better than IO, and best of 100 CoT samples achieve a success rate of <math alttext="49\%" class="ltx_Math" display="inline" id="S4.SS1.p5.10.m10.1"><semantics id="S4.SS1.p5.10.m10.1a"><mrow id="S4.SS1.p5.10.m10.1.1" xref="S4.SS1.p5.10.m10.1.1.cmml"><mn id="S4.SS1.p5.10.m10.1.1.2" xref="S4.SS1.p5.10.m10.1.1.2.cmml">49</mn><mo id="S4.SS1.p5.10.m10.1.1.1" xref="S4.SS1.p5.10.m10.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.10.m10.1b"><apply id="S4.SS1.p5.10.m10.1.1.cmml" xref="S4.SS1.p5.10.m10.1.1"><csymbol cd="latexml" id="S4.SS1.p5.10.m10.1.1.1.cmml" xref="S4.SS1.p5.10.m10.1.1.1">percent</csymbol><cn id="S4.SS1.p5.10.m10.1.1.2.cmml" type="integer" xref="S4.SS1.p5.10.m10.1.1.2">49</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.10.m10.1c">49\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.10.m10.1d">49 %</annotation></semantics></math>, but still much worse than exploring more nodes in ToT (<math alttext="b&gt;1" class="ltx_Math" display="inline" id="S4.SS1.p5.11.m11.1"><semantics id="S4.SS1.p5.11.m11.1a"><mrow id="S4.SS1.p5.11.m11.1.1" xref="S4.SS1.p5.11.m11.1.1.cmml"><mi id="S4.SS1.p5.11.m11.1.1.2" xref="S4.SS1.p5.11.m11.1.1.2.cmml">b</mi><mo id="S4.SS1.p5.11.m11.1.1.1" xref="S4.SS1.p5.11.m11.1.1.1.cmml">&gt;</mo><mn id="S4.SS1.p5.11.m11.1.1.3" xref="S4.SS1.p5.11.m11.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.11.m11.1b"><apply id="S4.SS1.p5.11.m11.1.1.cmml" xref="S4.SS1.p5.11.m11.1.1"><gt id="S4.SS1.p5.11.m11.1.1.1.cmml" xref="S4.SS1.p5.11.m11.1.1.1"></gt><ci id="S4.SS1.p5.11.m11.1.1.2.cmml" xref="S4.SS1.p5.11.m11.1.1.2">ğ‘</ci><cn id="S4.SS1.p5.11.m11.1.1.3.cmml" type="integer" xref="S4.SS1.p5.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.11.m11.1c">b&gt;1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.11.m11.1d">italic_b &gt; 1</annotation></semantics></math>). </p>
</div>
<div class="ltx_para" id="S4.SS1.p6">
<p class="ltx_p" id="S4.SS1.p6.2"><span class="ltx_text ltx_font_bold" id="S4.SS1.p6.2.1">Error analysis.</span> FigureÂ <a class="ltx_ref" href="#S4.F3" title="Figure 3 â€£ 4.1 Game of 24 â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>(b) breaks down at which step CoT and ToT samples fail the task, i.e.â€‰the thought (in CoT) or all <math alttext="b" class="ltx_Math" display="inline" id="S4.SS1.p6.1.m1.1"><semantics id="S4.SS1.p6.1.m1.1a"><mi id="S4.SS1.p6.1.m1.1.1" xref="S4.SS1.p6.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.1.m1.1b"><ci id="S4.SS1.p6.1.m1.1.1.cmml" xref="S4.SS1.p6.1.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.1.m1.1c">b</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.1.m1.1d">italic_b</annotation></semantics></math> thoughts (in ToT) are invalid or impossible to reach 24. Notably, around 60% of CoT samples already failed the task after generating the first step, or equivalently, the first three words (e.g.â€‰â€œ<math alttext="4+9" class="ltx_Math" display="inline" id="S4.SS1.p6.2.m2.1"><semantics id="S4.SS1.p6.2.m2.1a"><mrow id="S4.SS1.p6.2.m2.1.1" xref="S4.SS1.p6.2.m2.1.1.cmml"><mn id="S4.SS1.p6.2.m2.1.1.2" xref="S4.SS1.p6.2.m2.1.1.2.cmml">4</mn><mo id="S4.SS1.p6.2.m2.1.1.1" xref="S4.SS1.p6.2.m2.1.1.1.cmml">+</mo><mn id="S4.SS1.p6.2.m2.1.1.3" xref="S4.SS1.p6.2.m2.1.1.3.cmml">9</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.2.m2.1b"><apply id="S4.SS1.p6.2.m2.1.1.cmml" xref="S4.SS1.p6.2.m2.1.1"><plus id="S4.SS1.p6.2.m2.1.1.1.cmml" xref="S4.SS1.p6.2.m2.1.1.1"></plus><cn id="S4.SS1.p6.2.m2.1.1.2.cmml" type="integer" xref="S4.SS1.p6.2.m2.1.1.2">4</cn><cn id="S4.SS1.p6.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.p6.2.m2.1.1.3">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.2.m2.1c">4+9</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p6.2.m2.1d">4 + 9</annotation></semantics></math>â€). This highlights the issues with direct left-to-right decoding.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Creative writing</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Next, we invent a creative writing task where the input is 4 random sentences and the output should be a coherent passage with 4 paragraphs that end in the 4 input sentences respectively.
Such a task is open-ended and exploratory, and challenges creative thinking as well as high-level planning.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.1">Task setup.</span> We sample random sentences from <a class="ltx_ref ltx_href" href="https://randomwordgenerator.com/sentence.php" title="">randomwordgenerator.com</a> to form 100 inputs, and there is no groundtruth passage for each input constraint. As we find that GPT-4 can follow the input constraints most of the time, we focus on evaluating passage coherency in two ways: using a GPT-4 zero-shot prompt to provide a 1-10 scalar score, or using human judgments to compare pairs of outputs from different methods. For the former, we sample 5 scores and average them for each task output, and we find these 5 scores usually consistent, with a standard deviation of around <math alttext="0.56" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mn id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">0.56</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><cn id="S4.SS2.p2.1.m1.1.1.cmml" type="float" xref="S4.SS2.p2.1.m1.1.1">0.56</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">0.56</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">0.56</annotation></semantics></math> on average across outputs. For the latter, we employ a subset of the authors in a blind study to compare the coherency of CoT vs.â€‰ToT generated passage pairs, where the order of passages is random flipped over 100 inputs.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.1">Baselines.</span> Given the creative nature of the task, both IO and CoT prompts are zero-shot. While the former prompts the LM to directly generate a coherent passage given input constraints, the latter prompts the LM to first make a brief plan then write the passage, i.e.â€‰the plan serves as the intermediate thought step. We generate 10 IO and CoT samples per task.
We also consider an iterative-refine (<math alttext="k\leq 5" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">k</mi><mo id="S4.SS2.p3.1.m1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.cmml">â‰¤</mo><mn id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><leq id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1"></leq><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">ğ‘˜</ci><cn id="S4.SS2.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p3.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">k\leq 5</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_k â‰¤ 5</annotation></semantics></math>) method on top of a random IO sample for each task, where the LM is conditioned on input constraints and the last generated passage to decide if the passage is already â€œperfectly coherentâ€, and if not generate a refined one.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.3"><span class="ltx_text ltx_font_bold" id="S4.SS2.p4.3.1">ToT setup.</span> We build a ToT with depth 2 (and only 1 intermediate thought step) â€” the LM first generates <math alttext="k=5" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><mrow id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">k</mi><mo id="S4.SS2.p4.1.m1.1.1.1" xref="S4.SS2.p4.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><eq id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1.1"></eq><ci id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">ğ‘˜</ci><cn id="S4.SS2.p4.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p4.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">k=5</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">italic_k = 5</annotation></semantics></math> plans and votes for the best one (FigureÂ <a class="ltx_ref" href="#S4.F4" title="Figure 4 â€£ 4.2 Creative writing â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>), then similarly generate <math alttext="k=5" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml"><mi id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml">k</mi><mo id="S4.SS2.p4.2.m2.1.1.1" xref="S4.SS2.p4.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p4.2.m2.1.1.3" xref="S4.SS2.p4.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1"><eq id="S4.SS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1.1"></eq><ci id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2">ğ‘˜</ci><cn id="S4.SS2.p4.2.m2.1.1.3.cmml" type="integer" xref="S4.SS2.p4.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">k=5</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.1d">italic_k = 5</annotation></semantics></math> passages based on the best plan then vote for the best one. Here the breadth limit <math alttext="b=1" class="ltx_Math" display="inline" id="S4.SS2.p4.3.m3.1"><semantics id="S4.SS2.p4.3.m3.1a"><mrow id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml"><mi id="S4.SS2.p4.3.m3.1.1.2" xref="S4.SS2.p4.3.m3.1.1.2.cmml">b</mi><mo id="S4.SS2.p4.3.m3.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p4.3.m3.1.1.3" xref="S4.SS2.p4.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><apply id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1"><eq id="S4.SS2.p4.3.m3.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1"></eq><ci id="S4.SS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2">ğ‘</ci><cn id="S4.SS2.p4.3.m3.1.1.3.cmml" type="integer" xref="S4.SS2.p4.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">b=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.3.m3.1d">italic_b = 1</annotation></semantics></math>, as only one choice is kept per step. A simple zero-shot vote prompt (â€œanalyze choices below, then conclude which is most promising for the instructionâ€) is used to sample 5 votes at both steps.</p>
</div>
<div class="ltx_para" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p5.1.1">Results.</span> FigureÂ <a class="ltx_ref" href="#S4.F5" title="Figure 5 â€£ 4.2 Creative writing â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>(a) shows average GPT-4 scores across 100 tasks, where ToT (7.56) is deemed to generate more coherent passages than IO (6.19) and CoT (6.93) on average. While such an automatic metric might be noisy, FigureÂ <a class="ltx_ref" href="#S4.F5" title="Figure 5 â€£ 4.2 Creative writing â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>(b) confirms the finding by showing that humans prefer ToT over CoT in 41 out of 100 passage pairs, while only prefer CoT over ToT in 21 (other 38 pairs are found â€œsimilarly coherentâ€). Lastly, iterative-refine is more effective on this natural language task, where it improves IO coherency score from 6.19 to 7.67, and ToT coherency score from 7.56 to 7.91.
We believe it could be thought of as a third approach to thought generation in the ToT framework, where new thoughts can arise from refining old thoughts instead of i.i.d.â€‰or sequentially generated. </p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="290" id="S4.F4.g1" src="x5.png" width="746"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>A step of deliberate search in a randomly picked Creative Writing task. Given the input, the LM samples 5 different plans, then votes 5 times to decide which plan is best. The majority choice is used to consequently write the output passage with the same sample-vote procedure.
</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Creative Writing results.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_center ltx_align_middle" id="S4.F5.1" style="width:286.2pt;">
<span class="ltx_para" id="S4.F5.1.p1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="168" id="S4.F5.1.p1.g1" src="x6.png" width="178"/><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="168" id="S4.F5.1.p1.g2" src="x7.png" width="153"/>
</span></span></div>
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_center ltx_align_middle" id="S4.F5.2" style="width:143.1pt;">
<span class="ltx_para ltx_align_center" id="S4.F5.2.p1">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.F5.2.p1.1">
<span class="ltx_thead">
<span class="ltx_tr" id="S4.F5.2.p1.1.1.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.F5.2.p1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.F5.2.p1.1.1.1.1.1">Method</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_colspan ltx_colspan_3" id="S4.F5.2.p1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.F5.2.p1.1.1.1.2.1">Success Rate (%)</span></span></span>
<span class="ltx_tr" id="S4.F5.2.p1.1.2.2">
<span class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S4.F5.2.p1.1.2.2.1"></span>
<span class="ltx_td ltx_align_justify ltx_th ltx_th_column" id="S4.F5.2.p1.1.2.2.2"><span class="ltx_text ltx_font_bold ltx_align_top" id="S4.F5.2.p1.1.2.2.2.1" style="font-size:90%;">Letter</span></span>
<span class="ltx_td ltx_align_justify ltx_th ltx_th_column" id="S4.F5.2.p1.1.2.2.3"><span class="ltx_text ltx_font_bold ltx_align_top" id="S4.F5.2.p1.1.2.2.3.1" style="font-size:90%;">Word</span></span>
<span class="ltx_td ltx_align_justify ltx_th ltx_th_column" id="S4.F5.2.p1.1.2.2.4"><span class="ltx_text ltx_font_bold ltx_align_top" id="S4.F5.2.p1.1.2.2.4.1" style="font-size:90%;">Game</span></span></span>
</span>
<span class="ltx_tbody">
<span class="ltx_tr" id="S4.F5.2.p1.1.3.1">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.F5.2.p1.1.3.1.1">IO</span>
<span class="ltx_td ltx_align_justify ltx_border_t" id="S4.F5.2.p1.1.3.1.2">
<span class="ltx_p ltx_align_top" id="S4.F5.2.p1.1.3.1.2.1">38.7</span></span>
<span class="ltx_td ltx_align_justify ltx_border_t" id="S4.F5.2.p1.1.3.1.3">
<span class="ltx_p ltx_align_top" id="S4.F5.2.p1.1.3.1.3.1">14</span></span>
<span class="ltx_td ltx_align_justify ltx_border_t" id="S4.F5.2.p1.1.3.1.4">
<span class="ltx_p ltx_align_top" id="S4.F5.2.p1.1.3.1.4.1">0</span></span></span>
<span class="ltx_tr" id="S4.F5.2.p1.1.4.2">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.F5.2.p1.1.4.2.1">CoT</span>
<span class="ltx_td ltx_align_justify" id="S4.F5.2.p1.1.4.2.2">
<span class="ltx_p ltx_align_top" id="S4.F5.2.p1.1.4.2.2.1">40.6</span></span>
<span class="ltx_td ltx_align_justify" id="S4.F5.2.p1.1.4.2.3">
<span class="ltx_p ltx_align_top" id="S4.F5.2.p1.1.4.2.3.1">15.6</span></span>
<span class="ltx_td ltx_align_justify" id="S4.F5.2.p1.1.4.2.4">
<span class="ltx_p ltx_align_top" id="S4.F5.2.p1.1.4.2.4.1">1</span></span></span>
<span class="ltx_tr" id="S4.F5.2.p1.1.5.3">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.F5.2.p1.1.5.3.1">ToT (ours)</span>
<span class="ltx_td ltx_align_justify" id="S4.F5.2.p1.1.5.3.2"><span class="ltx_text ltx_font_bold ltx_align_top" id="S4.F5.2.p1.1.5.3.2.1">78</span></span>
<span class="ltx_td ltx_align_justify" id="S4.F5.2.p1.1.5.3.3"><span class="ltx_text ltx_font_bold ltx_align_top" id="S4.F5.2.p1.1.5.3.3.1">60</span></span>
<span class="ltx_td ltx_align_justify" id="S4.F5.2.p1.1.5.3.4"><span class="ltx_text ltx_font_bold ltx_align_top" id="S4.F5.2.p1.1.5.3.4.1">20</span></span></span>
<span class="ltx_tr" id="S4.F5.2.p1.1.6.4">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.F5.2.p1.1.6.4.1">+best state</span>
<span class="ltx_td ltx_align_justify ltx_border_t" id="S4.F5.2.p1.1.6.4.2">
<span class="ltx_p ltx_align_top" id="S4.F5.2.p1.1.6.4.2.1">82.4</span></span>
<span class="ltx_td ltx_align_justify ltx_border_t" id="S4.F5.2.p1.1.6.4.3">
<span class="ltx_p ltx_align_top" id="S4.F5.2.p1.1.6.4.3.1">67.5</span></span>
<span class="ltx_td ltx_align_justify ltx_border_t" id="S4.F5.2.p1.1.6.4.4">
<span class="ltx_p ltx_align_top" id="S4.F5.2.p1.1.6.4.4.1">35</span></span></span>
<span class="ltx_tr" id="S4.F5.2.p1.1.7.5">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.F5.2.p1.1.7.5.1">-prune</span>
<span class="ltx_td ltx_align_justify" id="S4.F5.2.p1.1.7.5.2">
<span class="ltx_p ltx_align_top" id="S4.F5.2.p1.1.7.5.2.1">65.4</span></span>
<span class="ltx_td ltx_align_justify" id="S4.F5.2.p1.1.7.5.3">
<span class="ltx_p ltx_align_top" id="S4.F5.2.p1.1.7.5.3.1">41.5</span></span>
<span class="ltx_td ltx_align_justify" id="S4.F5.2.p1.1.7.5.4">
<span class="ltx_p ltx_align_top" id="S4.F5.2.p1.1.7.5.4.1">5</span></span></span>
<span class="ltx_tr" id="S4.F5.2.p1.1.8.6">
<span class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.F5.2.p1.1.8.6.1">-backtrack</span>
<span class="ltx_td ltx_align_justify ltx_border_bb" id="S4.F5.2.p1.1.8.6.2">
<span class="ltx_p ltx_align_top" id="S4.F5.2.p1.1.8.6.2.1">54.6</span></span>
<span class="ltx_td ltx_align_justify ltx_border_bb" id="S4.F5.2.p1.1.8.6.3">
<span class="ltx_p ltx_align_top" id="S4.F5.2.p1.1.8.6.3.1">20</span></span>
<span class="ltx_td ltx_align_justify ltx_border_bb" id="S4.F5.2.p1.1.8.6.4">
<span class="ltx_p ltx_align_top" id="S4.F5.2.p1.1.8.6.4.1">5</span></span></span>
</span>
</span>
</span></span></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Creative Writing results.</figcaption>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 3: </span>Mini Crosswords results.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Mini crosswords</h3>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="280" id="S4.F6.g1" src="x8.png" width="663"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>In Mini Crosswords, (a) how thoughts are proposed and aggregated in a priority queue for depth-first search (DFS), and (b) how a state is evaluated based on the possibility of filling in each remaining word clue, and pruned if any remaining clue is deemed not possible to fill by the LM. Then DFS backtracks to the parent state and explore the next promising thought for clue.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">In Game of 24 and Creative Writing, ToT is relatively shallow â€” at most 3 thought steps are needed to reach the final output. Here we explore <math alttext="5\times 5" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mn id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">5</mn><mo id="S4.SS3.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.1.m1.1.1.1.cmml">Ã—</mo><mn id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><times id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1"></times><cn id="S4.SS3.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS3.p1.1.m1.1.1.2">5</cn><cn id="S4.SS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS3.p1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">5\times 5</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">5 Ã— 5</annotation></semantics></math> mini crosswords as a harder search problem involving natural language. Again, the goal is not just to solve the task, as more general crosswords can be readily solved with specialized NLP pipelinesÂ <cite class="ltx_cite ltx_citemacro_citep">(Wallace etÂ al., <a class="ltx_ref" href="#bib.bib34" title="">2022</a>)</cite> that leverages large-scale retrieval instead of LM. Rather, we aim to explore the limit of LM as a general problem solver that explores its own thoughts and guides its own exploration with deliberate reasoning as heuristics.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.4"><span class="ltx_text ltx_font_bold" id="S4.SS3.p2.4.1">Task setup.</span> We scrape data from <a class="ltx_ref ltx_href" href="https://www.goobix.com/crosswords/0505/" title="">GooBix</a>, which contains 156 games of <math alttext="5\times 5" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><mrow id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mn id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">5</mn><mo id="S4.SS3.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p2.1.m1.1.1.1.cmml">Ã—</mo><mn id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><times id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1.1"></times><cn id="S4.SS3.p2.1.m1.1.1.2.cmml" type="integer" xref="S4.SS3.p2.1.m1.1.1.2">5</cn><cn id="S4.SS3.p2.1.m1.1.1.3.cmml" type="integer" xref="S4.SS3.p2.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">5\times 5</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">5 Ã— 5</annotation></semantics></math> mini crosswords. As we observe adjacent games contain similar clues, we use 20 games with indices <math alttext="1,6,\cdots,91,96" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.5"><semantics id="S4.SS3.p2.2.m2.5a"><mrow id="S4.SS3.p2.2.m2.5.6.2" xref="S4.SS3.p2.2.m2.5.6.1.cmml"><mn id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">1</mn><mo id="S4.SS3.p2.2.m2.5.6.2.1" xref="S4.SS3.p2.2.m2.5.6.1.cmml">,</mo><mn id="S4.SS3.p2.2.m2.2.2" xref="S4.SS3.p2.2.m2.2.2.cmml">6</mn><mo id="S4.SS3.p2.2.m2.5.6.2.2" xref="S4.SS3.p2.2.m2.5.6.1.cmml">,</mo><mi id="S4.SS3.p2.2.m2.3.3" mathvariant="normal" xref="S4.SS3.p2.2.m2.3.3.cmml">â‹¯</mi><mo id="S4.SS3.p2.2.m2.5.6.2.3" xref="S4.SS3.p2.2.m2.5.6.1.cmml">,</mo><mn id="S4.SS3.p2.2.m2.4.4" xref="S4.SS3.p2.2.m2.4.4.cmml">91</mn><mo id="S4.SS3.p2.2.m2.5.6.2.4" xref="S4.SS3.p2.2.m2.5.6.1.cmml">,</mo><mn id="S4.SS3.p2.2.m2.5.5" xref="S4.SS3.p2.2.m2.5.5.cmml">96</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.5b"><list id="S4.SS3.p2.2.m2.5.6.1.cmml" xref="S4.SS3.p2.2.m2.5.6.2"><cn id="S4.SS3.p2.2.m2.1.1.cmml" type="integer" xref="S4.SS3.p2.2.m2.1.1">1</cn><cn id="S4.SS3.p2.2.m2.2.2.cmml" type="integer" xref="S4.SS3.p2.2.m2.2.2">6</cn><ci id="S4.SS3.p2.2.m2.3.3.cmml" xref="S4.SS3.p2.2.m2.3.3">â‹¯</ci><cn id="S4.SS3.p2.2.m2.4.4.cmml" type="integer" xref="S4.SS3.p2.2.m2.4.4">91</cn><cn id="S4.SS3.p2.2.m2.5.5.cmml" type="integer" xref="S4.SS3.p2.2.m2.5.5">96</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.5c">1,6,\cdots,91,96</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.5d">1 , 6 , â‹¯ , 91 , 96</annotation></semantics></math> for testing, and games <math alttext="136,141,146,151,156" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.5"><semantics id="S4.SS3.p2.3.m3.5a"><mrow id="S4.SS3.p2.3.m3.5.6.2" xref="S4.SS3.p2.3.m3.5.6.1.cmml"><mn id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">136</mn><mo id="S4.SS3.p2.3.m3.5.6.2.1" xref="S4.SS3.p2.3.m3.5.6.1.cmml">,</mo><mn id="S4.SS3.p2.3.m3.2.2" xref="S4.SS3.p2.3.m3.2.2.cmml">141</mn><mo id="S4.SS3.p2.3.m3.5.6.2.2" xref="S4.SS3.p2.3.m3.5.6.1.cmml">,</mo><mn id="S4.SS3.p2.3.m3.3.3" xref="S4.SS3.p2.3.m3.3.3.cmml">146</mn><mo id="S4.SS3.p2.3.m3.5.6.2.3" xref="S4.SS3.p2.3.m3.5.6.1.cmml">,</mo><mn id="S4.SS3.p2.3.m3.4.4" xref="S4.SS3.p2.3.m3.4.4.cmml">151</mn><mo id="S4.SS3.p2.3.m3.5.6.2.4" xref="S4.SS3.p2.3.m3.5.6.1.cmml">,</mo><mn id="S4.SS3.p2.3.m3.5.5" xref="S4.SS3.p2.3.m3.5.5.cmml">156</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.5b"><list id="S4.SS3.p2.3.m3.5.6.1.cmml" xref="S4.SS3.p2.3.m3.5.6.2"><cn id="S4.SS3.p2.3.m3.1.1.cmml" type="integer" xref="S4.SS3.p2.3.m3.1.1">136</cn><cn id="S4.SS3.p2.3.m3.2.2.cmml" type="integer" xref="S4.SS3.p2.3.m3.2.2">141</cn><cn id="S4.SS3.p2.3.m3.3.3.cmml" type="integer" xref="S4.SS3.p2.3.m3.3.3">146</cn><cn id="S4.SS3.p2.3.m3.4.4.cmml" type="integer" xref="S4.SS3.p2.3.m3.4.4">151</cn><cn id="S4.SS3.p2.3.m3.5.5.cmml" type="integer" xref="S4.SS3.p2.3.m3.5.5">156</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.5c">136,141,146,151,156</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.5d">136 , 141 , 146 , 151 , 156</annotation></semantics></math> for prompting.
For each task, the input describes the 5 horizontal clues and 5 vertical clues, and the output should be a board of <math alttext="5\times 5=25" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m4.1"><semantics id="S4.SS3.p2.4.m4.1a"><mrow id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml"><mrow id="S4.SS3.p2.4.m4.1.1.2" xref="S4.SS3.p2.4.m4.1.1.2.cmml"><mn id="S4.SS3.p2.4.m4.1.1.2.2" xref="S4.SS3.p2.4.m4.1.1.2.2.cmml">5</mn><mo id="S4.SS3.p2.4.m4.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p2.4.m4.1.1.2.1.cmml">Ã—</mo><mn id="S4.SS3.p2.4.m4.1.1.2.3" xref="S4.SS3.p2.4.m4.1.1.2.3.cmml">5</mn></mrow><mo id="S4.SS3.p2.4.m4.1.1.1" xref="S4.SS3.p2.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS3.p2.4.m4.1.1.3" xref="S4.SS3.p2.4.m4.1.1.3.cmml">25</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><apply id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1"><eq id="S4.SS3.p2.4.m4.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1.1"></eq><apply id="S4.SS3.p2.4.m4.1.1.2.cmml" xref="S4.SS3.p2.4.m4.1.1.2"><times id="S4.SS3.p2.4.m4.1.1.2.1.cmml" xref="S4.SS3.p2.4.m4.1.1.2.1"></times><cn id="S4.SS3.p2.4.m4.1.1.2.2.cmml" type="integer" xref="S4.SS3.p2.4.m4.1.1.2.2">5</cn><cn id="S4.SS3.p2.4.m4.1.1.2.3.cmml" type="integer" xref="S4.SS3.p2.4.m4.1.1.2.3">5</cn></apply><cn id="S4.SS3.p2.4.m4.1.1.3.cmml" type="integer" xref="S4.SS3.p2.4.m4.1.1.3">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">5\times 5=25</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m4.1d">5 Ã— 5 = 25</annotation></semantics></math> letters to solve the crosswords. For evaluation, we consider three levels of success: the portion of correct letters (25 per game), words (10 per game), and games.</p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p3.1.1">Baselines.</span> We provide 5 example input-output pairs in the IO prompt, and in the CoT prompt additionally include intermediate words in the order h1..5 then v1..5. We run each prompt for 10 samples and average the results.</p>
</div>
<div class="ltx_para" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p4.1.1">ToT setup.</span> We leverage a depth-first search (AlgorithmÂ <a class="ltx_ref" href="#alg2" title="Algorithm 2 â€£ 3 Tree of Thoughts: Deliberate Problem Solving with LM â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>) that keeps exploring the most promising subsequent word clue until the state is no longer promising, then backtrack to the parent state to explore alternative thoughts.
To make search tractable, subsequent thoughts are constrained not to change any filled words or letters, so that the ToT has at most 10 intermediate steps.
For thought generation, at each state we translate all existing thoughts (e.g.â€‰â€œh2.motor; h1.tasksâ€ for the state in FigureÂ <a class="ltx_ref" href="#S4.F6" title="Figure 6 â€£ 4.3 Mini crosswords â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>(a)) into letter constraints for remaining clues (e.g.â€‰â€œv1.To heap: tm___;â€¦â€) and prompt a proposal prompt <math alttext="5" class="ltx_Math" display="inline" id="S4.SS3.p4.1.m1.1"><semantics id="S4.SS3.p4.1.m1.1a"><mn id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><cn id="S4.SS3.p4.1.m1.1.1.cmml" type="integer" xref="S4.SS3.p4.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">5</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.1.m1.1d">5</annotation></semantics></math> times to come up with candidates for where and what to fill in the next word. Importantly, we also prompt the LM to give a confidence level for different thoughts, and aggregate these across proposals to obtain a sorted list of next thoughts to explore (FigureÂ <a class="ltx_ref" href="#S4.F6" title="Figure 6 â€£ 4.3 Mini crosswords â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>(a)).
For state evaluations, we similarly translate each state into letter constraints for remaining clues, then evaluate for each clue if it is possible to fill given the constraints. If any remaining clue is deemed â€œimpossibleâ€ to fill in (e.g.â€‰â€œv1. To heap: tm_s_â€), then the exploration of the stateâ€™s subtree is pruned and DFS backtracks to its parent to explore the next promising thought. We limit DFS search steps to 100, and simply render the deepest explored state (the first explored one if multiple) into the final output.</p>
</div>
<div class="ltx_para" id="S4.SS3.p5">
<p class="ltx_p" id="S4.SS3.p5.2"><span class="ltx_text ltx_font_bold" id="S4.SS3.p5.2.1">Results.</span> As shown in TableÂ <a class="ltx_ref" href="#S4.F5" title="Figure 5 â€£ 4.2 Creative writing â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>, IO and CoT prompting methods perform poorly with a word-level success rate less than <math alttext="16\%" class="ltx_Math" display="inline" id="S4.SS3.p5.1.m1.1"><semantics id="S4.SS3.p5.1.m1.1a"><mrow id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml"><mn id="S4.SS3.p5.1.m1.1.1.2" xref="S4.SS3.p5.1.m1.1.1.2.cmml">16</mn><mo id="S4.SS3.p5.1.m1.1.1.1" xref="S4.SS3.p5.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.1b"><apply id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1"><csymbol cd="latexml" id="S4.SS3.p5.1.m1.1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1.1">percent</csymbol><cn id="S4.SS3.p5.1.m1.1.1.2.cmml" type="integer" xref="S4.SS3.p5.1.m1.1.1.2">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.1c">16\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p5.1.m1.1d">16 %</annotation></semantics></math>, while ToT significantly improves all metrics, achieving a word-level success rate of <math alttext="60\%" class="ltx_Math" display="inline" id="S4.SS3.p5.2.m2.1"><semantics id="S4.SS3.p5.2.m2.1a"><mrow id="S4.SS3.p5.2.m2.1.1" xref="S4.SS3.p5.2.m2.1.1.cmml"><mn id="S4.SS3.p5.2.m2.1.1.2" xref="S4.SS3.p5.2.m2.1.1.2.cmml">60</mn><mo id="S4.SS3.p5.2.m2.1.1.1" xref="S4.SS3.p5.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.2.m2.1b"><apply id="S4.SS3.p5.2.m2.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1"><csymbol cd="latexml" id="S4.SS3.p5.2.m2.1.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1.1">percent</csymbol><cn id="S4.SS3.p5.2.m2.1.1.2.cmml" type="integer" xref="S4.SS3.p5.2.m2.1.1.2">60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.2.m2.1c">60\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p5.2.m2.1d">60 %</annotation></semantics></math> and solving 4 out of 20 games. Such an improvement is not surprising, given IO and CoT lack mechanisms to try different clues, make changes to decisions, or backtrack. </p>
</div>
<div class="ltx_para" id="S4.SS3.p6">
<p class="ltx_p" id="S4.SS3.p6.3"><span class="ltx_text ltx_font_bold" id="S4.SS3.p6.3.1">Oracle and ablation studies.</span> When outputting from the oracle best DFS state (instead of the heuristically determined best state) per task, ToT performance is even higher and actually solves 7/20 games (TableÂ <a class="ltx_ref" href="#S4.F5" title="Figure 5 â€£ 4.2 Creative writing â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>, â€œ+best stateâ€), indicating our simple output heuristics can be readily improved. Interestingly, sometimes when the crosswords game is actually solved, the state evaluator might still deem some words as â€œimpossibleâ€ and prune â€” possibly because <math alttext="5\times 5" class="ltx_Math" display="inline" id="S4.SS3.p6.1.m1.1"><semantics id="S4.SS3.p6.1.m1.1a"><mrow id="S4.SS3.p6.1.m1.1.1" xref="S4.SS3.p6.1.m1.1.1.cmml"><mn id="S4.SS3.p6.1.m1.1.1.2" xref="S4.SS3.p6.1.m1.1.1.2.cmml">5</mn><mo id="S4.SS3.p6.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p6.1.m1.1.1.1.cmml">Ã—</mo><mn id="S4.SS3.p6.1.m1.1.1.3" xref="S4.SS3.p6.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.1.m1.1b"><apply id="S4.SS3.p6.1.m1.1.1.cmml" xref="S4.SS3.p6.1.m1.1.1"><times id="S4.SS3.p6.1.m1.1.1.1.cmml" xref="S4.SS3.p6.1.m1.1.1.1"></times><cn id="S4.SS3.p6.1.m1.1.1.2.cmml" type="integer" xref="S4.SS3.p6.1.m1.1.1.2">5</cn><cn id="S4.SS3.p6.1.m1.1.1.3.cmml" type="integer" xref="S4.SS3.p6.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.1.m1.1c">5\times 5</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.1.m1.1d">5 Ã— 5</annotation></semantics></math> crosswords by design have some rare or obselete words that GPT-4 cannot recognize<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>For example, â€œagendâ€ is an obsolete form of â€œagendumâ€, but GPT-4 deems it a typo for â€œagendaâ€. External retrieval
or web interaction
could augment LM for problem solving under knowledge uncertainty.</span></span></span>.
Given the state evaluation as a pruning heuristic is imperfect, we also explore ablating the pruning, and find the performance generally worse (TableÂ <a class="ltx_ref" href="#S4.F5" title="Figure 5 â€£ 4.2 Creative writing â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>, â€œ-pruneâ€). However, it could actually find the correct solution for 4/20 games (though only outputting 1 via heuristic), 3 of which are games ToT+pruning cannot solve within 100 steps. Thus, better heuristics for DFS pruning are critical for problem solving in this case.
Lastly, we confirm the importance of backtracking by running an ablation that keeps filling the most promising clue for at most 20 steps, allowing overwrites. This is similar to a â€œgreedyâ€ BFS search with breadth limit of <math alttext="b=1" class="ltx_Math" display="inline" id="S4.SS3.p6.2.m2.1"><semantics id="S4.SS3.p6.2.m2.1a"><mrow id="S4.SS3.p6.2.m2.1.1" xref="S4.SS3.p6.2.m2.1.1.cmml"><mi id="S4.SS3.p6.2.m2.1.1.2" xref="S4.SS3.p6.2.m2.1.1.2.cmml">b</mi><mo id="S4.SS3.p6.2.m2.1.1.1" xref="S4.SS3.p6.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS3.p6.2.m2.1.1.3" xref="S4.SS3.p6.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.2.m2.1b"><apply id="S4.SS3.p6.2.m2.1.1.cmml" xref="S4.SS3.p6.2.m2.1.1"><eq id="S4.SS3.p6.2.m2.1.1.1.cmml" xref="S4.SS3.p6.2.m2.1.1.1"></eq><ci id="S4.SS3.p6.2.m2.1.1.2.cmml" xref="S4.SS3.p6.2.m2.1.1.2">ğ‘</ci><cn id="S4.SS3.p6.2.m2.1.1.3.cmml" type="integer" xref="S4.SS3.p6.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.2.m2.1c">b=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.2.m2.1d">italic_b = 1</annotation></semantics></math>, and performs poorly with a word level success of only <math alttext="20\%" class="ltx_Math" display="inline" id="S4.SS3.p6.3.m3.1"><semantics id="S4.SS3.p6.3.m3.1a"><mrow id="S4.SS3.p6.3.m3.1.1" xref="S4.SS3.p6.3.m3.1.1.cmml"><mn id="S4.SS3.p6.3.m3.1.1.2" xref="S4.SS3.p6.3.m3.1.1.2.cmml">20</mn><mo id="S4.SS3.p6.3.m3.1.1.1" xref="S4.SS3.p6.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.3.m3.1b"><apply id="S4.SS3.p6.3.m3.1.1.cmml" xref="S4.SS3.p6.3.m3.1.1"><csymbol cd="latexml" id="S4.SS3.p6.3.m3.1.1.1.cmml" xref="S4.SS3.p6.3.m3.1.1.1">percent</csymbol><cn id="S4.SS3.p6.3.m3.1.1.2.cmml" type="integer" xref="S4.SS3.p6.3.m3.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.3.m3.1c">20\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.3.m3.1d">20 %</annotation></semantics></math> (TableÂ <a class="ltx_ref" href="#S4.F5" title="Figure 5 â€£ 4.2 Creative writing â€£ 4 Experiments â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>, â€œ-backtrackâ€).</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Related Work</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.p1.1.1">Planning and decision making.</span> Smart planning and decision making are critical to achieving predefined goals. As they are trained on vast amount of world knowledge and human examples,
LMs are known to have already absorbed rich commonsense that makes it possible to propose reasonable plans conditioned on problem setting and environmental statesÂ <cite class="ltx_cite ltx_citemacro_citep">(Huang etÂ al., <a class="ltx_ref" href="#bib.bib12" title="">2022a</a>; Zhang etÂ al., <a class="ltx_ref" href="#bib.bib42" title="">2023</a>; Wang etÂ al., <a class="ltx_ref" href="#bib.bib37" title="">2023b</a>; Huang etÂ al., <a class="ltx_ref" href="#bib.bib13" title="">2022b</a>; Wang etÂ al., <a class="ltx_ref" href="#bib.bib35" title="">2023a</a>; Yao etÂ al., <a class="ltx_ref" href="#bib.bib41" title="">2022</a>; Yang etÂ al., <a class="ltx_ref" href="#bib.bib40" title="">2023</a>)</cite>. Our proposed ToT approach extends existing planning formulations by considering multiple potentially feasible plans simultaneously at each problem-solving step, and proceeding with the most promising ones. The integration between thought sampling and value feedback organically integrates planning and decision-making mechanisms, enabling effective search inside a solution tree. On the other hand, traditional decision-making procedures usually require training dedicated reward and policy models as in reinforcement learning (for example CHAIÂ <cite class="ltx_cite ltx_citemacro_citep">(Verma etÂ al., <a class="ltx_ref" href="#bib.bib33" title="">2022</a>)</cite>), whereas we use the LM itself to provide the value estimates for decision making.
RAPÂ <cite class="ltx_cite ltx_citemacro_citep">(Hao etÂ al., <a class="ltx_ref" href="#bib.bib9" title="">2023</a>)</cite> is a concurrent work that treats language model reasoning as planning with its internal world model, and proposes a MCTS-based method similar to ToT. However, its tasks are simpler than ours, and its framework lacks the modularity to incorporate different tree search algorithms.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">Self-reflection.</span> Using LLMs to assess the viability of their own predictions is becoming an increasingly important procedure in problem solving. <cite class="ltx_cite ltx_citemacro_citep">(Shinn etÂ al., <a class="ltx_ref" href="#bib.bib28" title="">2023</a>; Madaan etÂ al., <a class="ltx_ref" href="#bib.bib20" title="">2023</a>; Paul etÂ al., <a class="ltx_ref" href="#bib.bib24" title="">2023</a>)</cite> introduced the â€œself-reflectionâ€ mechanism, in which LMs provide feedback to their generation candidates. <cite class="ltx_cite ltx_citemacro_citep">(Chen etÂ al., <a class="ltx_ref" href="#bib.bib4" title="">2023</a>)</cite> improves LMs code generation accuracy by injecting feedback messages generated by the LM itself based on its code execution results. Similarly, <cite class="ltx_cite ltx_citemacro_citep">(Kim etÂ al., <a class="ltx_ref" href="#bib.bib17" title="">2023</a>)</cite> also introduces â€œcriticâ€ or review steps over the actions and states, deciding the next action to take in solving computer operation tasks. Another recent work very relevant to ours is â€œself-eval guided decodingâ€ Â <cite class="ltx_cite ltx_citemacro_citep">(Xie etÂ al., <a class="ltx_ref" href="#bib.bib39" title="">2023</a>)</cite>. Similar to our method, self-eval decoding also follows a tree-search procedure with leaves sampled from stochastic beam search decoding, which are then evaluated by LLM itself with carefully prepared self-eval prompts. Their approach however, uses the PAL formulation Â <cite class="ltx_cite ltx_citemacro_citep">(Gao etÂ al., <a class="ltx_ref" href="#bib.bib8" title="">2023</a>)</cite> which represents thoughts as codes, which makes it difficult to tackle challenging tasks like creative writing which we consider in this paper. Our Tree-of-Thought formulation is thus more versatile and handles challenging tasks on which GPT-4 only achieves very low accuracy with standard prompts.</p>
</div>
<div class="ltx_para" id="S5.p3">
<p class="ltx_p" id="S5.p3.1"><span class="ltx_text ltx_font_bold" id="S5.p3.1.1">Program-guided LLM generation.</span> Our proposal is also related to recent advancements that organize LMâ€™s behavior with systematic proceduresÂ <cite class="ltx_cite ltx_citemacro_citep">(Jung etÂ al., <a class="ltx_ref" href="#bib.bib14" title="">2022</a>; Zhu etÂ al., <a class="ltx_ref" href="#bib.bib44" title="">2022</a>; Creswell and Shanahan, <a class="ltx_ref" href="#bib.bib6" title="">2022</a>; Zhou etÂ al., <a class="ltx_ref" href="#bib.bib43" title="">2022</a>)</cite> or symbolic program guidance. For example, <cite class="ltx_cite ltx_citemacro_citet">Schlag etÂ al. (<a class="ltx_ref" href="#bib.bib27" title="">2023</a>)</cite> embeds LMs in an algorithmic search procedure to help solve problems like question answering step-by-step, in which the search trees are expanded by relevant paragraphs that might provide answers. This approach however differs from ours in that trees are expanded by sampling external paragraphs instead of the LMâ€™s own thoughts, and there is no reflection or voting steps. Another approach, LLM+PÂ <cite class="ltx_cite ltx_citemacro_citep">(Liu etÂ al., <a class="ltx_ref" href="#bib.bib18" title="">2023</a>)</cite>, goes one step further and delegates the actual planning process to a classical planner.</p>
</div>
<div class="ltx_para" id="S5.p4">
<p class="ltx_p" id="S5.p4.1"><span class="ltx_text ltx_font_bold" id="S5.p4.1.1">Classical search methods.</span> Last but not least, our approach can be treated as a modern rendition of classical search methods for problem solving. For example it can be considered as a heuristic search algorithm like A*Â <cite class="ltx_cite ltx_citemacro_citep">(Hart etÂ al., <a class="ltx_ref" href="#bib.bib10" title="">1968a</a>)</cite>, in which the heuristic at each search node is provided by the LMâ€™s self-assessment. From this perspective, our method is also related to NeuroLogic A*esque decodingÂ <cite class="ltx_cite ltx_citemacro_citep">(Lu etÂ al., <a class="ltx_ref" href="#bib.bib19" title="">2021</a>)</cite>, which is inspired by A* search but introduces look-ahead heuristics that are efficient for LMs to improve the beam-search or top-k sampling decoding. This method however is constrained to sentence generation tasks, whereas our framework are designed for complex, multi-step problem solving guarded by value feedback.
</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Discussion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1"><span class="ltx_text ltx_font_bold" id="S6.p1.1.1">Limitations and future directions.</span>
Deliberate search such as ToT might not be necessary for many existing tasks that GPT-4 already excels at (see AppendixÂ <a class="ltx_ref" href="#A2.SS1" title="B.1 Extension to new tasks (GSM8k, StrategyQA) with zero-shot ToT â€£ Appendix B Additional Experiment Results â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">B.1</span></a>), and as an initial step this work only explores three relatively simple tasks that challenges GPT-4 (see AppendixÂ <a class="ltx_ref" href="#A2.SS2" title="B.2 Extension to new LMs (GPT-3.5) â€£ Appendix B Additional Experiment Results â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">B.2</span></a> for some GPT-3.5 experiment results) and calls of better search and planning abilities incorporated with LMs. However, as we begin to deploy LMs for more real-world decision making applications (e.g.â€‰coding, data analysis, robotics, etc.), more complex tasks could emerge and present new opportunities to study these research questions. Also, search methods like ToT requires more resources (e.g.â€‰GPT-4 API cost) than sampling methods in order to improve task performances, but the modular flexibility of ToT allows users to customize such performance-cost tradeoffs, and ongoing open-source effortsÂ <cite class="ltx_cite ltx_citemacro_citep">(Touvron etÂ al., <a class="ltx_ref" href="#bib.bib32" title="">2023</a>)</cite> should readily reduce such costs in the near future. More details about cost and efficiency are in AppendixÂ <a class="ltx_ref" href="#A2.SS3" title="B.3 Cost and efficiency â€£ Appendix B Additional Experiment Results â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">B.3</span></a>. Lastly, this work focuses on using an off-the-shelf LM, and fine-tuning LMs using a ToT-style high-level counterfactual decision making (e.g.â€‰deliberating over potential choices for the next paragraph, instead of predicting the next token) might present opportunities to enhance the problem-solving capabilities of LMs.
</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1"><span class="ltx_text ltx_font_bold" id="S6.p2.1.1">Conclusion.</span> The associative â€œSystem 1â€ of LMs can be beneficially augmented by a â€œSystem 2â€ based on searching a tree of possible paths to the solution to a problem. The Tree of Thoughts framework provides a way to translate classical insights about problem-solving into actionable methods for contemporary LMs. At the same time, LMs address a weakness of these classical methods, providing a way to solve complex problems that are not easily formalized, such as creative writing. We see this intersection of LMs with classical approaches to AI as an exciting direction.</p>
</div>
<section class="ltx_subsection" id="S6.SSx1">
<h3 class="ltx_title ltx_title_subsection">Broader Impact</h3>
<div class="ltx_para" id="S6.SSx1.p1">
<p class="ltx_p" id="S6.SSx1.p1.1">ToT is a framework that empowers LMs to more autonomously and intelligently make decisions and solve problems. While current tasks are limited to reasoning and search problems, future applications involving interaction with external environments or humans could bring potential danger, e.g.â€‰facilitating harmful uses of LMs. On the other hand, ToT also improves the interpretability of model decisions and the opportunity for human alignment, as the resulting representations are readable, high-level language reasoning instead of implicit, low-level token values.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SSx2">
<h3 class="ltx_title ltx_title_subsection">Acknowledgements</h3>
<div class="ltx_para" id="S6.SSx2.p1">
<p class="ltx_p" id="S6.SSx2.p1.1">SY and KN acknowledge support from an Oracle Collaborative Research award and the National Science Foundation under Grant No. 2239363. Any opinions, findings, conclusions, or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the National Science Foundation. SY is also supported by the Harold W. Dodds Fellowship from Princeton.</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown etÂ al. (2020)</span>
<span class="ltx_bibblock">
T.Â Brown, B.Â Mann, N.Â Ryder, M.Â Subbiah, J.Â D. Kaplan, P.Â Dhariwal,
A.Â Neelakantan, P.Â Shyam, G.Â Sastry, A.Â Askell, etÂ al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Advances in neural information processing systems</em>,
33:1877â€“1901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Browne etÂ al. (2012)</span>
<span class="ltx_bibblock">
C.Â Browne, E.Â J. Powley, D.Â Whitehouse, S.Â M.Â M. Lucas, P.Â I. Cowling,
P.Â Rohlfshagen, S.Â Tavener, D.Â P. Liebana, S.Â Samothrakis, and S.Â Colton.

</span>
<span class="ltx_bibblock">A survey of monte carlo tree search methods.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">IEEE Transactions on Computational Intelligence and AI in
Games</em>, 4:1â€“43, 2012.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Campbell etÂ al. (2002)</span>
<span class="ltx_bibblock">
M.Â Campbell, A.Â J. HoaneÂ Jr, and F.-h. Hsu.

</span>
<span class="ltx_bibblock">Deep blue.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Artificial intelligence</em>, 134(1-2):57â€“83,
2002.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen etÂ al. (2023)</span>
<span class="ltx_bibblock">
X.Â Chen, M.Â Lin, N.Â SchÃ¤rli, and D.Â Zhou.

</span>
<span class="ltx_bibblock">Teaching large language models to self-debug, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chowdhery etÂ al. (2022)</span>
<span class="ltx_bibblock">
A.Â Chowdhery, S.Â Narang, J.Â Devlin, M.Â Bosma, G.Â Mishra, A.Â Roberts, P.Â Barham,
H.Â W. Chung, C.Â Sutton, S.Â Gehrmann, etÂ al.

</span>
<span class="ltx_bibblock">Palm: Scaling language modeling with pathways.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2204.02311</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Creswell and Shanahan (2022)</span>
<span class="ltx_bibblock">
A.Â Creswell and M.Â Shanahan.

</span>
<span class="ltx_bibblock">Faithful reasoning using large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2208.14271</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Daw etÂ al. (2005)</span>
<span class="ltx_bibblock">
N.Â D. Daw, Y.Â Niv, and P.Â Dayan.

</span>
<span class="ltx_bibblock">Uncertainty-based competition between prefrontal and dorsolateral
striatal systems for behavioral control.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Nature neuroscience</em>, 8(12):1704â€“1711,
2005.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao etÂ al. (2023)</span>
<span class="ltx_bibblock">
L.Â Gao, A.Â Madaan, S.Â Zhou, U.Â Alon, P.Â Liu, Y.Â Yang, J.Â Callan, and G.Â Neubig.

</span>
<span class="ltx_bibblock">Pal: Program-aided language models, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hao etÂ al. (2023)</span>
<span class="ltx_bibblock">
S.Â Hao, Y.Â Gu, H.Â Ma, J.Â J. Hong, Z.Â Wang, D.Â Z. Wang, and Z.Â Hu.

</span>
<span class="ltx_bibblock">Reasoning with language model is planning with world model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2305.14992</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hart etÂ al. (1968a)</span>
<span class="ltx_bibblock">
P.Â E. Hart, N.Â J. Nilsson, and B.Â Raphael.

</span>
<span class="ltx_bibblock">A formal basis for the heuristic determination of minimum cost paths.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">IEEE Transactions on Systems Science and Cybernetics</em>,
4(2):100â€“107, 1968a.

</span>
<span class="ltx_bibblock">doi: <a class="ltx_ref ltx_Url" href="10.1109/TSSC.1968.300136" title="">10.1109/TSSC.1968.300136</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hart etÂ al. (1968b)</span>
<span class="ltx_bibblock">
P.Â E. Hart, N.Â J. Nilsson, and B.Â Raphael.

</span>
<span class="ltx_bibblock">A formal basis for the heuristic determination of minimum cost paths.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">IEEE transactions on Systems Science and Cybernetics</em>,
4(2):100â€“107, 1968b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang etÂ al. (2022a)</span>
<span class="ltx_bibblock">
W.Â Huang, P.Â Abbeel, D.Â Pathak, and I.Â Mordatch.

</span>
<span class="ltx_bibblock">Language models as zero-shot planners: Extracting actionable
knowledge for embodied agents, 2022a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang etÂ al. (2022b)</span>
<span class="ltx_bibblock">
W.Â Huang, F.Â Xia, T.Â Xiao, H.Â Chan, J.Â Liang, P.Â Florence, A.Â Zeng, J.Â Tompson,
I.Â Mordatch, Y.Â Chebotar, etÂ al.

</span>
<span class="ltx_bibblock">Inner monologue: Embodied reasoning through planning with language
models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2207.05608</em>, 2022b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jung etÂ al. (2022)</span>
<span class="ltx_bibblock">
J.Â Jung, L.Â Qin, S.Â Welleck, F.Â Brahman, C.Â Bhagavatula, R.Â L. Bras, and
Y.Â Choi.

</span>
<span class="ltx_bibblock">Maieutic prompting: Logically consistent reasoning with recursive
explanations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2205.11822</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kahneman (2011)</span>
<span class="ltx_bibblock">
D.Â Kahneman.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Thinking, fast and slow</em>.

</span>
<span class="ltx_bibblock">Macmillan, 2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kahneman etÂ al. (2002)</span>
<span class="ltx_bibblock">
D.Â Kahneman, S.Â Frederick, etÂ al.

</span>
<span class="ltx_bibblock">Representativeness revisited: Attribute substitution in intuitive
judgment.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Heuristics and biases: The psychology of intuitive judgment</em>,
49(49-81):74, 2002.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim etÂ al. (2023)</span>
<span class="ltx_bibblock">
G.Â Kim, P.Â Baldi, and S.Â McAleer.

</span>
<span class="ltx_bibblock">Language models can solve computer tasks, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu etÂ al. (2023)</span>
<span class="ltx_bibblock">
B.Â Liu, Y.Â Jiang, X.Â Zhang, Q.Â Liu, S.Â Zhang, J.Â Biswas, and P.Â Stone.

</span>
<span class="ltx_bibblock">Llm+p: Empowering large language models with optimal planning
proficiency, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu etÂ al. (2021)</span>
<span class="ltx_bibblock">
X.Â Lu, S.Â Welleck, P.Â West, L.Â Jiang, J.Â Kasai, D.Â Khashabi, R.Â L. Bras,
L.Â Qin, Y.Â Yu, R.Â Zellers, N.Â A. Smith, and Y.Â Choi.

</span>
<span class="ltx_bibblock">Neurologic a*esque decoding: Constrained text generation with
lookahead heuristics.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">North American Chapter of the Association for Computational
Linguistics</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Madaan etÂ al. (2023)</span>
<span class="ltx_bibblock">
A.Â Madaan, N.Â Tandon, P.Â Gupta, S.Â Hallinan, L.Â Gao, S.Â Wiegreffe, U.Â Alon,
N.Â Dziri, S.Â Prabhumoye, Y.Â Yang, S.Â Welleck, B.Â P. Majumder, S.Â Gupta,
A.Â Yazdanbakhsh, and P.Â Clark.

</span>
<span class="ltx_bibblock">Self-refine: Iterative refinement with self-feedback, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Newell etÂ al. (1959)</span>
<span class="ltx_bibblock">
A.Â Newell, J.Â C. Shaw, and H.Â A. Simon.

</span>
<span class="ltx_bibblock">Report on a general problem solving program.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">IFIP congress</em>, volume 256, pageÂ 64. Pittsburgh, PA, 1959.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Newell etÂ al. (1972)</span>
<span class="ltx_bibblock">
A.Â Newell, H.Â A. Simon, etÂ al.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Human problem solving</em>.

</span>
<span class="ltx_bibblock">Prentice-Hall, 1972.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2023)</span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">ArXiv</em>, abs/2303.08774, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paul etÂ al. (2023)</span>
<span class="ltx_bibblock">
D.Â Paul, M.Â Ismayilzada, M.Â Peyrard, B.Â Borges, A.Â Bosselut, R.Â West, and
B.Â Faltings.

</span>
<span class="ltx_bibblock">Refiner: Reasoning feedback on intermediate representations, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford etÂ al. (2018)</span>
<span class="ltx_bibblock">
A.Â Radford, K.Â Narasimhan, T.Â Salimans, I.Â Sutskever, etÂ al.

</span>
<span class="ltx_bibblock">Improving language understanding by generative pre-training.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">OpenAI blog</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford etÂ al. (2019)</span>
<span class="ltx_bibblock">
A.Â Radford, J.Â Wu, R.Â Child, D.Â Luan, D.Â Amodei, I.Â Sutskever, etÂ al.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">OpenAI blog</em>, 1(8):9, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schlag etÂ al. (2023)</span>
<span class="ltx_bibblock">
I.Â Schlag, S.Â Sukhbaatar, A.Â Celikyilmaz, W.Â tau Yih, J.Â Weston,
J.Â Schmidhuber, and X.Â Li.

</span>
<span class="ltx_bibblock">Large language model programs, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shinn etÂ al. (2023)</span>
<span class="ltx_bibblock">
N.Â Shinn, B.Â Labash, and A.Â Gopinath.

</span>
<span class="ltx_bibblock">Reflexion: an autonomous agent with dynamic memory and
self-reflection, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Silver etÂ al. (2017)</span>
<span class="ltx_bibblock">
D.Â Silver, J.Â Schrittwieser, K.Â Simonyan, I.Â Antonoglou, A.Â Huang, A.Â Guez,
T.Â Hubert, L.Â Baker, M.Â Lai, A.Â Bolton, etÂ al.

</span>
<span class="ltx_bibblock">Mastering the game of go without human knowledge.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">nature</em>, 550(7676):354â€“359, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sloman (1996)</span>
<span class="ltx_bibblock">
S.Â A. Sloman.

</span>
<span class="ltx_bibblock">The empirical case for two systems of reasoning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Psychological bulletin</em>, 119(1):3, 1996.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stanovich (1999)</span>
<span class="ltx_bibblock">
K.Â E. Stanovich.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Who is rational? Studies of individual differences in
reasoning</em>.

</span>
<span class="ltx_bibblock">Psychology Press, 1999.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron etÂ al. (2023)</span>
<span class="ltx_bibblock">
H.Â Touvron, T.Â Lavril, G.Â Izacard, X.Â Martinet, M.-A. Lachaux, T.Â Lacroix,
B.Â RoziÃ¨re, N.Â Goyal, E.Â Hambro, F.Â Azhar, etÂ al.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:2302.13971</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Verma etÂ al. (2022)</span>
<span class="ltx_bibblock">
S.Â Verma, J.Â Fu, S.Â Yang, and S.Â Levine.

</span>
<span class="ltx_bibblock">Chai: A chatbot ai for task-oriented dialogue with offline
reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Proceedings of the 2022 Conference of the North American
Chapter of the Association for Computational Linguistics: Human Language
Technologies</em>, pages 4471â€“4491, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wallace etÂ al. (2022)</span>
<span class="ltx_bibblock">
E.Â Wallace, N.Â Tomlin, A.Â Xu, K.Â Yang, E.Â Pathak, M.Â Ginsberg, and D.Â Klein.

</span>
<span class="ltx_bibblock">Automated crossword solving.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2205.09665</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang etÂ al. (2023a)</span>
<span class="ltx_bibblock">
L.Â Wang, W.Â Xu, Y.Â Lan, Z.Â Hu, Y.Â Lan, R.Â K.-W. Lee, and E.-P. Lim.

</span>
<span class="ltx_bibblock">Plan-and-solve prompting: Improving zero-shot chain-of-thought
reasoning by large language models, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang etÂ al. (2022)</span>
<span class="ltx_bibblock">
X.Â Wang, J.Â Wei, D.Â Schuurmans, Q.Â Le, E.Â Chi, and D.Â Zhou.

</span>
<span class="ltx_bibblock">Self-consistency improves chain of thought reasoning in language
models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv preprint arXiv:2203.11171</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang etÂ al. (2023b)</span>
<span class="ltx_bibblock">
Z.Â Wang, S.Â Cai, A.Â Liu, X.Â Ma, and Y.Â Liang.

</span>
<span class="ltx_bibblock">Describe, explain, plan and select: Interactive planning with large
language models enables open-world multi-task agents, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei etÂ al. (2022)</span>
<span class="ltx_bibblock">
J.Â Wei, X.Â Wang, D.Â Schuurmans, M.Â Bosma, E.Â Chi, Q.Â Le, and D.Â Zhou.

</span>
<span class="ltx_bibblock">Chain of thought prompting elicits reasoning in large language
models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">arXiv preprint arXiv:2201.11903</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie etÂ al. (2023)</span>
<span class="ltx_bibblock">
Y.Â Xie, K.Â Kawaguchi, Y.Â Zhao, X.Â Zhao, M.-Y. Kan, J.Â He, and Q.Â Xie.

</span>
<span class="ltx_bibblock">Decomposition enhances reasoning via self-evaluation guided decoding,
2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang etÂ al. (2023)</span>
<span class="ltx_bibblock">
S.Â Yang, O.Â Nachum, Y.Â Du, J.Â Wei, P.Â Abbeel, and D.Â Schuurmans.

</span>
<span class="ltx_bibblock">Foundation models for decision making: Problems, methods, and
opportunities, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao etÂ al. (2022)</span>
<span class="ltx_bibblock">
S.Â Yao, J.Â Zhao, D.Â Yu, N.Â Du, I.Â Shafran, K.Â Narasimhan, and Y.Â Cao.

</span>
<span class="ltx_bibblock">ReAct: Synergizing reasoning and acting in language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:2210.03629</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang etÂ al. (2023)</span>
<span class="ltx_bibblock">
S.Â Zhang, Z.Â Chen, Y.Â Shen, M.Â Ding, J.Â B. Tenenbaum, and C.Â Gan.

</span>
<span class="ltx_bibblock">Planning with large language models for code generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">The Eleventh International Conference on Learning
Representations</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=Lr8cOOtYbfL" title="">https://openreview.net/forum?id=Lr8cOOtYbfL</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou etÂ al. (2022)</span>
<span class="ltx_bibblock">
D.Â Zhou, N.Â SchÃ¤rli, L.Â Hou, J.Â Wei, N.Â Scales, X.Â Wang, D.Â Schuurmans,
C.Â Cui, O.Â Bousquet, Q.Â Le, etÂ al.

</span>
<span class="ltx_bibblock">Least-to-most prompting enables complex reasoning in large language
models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">arXiv preprint arXiv:2205.10625</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu etÂ al. (2022)</span>
<span class="ltx_bibblock">
X.Â Zhu, J.Â Wang, L.Â Zhang, Y.Â Zhang, R.Â Gan, J.Â Zhang, and Y.Â Yang.

</span>
<span class="ltx_bibblock">Solving math word problem via cooperative reasoning induced language
models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">arXiv preprint arXiv:2210.16257</em>, 2022.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Code, Prompts, Trajectories</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">All code is available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/princeton-nlp/tree-of-thought-llm" title="">https://github.com/princeton-nlp/tree-of-thought-llm</a>.</p>
</div>
<div class="ltx_para" id="A1.p2">
<p class="ltx_p" id="A1.p2.1">All prompts are available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/princeton-nlp/tree-of-thought-llm/tree/master/src/tot/prompts" title="">https://github.com/princeton-nlp/tree-of-thought-llm/tree/master/src/tot/prompts</a>.</p>
</div>
<div class="ltx_para" id="A1.p3">
<p class="ltx_p" id="A1.p3.1">Trajectories are available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/princeton-nlp/tree-of-thought-llm/tree/master/logs" title="">https://github.com/princeton-nlp/tree-of-thought-llm/tree/master/logs</a>.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Additional Experiment Results</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">Given the motivation of exploring and extending the capability frontier of language models, our experiments in the main paper have focused on a setup with the state-of-the-art language model (GPT-4), and three hard tasks invented to challenge it. Here, we report additional experiments with weaker LLM or easier tasks, and discuss cost and efficiency.</p>
</div>
<figure class="ltx_figure" id="A2.3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 4: </span>New tasks withzero-shot ToT and GPT-4.</figcaption>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 5: </span>Game of 24 withGPT-4 vsâ€‰GPT-3.5.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<table class="ltx_tabular ltx_centering ltx_minipage ltx_flex_size_3 ltx_align_middle" id="A2.3.4" style="width:151.8pt;">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.3.4.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="A2.3.4.1.1.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.3.4.1.1.2"><span class="ltx_text ltx_font_bold" id="A2.3.4.1.1.2.1">GSM8K</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.3.4.1.1.3"><span class="ltx_text ltx_font_bold" id="A2.3.4.1.1.3.1">StrategyQA</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.3.4.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.3.4.2.1.1">IO</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.3.4.2.1.2">51</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.3.4.2.1.3">73</td>
</tr>
<tr class="ltx_tr" id="A2.3.4.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.3.4.3.2.1">CoT</th>
<td class="ltx_td ltx_align_left" id="A2.3.4.3.2.2">86</td>
<td class="ltx_td ltx_align_left" id="A2.3.4.3.2.3">82</td>
</tr>
<tr class="ltx_tr" id="A2.3.4.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.3.4.4.3.1">ToT</th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.3.4.4.3.2"><span class="ltx_text ltx_font_bold" id="A2.3.4.4.3.2.1">90</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.3.4.4.3.3"><span class="ltx_text ltx_font_bold" id="A2.3.4.4.3.3.1">83</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<table class="ltx_tabular ltx_centering ltx_minipage ltx_flex_size_3 ltx_align_middle" id="A2.3.5" style="width:134.4pt;">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.3.5.1.1">
<td class="ltx_td ltx_border_tt" id="A2.3.5.1.1.1"></td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.3.5.1.1.2"><span class="ltx_text ltx_font_bold" id="A2.3.5.1.1.2.1">GPT-4</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.3.5.1.1.3"><span class="ltx_text ltx_font_bold" id="A2.3.5.1.1.3.1">GPT-3.5</span></th>
</tr>
<tr class="ltx_tr" id="A2.3.5.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.3.5.2.2.1">IO</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.3.5.2.2.2">7.3%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.3.5.2.2.3">6%</td>
</tr>
<tr class="ltx_tr" id="A2.3.5.3.3">
<td class="ltx_td ltx_align_left" id="A2.3.5.3.3.1">CoT</td>
<td class="ltx_td ltx_align_left" id="A2.3.5.3.3.2">4.0%</td>
<td class="ltx_td ltx_align_left" id="A2.3.5.3.3.3">3%</td>
</tr>
<tr class="ltx_tr" id="A2.3.5.4.4">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.3.5.4.4.1">ToT</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.3.5.4.4.2"><span class="ltx_text ltx_font_bold" id="A2.3.5.4.4.2.1">74%</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.3.5.4.4.3"><span class="ltx_text ltx_font_bold" id="A2.3.5.4.4.3.1">19%</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<table class="ltx_tabular ltx_centering ltx_minipage ltx_flex_size_3 ltx_align_middle" id="A2.3.6" style="width:134.4pt;">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.3.6.1.1">
<td class="ltx_td ltx_border_tt" id="A2.3.6.1.1.1"></td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.3.6.1.1.2"><span class="ltx_text ltx_font_bold" id="A2.3.6.1.1.2.1">GPT-4</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.3.6.1.1.3"><span class="ltx_text ltx_font_bold" id="A2.3.6.1.1.3.1">GPT-3.5</span></th>
</tr>
<tr class="ltx_tr" id="A2.3.6.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.3.6.2.2.1">IO</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.3.6.2.2.2">6.19</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.3.6.2.2.3">4.47</td>
</tr>
<tr class="ltx_tr" id="A2.3.6.3.3">
<td class="ltx_td ltx_align_left" id="A2.3.6.3.3.1">CoT</td>
<td class="ltx_td ltx_align_left" id="A2.3.6.3.3.2">6.93</td>
<td class="ltx_td ltx_align_left" id="A2.3.6.3.3.3">5.16</td>
</tr>
<tr class="ltx_tr" id="A2.3.6.4.4">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.3.6.4.4.1">ToT</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.3.6.4.4.2"><span class="ltx_text ltx_font_bold" id="A2.3.6.4.4.2.1">7.56</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.3.6.4.4.3"><span class="ltx_text ltx_font_bold" id="A2.3.6.4.4.3.1">6.62</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 4: </span>New tasks withzero-shot ToT and GPT-4.</figcaption>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 5: </span>Game of 24 withGPT-4 vsâ€‰GPT-3.5.</figcaption>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 6: </span>Creative Writing withGPT-4 vs.â€‰GPT-3.5.</figcaption>
</figure>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Extension to new tasks (GSM8k, StrategyQA) with zero-shot ToT</h3>
<div class="ltx_para" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.1">While more common NLP tasks might be too easy for GPT-4 and do not require ToT (which is why we considered harder new tasks), we believe applying ToT to new tasks could be straightforward. For example, we implemented a simple and generic zero-shot ToT-BFS similar to creative writing (sample 5 problem solving strategies then vote for the best one; then sample 5 solutions based on the best strategy then vote for the best one) for GSM8K and StrategyQA with few extra lines of code:</p>
</div>
<div class="ltx_para" id="A2.SS1.p2">
<pre class="ltx_verbatim ltx_font_typewriter" id="A2.SS1.p2.1">
# define the answer format of new tasks
gsm8k_format = â€˜"the answer is n" where n is a numberâ€™
strategyqa_format = â€˜either "the answer is yes" or "the answer is no"â€™

# define zero-shot io prompting
standard_prompt = â€˜Answer the following question with {format}: {input}â€™

# define thought format for zero-shot cot and zero-shot tot
cot_prompt = â€˜â€˜â€˜Answer the following question: {input}

Make a strategy then write. Your output should be of the following format:

Strategy:
Your strategy about how to answer the question.

Answer:
Your answer to the question. It should end with {format}.
â€™â€™â€™

# define zero-shot voting used for zero-shot tot
vote_prompt = â€˜â€˜â€˜Given an instruction and several choices,
decide which choice is most promising.
Analyze each choice in detail, then conclude in the last line
"The best choice is {s}", where s the integer id of the choice.
â€™â€™â€™
</pre>
</div>
<div class="ltx_para" id="A2.SS1.p3">
<p class="ltx_p" id="A2.SS1.p3.1">We evaluated on a subset of 100 random GSM8K test and StrategyQA dev questions. As shown in TableÂ <a class="ltx_ref" href="#A2" title="Appendix B Additional Experiment Results â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">B</span></a> and as expected, ToT improves over CoT on both tasks (but only slightly, given GPT-4 + CoT is already very good on such tasks, and StrategyQAâ€™s bottleneck is external knowledge, not reasoning). Considering computational costs, it is more suitable to try smaller LLMs + ToT for traditional NLP tasks, or GPT-4 + ToT for hard tasks that challenge GPT-4 + CoTâ€™s reasoning.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Extension to new LMs (GPT-3.5)</h3>
<div class="ltx_para" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.2">To understand how ToT works with other LLMs, we also ran GPT-3.5-turbo for Creative Writing (TableÂ <a class="ltx_ref" href="#A2" title="Appendix B Additional Experiment Results â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">B</span></a>) and Game of 24 (TableÂ <a class="ltx_ref" href="#A2" title="Appendix B Additional Experiment Results â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">B</span></a>).
On both tasks, â€œToT <math alttext="&gt;" class="ltx_Math" display="inline" id="A2.SS2.p1.1.m1.1"><semantics id="A2.SS2.p1.1.m1.1a"><mo id="A2.SS2.p1.1.m1.1.1" xref="A2.SS2.p1.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.1.m1.1b"><gt id="A2.SS2.p1.1.m1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.1.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.1.m1.1d">&gt;</annotation></semantics></math> CoT <math alttext="&gt;" class="ltx_Math" display="inline" id="A2.SS2.p1.2.m2.1"><semantics id="A2.SS2.p1.2.m2.1a"><mo id="A2.SS2.p1.2.m2.1.1" xref="A2.SS2.p1.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.2.m2.1b"><gt id="A2.SS2.p1.2.m2.1.1.cmml" xref="A2.SS2.p1.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.2.m2.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.2.m2.1d">&gt;</annotation></semantics></math> IOâ€ remains true for GPT-3.5.
On Creative Writing, we find GPT-3.5+ToT outperform GPT-4+IO, and similar to GPT-4+CoT, which suggests ToT could also work well on weaker language models.</p>
</div>
<div class="ltx_para" id="A2.SS2.p2">
<p class="ltx_p" id="A2.SS2.p2.1">On Game of 24 (we changed 1-shot proposal prompt to 3-shot to make it work), GPT-3.5+ToTâ€™s 19% is far worse than GPT-4+ToTâ€™s 74%. To further understand the importance of generation vs. evaluation, we ran GPT-4 generation + GPT-3.5 evaluation (64%) and GPT-3.5 generation + GPT-4 evaluation (31%). This suggests the gameâ€™s bottleneck is thought generation, and different generation/evaluation language models might attain decent results while reducing costs.
</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Cost and efficiency</h3>
<div class="ltx_para" id="A2.SS3.p1">
<p class="ltx_p" id="A2.SS3.p1.1">Running ToT requires significantly more computations than IO or CoT prompting. For example, in Game of 24 (TableÂ <a class="ltx_ref" href="#A2.T7" title="Table 7 â€£ B.3 Cost and efficiency â€£ Appendix B Additional Experiment Results â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a> below), solving a problem with ToT requires 5.5k completion tokens, close to 100 CoT trials (6.7k tokens). But the performance of ToT is better than best of 100 independent CoT trials.</p>
</div>
<figure class="ltx_table" id="A2.T7">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T7.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T7.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.1.1.1">Game of 24</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T7.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.1.2.1">Generate/Prompt tokens</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T7.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.1.3.1">Cost per case</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T7.1.1.1.4"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.1.4.1">Success</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T7.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T7.1.2.1.1">IO (best of 100)</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T7.1.2.1.2">1.8k / 1.0k</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T7.1.2.1.3">$0.13</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T7.1.2.1.4">33%</td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.3.2">
<td class="ltx_td ltx_align_left" id="A2.T7.1.3.2.1">CoT (best of 100)</td>
<td class="ltx_td ltx_align_left" id="A2.T7.1.3.2.2">6.7k / 2.2k</td>
<td class="ltx_td ltx_align_left" id="A2.T7.1.3.2.3">$0.47</td>
<td class="ltx_td ltx_align_left" id="A2.T7.1.3.2.4">49%</td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.4.3">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T7.1.4.3.1">ToT</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T7.1.4.3.2">5.5k / 1.4k</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T7.1.4.3.3">$0.74</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T7.1.4.3.4">74%</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Cost analysis on Game of 24.</figcaption>
</figure>
<div class="ltx_para" id="A2.SS3.p2">
<p class="ltx_p" id="A2.SS3.p2.1">On Creative Writing (TableÂ <a class="ltx_ref" href="#A2.T8" title="Table 8 â€£ B.3 Cost and efficiency â€£ Appendix B Additional Experiment Results â€£ Tree of Thoughts: Deliberate Problem Solving with Large Language Models"><span class="ltx_text ltx_ref_tag">8</span></a> below), we found ToT takes around 5x completion tokens and money cost, which is intuitive as <math alttext="b=5" class="ltx_Math" display="inline" id="A2.SS3.p2.1.m1.1"><semantics id="A2.SS3.p2.1.m1.1a"><mrow id="A2.SS3.p2.1.m1.1.1" xref="A2.SS3.p2.1.m1.1.1.cmml"><mi id="A2.SS3.p2.1.m1.1.1.2" xref="A2.SS3.p2.1.m1.1.1.2.cmml">b</mi><mo id="A2.SS3.p2.1.m1.1.1.1" xref="A2.SS3.p2.1.m1.1.1.1.cmml">=</mo><mn id="A2.SS3.p2.1.m1.1.1.3" xref="A2.SS3.p2.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS3.p2.1.m1.1b"><apply id="A2.SS3.p2.1.m1.1.1.cmml" xref="A2.SS3.p2.1.m1.1.1"><eq id="A2.SS3.p2.1.m1.1.1.1.cmml" xref="A2.SS3.p2.1.m1.1.1.1"></eq><ci id="A2.SS3.p2.1.m1.1.1.2.cmml" xref="A2.SS3.p2.1.m1.1.1.2">ğ‘</ci><cn id="A2.SS3.p2.1.m1.1.1.3.cmml" type="integer" xref="A2.SS3.p2.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p2.1.m1.1c">b=5</annotation><annotation encoding="application/x-llamapun" id="A2.SS3.p2.1.m1.1d">italic_b = 5</annotation></semantics></math> and most tokens are generated passages.</p>
</div>
<figure class="ltx_table" id="A2.T8">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T8.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T8.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.1.1">Creative Writing</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.2.1">Generate/Prompt tokens</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A2.T8.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A2.T8.1.1.1.3.1">Cost per case</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T8.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T8.1.2.1.1">IO</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T8.1.2.1.2">0.9k / 0.4k</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T8.1.2.1.3">$0.06</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.3.2">
<td class="ltx_td ltx_align_left" id="A2.T8.1.3.2.1">CoT</td>
<td class="ltx_td ltx_align_left" id="A2.T8.1.3.2.2">0.9k / 0.4k</td>
<td class="ltx_td ltx_align_left" id="A2.T8.1.3.2.3">$0.07</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.4.3">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T8.1.4.3.1">ToT</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T8.1.4.3.2">4k / 2.9k</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T8.1.4.3.3">$0.32</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>Cost analysis on Game of 24.</figcaption>
</figure>
<div class="ltx_para" id="A2.SS3.p3">
<p class="ltx_p" id="A2.SS3.p3.2">So completing Game of 24 and Creative Writingâ€™s main ToT experiments cost around <math alttext="0.74\times 100+0.32\times 100=106" class="ltx_Math" display="inline" id="A2.SS3.p3.1.m1.1"><semantics id="A2.SS3.p3.1.m1.1a"><mrow id="A2.SS3.p3.1.m1.1.1" xref="A2.SS3.p3.1.m1.1.1.cmml"><mrow id="A2.SS3.p3.1.m1.1.1.2" xref="A2.SS3.p3.1.m1.1.1.2.cmml"><mrow id="A2.SS3.p3.1.m1.1.1.2.2" xref="A2.SS3.p3.1.m1.1.1.2.2.cmml"><mn id="A2.SS3.p3.1.m1.1.1.2.2.2" xref="A2.SS3.p3.1.m1.1.1.2.2.2.cmml">0.74</mn><mo id="A2.SS3.p3.1.m1.1.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="A2.SS3.p3.1.m1.1.1.2.2.1.cmml">Ã—</mo><mn id="A2.SS3.p3.1.m1.1.1.2.2.3" xref="A2.SS3.p3.1.m1.1.1.2.2.3.cmml">100</mn></mrow><mo id="A2.SS3.p3.1.m1.1.1.2.1" xref="A2.SS3.p3.1.m1.1.1.2.1.cmml">+</mo><mrow id="A2.SS3.p3.1.m1.1.1.2.3" xref="A2.SS3.p3.1.m1.1.1.2.3.cmml"><mn id="A2.SS3.p3.1.m1.1.1.2.3.2" xref="A2.SS3.p3.1.m1.1.1.2.3.2.cmml">0.32</mn><mo id="A2.SS3.p3.1.m1.1.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="A2.SS3.p3.1.m1.1.1.2.3.1.cmml">Ã—</mo><mn id="A2.SS3.p3.1.m1.1.1.2.3.3" xref="A2.SS3.p3.1.m1.1.1.2.3.3.cmml">100</mn></mrow></mrow><mo id="A2.SS3.p3.1.m1.1.1.1" xref="A2.SS3.p3.1.m1.1.1.1.cmml">=</mo><mn id="A2.SS3.p3.1.m1.1.1.3" xref="A2.SS3.p3.1.m1.1.1.3.cmml">106</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS3.p3.1.m1.1b"><apply id="A2.SS3.p3.1.m1.1.1.cmml" xref="A2.SS3.p3.1.m1.1.1"><eq id="A2.SS3.p3.1.m1.1.1.1.cmml" xref="A2.SS3.p3.1.m1.1.1.1"></eq><apply id="A2.SS3.p3.1.m1.1.1.2.cmml" xref="A2.SS3.p3.1.m1.1.1.2"><plus id="A2.SS3.p3.1.m1.1.1.2.1.cmml" xref="A2.SS3.p3.1.m1.1.1.2.1"></plus><apply id="A2.SS3.p3.1.m1.1.1.2.2.cmml" xref="A2.SS3.p3.1.m1.1.1.2.2"><times id="A2.SS3.p3.1.m1.1.1.2.2.1.cmml" xref="A2.SS3.p3.1.m1.1.1.2.2.1"></times><cn id="A2.SS3.p3.1.m1.1.1.2.2.2.cmml" type="float" xref="A2.SS3.p3.1.m1.1.1.2.2.2">0.74</cn><cn id="A2.SS3.p3.1.m1.1.1.2.2.3.cmml" type="integer" xref="A2.SS3.p3.1.m1.1.1.2.2.3">100</cn></apply><apply id="A2.SS3.p3.1.m1.1.1.2.3.cmml" xref="A2.SS3.p3.1.m1.1.1.2.3"><times id="A2.SS3.p3.1.m1.1.1.2.3.1.cmml" xref="A2.SS3.p3.1.m1.1.1.2.3.1"></times><cn id="A2.SS3.p3.1.m1.1.1.2.3.2.cmml" type="float" xref="A2.SS3.p3.1.m1.1.1.2.3.2">0.32</cn><cn id="A2.SS3.p3.1.m1.1.1.2.3.3.cmml" type="integer" xref="A2.SS3.p3.1.m1.1.1.2.3.3">100</cn></apply></apply><cn id="A2.SS3.p3.1.m1.1.1.3.cmml" type="integer" xref="A2.SS3.p3.1.m1.1.1.3">106</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p3.1.m1.1c">0.74\times 100+0.32\times 100=106</annotation><annotation encoding="application/x-llamapun" id="A2.SS3.p3.1.m1.1d">0.74 Ã— 100 + 0.32 Ã— 100 = 106</annotation></semantics></math> dollars. Crosswordsâ€™ DFS experiments should be also within <math alttext="100" class="ltx_Math" display="inline" id="A2.SS3.p3.2.m2.1"><semantics id="A2.SS3.p3.2.m2.1a"><mn id="A2.SS3.p3.2.m2.1.1" xref="A2.SS3.p3.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.SS3.p3.2.m2.1b"><cn id="A2.SS3.p3.2.m2.1.1.cmml" type="integer" xref="A2.SS3.p3.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p3.2.m2.1c">100</annotation><annotation encoding="application/x-llamapun" id="A2.SS3.p3.2.m2.1d">100</annotation></semantics></math> dollars. In general, cost and efficiency of ToT highly depend on the prompts and search algorithms used, and could require 5-100 times more generated tokens than CoT. Some actionable insights:</p>
<ul class="ltx_itemize" id="A2.I1">
<li class="ltx_item" id="A2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="A2.I1.i1.p1">
<p class="ltx_p" id="A2.I1.i1.p1.1">We recommend using ToT on tasks requiring deliberate reasoning, on which CoT struggles.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="A2.I1.i2.p1">
<p class="ltx_p" id="A2.I1.i2.p1.1">Flexibility of ToT allows some performance-cost tradeoff, e.g., change beam size or vote number in BFS, few-shot vs. zero-shot prompting, GPT-3.5 vs. GPT-4, etc. One could configure the setup based on some resource constraints or performance goal.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="A2.I1.i3.p1">
<p class="ltx_p" id="A2.I1.i3.p1.1">There is much space for improving efficiency, e.g., BFS could early stop when solution is found, or trim down beam size to when some thoughts are â€impossibleâ€.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="A2.I1.i4.p1">
<p class="ltx_p" id="A2.I1.i4.p1.1">We believe that more computation is indeed required in order for the model to achieve stronger intelligence, and this should not become a blocking issue as in the long run, (open-source) LMs will become much cheaper and more efficient. It is also a great direction how to better train/finetune LMs for thought generation and/or evaluation.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Dec  3 22:50:51 2023 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span style="font-size:70%;position:relative; bottom:2.2pt;">A</span>T<span style="position:relative; bottom:-0.4ex;">E</span></span><span class="ltx_font_smallcaps">xml</span><img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
