<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Reflexion: Language Agents with Verbal Reinforcement Learning</title>
<!--Generated on Tue Oct 10 05:20:34 2023 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="https://browse.arxiv.org/latexml/ar5iv_0.7.4.min.css" type="text/css">
<link rel="stylesheet" href="https://browse.arxiv.org/latexml/styles.css" type="text/css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="https://browse.arxiv.org/latexml/addons.js"></script>
<script src="https://browse.arxiv.org/latexml/feedbackOverlay.js"></script>
</head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a href="#S1" title="1 Introduction ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a href="#S2" title="2 Related work ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a href="#S2.SS0.SSS0.Px1" title="Reasoning and decision-making ‣ 2 Related work ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title">Reasoning and decision-making</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a href="#S2.SS0.SSS0.Px2" title="Programming ‣ 2 Related work ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title">Programming</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a href="#S3" title="3 Reflexion: reinforcement via verbal reflection ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Reflexion: reinforcement via verbal reflection</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a href="#S3.SS0.SSS0.Px1" title="Actor ‣ 3 Reflexion: reinforcement via verbal reflection ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title">Actor</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a href="#S3.SS0.SSS0.Px2" title="Evaluator ‣ 3 Reflexion: reinforcement via verbal reflection ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title">Evaluator</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a href="#S3.SS0.SSS0.Px3" title="Self-reflection ‣ 3 Reflexion: reinforcement via verbal reflection ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title">Self-reflection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a href="#S3.SS0.SSS0.Px4" title="Memory ‣ 3 Reflexion: reinforcement via verbal reflection ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title">Memory</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a href="#S3.SS0.SSS0.Px5" title="The Reflexion process ‣ 3 Reflexion: reinforcement via verbal reflection ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title">The Reflexion process</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a href="#S4" title="4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a href="#S4.SS1" title="4.1 Sequential decision making: ALFWorld ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Sequential decision making: ALFWorld</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a href="#S4.SS1.SSS0.Px1" title="Results ‣ 4.1 Sequential decision making: ALFWorld ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title">Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a href="#S4.SS1.SSS0.Px2" title="Analysis ‣ 4.1 Sequential decision making: ALFWorld ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title">Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a href="#S4.SS2" title="4.2 Reasoning: HotpotQA ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Reasoning: HotpotQA</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a href="#S4.SS2.SSS0.Px1" title="Results ‣ 4.2 Reasoning: HotpotQA ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title">Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a href="#S4.SS2.SSS0.Px2" title="Analysis ‣ 4.2 Reasoning: HotpotQA ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title">Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a href="#S4.SS3" title="4.3 Programming ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Programming</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a href="#S4.SS3.SSS0.Px1" title="Results ‣ 4.3 Programming ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title">Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a href="#S4.SS3.SSS0.Px2" title="Analysis ‣ 4.3 Programming ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title">Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a href="#S4.SS3.SSS0.Px3" title="Ablation study ‣ 4.3 Programming ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title">Ablation study</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a href="#S5" title="5 Limitations ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a href="#S6" title="6 Broader impact ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Broader impact</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a href="#S7" title="7 Conclusion ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a href="#S8" title="8 Reproducibility ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Reproducibility</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a href="#A1" title="Appendix A Evaluation with additional models ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Evaluation with additional models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a href="#A2" title="Appendix B Decision-making ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Decision-making</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#A2.SS1" title="B.1 WebShop Limitation ‣ Appendix B Decision-making ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>WebShop Limitation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a href="#A3" title="Appendix C Programming ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Programming</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#A3.SS1" title="C.1 Programming function implementation example (HumanEval Python) ‣ Appendix C Programming ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>Programming function implementation example (HumanEval Python)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#A3.SS2" title="C.2 Reflexion Actor instruction ‣ Appendix C Programming ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>Reflexion Actor instruction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#A3.SS3" title="C.3 Reflexion Self-reflection instruction and example ‣ Appendix C Programming ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.3 </span>Reflexion Self-reflection instruction and example</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#A3.SS4" title="C.4 Reflexion programming no Self-Reflection ablation example ‣ Appendix C Programming ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.4 </span>Reflexion programming <em class="ltx_emph ltx_font_italic">no</em> Self-Reflection ablation example</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#A3.SS5" title="C.5 Reflexion programming no test generation ablation example ‣ Appendix C Programming ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.5 </span>Reflexion programming <em class="ltx_emph ltx_font_italic">no</em> test generation ablation example</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a href="#A4" title="Appendix D Reasoning ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Reasoning</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#A4.SS1" title="D.1 Full example ‣ Appendix D Reasoning ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1 </span>Full example</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#A4.SS2" title="D.2 Chain-of-Thought + Reflexion ‣ Appendix D Reasoning ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.2 </span>Chain-of-Thought + Reflexion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#A4.SS3" title="D.3 HotPotQA Chain-of-Thought (GT) + Reflexion ‣ Appendix D Reasoning ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3 </span>HotPotQA Chain-of-Thought (GT) + Reflexion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a href="#A4.SS4" title="D.4 HotPotQA episodic memory (EPM) ablation prompts ‣ Appendix D Reasoning ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.4 </span>HotPotQA episodic memory (EPM) ablation prompts</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a href="#A4.SS4.SSS1" title="D.4.1 (EPM) Chain-of-Thought + Reflexion ‣ D.4 HotPotQA episodic memory (EPM) ablation prompts ‣ Appendix D Reasoning ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.4.1 </span>(EPM) Chain-of-Thought + Reflexion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a href="#A4.SS4.SSS2" title="D.4.2 (EPM) Chain-of-Thought (GT) + Reflexion ‣ D.4 HotPotQA episodic memory (EPM) ablation prompts ‣ Appendix D Reasoning ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.4.2 </span>(EPM) Chain-of-Thought (GT) + Reflexion</span></a></li>
</ol>
</li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Reflexion: Language Agents with 
<br class="ltx_break">Verbal Reinforcement Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Noah Shinn 
<br class="ltx_break">Northeastern University 
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">noahshinn024@gmail.com</span> 
<br class="ltx_break">Federico Cassano 
<br class="ltx_break">Northeastern University 
<br class="ltx_break"><span id="id2.2.id2" class="ltx_text ltx_font_typewriter">cassano.f@northeastern.edu</span> 
<br class="ltx_break">Edward Berman 
<br class="ltx_break">Northeastern University 
<br class="ltx_break"><span id="id3.3.id3" class="ltx_text ltx_font_typewriter">berman.ed@northeastern.edu</span> 
<br class="ltx_break">Ashwin Gopinath 
<br class="ltx_break">Massachusetts Institute of Technology 
<br class="ltx_break"><span id="id4.4.id4" class="ltx_text ltx_font_typewriter">agopi@mit.edu</span> 
<br class="ltx_break">Karthik Narasimhan
<br class="ltx_break">Princeton University 
<br class="ltx_break"><span id="id5.5.id5" class="ltx_text ltx_font_typewriter">karthikn@princeton.edu</span> 
<br class="ltx_break">Shunyu Yao 
<br class="ltx_break">Princeton University 
<br class="ltx_break"><span id="id6.6.id6" class="ltx_text ltx_font_typewriter">shunyuy@princeton.edu</span> 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id7.id1" class="ltx_p">Large language models (LLMs) have been increasingly used to interact with external
environments (e.g., games, compilers, APIs) as goal-driven agents. However, it
remains challenging for these language agents to quickly and efficiently learn from
trial-and-error as traditional reinforcement learning methods require extensive
training samples and expensive model fine-tuning. We propose <em id="id7.id1.1" class="ltx_emph ltx_font_italic">Reflexion</em>, a
novel framework to reinforce language agents not by updating weights, but instead
through linguistic feedback. Concretely, Reflexion agents verbally reflect on
task feedback signals, then maintain their own reflective text in an episodic
memory buffer to induce better decision-making in subsequent trials. Reflexion is
flexible enough to incorporate various types (scalar values or free-form
language) and sources (external or internally simulated) of feedback signals,
and obtains significant improvements over a baseline agent across diverse tasks
(sequential decision-making, coding, language reasoning). For example, Reflexion
achieves a 91% pass@1 accuracy on the HumanEval coding benchmark, surpassing
the previous state-of-the-art GPT-4 that achieves 80%. We also conduct ablation
and analysis studies using different feedback signals, feedback incorporation
methods, and agent types, and provide insights into how they affect performance.
We release all code, demos, and datasets at <a href="https://github.com/noahshinn024/reflexion" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/noahshinn024/reflexion</a>.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Recent works such as ReAct <cite class="ltx_cite ltx_citemacro_cite">Yao et al., (<a href="#bib.bib30" title="" class="ltx_ref">2023</a>)</cite>, SayCan <cite class="ltx_cite ltx_citemacro_cite">Ahn et al., (<a href="#bib.bib1" title="" class="ltx_ref">2022</a>)</cite>,
Toolformer <cite class="ltx_cite ltx_citemacro_cite">Schick et al., (<a href="#bib.bib22" title="" class="ltx_ref">2023</a>)</cite>, HuggingGPT <cite class="ltx_cite ltx_citemacro_citep">(Shen et al.,, <a href="#bib.bib23" title="" class="ltx_ref">2023</a>)</cite>,
generative agents <cite class="ltx_cite ltx_citemacro_citep">(Park et al.,, <a href="#bib.bib19" title="" class="ltx_ref">2023</a>)</cite>, and WebGPT <cite class="ltx_cite ltx_citemacro_citep">(Nakano et al.,, <a href="#bib.bib17" title="" class="ltx_ref">2021</a>)</cite>
have demonstrated the feasibility of
autonomous decision-making agents that are built on top of a large language
model (LLM) core. These methods use LLMs to generate text and ‘actions‘
that can be used in API calls and executed in an environment. Since they
rely on massive models with an enormous number of parameters, such approaches
have been so far limited to using in-context examples as a way of teaching
the agents, since more traditional optimization schemes like reinforcement
learning with gradient descent require substantial amounts of compute and
time.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In this paper, we propose an alternative approach called <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">Reflexion</span> that uses verbal reinforcement to help agents learn from prior failings. Reflexion converts binary or scalar feedback from the environment into verbal feedback in the form of a textual summary, which is then added as additional context for the LLM agent in the next episode. This self-reflective feedback acts as a ‘semantic’ gradient signal by providing the agent with a concrete direction to improve upon, helping it learn from prior mistakes to perform better on the task. This is akin to how humans iteratively learn to accomplish complex tasks in a few-shot manner – by reflecting on their previous failures in order to form an improved plan of attack for the next attempt. For example, in figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, a Reflexion agent learns to
optimize its own behavior to solve decision-making, programming, and reasoning tasks through
trial, error, and self-reflection.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Generating useful reflective feedback is challenging since it requires a good understanding of where the model made mistakes (i.e. the credit assignment problem <cite class="ltx_cite ltx_citemacro_citep">(Sutton and Barto,, <a href="#bib.bib25" title="" class="ltx_ref">2018</a>)</cite>) as well as the ability to generate a summary containing actionable insights for improvement. We explore three ways for
doing this – simple binary environment feedback, pre-defined heuristics for common failure
cases, and self-evaluation such as binary classification using LLMs (decision-making) or
self-written unit tests (programming). In all implementations, the evaluation signal is
amplified to natural language experience summaries which can be stored in long-term memory.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Reflexion has several advantages compared to more traditional RL approaches like policy or value-based learning: 1) it is lightweight and doesn’t require finetuning the LLM, 2) it allows for more nuanced forms of feedback (e.g. targeted changes in actions), compared to scalar or vector rewards that are challenging to perform accurate credit assignment with, 3) it allows for a more explicit and interpretable form of episodic memory over prior experiences, and 4) it provides more explicit hints for actions in future episodes. At the same time, it does have the disadvantages of relying on the power of the LLM’s self-evaluation capabilities (or heuristics) and not having a formal guarantee for success. However, as LLM capabilities improve, we only expect this paradigm to get better over time.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We perform experiments on (1) decision-making tasks to test sequential action choices over long
trajectories, (2) reasoning tasks to test knowledge-intensive, single-step generation
improvement, and (3) programming tasks to teach the agent to effectively use external
tools such as compilers and interpreters. Across all three types of tasks, we observe
Reflexion agents are better decision-makers, reasoners, and programmers. More concretely,
Reflexion agents improve on decision-making AlfWorld <cite class="ltx_cite ltx_citemacro_citep">(Shridhar et al.,, <a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite> tasks over strong baseline approaches by
an absolute 22% in 12 iterative learning steps, and
on reasoning questions in HotPotQA <cite class="ltx_cite ltx_citemacro_citep">(Yang et al.,, <a href="#bib.bib28" title="" class="ltx_ref">2018</a>)</cite> by 20%, and Python programming
tasks on HumanEval <cite class="ltx_cite ltx_citemacro_citep">(Chen et al.,, <a href="#bib.bib6" title="" class="ltx_ref">2021</a>)</cite> by as much as 11%.
</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">To summarize, our contributions are the following:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose Reflexion, a new paradigm for ‘verbal‘ reinforcement that parameterizes a policy as an
agent’s memory encoding paired with a choice of LLM parameters.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We explore this emergent property of <em id="S1.I1.i2.p1.1.1" class="ltx_emph ltx_font_italic">self-reflection</em> in LLMs and empirically
show that self-reflection is extremely useful to learn complex tasks over a handful of trials.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We introduce LeetcodeHardGym, a code-generation RL gym environment consisting
of 40 challenging Leetcode questions (‘hard-level‘) in 19 programming languages.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">We show that Reflexion achieves improvements over strong baselines across several tasks, and achieves state-of-the-art results on various code generation benchmarks.</p>
</div>
</li>
</ul>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="830" height="311" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">Reflexion works on decision-making <a href="#S4.SS1" title="4.1 Sequential decision making: ALFWorld ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>,
programming <a href="#S4.SS3" title="4.3 Programming ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>, and reasoning <a href="#S4.SS2" title="4.2 Reasoning: HotpotQA ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a> tasks.</span></figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Reasoning and decision-making</h5>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p1.1" class="ltx_p">Self-Refine <cite class="ltx_cite ltx_citemacro_citep">(Madaan et al.,, <a href="#bib.bib15" title="" class="ltx_ref">2023</a>)</cite> employs an iterative framework for
self-refinement to autonomously improve generation through self-evaluation.
These self-evaluation and self-improvement steps are conditioned on
given task constraints, such as "How can this generation be written
in a more positive way". Self-Refine is effective
but is limited to single-generation reasoning tasks. <cite class="ltx_cite ltx_citemacro_citet">Pryzant et al., (<a href="#bib.bib21" title="" class="ltx_ref">2023</a>)</cite>
performs a similar semantic prompt-writing optimization, but is
also limited to single-generation tasks.
<cite class="ltx_cite ltx_citemacro_citet">Paul et al., (<a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite> fine-tune critic models to provide intermediate
feedback within trajectories to improve reasoning responses.
<cite class="ltx_cite ltx_citemacro_citet">Xie et al., (<a href="#bib.bib27" title="" class="ltx_ref">2023</a>)</cite> use stochastic beam search over actions to
perform a more efficient decision-making search strategy which allows
the agent to use foresight advantage due to its self-evaluation component.
<cite class="ltx_cite ltx_citemacro_citet">Yoran et al., (<a href="#bib.bib31" title="" class="ltx_ref">2023</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Nair et al., (<a href="#bib.bib16" title="" class="ltx_ref">2023</a>)</cite> use decider models
to reason over several generations. <cite class="ltx_cite ltx_citemacro_citet">Kim et al., (<a href="#bib.bib10" title="" class="ltx_ref">2023</a>)</cite> use a
retry pattern over a fixed number of steps without an evaluation step.
<cite class="ltx_cite ltx_citemacro_citet">Goodman, (<a href="#bib.bib9" title="" class="ltx_ref">2023</a>)</cite> perform a qualitative evaluation step that
proposes optimizations to the previous generation. In this paper, we show that several
of these concepts can be enhanced with <em id="S2.SS0.SSS0.Px1.p1.1.1" class="ltx_emph ltx_font_italic">self-reflection</em> to
build a persisting memory of self-reflective experiences which allows
an agent to identify its own errors and self-suggest lessons to learn
from its mistakes over time.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Programming</h5>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">Several past and recent works employ variations of test-driven development
or code debugging practices. AlphaCode <cite class="ltx_cite ltx_citemacro_citep">(Li et al.,, <a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite>
evaluates a set of generations on hidden test cases. CodeT <cite class="ltx_cite ltx_citemacro_citep">(Chen et al.,, <a href="#bib.bib5" title="" class="ltx_ref">2022</a>)</cite>
uses self-generated unit tests that are used to score generated function
implementations.
Self-Debugging <cite class="ltx_cite ltx_citemacro_citep">(Chen et al.,, <a href="#bib.bib7" title="" class="ltx_ref">2023</a>)</cite> employs a debugging component that is used
to improve existing implementations given feedback from a code
execution environment. CodeRL <cite class="ltx_cite ltx_citemacro_citep">(Le et al.,, <a href="#bib.bib12" title="" class="ltx_ref">2022</a>)</cite> sets the problem
in an RL framework using an actor-critic setup to debug programs given
feedback from an execution environment. AlphaCode, Self-Debugging and CodeRL
are effective in fixing less-complex program bugs, but they rely
upon ground truth test cases that invalidate pass@1 eligibility,
and do not use self-reflection to bridge the gap between error
identification and implementation improvement. CodeT does not access
hidden test cases but does not implement a self-learning step to
improve code writing.</p>
</div>
<figure id="S2.SS0.SSS0.Px2.tab1" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">

<div class="ltx_flex_cell 
                  ltx_flex_size_1">
<table id="S2.SS0.SSS0.Px2.tab1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_flex_size_1 ltx_align_middle">
<thead class="ltx_thead">
<tr id="S2.SS0.SSS0.Px2.tab1.1.1.1" class="ltx_tr">
<th id="S2.SS0.SSS0.Px2.tab1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="6"><span id="S2.SS0.SSS0.Px2.tab1.1.1.1.1.1" class="ltx_text" style="font-size:90%;">Related work on reasoning and decision-making</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S2.SS0.SSS0.Px2.tab1.1.2.1" class="ltx_tr">
<th id="S2.SS0.SSS0.Px2.tab1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="S2.SS0.SSS0.Px2.tab1.1.2.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Approach</span></th>
<td id="S2.SS0.SSS0.Px2.tab1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.SS0.SSS0.Px2.tab1.1.2.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Self</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.SS0.SSS0.Px2.tab1.1.2.1.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Hidden</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.SS0.SSS0.Px2.tab1.1.2.1.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Decision</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.SS0.SSS0.Px2.tab1.1.2.1.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Binary</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.SS0.SSS0.Px2.tab1.1.2.1.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Memory</span></td>
</tr>
<tr id="S2.SS0.SSS0.Px2.tab1.1.3.2" class="ltx_tr">
<th id="S2.SS0.SSS0.Px2.tab1.1.3.2.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S2.SS0.SSS0.Px2.tab1.1.3.2.2" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.1.3.2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">refine</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.3.2.3" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.1.3.2.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">constraints</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.3.2.4" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.1.3.2.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">making</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.3.2.5" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.1.3.2.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">reward</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.3.2.6" class="ltx_td"></td>
</tr>
<tr id="S2.SS0.SSS0.Px2.tab1.1.4.3" class="ltx_tr">
<th id="S2.SS0.SSS0.Px2.tab1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">
<span id="S2.SS0.SSS0.Px2.tab1.1.4.3.1.1" class="ltx_text" style="font-size:90%;">Self-refine </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S2.SS0.SSS0.Px2.tab1.1.4.3.1.2.1" class="ltx_text" style="font-size:90%;">(</span>Madaan et al.,<span id="S2.SS0.SSS0.Px2.tab1.1.4.3.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib15" title="" class="ltx_ref">2023</a><span id="S2.SS0.SSS0.Px2.tab1.1.4.3.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite>
</th>
<td id="S2.SS0.SSS0.Px2.tab1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.1.4.3.2.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.1.4.3.3.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.1.4.3.4.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.1.4.3.5.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.4.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.1.4.3.6.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
</tr>
<tr id="S2.SS0.SSS0.Px2.tab1.1.5.4" class="ltx_tr">
<th id="S2.SS0.SSS0.Px2.tab1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S2.SS0.SSS0.Px2.tab1.1.5.4.1.1" class="ltx_text" style="font-size:90%;">Beam search </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S2.SS0.SSS0.Px2.tab1.1.5.4.1.2.1" class="ltx_text" style="font-size:90%;">(</span>Xie et al.,<span id="S2.SS0.SSS0.Px2.tab1.1.5.4.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib27" title="" class="ltx_ref">2023</a><span id="S2.SS0.SSS0.Px2.tab1.1.5.4.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite>
</th>
<td id="S2.SS0.SSS0.Px2.tab1.1.5.4.2" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.1.5.4.2.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.5.4.3" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.1.5.4.3.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.5.4.4" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.1.5.4.4.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.5.4.5" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.1.5.4.5.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.5.4.6" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.1.5.4.6.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
</tr>
<tr id="S2.SS0.SSS0.Px2.tab1.1.6.5" class="ltx_tr">
<th id="S2.SS0.SSS0.Px2.tab1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S2.SS0.SSS0.Px2.tab1.1.6.5.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Reflexion (ours)</span></th>
<td id="S2.SS0.SSS0.Px2.tab1.1.6.5.2" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.1.6.5.2.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.6.5.3" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.1.6.5.3.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.6.5.4" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.1.6.5.4.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.6.5.5" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.1.6.5.5.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.1.6.5.6" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.1.6.5.6.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_1">
<table id="S2.SS0.SSS0.Px2.tab1.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_flex_size_1 ltx_align_middle">
<thead class="ltx_thead">
<tr id="S2.SS0.SSS0.Px2.tab1.2.1.1" class="ltx_tr">
<th id="S2.SS0.SSS0.Px2.tab1.2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="6"><span id="S2.SS0.SSS0.Px2.tab1.2.1.1.1.1" class="ltx_text" style="font-size:90%;">Related work on programming</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S2.SS0.SSS0.Px2.tab1.2.2.1" class="ltx_tr">
<th id="S2.SS0.SSS0.Px2.tab1.2.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.2.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Approach</span></th>
<td id="S2.SS0.SSS0.Px2.tab1.2.2.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.2.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Test</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.2.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.2.1.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Debugging</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.2.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.2.1.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Self-generated</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.2.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.2.1.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Multiple</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.2.1.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.2.1.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Self-reflection</span></td>
</tr>
<tr id="S2.SS0.SSS0.Px2.tab1.2.3.2" class="ltx_tr">
<th id="S2.SS0.SSS0.Px2.tab1.2.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S2.SS0.SSS0.Px2.tab1.2.3.2.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Test execution</span></th>
<td id="S2.SS0.SSS0.Px2.tab1.2.3.2.2" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.2.3.2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">execution</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.3.2.3" class="ltx_td"></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.3.2.4" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.2.3.2.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">tests</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.3.2.5" class="ltx_td ltx_align_center"><span id="S2.SS0.SSS0.Px2.tab1.2.3.2.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">languages</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.3.2.6" class="ltx_td"></td>
</tr>
<tr id="S2.SS0.SSS0.Px2.tab1.2.4.3" class="ltx_tr">
<th id="S2.SS0.SSS0.Px2.tab1.2.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">
<span id="S2.SS0.SSS0.Px2.tab1.2.4.3.1.1" class="ltx_text" style="font-size:90%;">AlphaCode </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S2.SS0.SSS0.Px2.tab1.2.4.3.1.2.1" class="ltx_text" style="font-size:90%;">(</span>Li et al.,<span id="S2.SS0.SSS0.Px2.tab1.2.4.3.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib14" title="" class="ltx_ref">2022</a><span id="S2.SS0.SSS0.Px2.tab1.2.4.3.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite>
</th>
<td id="S2.SS0.SSS0.Px2.tab1.2.4.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.4.3.2.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.4.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.4.3.3.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.4.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.4.3.4.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.4.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.4.3.5.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.4.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.4.3.6.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
</tr>
<tr id="S2.SS0.SSS0.Px2.tab1.2.5.4" class="ltx_tr">
<th id="S2.SS0.SSS0.Px2.tab1.2.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">
<span id="S2.SS0.SSS0.Px2.tab1.2.5.4.1.1" class="ltx_text" style="font-size:90%;">CodeT </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S2.SS0.SSS0.Px2.tab1.2.5.4.1.2.1" class="ltx_text" style="font-size:90%;">(</span>Chen et al.,<span id="S2.SS0.SSS0.Px2.tab1.2.5.4.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib5" title="" class="ltx_ref">2022</a><span id="S2.SS0.SSS0.Px2.tab1.2.5.4.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite>
</th>
<td id="S2.SS0.SSS0.Px2.tab1.2.5.4.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.5.4.2.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.5.4.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.5.4.3.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.5.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.5.4.4.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.5.4.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.5.4.5.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.5.4.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.5.4.6.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
</tr>
<tr id="S2.SS0.SSS0.Px2.tab1.2.6.5" class="ltx_tr">
<th id="S2.SS0.SSS0.Px2.tab1.2.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">
<span id="S2.SS0.SSS0.Px2.tab1.2.6.5.1.1" class="ltx_text" style="font-size:90%;">Self-debugging </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S2.SS0.SSS0.Px2.tab1.2.6.5.1.2.1" class="ltx_text" style="font-size:90%;">(</span>Chen et al.,<span id="S2.SS0.SSS0.Px2.tab1.2.6.5.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib7" title="" class="ltx_ref">2023</a><span id="S2.SS0.SSS0.Px2.tab1.2.6.5.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite>
</th>
<td id="S2.SS0.SSS0.Px2.tab1.2.6.5.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.6.5.2.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.6.5.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.6.5.3.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.6.5.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.6.5.4.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.6.5.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.6.5.5.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.6.5.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.6.5.6.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
</tr>
<tr id="S2.SS0.SSS0.Px2.tab1.2.7.6" class="ltx_tr">
<th id="S2.SS0.SSS0.Px2.tab1.2.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">
<span id="S2.SS0.SSS0.Px2.tab1.2.7.6.1.1" class="ltx_text" style="font-size:90%;">CodeRL </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S2.SS0.SSS0.Px2.tab1.2.7.6.1.2.1" class="ltx_text" style="font-size:90%;">(</span>Le et al.,<span id="S2.SS0.SSS0.Px2.tab1.2.7.6.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib12" title="" class="ltx_ref">2022</a><span id="S2.SS0.SSS0.Px2.tab1.2.7.6.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite>
</th>
<td id="S2.SS0.SSS0.Px2.tab1.2.7.6.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.7.6.2.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.7.6.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.7.6.3.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.7.6.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.7.6.4.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.7.6.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.7.6.5.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.7.6.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.7.6.6.1" class="ltx_text" style="font-size:90%;color:#EB1E1E;">✗</span></td>
</tr>
<tr id="S2.SS0.SSS0.Px2.tab1.2.8.7" class="ltx_tr">
<th id="S2.SS0.SSS0.Px2.tab1.2.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.8.7.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Reflexion (ours)</span></th>
<td id="S2.SS0.SSS0.Px2.tab1.2.8.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.8.7.2.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.8.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.8.7.3.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.8.7.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.8.7.4.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.8.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.8.7.5.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
<td id="S2.SS0.SSS0.Px2.tab1.2.8.7.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S2.SS0.SSS0.Px2.tab1.2.8.7.6.1" class="ltx_text" style="font-size:90%;color:#24D624;">✓</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Reflexion: reinforcement via verbal reflection</h2>

<figure id="S3.F2" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="S3.F2.1" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_middle" style="width:208.1pt;">
<span id="S3.F2.1.p1" class="ltx_para ltx_align_center"><img src="x2.png" id="S3.F2.1.p1.g1" class="ltx_graphics ltx_img_square" width="829" height="721" alt="Refer to caption">
</span></span></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2">
<figure id="alg1" class="ltx_float ltx_minipage ltx_flex_size_2 ltx_align_middle ltx_framed_top" style="width:208.1pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Reinforcement via self-reflection</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">Initialize Actor, Evaluator, Self-Reflection:

</div>
<div id="alg1.l2" class="ltx_listingline">
<math id="alg1.l2.m1.1" class="ltx_Math" alttext="M_{a}" display="inline"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">M</mi><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑀</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">M_{a}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_M start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="alg1.l2.m2.1" class="ltx_Math" alttext="M_{e}" display="inline"><semantics id="alg1.l2.m2.1a"><msub id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml">M</mi><mi id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1">subscript</csymbol><ci id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2">𝑀</ci><ci id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">M_{e}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.1d">italic_M start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="alg1.l2.m3.1" class="ltx_Math" alttext="M_{sr}" display="inline"><semantics id="alg1.l2.m3.1a"><msub id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml"><mi id="alg1.l2.m3.1.1.2" xref="alg1.l2.m3.1.1.2.cmml">M</mi><mrow id="alg1.l2.m3.1.1.3" xref="alg1.l2.m3.1.1.3.cmml"><mi id="alg1.l2.m3.1.1.3.2" xref="alg1.l2.m3.1.1.3.2.cmml">s</mi><mo id="alg1.l2.m3.1.1.3.1" xref="alg1.l2.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m3.1.1.3.3" xref="alg1.l2.m3.1.1.3.3.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><apply id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.1.cmml" xref="alg1.l2.m3.1.1">subscript</csymbol><ci id="alg1.l2.m3.1.1.2.cmml" xref="alg1.l2.m3.1.1.2">𝑀</ci><apply id="alg1.l2.m3.1.1.3.cmml" xref="alg1.l2.m3.1.1.3"><times id="alg1.l2.m3.1.1.3.1.cmml" xref="alg1.l2.m3.1.1.3.1"></times><ci id="alg1.l2.m3.1.1.3.2.cmml" xref="alg1.l2.m3.1.1.3.2">𝑠</ci><ci id="alg1.l2.m3.1.1.3.3.cmml" xref="alg1.l2.m3.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">M_{sr}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m3.1d">italic_M start_POSTSUBSCRIPT italic_s italic_r end_POSTSUBSCRIPT</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">Initialize policy <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\pi_{\theta}(a_{i}|s_{i})" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><msub id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><mi id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml">π</mi><mi id="alg1.l3.m1.1.1.3.3" xref="alg1.l3.m1.1.1.3.3.cmml">θ</mi></msub><mo id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">⁢</mo><mrow id="alg1.l3.m1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l3.m1.1.1.1.1.2" xref="alg1.l3.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l3.m1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.cmml"><msub id="alg1.l3.m1.1.1.1.1.1.2" xref="alg1.l3.m1.1.1.1.1.1.2.cmml"><mi id="alg1.l3.m1.1.1.1.1.1.2.2" xref="alg1.l3.m1.1.1.1.1.1.2.2.cmml">a</mi><mi id="alg1.l3.m1.1.1.1.1.1.2.3" xref="alg1.l3.m1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="alg1.l3.m1.1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.1.cmml">|</mo><msub id="alg1.l3.m1.1.1.1.1.1.3" xref="alg1.l3.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l3.m1.1.1.1.1.1.3.2" xref="alg1.l3.m1.1.1.1.1.1.3.2.cmml">s</mi><mi id="alg1.l3.m1.1.1.1.1.1.3.3" xref="alg1.l3.m1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="alg1.l3.m1.1.1.1.1.3" xref="alg1.l3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><times id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2"></times><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3">subscript</csymbol><ci id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2">𝜋</ci><ci id="alg1.l3.m1.1.1.3.3.cmml" xref="alg1.l3.m1.1.1.3.3">𝜃</ci></apply><apply id="alg1.l3.m1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1"><csymbol cd="latexml" id="alg1.l3.m1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1.1">conditional</csymbol><apply id="alg1.l3.m1.1.1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l3.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.1.1.1.2.2">𝑎</ci><ci id="alg1.l3.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l3.m1.1.1.1.1.1.3.cmml" xref="alg1.l3.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l3.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.1.1.1.3.2">𝑠</ci><ci id="alg1.l3.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l3.m1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\pi_{\theta}(a_{i}|s_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, <math id="alg1.l3.m2.2" class="ltx_Math" alttext="\theta=\{M_{a},mem\}" display="inline"><semantics id="alg1.l3.m2.2a"><mrow id="alg1.l3.m2.2.2" xref="alg1.l3.m2.2.2.cmml"><mi id="alg1.l3.m2.2.2.4" xref="alg1.l3.m2.2.2.4.cmml">θ</mi><mo id="alg1.l3.m2.2.2.3" xref="alg1.l3.m2.2.2.3.cmml">=</mo><mrow id="alg1.l3.m2.2.2.2.2" xref="alg1.l3.m2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l3.m2.2.2.2.2.3" xref="alg1.l3.m2.2.2.2.3.cmml">{</mo><msub id="alg1.l3.m2.1.1.1.1.1" xref="alg1.l3.m2.1.1.1.1.1.cmml"><mi id="alg1.l3.m2.1.1.1.1.1.2" xref="alg1.l3.m2.1.1.1.1.1.2.cmml">M</mi><mi id="alg1.l3.m2.1.1.1.1.1.3" xref="alg1.l3.m2.1.1.1.1.1.3.cmml">a</mi></msub><mo id="alg1.l3.m2.2.2.2.2.4" xref="alg1.l3.m2.2.2.2.3.cmml">,</mo><mrow id="alg1.l3.m2.2.2.2.2.2" xref="alg1.l3.m2.2.2.2.2.2.cmml"><mi id="alg1.l3.m2.2.2.2.2.2.2" xref="alg1.l3.m2.2.2.2.2.2.2.cmml">m</mi><mo id="alg1.l3.m2.2.2.2.2.2.1" xref="alg1.l3.m2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l3.m2.2.2.2.2.2.3" xref="alg1.l3.m2.2.2.2.2.2.3.cmml">e</mi><mo id="alg1.l3.m2.2.2.2.2.2.1a" xref="alg1.l3.m2.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l3.m2.2.2.2.2.2.4" xref="alg1.l3.m2.2.2.2.2.2.4.cmml">m</mi></mrow><mo stretchy="false" id="alg1.l3.m2.2.2.2.2.5" xref="alg1.l3.m2.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.2b"><apply id="alg1.l3.m2.2.2.cmml" xref="alg1.l3.m2.2.2"><eq id="alg1.l3.m2.2.2.3.cmml" xref="alg1.l3.m2.2.2.3"></eq><ci id="alg1.l3.m2.2.2.4.cmml" xref="alg1.l3.m2.2.2.4">𝜃</ci><set id="alg1.l3.m2.2.2.2.3.cmml" xref="alg1.l3.m2.2.2.2.2"><apply id="alg1.l3.m2.1.1.1.1.1.cmml" xref="alg1.l3.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.1.1.1.1.cmml" xref="alg1.l3.m2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l3.m2.1.1.1.1.1.2.cmml" xref="alg1.l3.m2.1.1.1.1.1.2">𝑀</ci><ci id="alg1.l3.m2.1.1.1.1.1.3.cmml" xref="alg1.l3.m2.1.1.1.1.1.3">𝑎</ci></apply><apply id="alg1.l3.m2.2.2.2.2.2.cmml" xref="alg1.l3.m2.2.2.2.2.2"><times id="alg1.l3.m2.2.2.2.2.2.1.cmml" xref="alg1.l3.m2.2.2.2.2.2.1"></times><ci id="alg1.l3.m2.2.2.2.2.2.2.cmml" xref="alg1.l3.m2.2.2.2.2.2.2">𝑚</ci><ci id="alg1.l3.m2.2.2.2.2.2.3.cmml" xref="alg1.l3.m2.2.2.2.2.2.3">𝑒</ci><ci id="alg1.l3.m2.2.2.2.2.2.4.cmml" xref="alg1.l3.m2.2.2.2.2.2.4">𝑚</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.2c">\theta=\{M_{a},mem\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.2d">italic_θ = { italic_M start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_m italic_e italic_m }</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">Generate initial trajectory using <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="alg1.l4.m1.1a"><msub id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">π</mi><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝜋</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">Evaluate <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\tau_{0}" display="inline"><semantics id="alg1.l5.m1.1a"><msub id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">τ</mi><mn id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝜏</ci><cn type="integer" id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\tau_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_τ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> using <math id="alg1.l5.m2.1" class="ltx_Math" alttext="M_{e}" display="inline"><semantics id="alg1.l5.m2.1a"><msub id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mi id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">M</mi><mi id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1">subscript</csymbol><ci id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">𝑀</ci><ci id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">M_{e}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m2.1d">italic_M start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">Generate initial self-reflection <math id="alg1.l6.m1.1" class="ltx_Math" alttext="sr_{0}" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">s</mi><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">⁢</mo><msub id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.3.2.cmml">r</mi><mn id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><times id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"></times><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑠</ci><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2">𝑟</ci><cn type="integer" id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">sr_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_s italic_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> using <math id="alg1.l6.m2.1" class="ltx_Math" alttext="M_{sr}" display="inline"><semantics id="alg1.l6.m2.1a"><msub id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2.cmml">M</mi><mrow id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml"><mi id="alg1.l6.m2.1.1.3.2" xref="alg1.l6.m2.1.1.3.2.cmml">s</mi><mo id="alg1.l6.m2.1.1.3.1" xref="alg1.l6.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.l6.m2.1.1.3.3" xref="alg1.l6.m2.1.1.3.3.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1">subscript</csymbol><ci id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">𝑀</ci><apply id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3"><times id="alg1.l6.m2.1.1.3.1.cmml" xref="alg1.l6.m2.1.1.3.1"></times><ci id="alg1.l6.m2.1.1.3.2.cmml" xref="alg1.l6.m2.1.1.3.2">𝑠</ci><ci id="alg1.l6.m2.1.1.3.3.cmml" xref="alg1.l6.m2.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">M_{sr}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m2.1d">italic_M start_POSTSUBSCRIPT italic_s italic_r end_POSTSUBSCRIPT</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">Set <math id="alg1.l7.m1.1" class="ltx_Math" alttext="mem\leftarrow[sr_{0}]" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mrow id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml">m</mi><mo id="alg1.l7.m1.1.1.3.1" xref="alg1.l7.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">e</mi><mo id="alg1.l7.m1.1.1.3.1a" xref="alg1.l7.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.3.4" xref="alg1.l7.m1.1.1.3.4.cmml">m</mi></mrow><mo stretchy="false" id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">←</mo><mrow id="alg1.l7.m1.1.1.1.1" xref="alg1.l7.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.2.cmml">s</mi><mo id="alg1.l7.m1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">⁢</mo><msub id="alg1.l7.m1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.3.2" xref="alg1.l7.m1.1.1.1.1.1.3.2.cmml">r</mi><mn id="alg1.l7.m1.1.1.1.1.1.3.3" xref="alg1.l7.m1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">←</ci><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><times id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3.1"></times><ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">𝑚</ci><ci id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">𝑒</ci><ci id="alg1.l7.m1.1.1.3.4.cmml" xref="alg1.l7.m1.1.1.3.4">𝑚</ci></apply><apply id="alg1.l7.m1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1"><csymbol cd="latexml" id="alg1.l7.m1.1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l7.m1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1"><times id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1"></times><ci id="alg1.l7.m1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.2">𝑠</ci><apply id="alg1.l7.m1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.3.2">𝑟</ci><cn type="integer" id="alg1.l7.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.3.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">mem\leftarrow[sr_{0}]</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_m italic_e italic_m ← [ italic_s italic_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ]</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">Set <math id="alg1.l8.m1.1" class="ltx_Math" alttext="t=0" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">t</mi><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">=</mo><mn id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><eq id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></eq><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">t=0</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_t = 0</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span id="alg1.l9.1" class="ltx_text ltx_font_bold">while</span> <math id="alg1.l9.m1.1" class="ltx_Math" alttext="M_{e}" display="inline"><semantics id="alg1.l9.m1.1a"><msub id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">M</mi><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝑀</ci><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">M_{e}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_M start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> not pass or <math id="alg1.l9.m2.1" class="ltx_Math" alttext="t&lt;" display="inline"><semantics id="alg1.l9.m2.1a"><mrow id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi id="alg1.l9.m2.1.1.2" xref="alg1.l9.m2.1.1.2.cmml">t</mi><mo id="alg1.l9.m2.1.1.1" xref="alg1.l9.m2.1.1.1.cmml">&lt;</mo><mi id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><lt id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1.1"></lt><ci id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1.2">𝑡</ci><csymbol cd="latexml" id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">t&lt;</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m2.1d">italic_t &lt;</annotation></semantics></math> max trials <span id="alg1.l9.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l10" class="ltx_listingline">     Generate <math id="alg1.l10.m1.4" class="ltx_Math" alttext="\tau_{t}={[a_{0},o_{0},\dots a_{i},o_{i}]}" display="inline"><semantics id="alg1.l10.m1.4a"><mrow id="alg1.l10.m1.4.4" xref="alg1.l10.m1.4.4.cmml"><msub id="alg1.l10.m1.4.4.6" xref="alg1.l10.m1.4.4.6.cmml"><mi id="alg1.l10.m1.4.4.6.2" xref="alg1.l10.m1.4.4.6.2.cmml">τ</mi><mi id="alg1.l10.m1.4.4.6.3" xref="alg1.l10.m1.4.4.6.3.cmml">t</mi></msub><mo id="alg1.l10.m1.4.4.5" xref="alg1.l10.m1.4.4.5.cmml">=</mo><mrow id="alg1.l10.m1.4.4.4.4" xref="alg1.l10.m1.4.4.4.5.cmml"><mo stretchy="false" id="alg1.l10.m1.4.4.4.4.5" xref="alg1.l10.m1.4.4.4.5.cmml">[</mo><msub id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.2.cmml">a</mi><mn id="alg1.l10.m1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="alg1.l10.m1.4.4.4.4.6" xref="alg1.l10.m1.4.4.4.5.cmml">,</mo><msub id="alg1.l10.m1.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.cmml"><mi id="alg1.l10.m1.2.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.2.cmml">o</mi><mn id="alg1.l10.m1.2.2.2.2.2.3" xref="alg1.l10.m1.2.2.2.2.2.3.cmml">0</mn></msub><mo id="alg1.l10.m1.4.4.4.4.7" xref="alg1.l10.m1.4.4.4.5.cmml">,</mo><mrow id="alg1.l10.m1.3.3.3.3.3" xref="alg1.l10.m1.3.3.3.3.3.cmml"><mi mathvariant="normal" id="alg1.l10.m1.3.3.3.3.3.2" xref="alg1.l10.m1.3.3.3.3.3.2.cmml">…</mi><mo id="alg1.l10.m1.3.3.3.3.3.1" xref="alg1.l10.m1.3.3.3.3.3.1.cmml">⁢</mo><msub id="alg1.l10.m1.3.3.3.3.3.3" xref="alg1.l10.m1.3.3.3.3.3.3.cmml"><mi id="alg1.l10.m1.3.3.3.3.3.3.2" xref="alg1.l10.m1.3.3.3.3.3.3.2.cmml">a</mi><mi id="alg1.l10.m1.3.3.3.3.3.3.3" xref="alg1.l10.m1.3.3.3.3.3.3.3.cmml">i</mi></msub></mrow><mo id="alg1.l10.m1.4.4.4.4.8" xref="alg1.l10.m1.4.4.4.5.cmml">,</mo><msub id="alg1.l10.m1.4.4.4.4.4" xref="alg1.l10.m1.4.4.4.4.4.cmml"><mi id="alg1.l10.m1.4.4.4.4.4.2" xref="alg1.l10.m1.4.4.4.4.4.2.cmml">o</mi><mi id="alg1.l10.m1.4.4.4.4.4.3" xref="alg1.l10.m1.4.4.4.4.4.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l10.m1.4.4.4.4.9" xref="alg1.l10.m1.4.4.4.5.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.4b"><apply id="alg1.l10.m1.4.4.cmml" xref="alg1.l10.m1.4.4"><eq id="alg1.l10.m1.4.4.5.cmml" xref="alg1.l10.m1.4.4.5"></eq><apply id="alg1.l10.m1.4.4.6.cmml" xref="alg1.l10.m1.4.4.6"><csymbol cd="ambiguous" id="alg1.l10.m1.4.4.6.1.cmml" xref="alg1.l10.m1.4.4.6">subscript</csymbol><ci id="alg1.l10.m1.4.4.6.2.cmml" xref="alg1.l10.m1.4.4.6.2">𝜏</ci><ci id="alg1.l10.m1.4.4.6.3.cmml" xref="alg1.l10.m1.4.4.6.3">𝑡</ci></apply><list id="alg1.l10.m1.4.4.4.5.cmml" xref="alg1.l10.m1.4.4.4.4"><apply id="alg1.l10.m1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.2">𝑎</ci><cn type="integer" id="alg1.l10.m1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.3">0</cn></apply><apply id="alg1.l10.m1.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.2.2.2.1.cmml" xref="alg1.l10.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l10.m1.2.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.2">𝑜</ci><cn type="integer" id="alg1.l10.m1.2.2.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.3">0</cn></apply><apply id="alg1.l10.m1.3.3.3.3.3.cmml" xref="alg1.l10.m1.3.3.3.3.3"><times id="alg1.l10.m1.3.3.3.3.3.1.cmml" xref="alg1.l10.m1.3.3.3.3.3.1"></times><ci id="alg1.l10.m1.3.3.3.3.3.2.cmml" xref="alg1.l10.m1.3.3.3.3.3.2">…</ci><apply id="alg1.l10.m1.3.3.3.3.3.3.cmml" xref="alg1.l10.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l10.m1.3.3.3.3.3.3.1.cmml" xref="alg1.l10.m1.3.3.3.3.3.3">subscript</csymbol><ci id="alg1.l10.m1.3.3.3.3.3.3.2.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.2">𝑎</ci><ci id="alg1.l10.m1.3.3.3.3.3.3.3.cmml" xref="alg1.l10.m1.3.3.3.3.3.3.3">𝑖</ci></apply></apply><apply id="alg1.l10.m1.4.4.4.4.4.cmml" xref="alg1.l10.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l10.m1.4.4.4.4.4.1.cmml" xref="alg1.l10.m1.4.4.4.4.4">subscript</csymbol><ci id="alg1.l10.m1.4.4.4.4.4.2.cmml" xref="alg1.l10.m1.4.4.4.4.4.2">𝑜</ci><ci id="alg1.l10.m1.4.4.4.4.4.3.cmml" xref="alg1.l10.m1.4.4.4.4.4.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.4c">\tau_{t}={[a_{0},o_{0},\dots a_{i},o_{i}]}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.4d">italic_τ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = [ italic_a start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ]</annotation></semantics></math> using <math id="alg1.l10.m2.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="alg1.l10.m2.1a"><msub id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml"><mi id="alg1.l10.m2.1.1.2" xref="alg1.l10.m2.1.1.2.cmml">π</mi><mi id="alg1.l10.m2.1.1.3" xref="alg1.l10.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><apply id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.1.cmml" xref="alg1.l10.m2.1.1">subscript</csymbol><ci id="alg1.l10.m2.1.1.2.cmml" xref="alg1.l10.m2.1.1.2">𝜋</ci><ci id="alg1.l10.m2.1.1.3.cmml" xref="alg1.l10.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">     Evaluate <math id="alg1.l11.m1.1" class="ltx_Math" alttext="\tau_{t}" display="inline"><semantics id="alg1.l11.m1.1a"><msub id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">τ</mi><mi id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝜏</ci><ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\tau_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">italic_τ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> using <math id="alg1.l11.m2.1" class="ltx_Math" alttext="M_{e}" display="inline"><semantics id="alg1.l11.m2.1a"><msub id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml"><mi id="alg1.l11.m2.1.1.2" xref="alg1.l11.m2.1.1.2.cmml">M</mi><mi id="alg1.l11.m2.1.1.3" xref="alg1.l11.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><apply id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1"><csymbol cd="ambiguous" id="alg1.l11.m2.1.1.1.cmml" xref="alg1.l11.m2.1.1">subscript</csymbol><ci id="alg1.l11.m2.1.1.2.cmml" xref="alg1.l11.m2.1.1.2">𝑀</ci><ci id="alg1.l11.m2.1.1.3.cmml" xref="alg1.l11.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">M_{e}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m2.1d">italic_M start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math>

</div>
<div id="alg1.l12" class="ltx_listingline">     Generate self-reflection <math id="alg1.l12.m1.1" class="ltx_Math" alttext="sr_{t}" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">s</mi><mo id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">⁢</mo><msub id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><mi id="alg1.l12.m1.1.1.3.2" xref="alg1.l12.m1.1.1.3.2.cmml">r</mi><mi id="alg1.l12.m1.1.1.3.3" xref="alg1.l12.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><times id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1"></times><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝑠</ci><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.2">𝑟</ci><ci id="alg1.l12.m1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">sr_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">italic_s italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> using <math id="alg1.l12.m2.1" class="ltx_Math" alttext="M_{sr}" display="inline"><semantics id="alg1.l12.m2.1a"><msub id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml"><mi id="alg1.l12.m2.1.1.2" xref="alg1.l12.m2.1.1.2.cmml">M</mi><mrow id="alg1.l12.m2.1.1.3" xref="alg1.l12.m2.1.1.3.cmml"><mi id="alg1.l12.m2.1.1.3.2" xref="alg1.l12.m2.1.1.3.2.cmml">s</mi><mo id="alg1.l12.m2.1.1.3.1" xref="alg1.l12.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.l12.m2.1.1.3.3" xref="alg1.l12.m2.1.1.3.3.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><apply id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.1.cmml" xref="alg1.l12.m2.1.1">subscript</csymbol><ci id="alg1.l12.m2.1.1.2.cmml" xref="alg1.l12.m2.1.1.2">𝑀</ci><apply id="alg1.l12.m2.1.1.3.cmml" xref="alg1.l12.m2.1.1.3"><times id="alg1.l12.m2.1.1.3.1.cmml" xref="alg1.l12.m2.1.1.3.1"></times><ci id="alg1.l12.m2.1.1.3.2.cmml" xref="alg1.l12.m2.1.1.3.2">𝑠</ci><ci id="alg1.l12.m2.1.1.3.3.cmml" xref="alg1.l12.m2.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">M_{sr}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m2.1d">italic_M start_POSTSUBSCRIPT italic_s italic_r end_POSTSUBSCRIPT</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">     Append <math id="alg1.l13.m1.1" class="ltx_Math" alttext="sr_{t}" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">s</mi><mo id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">⁢</mo><msub id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml">r</mi><mi id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><times id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"></times><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">𝑠</ci><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3">subscript</csymbol><ci id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2">𝑟</ci><ci id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">sr_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">italic_s italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to <math id="alg1.l13.m2.1" class="ltx_Math" alttext="mem" display="inline"><semantics id="alg1.l13.m2.1a"><mrow id="alg1.l13.m2.1.1" xref="alg1.l13.m2.1.1.cmml"><mi id="alg1.l13.m2.1.1.2" xref="alg1.l13.m2.1.1.2.cmml">m</mi><mo id="alg1.l13.m2.1.1.1" xref="alg1.l13.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m2.1.1.3" xref="alg1.l13.m2.1.1.3.cmml">e</mi><mo id="alg1.l13.m2.1.1.1a" xref="alg1.l13.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m2.1.1.4" xref="alg1.l13.m2.1.1.4.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b"><apply id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1"><times id="alg1.l13.m2.1.1.1.cmml" xref="alg1.l13.m2.1.1.1"></times><ci id="alg1.l13.m2.1.1.2.cmml" xref="alg1.l13.m2.1.1.2">𝑚</ci><ci id="alg1.l13.m2.1.1.3.cmml" xref="alg1.l13.m2.1.1.3">𝑒</ci><ci id="alg1.l13.m2.1.1.4.cmml" xref="alg1.l13.m2.1.1.4">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.1c">mem</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m2.1d">italic_m italic_e italic_m</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">     Increment <math id="alg1.l14.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg1.l14.m1.1a"><mi id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><ci id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">italic_t</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span id="alg1.l15.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l15.2" class="ltx_text ltx_font_bold">while</span>
</div>
<div id="alg1.l16" class="ltx_listingline">
<span id="alg1.l16.1" class="ltx_text ltx_font_bold">return</span> 
</div>
</div>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.3.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.4.2" class="ltx_text" style="font-size:90%;">(a) Diagram of Reflexion. (b) Reflexion reinforcement algorithm</span></figcaption>
</figure>
<div id="S3.p1" class="ltx_para">
<p id="S3.p1.4" class="ltx_p">We develop a modular formulation for Reflexion, utilizing three distinct models:
an <span id="S3.p1.4.1" class="ltx_text ltx_font_italic">Actor</span>, denoted as <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="M_{a}" display="inline"><semantics id="S3.p1.1.m1.1a"><msub id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">M</mi><mi id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">𝑀</ci><ci id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">M_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_M start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>, which generates text and actions;
an <span id="S3.p1.4.2" class="ltx_text ltx_font_italic">Evaluator</span> model, represented by <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="M_{e}" display="inline"><semantics id="S3.p1.2.m2.1a"><msub id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">M</mi><mi id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">𝑀</ci><ci id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">M_{e}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_M start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, that scores the outputs produced
by <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="M_{a}" display="inline"><semantics id="S3.p1.3.m3.1a"><msub id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><mi id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml">M</mi><mi id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2">𝑀</ci><ci id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">M_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">italic_M start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>; and a <span id="S3.p1.4.3" class="ltx_text ltx_font_italic">Self-Reflection</span> model, denoted as <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="M_{sr}" display="inline"><semantics id="S3.p1.4.m4.1a"><msub id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><mi id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml">M</mi><mrow id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml"><mi id="S3.p1.4.m4.1.1.3.2" xref="S3.p1.4.m4.1.1.3.2.cmml">s</mi><mo id="S3.p1.4.m4.1.1.3.1" xref="S3.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.p1.4.m4.1.1.3.3" xref="S3.p1.4.m4.1.1.3.3.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2">𝑀</ci><apply id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3"><times id="S3.p1.4.m4.1.1.3.1.cmml" xref="S3.p1.4.m4.1.1.3.1"></times><ci id="S3.p1.4.m4.1.1.3.2.cmml" xref="S3.p1.4.m4.1.1.3.2">𝑠</ci><ci id="S3.p1.4.m4.1.1.3.3.cmml" xref="S3.p1.4.m4.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">M_{sr}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">italic_M start_POSTSUBSCRIPT italic_s italic_r end_POSTSUBSCRIPT</annotation></semantics></math>,
which generates verbal reinforcement cues to assist the Actor in
self-improvement. We provide a detailed description of each of these models and
subsequently elucidate their collaborative functioning within the Reflexion
framework.</p>
</div>
<section id="S3.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Actor</h5>

<div id="S3.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p1.4" class="ltx_p">The Actor is built upon a large language model (LLM) that is specifically
prompted to generate the necessary text and actions conditioned on the state
observations. Analogous to traditional policy-based RL setups, we sample an action
or generation, <math id="S3.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="a_{t}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.1.m1.1a"><msub id="S3.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">a</mi><mi id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2">𝑎</ci><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.1.m1.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.1.m1.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, from the current policy <math id="S3.SS0.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.2.m2.1a"><msub id="S3.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml">π</mi><mi id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1.2">𝜋</ci><ci id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.2.m2.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> at time <math id="S3.SS0.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.3.m3.1a"><mi id="S3.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.3.m3.1b"><ci id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.3.m3.1d">italic_t</annotation></semantics></math>, receive
an observation from the environment <math id="S3.SS0.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="o_{t}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.4.m4.1a"><msub id="S3.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.4.m4.1.1.2" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1.2.cmml">o</mi><mi id="S3.SS0.SSS0.Px1.p1.4.m4.1.1.3" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.4.m4.1b"><apply id="S3.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1.2">𝑜</ci><ci id="S3.SS0.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.4.m4.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.4.m4.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. We explore various Actor models,
including Chain of Thought <cite class="ltx_cite ltx_citemacro_cite">Wei et al., (<a href="#bib.bib26" title="" class="ltx_ref">2022</a>)</cite> and ReAct <cite class="ltx_cite ltx_citemacro_cite">Yao et al., (<a href="#bib.bib30" title="" class="ltx_ref">2023</a>)</cite>.
These diverse generation models allow us to explore different aspects of text and
action generation within the Reflexion framework, providing valuable insights into
their performance and effectiveness. In addition, we also add a memory component
<em id="S3.SS0.SSS0.Px1.p1.4.1" class="ltx_emph ltx_font_italic">mem</em> that provides additional context to this agent. This adaption
was inspired by <cite class="ltx_cite ltx_citemacro_citet">Brooks et al., (<a href="#bib.bib3" title="" class="ltx_ref">2022</a>)</cite>, who suggest a policy iteration approach using in-context learning. Details on how this
is populated are provided below.</p>
</div>
</section>
<section id="S3.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Evaluator</h5>

<div id="S3.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px2.p1.1" class="ltx_p">The Evaluator component of the Reflexion framework plays a crucial role in assessing
the quality of the generated outputs produced by the Actor. It takes as input a
generated trajectory and computes a reward score that reflects its performance within
the given task context. Defining effective value and reward functions that apply
to semantic spaces is difficult, so we investigate several variants of the
Evaluator model. For reasoning tasks, we explore reward functions based on exact
match (EM) grading, ensuring that the generated output aligns closely with the
expected solution. In decision-making tasks, we employ pre-defined heuristic
functions that are tailored to specific evaluation criteria. Additionally, we
experiment with using a different instantiation of an LLM itself as an Evaluator,
generating rewards for decision-making and programming tasks. This multi-faceted
approach to Evaluator design allows us to examine different strategies for scoring
generated outputs, offering insights into their effectiveness and suitability
across a range of tasks.</p>
</div>
</section>
<section id="S3.SS0.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Self-reflection</h5>

<div id="S3.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px3.p1.8" class="ltx_p">The Self-Reflection model instantiated as an LLM, plays a crucial role in the
Reflexion framework by generating verbal self-reflections to provide valuable
feedback for future trials. Given a sparse reward signal, such as a binary
success status (success/fail), the current trajectory, and its persistent memory
<em id="S3.SS0.SSS0.Px3.p1.8.1" class="ltx_emph ltx_font_italic">mem</em>, the self-reflection model generates nuanced and specific feedback.
This feedback, which is more informative than scalar rewards, is then stored
in the agent’s memory (<em id="S3.SS0.SSS0.Px3.p1.8.2" class="ltx_emph ltx_font_italic">mem</em>). For instance, in a multi-step decision-making
task, when the agent receives a failure signal, it can infer that a specific
action <math id="S3.SS0.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="a_{i}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.1.m1.1a"><msub id="S3.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.2" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.2.cmml">a</mi><mi id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.3" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.1.m1.1b"><apply id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.2">𝑎</ci><ci id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.1.m1.1c">a_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px3.p1.1.m1.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> led to subsequent incorrect actions <math id="S3.SS0.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="a_{i+1}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.2.m2.1a"><msub id="S3.SS0.SSS0.Px3.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.2" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml">a</mi><mrow id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3.2" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3.2.cmml">i</mi><mo id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3.1" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3.1.cmml">+</mo><mn id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3.3" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.2.m2.1b"><apply id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.2">𝑎</ci><apply id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3"><plus id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3.1"></plus><ci id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.2.m2.1c">a_{i+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px3.p1.2.m2.1d">italic_a start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S3.SS0.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="a_{i+2}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.3.m3.1a"><msub id="S3.SS0.SSS0.Px3.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.2" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml">a</mi><mrow id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3.2" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3.2.cmml">i</mi><mo id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3.1" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3.1.cmml">+</mo><mn id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3.3" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3.3.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.3.m3.1b"><apply id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.2">𝑎</ci><apply id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3"><plus id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3.1"></plus><ci id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.3.m3.1c">a_{i+2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px3.p1.3.m3.1d">italic_a start_POSTSUBSCRIPT italic_i + 2 end_POSTSUBSCRIPT</annotation></semantics></math>. The
agent can then verbally state that it should have taken a different action,
<math id="S3.SS0.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="a_{i}^{\prime}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.4.m4.1a"><msubsup id="S3.SS0.SSS0.Px3.p1.4.m4.1.1" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p1.4.m4.1.1.2.2" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.1.2.2.cmml">a</mi><mi id="S3.SS0.SSS0.Px3.p1.4.m4.1.1.2.3" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.1.2.3.cmml">i</mi><mo id="S3.SS0.SSS0.Px3.p1.4.m4.1.1.3" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.4.m4.1b"><apply id="S3.SS0.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.4.m4.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px3.p1.4.m4.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.4.m4.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p1.4.m4.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.1.2.2">𝑎</ci><ci id="S3.SS0.SSS0.Px3.p1.4.m4.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.1.2.3">𝑖</ci></apply><ci id="S3.SS0.SSS0.Px3.p1.4.m4.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p1.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.4.m4.1c">a_{i}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px3.p1.4.m4.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, which would have resulted in <math id="S3.SS0.SSS0.Px3.p1.5.m5.1" class="ltx_Math" alttext="a_{i+1}^{\prime}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.5.m5.1a"><msubsup id="S3.SS0.SSS0.Px3.p1.5.m5.1.1" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.2" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.2.cmml">a</mi><mrow id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.3" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.3.cmml"><mi id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.3.2" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.3.2.cmml">i</mi><mo id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.3.1" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.3.1.cmml">+</mo><mn id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.3.3" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.3.3.cmml">1</mn></mrow><mo id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.3" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.5.m5.1b"><apply id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.2">𝑎</ci><apply id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.3"><plus id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.3.1.cmml" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.3.1"></plus><ci id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.3.2.cmml" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.3.3.cmml" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1.2.3.3">1</cn></apply></apply><ci id="S3.SS0.SSS0.Px3.p1.5.m5.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p1.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.5.m5.1c">a_{i+1}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px3.p1.5.m5.1d">italic_a start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> and <math id="S3.SS0.SSS0.Px3.p1.6.m6.1" class="ltx_Math" alttext="a_{i+2}^{\prime}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.6.m6.1a"><msubsup id="S3.SS0.SSS0.Px3.p1.6.m6.1.1" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.2" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.2.cmml">a</mi><mrow id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.3" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.3.cmml"><mi id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.3.2" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.3.2.cmml">i</mi><mo id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.3.1" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.3.1.cmml">+</mo><mn id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.3.3" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.3.3.cmml">2</mn></mrow><mo id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.6.m6.1b"><apply id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.2">𝑎</ci><apply id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.3"><plus id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.3.1.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.3.1"></plus><ci id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.3.2.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.3.3.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.2.3.3">2</cn></apply></apply><ci id="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p1.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.6.m6.1c">a_{i+2}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px3.p1.6.m6.1d">italic_a start_POSTSUBSCRIPT italic_i + 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, and store
this experience in its memory. In subsequent trials, the agent can leverage
its past experiences to adapt its decision-making approach at time <math id="S3.SS0.SSS0.Px3.p1.7.m7.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.7.m7.1a"><mi id="S3.SS0.SSS0.Px3.p1.7.m7.1.1" xref="S3.SS0.SSS0.Px3.p1.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.7.m7.1b"><ci id="S3.SS0.SSS0.Px3.p1.7.m7.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.7.m7.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px3.p1.7.m7.1d">italic_t</annotation></semantics></math> by
choosing action <math id="S3.SS0.SSS0.Px3.p1.8.m8.1" class="ltx_Math" alttext="a_{i}^{\prime}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.8.m8.1a"><msubsup id="S3.SS0.SSS0.Px3.p1.8.m8.1.1" xref="S3.SS0.SSS0.Px3.p1.8.m8.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p1.8.m8.1.1.2.2" xref="S3.SS0.SSS0.Px3.p1.8.m8.1.1.2.2.cmml">a</mi><mi id="S3.SS0.SSS0.Px3.p1.8.m8.1.1.2.3" xref="S3.SS0.SSS0.Px3.p1.8.m8.1.1.2.3.cmml">i</mi><mo id="S3.SS0.SSS0.Px3.p1.8.m8.1.1.3" xref="S3.SS0.SSS0.Px3.p1.8.m8.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.8.m8.1b"><apply id="S3.SS0.SSS0.Px3.p1.8.m8.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.8.m8.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.8.m8.1.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px3.p1.8.m8.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.8.m8.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p1.8.m8.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p1.8.m8.1.1.2.2">𝑎</ci><ci id="S3.SS0.SSS0.Px3.p1.8.m8.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px3.p1.8.m8.1.1.2.3">𝑖</ci></apply><ci id="S3.SS0.SSS0.Px3.p1.8.m8.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p1.8.m8.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.8.m8.1c">a_{i}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px3.p1.8.m8.1d">italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. This iterative process of trial, error, self-reflection,
and persisting memory enables the agent to rapidly improve its decision-making
ability in various environments by utilizing informative feedback signals.</p>
</div>
</section>
<section id="S3.SS0.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Memory</h5>

<div id="S3.SS0.SSS0.Px4.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px4.p1.1" class="ltx_p">Core components of the Reflexion process are the notion of short-term and
long-term memory. At inference time, the Actor conditions its decisions on
short and long-term memory, similar to the way that humans remember fine-grain
recent details while also recalling distilled important experiences from long-term memory.
In the RL setup, the trajectory history serves as the short-term memory while
outputs from the Self-Reflection model are stored in long-term memory. These two
memory components work together to provide context that is specific but
also influenced by lessons learned over several trials, which is a key
advantage of Reflexion agents over other LLM action choice works.</p>
</div>
</section>
<section id="S3.SS0.SSS0.Px5" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">The Reflexion process</h5>

<div id="S3.SS0.SSS0.Px5.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px5.p1.14" class="ltx_p">Reflexion is formalized as an iterative optimization process in <a href="#alg1" title="Algorithm 1 ‣ Figure 2 ‣ 3 Reflexion: reinforcement via verbal reflection ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
In the first trial, the Actor produces a trajectory <math id="S3.SS0.SSS0.Px5.p1.1.m1.1" class="ltx_Math" alttext="\tau_{0}" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.1.m1.1a"><msub id="S3.SS0.SSS0.Px5.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px5.p1.1.m1.1.1.cmml"><mi id="S3.SS0.SSS0.Px5.p1.1.m1.1.1.2" xref="S3.SS0.SSS0.Px5.p1.1.m1.1.1.2.cmml">τ</mi><mn id="S3.SS0.SSS0.Px5.p1.1.m1.1.1.3" xref="S3.SS0.SSS0.Px5.p1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.1.m1.1b"><apply id="S3.SS0.SSS0.Px5.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px5.p1.1.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px5.p1.1.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px5.p1.1.m1.1.1.2">𝜏</ci><cn type="integer" id="S3.SS0.SSS0.Px5.p1.1.m1.1.1.3.cmml" xref="S3.SS0.SSS0.Px5.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.1.m1.1c">\tau_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px5.p1.1.m1.1d">italic_τ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> by
interacting with the environment. The Evaluator then produces a score <math id="S3.SS0.SSS0.Px5.p1.2.m2.1" class="ltx_Math" alttext="r_{0}" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.2.m2.1a"><msub id="S3.SS0.SSS0.Px5.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px5.p1.2.m2.1.1.cmml"><mi id="S3.SS0.SSS0.Px5.p1.2.m2.1.1.2" xref="S3.SS0.SSS0.Px5.p1.2.m2.1.1.2.cmml">r</mi><mn id="S3.SS0.SSS0.Px5.p1.2.m2.1.1.3" xref="S3.SS0.SSS0.Px5.p1.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.2.m2.1b"><apply id="S3.SS0.SSS0.Px5.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px5.p1.2.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px5.p1.2.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px5.p1.2.m2.1.1.2">𝑟</ci><cn type="integer" id="S3.SS0.SSS0.Px5.p1.2.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px5.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.2.m2.1c">r_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px5.p1.2.m2.1d">italic_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>
which is computed as <math id="S3.SS0.SSS0.Px5.p1.3.m3.1" class="ltx_Math" alttext="r_{t}=M_{e}(\tau_{0})" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.3.m3.1a"><mrow id="S3.SS0.SSS0.Px5.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.cmml"><msub id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.3" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.3.2" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.3.2.cmml">r</mi><mi id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.3.3" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.3.3.cmml">t</mi></msub><mo id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.2" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.2.cmml">=</mo><mrow id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.cmml"><msub id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.3" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.3.2" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.3.2.cmml">M</mi><mi id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.3.3" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.3.3.cmml">e</mi></msub><mo id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.2" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.1.2.cmml">τ</mi><mn id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.1.3.cmml">0</mn></msub><mo stretchy="false" id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.3.m3.1b"><apply id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1"><eq id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.2"></eq><apply id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.3.2">𝑟</ci><ci id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.3.3">𝑡</ci></apply><apply id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1"><times id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.2"></times><apply id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.3.2">𝑀</ci><ci id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.3.3">𝑒</ci></apply><apply id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.1.2">𝜏</ci><cn type="integer" id="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px5.p1.3.m3.1.1.1.1.1.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.3.m3.1c">r_{t}=M_{e}(\tau_{0})</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px5.p1.3.m3.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_M start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( italic_τ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>. <math id="S3.SS0.SSS0.Px5.p1.4.m4.1" class="ltx_Math" alttext="r_{t}" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.4.m4.1a"><msub id="S3.SS0.SSS0.Px5.p1.4.m4.1.1" xref="S3.SS0.SSS0.Px5.p1.4.m4.1.1.cmml"><mi id="S3.SS0.SSS0.Px5.p1.4.m4.1.1.2" xref="S3.SS0.SSS0.Px5.p1.4.m4.1.1.2.cmml">r</mi><mi id="S3.SS0.SSS0.Px5.p1.4.m4.1.1.3" xref="S3.SS0.SSS0.Px5.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.4.m4.1b"><apply id="S3.SS0.SSS0.Px5.p1.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px5.p1.4.m4.1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px5.p1.4.m4.1.1.2.cmml" xref="S3.SS0.SSS0.Px5.p1.4.m4.1.1.2">𝑟</ci><ci id="S3.SS0.SSS0.Px5.p1.4.m4.1.1.3.cmml" xref="S3.SS0.SSS0.Px5.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.4.m4.1c">r_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px5.p1.4.m4.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is only a scalar
reward for trial <math id="S3.SS0.SSS0.Px5.p1.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.5.m5.1a"><mi id="S3.SS0.SSS0.Px5.p1.5.m5.1.1" xref="S3.SS0.SSS0.Px5.p1.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.5.m5.1b"><ci id="S3.SS0.SSS0.Px5.p1.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px5.p1.5.m5.1d">italic_t</annotation></semantics></math> that improves as task-specific performance increases.
After the first trial, to amplify <math id="S3.SS0.SSS0.Px5.p1.6.m6.1" class="ltx_Math" alttext="r_{0}" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.6.m6.1a"><msub id="S3.SS0.SSS0.Px5.p1.6.m6.1.1" xref="S3.SS0.SSS0.Px5.p1.6.m6.1.1.cmml"><mi id="S3.SS0.SSS0.Px5.p1.6.m6.1.1.2" xref="S3.SS0.SSS0.Px5.p1.6.m6.1.1.2.cmml">r</mi><mn id="S3.SS0.SSS0.Px5.p1.6.m6.1.1.3" xref="S3.SS0.SSS0.Px5.p1.6.m6.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.6.m6.1b"><apply id="S3.SS0.SSS0.Px5.p1.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px5.p1.6.m6.1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px5.p1.6.m6.1.1.2.cmml" xref="S3.SS0.SSS0.Px5.p1.6.m6.1.1.2">𝑟</ci><cn type="integer" id="S3.SS0.SSS0.Px5.p1.6.m6.1.1.3.cmml" xref="S3.SS0.SSS0.Px5.p1.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.6.m6.1c">r_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px5.p1.6.m6.1d">italic_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> to a feedback form that can be used
for improvement by an LLM, the Self-Reflection
model analyzes the set of <math id="S3.SS0.SSS0.Px5.p1.7.m7.2" class="ltx_Math" alttext="\{\tau_{0},r_{0}\}" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.7.m7.2a"><mrow id="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2" xref="S3.SS0.SSS0.Px5.p1.7.m7.2.2.3.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.3" xref="S3.SS0.SSS0.Px5.p1.7.m7.2.2.3.cmml">{</mo><msub id="S3.SS0.SSS0.Px5.p1.7.m7.1.1.1.1" xref="S3.SS0.SSS0.Px5.p1.7.m7.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px5.p1.7.m7.1.1.1.1.2" xref="S3.SS0.SSS0.Px5.p1.7.m7.1.1.1.1.2.cmml">τ</mi><mn id="S3.SS0.SSS0.Px5.p1.7.m7.1.1.1.1.3" xref="S3.SS0.SSS0.Px5.p1.7.m7.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.4" xref="S3.SS0.SSS0.Px5.p1.7.m7.2.2.3.cmml">,</mo><msub id="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.2" xref="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.2.cmml"><mi id="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.2.2" xref="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.2.2.cmml">r</mi><mn id="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.2.3" xref="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.2.3.cmml">0</mn></msub><mo stretchy="false" id="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.5" xref="S3.SS0.SSS0.Px5.p1.7.m7.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.7.m7.2b"><set id="S3.SS0.SSS0.Px5.p1.7.m7.2.2.3.cmml" xref="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2"><apply id="S3.SS0.SSS0.Px5.p1.7.m7.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px5.p1.7.m7.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.7.m7.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px5.p1.7.m7.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px5.p1.7.m7.1.1.1.1.2">𝜏</ci><cn type="integer" id="S3.SS0.SSS0.Px5.p1.7.m7.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px5.p1.7.m7.1.1.1.1.3">0</cn></apply><apply id="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.2.2">𝑟</ci><cn type="integer" id="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px5.p1.7.m7.2.2.2.2.3">0</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.7.m7.2c">\{\tau_{0},r_{0}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px5.p1.7.m7.2d">{ italic_τ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT }</annotation></semantics></math> to produce a summary
<math id="S3.SS0.SSS0.Px5.p1.8.m8.1" class="ltx_Math" alttext="sr_{0}" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.8.m8.1a"><mrow id="S3.SS0.SSS0.Px5.p1.8.m8.1.1" xref="S3.SS0.SSS0.Px5.p1.8.m8.1.1.cmml"><mi id="S3.SS0.SSS0.Px5.p1.8.m8.1.1.2" xref="S3.SS0.SSS0.Px5.p1.8.m8.1.1.2.cmml">s</mi><mo id="S3.SS0.SSS0.Px5.p1.8.m8.1.1.1" xref="S3.SS0.SSS0.Px5.p1.8.m8.1.1.1.cmml">⁢</mo><msub id="S3.SS0.SSS0.Px5.p1.8.m8.1.1.3" xref="S3.SS0.SSS0.Px5.p1.8.m8.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px5.p1.8.m8.1.1.3.2" xref="S3.SS0.SSS0.Px5.p1.8.m8.1.1.3.2.cmml">r</mi><mn id="S3.SS0.SSS0.Px5.p1.8.m8.1.1.3.3" xref="S3.SS0.SSS0.Px5.p1.8.m8.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.8.m8.1b"><apply id="S3.SS0.SSS0.Px5.p1.8.m8.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.8.m8.1.1"><times id="S3.SS0.SSS0.Px5.p1.8.m8.1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.8.m8.1.1.1"></times><ci id="S3.SS0.SSS0.Px5.p1.8.m8.1.1.2.cmml" xref="S3.SS0.SSS0.Px5.p1.8.m8.1.1.2">𝑠</ci><apply id="S3.SS0.SSS0.Px5.p1.8.m8.1.1.3.cmml" xref="S3.SS0.SSS0.Px5.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px5.p1.8.m8.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px5.p1.8.m8.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px5.p1.8.m8.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px5.p1.8.m8.1.1.3.2">𝑟</ci><cn type="integer" id="S3.SS0.SSS0.Px5.p1.8.m8.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px5.p1.8.m8.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.8.m8.1c">sr_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px5.p1.8.m8.1d">italic_s italic_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> which is stored in the memory <em id="S3.SS0.SSS0.Px5.p1.14.1" class="ltx_emph ltx_font_italic">mem</em>. <math id="S3.SS0.SSS0.Px5.p1.9.m9.1" class="ltx_Math" alttext="sr_{t}" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.9.m9.1a"><mrow id="S3.SS0.SSS0.Px5.p1.9.m9.1.1" xref="S3.SS0.SSS0.Px5.p1.9.m9.1.1.cmml"><mi id="S3.SS0.SSS0.Px5.p1.9.m9.1.1.2" xref="S3.SS0.SSS0.Px5.p1.9.m9.1.1.2.cmml">s</mi><mo id="S3.SS0.SSS0.Px5.p1.9.m9.1.1.1" xref="S3.SS0.SSS0.Px5.p1.9.m9.1.1.1.cmml">⁢</mo><msub id="S3.SS0.SSS0.Px5.p1.9.m9.1.1.3" xref="S3.SS0.SSS0.Px5.p1.9.m9.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px5.p1.9.m9.1.1.3.2" xref="S3.SS0.SSS0.Px5.p1.9.m9.1.1.3.2.cmml">r</mi><mi id="S3.SS0.SSS0.Px5.p1.9.m9.1.1.3.3" xref="S3.SS0.SSS0.Px5.p1.9.m9.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.9.m9.1b"><apply id="S3.SS0.SSS0.Px5.p1.9.m9.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.9.m9.1.1"><times id="S3.SS0.SSS0.Px5.p1.9.m9.1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.9.m9.1.1.1"></times><ci id="S3.SS0.SSS0.Px5.p1.9.m9.1.1.2.cmml" xref="S3.SS0.SSS0.Px5.p1.9.m9.1.1.2">𝑠</ci><apply id="S3.SS0.SSS0.Px5.p1.9.m9.1.1.3.cmml" xref="S3.SS0.SSS0.Px5.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px5.p1.9.m9.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px5.p1.9.m9.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px5.p1.9.m9.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px5.p1.9.m9.1.1.3.2">𝑟</ci><ci id="S3.SS0.SSS0.Px5.p1.9.m9.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px5.p1.9.m9.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.9.m9.1c">sr_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px5.p1.9.m9.1d">italic_s italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is a verbal
experience feedback for trial <math id="S3.SS0.SSS0.Px5.p1.10.m10.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.10.m10.1a"><mi id="S3.SS0.SSS0.Px5.p1.10.m10.1.1" xref="S3.SS0.SSS0.Px5.p1.10.m10.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.10.m10.1b"><ci id="S3.SS0.SSS0.Px5.p1.10.m10.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.10.m10.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.10.m10.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px5.p1.10.m10.1d">italic_t</annotation></semantics></math>. The Actor, Evaluator, and Self-Reflection
models work together through trials in a loop until the Evaluator deems <math id="S3.SS0.SSS0.Px5.p1.11.m11.1" class="ltx_Math" alttext="\tau_{t}" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.11.m11.1a"><msub id="S3.SS0.SSS0.Px5.p1.11.m11.1.1" xref="S3.SS0.SSS0.Px5.p1.11.m11.1.1.cmml"><mi id="S3.SS0.SSS0.Px5.p1.11.m11.1.1.2" xref="S3.SS0.SSS0.Px5.p1.11.m11.1.1.2.cmml">τ</mi><mi id="S3.SS0.SSS0.Px5.p1.11.m11.1.1.3" xref="S3.SS0.SSS0.Px5.p1.11.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.11.m11.1b"><apply id="S3.SS0.SSS0.Px5.p1.11.m11.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px5.p1.11.m11.1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px5.p1.11.m11.1.1.2.cmml" xref="S3.SS0.SSS0.Px5.p1.11.m11.1.1.2">𝜏</ci><ci id="S3.SS0.SSS0.Px5.p1.11.m11.1.1.3.cmml" xref="S3.SS0.SSS0.Px5.p1.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.11.m11.1c">\tau_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px5.p1.11.m11.1d">italic_τ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to
be correct. As mentioned in <a href="#S3.SS0.SSS0.Px4" title="Memory ‣ 3 Reflexion: reinforcement via verbal reflection ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the memory component of
Reflexion is crucial to its effectiveness. After each trial <math id="S3.SS0.SSS0.Px5.p1.12.m12.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.12.m12.1a"><mi id="S3.SS0.SSS0.Px5.p1.12.m12.1.1" xref="S3.SS0.SSS0.Px5.p1.12.m12.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.12.m12.1b"><ci id="S3.SS0.SSS0.Px5.p1.12.m12.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.12.m12.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.12.m12.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px5.p1.12.m12.1d">italic_t</annotation></semantics></math>, <math id="S3.SS0.SSS0.Px5.p1.13.m13.1" class="ltx_Math" alttext="sr_{t}" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.13.m13.1a"><mrow id="S3.SS0.SSS0.Px5.p1.13.m13.1.1" xref="S3.SS0.SSS0.Px5.p1.13.m13.1.1.cmml"><mi id="S3.SS0.SSS0.Px5.p1.13.m13.1.1.2" xref="S3.SS0.SSS0.Px5.p1.13.m13.1.1.2.cmml">s</mi><mo id="S3.SS0.SSS0.Px5.p1.13.m13.1.1.1" xref="S3.SS0.SSS0.Px5.p1.13.m13.1.1.1.cmml">⁢</mo><msub id="S3.SS0.SSS0.Px5.p1.13.m13.1.1.3" xref="S3.SS0.SSS0.Px5.p1.13.m13.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px5.p1.13.m13.1.1.3.2" xref="S3.SS0.SSS0.Px5.p1.13.m13.1.1.3.2.cmml">r</mi><mi id="S3.SS0.SSS0.Px5.p1.13.m13.1.1.3.3" xref="S3.SS0.SSS0.Px5.p1.13.m13.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.13.m13.1b"><apply id="S3.SS0.SSS0.Px5.p1.13.m13.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.13.m13.1.1"><times id="S3.SS0.SSS0.Px5.p1.13.m13.1.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.13.m13.1.1.1"></times><ci id="S3.SS0.SSS0.Px5.p1.13.m13.1.1.2.cmml" xref="S3.SS0.SSS0.Px5.p1.13.m13.1.1.2">𝑠</ci><apply id="S3.SS0.SSS0.Px5.p1.13.m13.1.1.3.cmml" xref="S3.SS0.SSS0.Px5.p1.13.m13.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px5.p1.13.m13.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px5.p1.13.m13.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px5.p1.13.m13.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px5.p1.13.m13.1.1.3.2">𝑟</ci><ci id="S3.SS0.SSS0.Px5.p1.13.m13.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px5.p1.13.m13.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.13.m13.1c">sr_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px5.p1.13.m13.1d">italic_s italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, is appended
<em id="S3.SS0.SSS0.Px5.p1.14.2" class="ltx_emph ltx_font_italic">mem</em>. In practice, we bound <em id="S3.SS0.SSS0.Px5.p1.14.3" class="ltx_emph ltx_font_italic">mem</em> by a maximum number of stored experiences, <math id="S3.SS0.SSS0.Px5.p1.14.m14.1" class="ltx_Math" alttext="\Omega" display="inline"><semantics id="S3.SS0.SSS0.Px5.p1.14.m14.1a"><mi mathvariant="normal" id="S3.SS0.SSS0.Px5.p1.14.m14.1.1" xref="S3.SS0.SSS0.Px5.p1.14.m14.1.1.cmml">Ω</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px5.p1.14.m14.1b"><ci id="S3.SS0.SSS0.Px5.p1.14.m14.1.1.cmml" xref="S3.SS0.SSS0.Px5.p1.14.m14.1.1">Ω</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px5.p1.14.m14.1c">\Omega</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px5.p1.14.m14.1d">roman_Ω</annotation></semantics></math>
(usually set to 1-3) to adhere to max context LLM limitations.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We evaluate various natural language RL setups on decision-making, reasoning,
and code generation tasks. Specifically, we challenge an agent to perform
search-based question answering on HotPotQA <cite class="ltx_cite ltx_citemacro_citep">(Yang et al.,, <a href="#bib.bib28" title="" class="ltx_ref">2018</a>)</cite>, multi-step
tasks in common household environments in AlfWorld <cite class="ltx_cite ltx_citemacro_citep">(Shridhar et al.,, <a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>, and code
writing tasks in competition-like environments with interpreters and
compilers in HumanEval <cite class="ltx_cite ltx_citemacro_citep">(Chen et al.,, <a href="#bib.bib6" title="" class="ltx_ref">2021</a>)</cite>, MBPP <cite class="ltx_cite ltx_citemacro_citep">(Austin et al.,, <a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite>,
and LeetcodeHard, a new benchmark. Most notably, Reflexion improves performance
over strong baselines by 22% in AlfWorld, 20% in HotPotQA, and 11% on HumanEval.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Sequential decision making: ALFWorld</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">AlfWorld is a suite of text-based environments that challenge an agent to solve
multi-step tasks in a variety of interactive environments based on TextWorld
<cite class="ltx_cite ltx_citemacro_citep">(Côté et al.,, <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>. Following <cite class="ltx_cite ltx_citemacro_citet">Yao et al., (<a href="#bib.bib30" title="" class="ltx_ref">2023</a>)</cite>, we run the agent in
134 AlfWorld environments across six different tasks, including finding hidden
objects (e.g., finding a spatula in a drawer), moving objects (e.g., moving a
knife to the cutting board), and manipulating objects with other objects (e.g.,
chilling a tomato in the fridge). We use ReAct <cite class="ltx_cite ltx_citemacro_citep">(Yao et al.,, <a href="#bib.bib30" title="" class="ltx_ref">2023</a>)</cite> as the
action generator as <cite class="ltx_cite ltx_citemacro_citet">Yao et al., (<a href="#bib.bib30" title="" class="ltx_ref">2023</a>)</cite> has shown success in long trajectory
decision-making using explicit intermediate thoughts. AlfWorld tasks naturally
require a self-evaluation step as the environment can only signal if a task
is complete. To achieve fully autonomous behavior, we implement two self-evaluation
techniques: natural language classification using an LLM and a hand-written
heuristic. The heuristic is simple: if the agent executes the
same action and receives the same response for more than 3 cycles, or if the
number of actions taken in the current environment exceeds 30 (inefficient
planning), we self-reflect. In the baseline runs, if self-reflection is suggested, we
skip the self-reflection process, reset the environment, and start a new trial.
In the Reflexion runs, the agent uses self-reflection to find its mistake,
update its memory, reset the environment, and start a new trial. To avoid
very long prompt windows that may exceed the maximum limit, we truncate the
agent’s memory to the last 3 self-reflections (experiences).</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">To avoid syntactic errors, we provide two
domain-specific few-shot trajectories to the agent. We use the same few-shot
trajectory examples as <cite class="ltx_cite ltx_citemacro_citet">Yao et al., (<a href="#bib.bib30" title="" class="ltx_ref">2023</a>)</cite> with GPT-3 for the LLM. AlfWorld
tasks, ReAct few-shot prompts, and Reflexion examples are included in the
appendix.</p>
</div>
<section id="S4.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Results</h5>

<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_2">
<figure id="S4.F3.1" class="ltx_figure ltx_flex_size_2"><img src="x3.png" id="S4.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="830" height="690" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2">
<figure id="S4.F3.2" class="ltx_figure ltx_flex_size_2"><img src="x4.png" id="S4.F3.2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="830" height="690" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.4.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.5.2" class="ltx_text" style="font-size:90%;">(a) AlfWorld performance across 134 tasks showing cumulative
proportions of solved tasks using self-evaluation techniques of (Heuristic)
and (GPT) for binary classification. (b) Classification of AlfWorld trajectories by reason of
failure.</span></figcaption>
</figure>
<div id="S4.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p1.1" class="ltx_p">ReAct + Reflexion significantly outperforms ReAct by completing 130 out of 134 tasks
using the simple heuristic to detect hallucinations and inefficient planning. Further,
ReAct + Reflexion learns to solve additional tasks by learning in 12 consecutive
trials. In the ReAct-only approach, we see that performance increase halts between
trials 6 and 7.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Analysis</h5>

<div id="S4.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p1.1" class="ltx_p">A common error in baseline failed AlfWorld trajectories is when an agent
thinks that it has possession of an item but does not actually have the item. The
agent proceeds to execute several actions in a long trajectory and is not able to
backtrack its actions to find the mistake. Reflexion eliminates almost all of
these cases by using self-reflection to distill long, failed trajectories
into relevant experiences that can are used as "self-hints" in the future.
There are two main cases in which long-term memory helps an agent in AlfWorld:
1) An early mistake in a long trajectory can be easily identified. The agent
can suggest a new action choice or even a new long-term plan.
2) There are too many surfaces/containers to check for an item. The agent can
exploit its experience memory over several trials to thoroughly search a room.
In <a href="#S4.F3" title="Figure 3 ‣ Results ‣ 4.1 Sequential decision making: ALFWorld ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the learning curve suggests that
the learning process occurs over several experiences, meaning that the agent
is successfully balancing cases 1 and 2 shown in the immediate spike in
the improvement between the first two trials, then a steady increase over the
next 11 trials to a near-perfect performance. On the other hand, <a href="#S4.F3" title="Figure 3 ‣ Results ‣ 4.1 Sequential decision making: ALFWorld ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>
shows a ReAct-only agent converging at a hallucination rate of 22% with
no signs of long-term recovery.</p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Reasoning: HotpotQA</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.7" class="ltx_p">HotPotQA <cite class="ltx_cite ltx_citemacro_citep">(Yang et al.,, <a href="#bib.bib28" title="" class="ltx_ref">2018</a>)</cite> is a Wikipedia-based dataset with 113k
question-and-answer pairs that challenge agents to parse content and reason
over several supporting documents.
To test improvement in reasoning <span id="S4.SS2.p1.7.1" class="ltx_text ltx_font_italic">only</span> ability, we implement Reflexion
+ Chain-of-Thought (CoT) <cite class="ltx_cite ltx_citemacro_citep">(Wei et al.,, <a href="#bib.bib26" title="" class="ltx_ref">2022</a>)</cite> for step-by-step <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="Q\rightarrow A" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">Q</mi><mo stretchy="false" id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">→</mo><mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">A</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><ci id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1">→</ci><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝑄</ci><ci id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">Q\rightarrow A</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_Q → italic_A</annotation></semantics></math> and
<math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_Q</annotation></semantics></math>, <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="C_{gt}\rightarrow A" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><msub id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2.2" xref="S4.SS2.p1.3.m3.1.1.2.2.cmml">C</mi><mrow id="S4.SS2.p1.3.m3.1.1.2.3" xref="S4.SS2.p1.3.m3.1.1.2.3.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2.3.2" xref="S4.SS2.p1.3.m3.1.1.2.3.2.cmml">g</mi><mo id="S4.SS2.p1.3.m3.1.1.2.3.1" xref="S4.SS2.p1.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.3.m3.1.1.2.3.3" xref="S4.SS2.p1.3.m3.1.1.2.3.3.cmml">t</mi></mrow></msub><mo stretchy="false" id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">→</mo><mi id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">A</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><ci id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1">→</ci><apply id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.2.1.cmml" xref="S4.SS2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.2.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2.2">𝐶</ci><apply id="S4.SS2.p1.3.m3.1.1.2.3.cmml" xref="S4.SS2.p1.3.m3.1.1.2.3"><times id="S4.SS2.p1.3.m3.1.1.2.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.2.3.1"></times><ci id="S4.SS2.p1.3.m3.1.1.2.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2.3.2">𝑔</ci><ci id="S4.SS2.p1.3.m3.1.1.2.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.2.3.3">𝑡</ci></apply></apply><ci id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">C_{gt}\rightarrow A</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">italic_C start_POSTSUBSCRIPT italic_g italic_t end_POSTSUBSCRIPT → italic_A</annotation></semantics></math> implementations, where <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mi id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">italic_Q</annotation></semantics></math> is the question, <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="C_{gt}" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><msub id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mi id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">C</mi><mrow id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml"><mi id="S4.SS2.p1.5.m5.1.1.3.2" xref="S4.SS2.p1.5.m5.1.1.3.2.cmml">g</mi><mo id="S4.SS2.p1.5.m5.1.1.3.1" xref="S4.SS2.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.5.m5.1.1.3.3" xref="S4.SS2.p1.5.m5.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2">𝐶</ci><apply id="S4.SS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3"><times id="S4.SS2.p1.5.m5.1.1.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3.1"></times><ci id="S4.SS2.p1.5.m5.1.1.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2">𝑔</ci><ci id="S4.SS2.p1.5.m5.1.1.3.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">C_{gt}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">italic_C start_POSTSUBSCRIPT italic_g italic_t end_POSTSUBSCRIPT</annotation></semantics></math>
is the ground truth context from the dataset, and <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mi id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><ci id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">A</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m6.1d">italic_A</annotation></semantics></math> is the final answer.
Since CoT is not a multi-step
decision-making technique, we give <math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="C_{gt}" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><msub id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml"><mi id="S4.SS2.p1.7.m7.1.1.2" xref="S4.SS2.p1.7.m7.1.1.2.cmml">C</mi><mrow id="S4.SS2.p1.7.m7.1.1.3" xref="S4.SS2.p1.7.m7.1.1.3.cmml"><mi id="S4.SS2.p1.7.m7.1.1.3.2" xref="S4.SS2.p1.7.m7.1.1.3.2.cmml">g</mi><mo id="S4.SS2.p1.7.m7.1.1.3.1" xref="S4.SS2.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p1.7.m7.1.1.3.3" xref="S4.SS2.p1.7.m7.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.2">𝐶</ci><apply id="S4.SS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3"><times id="S4.SS2.p1.7.m7.1.1.3.1.cmml" xref="S4.SS2.p1.7.m7.1.1.3.1"></times><ci id="S4.SS2.p1.7.m7.1.1.3.2.cmml" xref="S4.SS2.p1.7.m7.1.1.3.2">𝑔</ci><ci id="S4.SS2.p1.7.m7.1.1.3.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">C_{gt}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.7.m7.1d">italic_C start_POSTSUBSCRIPT italic_g italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to the agent so that we can isolate
the reasoning behavior over large sections of the provided text. To test holistic
question and answering ability, which requires reasoning and action choice, we
implement a Reflexion + ReAct <cite class="ltx_cite ltx_citemacro_citep">(Yao et al.,, <a href="#bib.bib30" title="" class="ltx_ref">2023</a>)</cite> agent that can retrieve
relevant context using a Wikipedia API and infer answers using step-by-step
explicit thinking. For CoT implementations, we
use 6-shot prompting; for ReAct, we use 2-shot prompting, and for self-reflection,
we use 2-shot prompting. All examples can be found in the appendix.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Robustly evaluating natural language answers is a long-standing problem in NLP.
Therefore, between trials, we use exact match answer grading using the environment
to give a binary success signal to the agent. After each trial,
the self-reflection loop is employed to amplify the binary signal, similar to
the decision-making setup <a href="#S4.SS1" title="4.1 Sequential decision making: ALFWorld ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a> in AlfWorld with a
memory size of 3 experiences.</p>
</div>
<section id="S4.SS2.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Results</h5>

<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_3">
<figure id="S4.F4.1" class="ltx_figure ltx_flex_size_3"><img src="x5.png" id="S4.F4.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="831" height="665" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell 
                  ltx_flex_size_3">
<figure id="S4.F4.2" class="ltx_figure ltx_flex_size_3"><img src="x6.png" id="S4.F4.2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="830" height="671" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell 
                  ltx_flex_size_3">
<figure id="S4.F4.3" class="ltx_figure ltx_flex_size_3"><img src="x7.png" id="S4.F4.3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="830" height="654" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.5.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.6.2" class="ltx_text" style="font-size:90%;">Chain-of-Thought (CoT) and ReAct. Reflexion improves search, information
retrieval, and reasoning capabilities on 100 HotPotQA questions. (a) Reflexion
ReAct vs Reflexion CoT (b) Reflexion CoT (GT) for reasoning only (c) Reflexion
vs episodic memory ablation.</span></figcaption>
</figure>
<div id="S4.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS2.SSS0.Px1.p1.1" class="ltx_p">Reflexion outperforms all baseline approaches by significant margins over several
learning steps. Furthermore, ReAct-only, CoT-only, and CoT (GT)-only implementations
fail to probabilistically improve on any tasks, meaning that no failed
tasks from the first trial from any of the baseline approaches were able to be solved
in subsequent trials using a temperature of 0.7
In the Reflexion runs, we allowed the agent to gather
experience and retry on failed tasks until it produced 3 consecutive failed attempts
on the particular task. Naturally, the CoT (GT) achieved higher accuracy scores
as it was given access to the ground truth context of the question. Still,
the CoT (GT) agent is unable to correctly infer the correct answer for 39% of
the questions, but Reflexion helps the agent to correct its mistakes without
access to the ground truth answer to improve its accuracy by 14%.</p>
</div>
</section>
<section id="S4.SS2.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Analysis</h5>

<div id="S4.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS2.SSS0.Px2.p1.1" class="ltx_p">We perform an ablation experiment to isolate the advantage of the self-reflective
step for reasoning using CoT (GT) as the baseline approach <a href="#S4.F4" title="Figure 4 ‣ Results ‣ 4.2 Reasoning: HotpotQA ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
Recall that CoT (GT)
uses Chain-of-Thought reasoning with provided ground truth context, which tests
reasoning ability over long contexts. Next, we add an element of episodic memory
(EPM) by including the most recent trajectory. For the Reflexion agent, we
implement the standard self-reflection step as a final pass. Intuitively, we
test if the agent is iteratively learning more effectively by using verbal
explanation using language written in the first person. <a href="#S4.F4" title="Figure 4 ‣ Results ‣ 4.2 Reasoning: HotpotQA ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>
shows that self-reflection improves learning by an 8% absolute
boost over the episodic memory learning advantage. This result
supports the argument that refinement-only approaches are not as effective as
self-reflection-guided refinement approaches.</p>
</div>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Programming</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We evaluate the baseline and Reflexion approaches on Python and Rust code
writing on MBPP <cite class="ltx_cite ltx_citemacro_citep">(Austin et al.,, <a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite>, HumanEval <cite class="ltx_cite ltx_citemacro_citep">(Chen et al.,, <a href="#bib.bib6" title="" class="ltx_ref">2021</a>)</cite>,
and LeetcodeHardGym, our new dataset. MBPP and HumanEval measure function body
generation accuracy given natural language
descriptions. We use a benchmark language compiler, MultiPL-E <cite class="ltx_cite ltx_citemacro_citep">(Cassano et al.,, <a href="#bib.bib4" title="" class="ltx_ref">2022</a>)</cite>,
to translate subsets of HumanEval and MBPP to the Rust language. MultiPL-E
is a collection of small compilers that can be used to translate Python
benchmark questions to 18 other languages. We include experiments for Rust
code generation to demonstrate that Reflexion implementations for code
generation are language-agnostic and can be used for interpreted and compiled
languages. Lastly, we introduce
a new benchmark, LeetcodeHardGym, which is an interactive programming gym
that contains 40 Leetcode hard-rated questions that have been released after
October 8, 2022, which is the pre-training cutoff date of GPT-4 <cite class="ltx_cite ltx_citemacro_citep">(OpenAI,, <a href="#bib.bib18" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.4" class="ltx_p">The task of programming presents a unique opportunity to use more grounded
self-evaluation practices such as self-generated unit test suites. Thus, our
Reflexion-based programming task implementation is eligible for pass@1
accuracy reporting. To generate a test suite, we use Chain-of-Thought prompting
<cite class="ltx_cite ltx_citemacro_citep">(Wei et al.,, <a href="#bib.bib26" title="" class="ltx_ref">2022</a>)</cite>
to produce diverse, extensive tests with corresponding natural language descriptions.
Then, we filter for syntactically valid test statements by attempting to
construct a valid abstract syntax tree (AST) for each proposed test. Finally, we
sample <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">italic_n</annotation></semantics></math> tests from the collection of generated unit tests to produce a
test suite <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mi id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><ci id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">italic_T</annotation></semantics></math>, denoted as <math id="S4.SS3.p2.3.m3.4" class="ltx_Math" alttext="\{t_{0},t_{1},\dots,t_{n}\}" display="inline"><semantics id="S4.SS3.p2.3.m3.4a"><mrow id="S4.SS3.p2.3.m3.4.4.3" xref="S4.SS3.p2.3.m3.4.4.4.cmml"><mo stretchy="false" id="S4.SS3.p2.3.m3.4.4.3.4" xref="S4.SS3.p2.3.m3.4.4.4.cmml">{</mo><msub id="S4.SS3.p2.3.m3.2.2.1.1" xref="S4.SS3.p2.3.m3.2.2.1.1.cmml"><mi id="S4.SS3.p2.3.m3.2.2.1.1.2" xref="S4.SS3.p2.3.m3.2.2.1.1.2.cmml">t</mi><mn id="S4.SS3.p2.3.m3.2.2.1.1.3" xref="S4.SS3.p2.3.m3.2.2.1.1.3.cmml">0</mn></msub><mo id="S4.SS3.p2.3.m3.4.4.3.5" xref="S4.SS3.p2.3.m3.4.4.4.cmml">,</mo><msub id="S4.SS3.p2.3.m3.3.3.2.2" xref="S4.SS3.p2.3.m3.3.3.2.2.cmml"><mi id="S4.SS3.p2.3.m3.3.3.2.2.2" xref="S4.SS3.p2.3.m3.3.3.2.2.2.cmml">t</mi><mn id="S4.SS3.p2.3.m3.3.3.2.2.3" xref="S4.SS3.p2.3.m3.3.3.2.2.3.cmml">1</mn></msub><mo id="S4.SS3.p2.3.m3.4.4.3.6" xref="S4.SS3.p2.3.m3.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">…</mi><mo id="S4.SS3.p2.3.m3.4.4.3.7" xref="S4.SS3.p2.3.m3.4.4.4.cmml">,</mo><msub id="S4.SS3.p2.3.m3.4.4.3.3" xref="S4.SS3.p2.3.m3.4.4.3.3.cmml"><mi id="S4.SS3.p2.3.m3.4.4.3.3.2" xref="S4.SS3.p2.3.m3.4.4.3.3.2.cmml">t</mi><mi id="S4.SS3.p2.3.m3.4.4.3.3.3" xref="S4.SS3.p2.3.m3.4.4.3.3.3.cmml">n</mi></msub><mo stretchy="false" id="S4.SS3.p2.3.m3.4.4.3.8" xref="S4.SS3.p2.3.m3.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.4b"><set id="S4.SS3.p2.3.m3.4.4.4.cmml" xref="S4.SS3.p2.3.m3.4.4.3"><apply id="S4.SS3.p2.3.m3.2.2.1.1.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.2.2.1.1.1.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1">subscript</csymbol><ci id="S4.SS3.p2.3.m3.2.2.1.1.2.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.2">𝑡</ci><cn type="integer" id="S4.SS3.p2.3.m3.2.2.1.1.3.cmml" xref="S4.SS3.p2.3.m3.2.2.1.1.3">0</cn></apply><apply id="S4.SS3.p2.3.m3.3.3.2.2.cmml" xref="S4.SS3.p2.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.3.3.2.2.1.cmml" xref="S4.SS3.p2.3.m3.3.3.2.2">subscript</csymbol><ci id="S4.SS3.p2.3.m3.3.3.2.2.2.cmml" xref="S4.SS3.p2.3.m3.3.3.2.2.2">𝑡</ci><cn type="integer" id="S4.SS3.p2.3.m3.3.3.2.2.3.cmml" xref="S4.SS3.p2.3.m3.3.3.2.2.3">1</cn></apply><ci id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">…</ci><apply id="S4.SS3.p2.3.m3.4.4.3.3.cmml" xref="S4.SS3.p2.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.4.4.3.3.1.cmml" xref="S4.SS3.p2.3.m3.4.4.3.3">subscript</csymbol><ci id="S4.SS3.p2.3.m3.4.4.3.3.2.cmml" xref="S4.SS3.p2.3.m3.4.4.3.3.2">𝑡</ci><ci id="S4.SS3.p2.3.m3.4.4.3.3.3.cmml" xref="S4.SS3.p2.3.m3.4.4.3.3.3">𝑛</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.4c">\{t_{0},t_{1},\dots,t_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.4d">{ italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math>. We set <math id="S4.SS3.p2.4.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS3.p2.4.m4.1a"><mi id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><ci id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m4.1d">italic_n</annotation></semantics></math> to a maximum
of 6 unit tests. Aside from the unit test suite component,
the setup for the learning loop for a Reflexion programming agent is identical
to the reasoning and decision-making agents with a max memory limit of 1
experience.</p>
</div>
<section id="S4.SS3.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Results</h5>

<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.2.1.1" class="ltx_tr">
<th id="S4.T1.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T1.2.1.1.1.1" class="ltx_text ltx_font_bold">Benchmark + Language</span></th>
<th id="S4.T1.2.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T1.2.1.1.2.1" class="ltx_text ltx_font_bold">Prev SOTA Pass@1</span></th>
<td id="S4.T1.2.1.1.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.2.1.1.3.1" class="ltx_text ltx_font_bold">SOTA Pass@1</span></td>
<td id="S4.T1.2.1.1.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.2.1.1.4.1" class="ltx_text ltx_font_bold">Reflexion Pass@1</span></td>
</tr>
<tr id="S4.T1.2.2.2" class="ltx_tr">
<th id="S4.T1.2.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">HumanEval (PY)</th>
<th id="S4.T1.2.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">65.8 (CodeT <cite class="ltx_cite ltx_citemacro_citep">(Chen et al.,, <a href="#bib.bib5" title="" class="ltx_ref">2022</a>)</cite> + GPT-3.5)</th>
<td id="S4.T1.2.2.2.3" class="ltx_td ltx_align_left ltx_border_t">80.1 (GPT-4)</td>
<td id="S4.T1.2.2.2.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.2.2.2.4.1" class="ltx_text ltx_font_bold">91.0</span></td>
</tr>
<tr id="S4.T1.2.3.3" class="ltx_tr">
<th id="S4.T1.2.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">HumanEval (RS)</th>
<th id="S4.T1.2.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">–</th>
<td id="S4.T1.2.3.3.3" class="ltx_td ltx_align_left">60.0 (GPT-4)</td>
<td id="S4.T1.2.3.3.4" class="ltx_td ltx_align_left"><span id="S4.T1.2.3.3.4.1" class="ltx_text ltx_font_bold">68.0</span></td>
</tr>
<tr id="S4.T1.2.4.4" class="ltx_tr">
<th id="S4.T1.2.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MBPP (PY)</th>
<th id="S4.T1.2.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">67.7 (CodeT <cite class="ltx_cite ltx_citemacro_citep">(Chen et al.,, <a href="#bib.bib5" title="" class="ltx_ref">2022</a>)</cite> + Codex <cite class="ltx_cite ltx_citemacro_citep">(Chen et al.,, <a href="#bib.bib6" title="" class="ltx_ref">2021</a>)</cite>)</th>
<td id="S4.T1.2.4.4.3" class="ltx_td ltx_align_left">
<span id="S4.T1.2.4.4.3.1" class="ltx_text ltx_font_bold">80.1</span> (GPT-4)</td>
<td id="S4.T1.2.4.4.4" class="ltx_td ltx_align_left">77.1</td>
</tr>
<tr id="S4.T1.2.5.5" class="ltx_tr">
<th id="S4.T1.2.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MBPP (RS)</th>
<th id="S4.T1.2.5.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">–</th>
<td id="S4.T1.2.5.5.3" class="ltx_td ltx_align_left">70.9 (GPT-4)</td>
<td id="S4.T1.2.5.5.4" class="ltx_td ltx_align_left"><span id="S4.T1.2.5.5.4.1" class="ltx_text ltx_font_bold">75.4</span></td>
</tr>
<tr id="S4.T1.2.6.6" class="ltx_tr">
<th id="S4.T1.2.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Leetcode Hard (PY)</th>
<th id="S4.T1.2.6.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">–</th>
<td id="S4.T1.2.6.6.3" class="ltx_td ltx_align_left ltx_border_bb">7.5 (GPT-4)</td>
<td id="S4.T1.2.6.6.4" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T1.2.6.6.4.1" class="ltx_text ltx_font_bold">15.0</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.3.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.4.2" class="ltx_text" style="font-size:90%;">Pass@1 accuracy for various model-strategy-language combinations. The
base strategy is a single code generation sample. All instruction-based models
follow zero-shot code generation.</span></figcaption>
</figure>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.2.1.1" class="ltx_tr">
<th id="S4.T2.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.2.1.1.1.1" class="ltx_text ltx_font_bold">Benchmark + Language</span></th>
<th id="S4.T2.2.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.2.1.1.2.1" class="ltx_text ltx_font_bold">Base</span></th>
<th id="S4.T2.2.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.2.1.1.3.1" class="ltx_text ltx_font_bold">Reflexion</span></th>
<th id="S4.T2.2.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.2.1.1.4.1" class="ltx_text ltx_font_bold">TP</span></th>
<th id="S4.T2.2.1.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.2.1.1.5.1" class="ltx_text ltx_font_bold">FN</span></th>
<th id="S4.T2.2.1.1.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.2.1.1.6.1" class="ltx_text ltx_font_bold">FP</span></th>
<th id="S4.T2.2.1.1.7" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.2.1.1.7.1" class="ltx_text ltx_font_bold">TN</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.2.2.1" class="ltx_tr">
<td id="S4.T2.2.2.1.1" class="ltx_td ltx_align_left ltx_border_t">HumanEval (PY)</td>
<td id="S4.T2.2.2.1.2" class="ltx_td ltx_align_left ltx_border_t">0.80</td>
<td id="S4.T2.2.2.1.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T2.2.2.1.3.1" class="ltx_text ltx_font_bold">0.91</span></td>
<td id="S4.T2.2.2.1.4" class="ltx_td ltx_align_left ltx_border_t">0.99</td>
<td id="S4.T2.2.2.1.5" class="ltx_td ltx_align_left ltx_border_t">0.40</td>
<td id="S4.T2.2.2.1.6" class="ltx_td ltx_align_left ltx_border_t">0.01</td>
<td id="S4.T2.2.2.1.7" class="ltx_td ltx_align_left ltx_border_t">0.60</td>
</tr>
<tr id="S4.T2.2.3.2" class="ltx_tr">
<td id="S4.T2.2.3.2.1" class="ltx_td ltx_align_left">MBPP (PY)</td>
<td id="S4.T2.2.3.2.2" class="ltx_td ltx_align_left"><span id="S4.T2.2.3.2.2.1" class="ltx_text ltx_font_bold">0.80</span></td>
<td id="S4.T2.2.3.2.3" class="ltx_td ltx_align_left">0.77</td>
<td id="S4.T2.2.3.2.4" class="ltx_td ltx_align_left">0.84</td>
<td id="S4.T2.2.3.2.5" class="ltx_td ltx_align_left">0.59</td>
<td id="S4.T2.2.3.2.6" class="ltx_td ltx_align_left">0.16</td>
<td id="S4.T2.2.3.2.7" class="ltx_td ltx_align_left">0.41</td>
</tr>
<tr id="S4.T2.2.4.3" class="ltx_tr">
<td id="S4.T2.2.4.3.1" class="ltx_td ltx_align_left">HumanEval (RS)</td>
<td id="S4.T2.2.4.3.2" class="ltx_td ltx_align_left">0.60</td>
<td id="S4.T2.2.4.3.3" class="ltx_td ltx_align_left"><span id="S4.T2.2.4.3.3.1" class="ltx_text ltx_font_bold">0.68</span></td>
<td id="S4.T2.2.4.3.4" class="ltx_td ltx_align_left">0.87</td>
<td id="S4.T2.2.4.3.5" class="ltx_td ltx_align_left">0.37</td>
<td id="S4.T2.2.4.3.6" class="ltx_td ltx_align_left">0.13</td>
<td id="S4.T2.2.4.3.7" class="ltx_td ltx_align_left">0.63</td>
</tr>
<tr id="S4.T2.2.5.4" class="ltx_tr">
<td id="S4.T2.2.5.4.1" class="ltx_td ltx_align_left ltx_border_bb">MBPP (RS)</td>
<td id="S4.T2.2.5.4.2" class="ltx_td ltx_align_left ltx_border_bb">0.71</td>
<td id="S4.T2.2.5.4.3" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T2.2.5.4.3.1" class="ltx_text ltx_font_bold">0.75</span></td>
<td id="S4.T2.2.5.4.4" class="ltx_td ltx_align_left ltx_border_bb">0.84</td>
<td id="S4.T2.2.5.4.5" class="ltx_td ltx_align_left ltx_border_bb">0.51</td>
<td id="S4.T2.2.5.4.6" class="ltx_td ltx_align_left ltx_border_bb">0.16</td>
<td id="S4.T2.2.5.4.7" class="ltx_td ltx_align_left ltx_border_bb">0.49</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.3.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.4.2" class="ltx_text" style="font-size:90%;">Overall accuracy and test generation performance for HumanEval and
MBPP. For Rust, HumanEval is the hardest 50 problems from HumanEval Python
translated to Rust with MultiPL-E <cite class="ltx_cite ltx_citemacro_citep">(Cassano et al.,, <a href="#bib.bib4" title="" class="ltx_ref">2022</a>)</cite>. TP: unit
tests pass, solution pass; FN: unit tests fail, solution pass; FP: unit
tests pass, solution fail; TN: unit tests fail, solution fail.</span></figcaption>
</figure>
<div id="S4.SS3.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS3.SSS0.Px1.p1.1" class="ltx_p">Reflexion outperforms all baseline accuracies and sets new state-of-the-art standards
on all benchmarks for Python and Rust except for MBPP Python <a href="#S4.T1" title="Table 1 ‣ Results ‣ 4.3 Programming ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
We further investigate the inferior performance of Reflexion on MBPP Python.</p>
</div>
</section>
<section id="S4.SS3.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Analysis</h5>

<div id="S4.SS3.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS3.SSS0.Px2.p1.1" class="ltx_p">We acknowledge that self-reflecting code-generation agents are bound to their ability
to write diverse, comprehensive tests. Therefore, in the case in which the model
generates a flaky test suite, it is possible that all tests pass on an incorrect
solution and lead to a false positive label on a code completion <cite class="ltx_cite ltx_citemacro_citep">(Lam et al.,, <a href="#bib.bib11" title="" class="ltx_ref">2020</a>)</cite>.
On the other hand, if the model produces an incorrectly written test suite, it is
possible for some of the tests to fail on a correct solution, leading to a
self-reflection generation that is conditioned on a false negative code completion.
Given the implementation of Reflexion, false negatives are preferred over false
positives as the agent may be able to use self-reflection to identify the incorrect
test(s) and prompt itself to keep the original code completion intact. On the other
hand, if an invalid test suite returns a false positive completion (all internal
test cases pass but the implementation is incorrect), the agent will prematurely
report an invalid submission. In <a href="#S4.T2" title="Table 2 ‣ Results ‣ 4.3 Programming ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, various conditions
are measured to analyze performance beyond pass@1 accuracy. Previously, we
displayed the inferior performance of Reflexion to the baseline GPT-4 on MBPP
Python. In <a href="#S4.T2" title="Table 2 ‣ Results ‣ 4.3 Programming ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we observe a notable discrepancy between
the false positive labels produced by internal test execution, P(not pass@1
generation correct | tests pass). That is, the probability that a submission
will fail given that it passes all unit tests. For HumanEval and MBPP Python,
the baseline pass@1 accuracies are relatively similar, 82% and 80%, respectively.
However, the false positive test execution rate for MBPP Python is 16.3% while
the rate for HumanEval Python is a mere 1.4%, leading to 91% overall accuracy
<a href="#S4.T1" title="Table 1 ‣ Results ‣ 4.3 Programming ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section id="S4.SS3.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Ablation study</h5>

<figure id="S4.T3" class="ltx_table">
<table id="S4.T3.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.2.1.1" class="ltx_tr">
<th id="S4.T3.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S4.T3.2.1.1.1.1" class="ltx_text ltx_font_bold">Approach</span></th>
<th id="S4.T3.2.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S4.T3.2.1.1.2.1" class="ltx_text ltx_font_bold">Test Generation</span></th>
<th id="S4.T3.2.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S4.T3.2.1.1.3.1" class="ltx_text ltx_font_bold">Self-reflection</span></th>
<th id="S4.T3.2.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S4.T3.2.1.1.4.1" class="ltx_text ltx_font_bold">Pass@1 (Acc)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.2.2.1" class="ltx_tr">
<td id="S4.T3.2.2.1.1" class="ltx_td ltx_align_left ltx_border_t">Base model</td>
<td id="S4.T3.2.2.1.2" class="ltx_td ltx_align_left ltx_border_t">False</td>
<td id="S4.T3.2.2.1.3" class="ltx_td ltx_align_left ltx_border_t">False</td>
<td id="S4.T3.2.2.1.4" class="ltx_td ltx_align_left ltx_border_t">0.60</td>
</tr>
<tr id="S4.T3.2.3.2" class="ltx_tr">
<td id="S4.T3.2.3.2.1" class="ltx_td ltx_align_left">Test generation omission</td>
<td id="S4.T3.2.3.2.2" class="ltx_td ltx_align_left">False</td>
<td id="S4.T3.2.3.2.3" class="ltx_td ltx_align_left">True</td>
<td id="S4.T3.2.3.2.4" class="ltx_td ltx_align_left">0.52</td>
</tr>
<tr id="S4.T3.2.4.3" class="ltx_tr">
<td id="S4.T3.2.4.3.1" class="ltx_td ltx_align_left">Self-reflection omission</td>
<td id="S4.T3.2.4.3.2" class="ltx_td ltx_align_left">True</td>
<td id="S4.T3.2.4.3.3" class="ltx_td ltx_align_left">False</td>
<td id="S4.T3.2.4.3.4" class="ltx_td ltx_align_left">0.60</td>
</tr>
<tr id="S4.T3.2.5.4" class="ltx_tr">
<td id="S4.T3.2.5.4.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T3.2.5.4.1.1" class="ltx_text ltx_font_bold">Reflexion</span></td>
<td id="S4.T3.2.5.4.2" class="ltx_td ltx_align_left ltx_border_bb">True</td>
<td id="S4.T3.2.5.4.3" class="ltx_td ltx_align_left ltx_border_bb">True</td>
<td id="S4.T3.2.5.4.4" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T3.2.5.4.4.1" class="ltx_text ltx_font_bold">0.68</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.3.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S4.T3.4.2" class="ltx_text" style="font-size:90%;">Pass@1 accuracy for various compromised approaches on the
Reflexion approach using GPT-4 as the base model on HumanEval Rust
- 50 hardest problems</span></figcaption>
</figure>
<div id="S4.SS3.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS3.SSS0.Px3.p1.1" class="ltx_p">We test the composite approach of Reflexion for test generation and self-reflection
cooperation on a subset of the 50 hardest HumanEval Rust problems. Our Rust
compiler environment provides verbose error logs and helpful debugging hints,
therefore serving as a good playground for compromised approaches. First, we
omit internal test generation and execution steps, which test the agent to
self-reflect without guidance from
current implementations. <a href="#S4.T3" title="Table 3 ‣ Ablation study ‣ 4.3 Programming ‣ 4 Experiments ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows an inferior
52% vs 60% (baseline) accuracy, which suggests that the agent
is unable to determine if the current implementation is correct without unit tests.
Therefore, the agent must participate in all
iterations of the run without the option to return early, performing
harmful edits to the implementation.</p>
</div>
<div id="S4.SS3.SSS0.Px3.p2" class="ltx_para">
<p id="S4.SS3.SSS0.Px3.p2.1" class="ltx_p">Next, we test self-reflection contribution by omitting the natural
language explanation step following failed unit test suite evaluations. Intuitively,
this challenges the agent to combine the tasks of error identification and implementation
improvement across all failed unit tests. Interestingly, the compromised agent
does not improve performance over the baseline run. We observe that the test
generation and code compilation steps are able to catch syntax and logic
errors, but the implementation fixes do not reflect these indications.
These empirical results suggest that several recent works that propose <span id="S4.SS3.SSS0.Px3.p2.1.1" class="ltx_text ltx_font_italic">blind</span>
trial and error debugging techniques without self-reflection are ineffective
on harder tasks such as writing complex programs in Rust.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Limitations</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">At its core, Reflexion is an optimization technique that uses natural language
to do policy optimization. Policy optimization is a powerful approach to improve
action choice through experience, but it may still succumb to non-optimal local
minima solutions. In this study, we limit long-term memory
to a sliding window with maximum capacity, but we encourage future work to
extend the memory component of <span id="S5.p1.1.1" class="ltx_text ltx_font_italic">Reflexion</span> with more advanced structures
such as vector embedding databases or traditional SQL databases. Specific to code
generation, there are many practical limitations to test-driven
development in specifying accurate input-output mappings such as non-deterministic
generator functions, impure functions that interact with
APIs, functions that vary output according to hardware specifications, or functions
that invoke parallel or concurrent behavior that may be difficult to predict.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Broader impact</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">Large language models are increasingly used to interact with external
environments (e.g. the Internet, software, robotics, etc.) and humans.
Our work has the potential of reinforcing and empowering these agents
toward greater automation and work efficiency, but it also amplifies
the risks when these agents were put into misuse. We believe that this
direction of research will need more effort in safety and ethical
considerations.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">On the other hand, reinforcement learning has suffered from its black-box
policy and optimization setups in which interpretability and alignment have
been challenging. Our proposed “verbal” reinforcement learning might
address some of the issues and turn autonomous agents more interpretable
and diagnosable. For example, in the case of tool-usage that may be too
hard for humans to understand, self-reflections could be monitored to
ensure proper intent before using the tool.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">In this work, we present <em id="S7.p1.1.1" class="ltx_emph ltx_font_italic">Reflexion</em>, an approach that leverages verbal reinforcement
to teach agents to learn from past mistakes. We empirically show that Reflexion agents
significantly outperform currently widely-used decision-making approaches by utilizing
self-reflection. In future work, Reflexion could be used to employ more advanced
techniques that have been thoroughly studied in traditional RL settings, such as value
learning in natural language or off-policy exploration techniques.</p>
</div>
</section>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Reproducibility</h2>

<div id="S8.p1" class="ltx_para">
<p id="S8.p1.1" class="ltx_p">We highly advise others to use isolated execution environments when running autonomous code
writing experiments as the generated code is not validated before execution.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ahn et al.,  (2022)</span>
<span class="ltx_bibblock">
Ahn, M., Brohan, A., Brown, N., Chebotar, Y., Cortes, O., David, B., Finn, C.,
Gopalakrishnan, K., Hausman, K., Herzog, A., et al. (2022).

</span>
<span class="ltx_bibblock">Do as i can, not as i say: Grounding language in robotic affordances.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2204.01691</span>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Austin et al.,  (2021)</span>
<span class="ltx_bibblock">
Austin, J., Odena, A., Nye, M., Bosma, M., Michalewski, H., Dohan, D., Jiang,
E., Cai, C., Terry, M., Le, Q., et al. (2021).

</span>
<span class="ltx_bibblock">Program synthesis with large language models.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2108.07732</span>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brooks et al.,  (2022)</span>
<span class="ltx_bibblock">
Brooks, E., Walls, L., Lewis, R. L., and Singh, S. (2022).

</span>
<span class="ltx_bibblock">In-context policy iteration.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2210.03821</span>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cassano et al.,  (2022)</span>
<span class="ltx_bibblock">
Cassano, F., Gouwar, J., Nguyen, D., Nguyen, S., Phipps-Costin, L., Pinckney,
D., Yee, M.-H., Zi, Y., Anderson, C. J., Feldman, M. Q., Guha, A., Greenberg,
M., and Jangda, A. (2022).

</span>
<span class="ltx_bibblock">Multipl-e: A scalable and extensible approach to benchmarking neural
code generation.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al.,  (2022)</span>
<span class="ltx_bibblock">
Chen, B., Zhang, F., Nguyen, A., Zan, D., Lin, Z., Lou, J.-G., and Chen, W.
(2022).

</span>
<span class="ltx_bibblock">Codet: Code generation with generated tests.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2207.10397</span>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al.,  (2021)</span>
<span class="ltx_bibblock">
Chen, M., Tworek, J., Jun, H., Yuan, Q., Pinto, H. P. d. O., Kaplan, J.,
Edwards, H., Burda, Y., Joseph, N., Brockman, G., et al. (2021).

</span>
<span class="ltx_bibblock">Evaluating large language models trained on code.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2107.03374</span>.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al.,  (2023)</span>
<span class="ltx_bibblock">
Chen, X., Lin, M., Schärli, N., and Zhou, D. (2023).

</span>
<span class="ltx_bibblock">Teaching large language models to self-debug.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2304.05128</span>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Côté et al.,  (2019)</span>
<span class="ltx_bibblock">
Côté, M.-A., Kádár, A., Yuan, X., Kybartas, B., Barnes, T.,
Fine, E., Moore, J., Hausknecht, M., El Asri, L., Adada, M., et al. (2019).

</span>
<span class="ltx_bibblock">Textworld: A learning environment for text-based games.

</span>
<span class="ltx_bibblock">In <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">Computer Games: 7th Workshop, CGW 2018, Held in Conjunction
with the 27th International Conference on Artificial Intelligence, IJCAI
2018, Stockholm, Sweden, July 13, 2018, Revised Selected Papers 7</span>, pages
41–75. Springer.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goodman,  (2023)</span>
<span class="ltx_bibblock">
Goodman, N. (2023).

</span>
<span class="ltx_bibblock">Meta-prompt: A simple self-improving language agent.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">noahgoodman.substack.com</span>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al.,  (2023)</span>
<span class="ltx_bibblock">
Kim, G., Baldi, P., and McAleer, S. (2023).

</span>
<span class="ltx_bibblock">Language models can solve computer tasks.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2303.17491</span>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lam et al.,  (2020)</span>
<span class="ltx_bibblock">
Lam, W., Winter, S., Wei, A., Xie, T., Marinov, D., and Bell, J. (2020).

</span>
<span class="ltx_bibblock">A large-scale longitudinal study of flaky tests.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Proc. ACM Program. Lang.</span>, 4(OOPSLA).

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Le et al.,  (2022)</span>
<span class="ltx_bibblock">
Le, H., Wang, Y., Gotmare, A. D., Savarese, S., and Hoi, S. C. H. (2022).

</span>
<span class="ltx_bibblock">Coderl: Mastering code generation through pretrained models and deep
reinforcement learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
35:21314–21328.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al.,  (2023)</span>
<span class="ltx_bibblock">
Li, R., Allal, L. B., Zi, Y., Muennighoff, N., Kocetkov, D., Mou, C., Marone,
M., Akiki, C., Li, J., Chim, J., et al. (2023).

</span>
<span class="ltx_bibblock">Starcoder: may the source be with you!

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2305.06161</span>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al.,  (2022)</span>
<span class="ltx_bibblock">
Li, Y., Choi, D., Chung, J., Kushman, N., Schrittwieser, J., Leblond, R.,
Eccles, T., Keeling, J., Gimeno, F., Dal Lago, A., et al. (2022).

</span>
<span class="ltx_bibblock">Competition-level code generation with alphacode.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Science</span>, 378(6624):1092–1097.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Madaan et al.,  (2023)</span>
<span class="ltx_bibblock">
Madaan, A., Tandon, N., Gupta, P., Hallinan, S., Gao, L., Wiegreffe, S., Alon,
U., Dziri, N., Prabhumoye, S., Yang, Y., et al. (2023).

</span>
<span class="ltx_bibblock">Self-refine: Iterative refinement with self-feedback.

</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2303.17651</span>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nair et al.,  (2023)</span>
<span class="ltx_bibblock">
Nair, V., Schumacher, E., Tso, G., and Kannan, A. (2023).

</span>
<span class="ltx_bibblock">Dera: Enhancing large language model completions with dialog-enabled
resolving agents.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2303.17071</span>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nakano et al.,  (2021)</span>
<span class="ltx_bibblock">
Nakano, R., Hilton, J., Balaji, S., Wu, J., Ouyang, L., Kim, C., Hesse, C.,
Jain, S., Kosaraju, V., Saunders, W., et al. (2021).

</span>
<span class="ltx_bibblock">Webgpt: Browser-assisted question-answering with human feedback.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2112.09332</span>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI,  (2023)</span>
<span class="ltx_bibblock">
OpenAI (2023).

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">ArXiv</span>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Park et al.,  (2023)</span>
<span class="ltx_bibblock">
Park, J. S., O’Brien, J. C., Cai, C. J., Morris, M. R., Liang, P., and
Bernstein, M. S. (2023).

</span>
<span class="ltx_bibblock">Generative agents: Interactive simulacra of human behavior.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2304.03442</span>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paul et al.,  (2023)</span>
<span class="ltx_bibblock">
Paul, D., Ismayilzada, M., Peyrard, M., Borges, B., Bosselut, A., West, R., and
Faltings, B. (2023).

</span>
<span class="ltx_bibblock">Refiner: Reasoning feedback on intermediate representations.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2304.01904</span>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pryzant et al.,  (2023)</span>
<span class="ltx_bibblock">
Pryzant, R., Iter, D., Li, J., Lee, Y. T., Zhu, C., and Zeng, M. (2023).

</span>
<span class="ltx_bibblock">Automatic prompt optimization with" gradient descent" and beam
search.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2305.03495</span>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schick et al.,  (2023)</span>
<span class="ltx_bibblock">
Schick, T., Dwivedi-Yu, J., Dessì, R., Raileanu, R., Lomeli, M.,
Zettlemoyer, L., Cancedda, N., and Scialom, T. (2023).

</span>
<span class="ltx_bibblock">Toolformer: Language models can teach themselves to use tools.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2302.04761</span>.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al.,  (2023)</span>
<span class="ltx_bibblock">
Shen, Y., Song, K., Tan, X., Li, D., Lu, W., and Zhuang, Y. (2023).

</span>
<span class="ltx_bibblock">Hugginggpt: Solving ai tasks with chatgpt and its friends in
huggingface.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2303.17580</span>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shridhar et al.,  (2021)</span>
<span class="ltx_bibblock">
Shridhar, M., Yuan, X., Côté, M.-A., Bisk, Y., Trischler, A., and
Hausknecht, M. (2021).

</span>
<span class="ltx_bibblock">ALFWorld: Aligning Text and Embodied Environments for Interactive
Learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">Proceedings of the International Conference on Learning
Representations (ICLR)</span>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutton and Barto,  (2018)</span>
<span class="ltx_bibblock">
Sutton, R. S. and Barto, A. G. (2018).

</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">Reinforcement Learning: An Introduction</span>.

</span>
<span class="ltx_bibblock">The MIT Press, second edition.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al.,  (2022)</span>
<span class="ltx_bibblock">
Wei, J., Wang, X., Schuurmans, D., Bosma, M., Chi, E., Le, Q., and Zhou, D.
(2022).

</span>
<span class="ltx_bibblock">Chain of thought prompting elicits reasoning in large language
models.

</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2201.11903</span>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al.,  (2023)</span>
<span class="ltx_bibblock">
Xie, Y., Kawaguchi, K., Zhao, Y., Zhao, X., Kan, M.-Y., He, J., and Xie, Q.
(2023).

</span>
<span class="ltx_bibblock">Decomposition enhances reasoning via self-evaluation guided decoding.

</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2305.00633</span>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al.,  (2018)</span>
<span class="ltx_bibblock">
Yang, Z., Qi, P., Zhang, S., Bengio, Y., Cohen, W. W., Salakhutdinov, R., and
Manning, C. D. (2018).

</span>
<span class="ltx_bibblock">HotpotQA: A dataset for diverse, explainable multi-hop question
answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">Conference on Empirical Methods in Natural Language
Processing (EMNLP)</span>.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(29)</span>
<span class="ltx_bibblock">
Yao, S., Chen, H., Yang, J., and Narasimhan, K. (preprint).

</span>
<span class="ltx_bibblock">Webshop: Towards scalable real-world web interaction with grounded
language agents.

</span>
<span class="ltx_bibblock">In <span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">ArXiv</span>.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al.,  (2023)</span>
<span class="ltx_bibblock">
Yao, S., Zhao, J., Yu, D., Du, N., Shafran, I., Narasimhan, K., and Cao, Y.
(2023).

</span>
<span class="ltx_bibblock">ReAct: Synergizing reasoning and acting in language models.

</span>
<span class="ltx_bibblock">In <span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations (ICLR)</span>.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yoran et al.,  (2023)</span>
<span class="ltx_bibblock">
Yoran, O., Wolfson, T., Bogin, B., Katz, U., Deutch, D., and Berant, J. (2023).

</span>
<span class="ltx_bibblock">Answering questions by meta-reasoning over multiple chains of
thought.

</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2304.13007</span>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Evaluation with additional models</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">We further investigated the applicability of trial-and-error problem-solving with
models of various strengths. We found that the ability to specify self-corrections
is an emergent quality of stronger, larger models.</p>
</div>
<figure id="A1.T4" class="ltx_table">
<table id="A1.T4.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T4.2.1.1" class="ltx_tr">
<th id="A1.T4.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="A1.T4.2.1.1.1.1" class="ltx_text ltx_font_bold">Approach</span></th>
<th id="A1.T4.2.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="A1.T4.2.1.1.2.1" class="ltx_text ltx_font_bold">Pass@1 accuracy (avg over 8 trials)</span></th>
<th id="A1.T4.2.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="A1.T4.2.1.1.3.1" class="ltx_text ltx_font_bold">Pass@1 accuracy (std)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T4.2.2.1" class="ltx_tr">
<td id="A1.T4.2.2.1.1" class="ltx_td ltx_align_left ltx_border_t">Baseline</td>
<td id="A1.T4.2.2.1.2" class="ltx_td ltx_align_left ltx_border_t">0.26</td>
<td id="A1.T4.2.2.1.3" class="ltx_td ltx_align_left ltx_border_t">0.00481</td>
</tr>
<tr id="A1.T4.2.3.2" class="ltx_tr">
<td id="A1.T4.2.3.2.1" class="ltx_td ltx_align_left ltx_border_bb">Reflexion</td>
<td id="A1.T4.2.3.2.2" class="ltx_td ltx_align_left ltx_border_bb">0.26</td>
<td id="A1.T4.2.3.2.3" class="ltx_td ltx_align_left ltx_border_bb">0.00305</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A1.T4.3.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="A1.T4.4.2" class="ltx_text" style="font-size:90%;">Pass@1 accuracy on HumanEval Python using starchat-beta <cite class="ltx_cite ltx_citemacro_citep">(Li et al.,, <a href="#bib.bib13" title="" class="ltx_ref">2023</a>)</cite>.</span></figcaption>
</figure>
<figure id="A1.T5" class="ltx_table">
<table id="A1.T5.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T5.2.1.1" class="ltx_tr">
<th id="A1.T5.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="A1.T5.2.1.1.1.1" class="ltx_text ltx_font_bold">Model</span></th>
<th id="A1.T5.2.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="A1.T5.2.1.1.2.1" class="ltx_text ltx_font_bold">Baseline accuracy</span></th>
<th id="A1.T5.2.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="A1.T5.2.1.1.3.1" class="ltx_text ltx_font_bold">Reflexion accuracy</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T5.2.2.1" class="ltx_tr">
<td id="A1.T5.2.2.1.1" class="ltx_td ltx_align_left ltx_border_t">CoT (GT) + text-davinci-003</td>
<td id="A1.T5.2.2.1.2" class="ltx_td ltx_align_left ltx_border_t">0.60</td>
<td id="A1.T5.2.2.1.3" class="ltx_td ltx_align_left ltx_border_t"><span id="A1.T5.2.2.1.3.1" class="ltx_text ltx_font_bold">0.77</span></td>
</tr>
<tr id="A1.T5.2.3.2" class="ltx_tr">
<td id="A1.T5.2.3.2.1" class="ltx_td ltx_align_left">CoT (GT) + gpt-3.5-turbo</td>
<td id="A1.T5.2.3.2.2" class="ltx_td ltx_align_left">0.57</td>
<td id="A1.T5.2.3.2.3" class="ltx_td ltx_align_left"><span id="A1.T5.2.3.2.3.1" class="ltx_text ltx_font_bold">0.71</span></td>
</tr>
<tr id="A1.T5.2.4.3" class="ltx_tr">
<td id="A1.T5.2.4.3.1" class="ltx_td ltx_align_left">CoT (GT) + gpt-4</td>
<td id="A1.T5.2.4.3.2" class="ltx_td ltx_align_left">0.68</td>
<td id="A1.T5.2.4.3.3" class="ltx_td ltx_align_left"><span id="A1.T5.2.4.3.3.1" class="ltx_text ltx_font_bold">0.80</span></td>
</tr>
<tr id="A1.T5.2.5.4" class="ltx_tr">
<td id="A1.T5.2.5.4.1" class="ltx_td ltx_align_left">ReAct + text-davinci-003</td>
<td id="A1.T5.2.5.4.2" class="ltx_td ltx_align_left">0.30</td>
<td id="A1.T5.2.5.4.3" class="ltx_td ltx_align_left"><span id="A1.T5.2.5.4.3.1" class="ltx_text ltx_font_bold">0.55</span></td>
</tr>
<tr id="A1.T5.2.6.5" class="ltx_tr">
<td id="A1.T5.2.6.5.1" class="ltx_td ltx_align_left">ReAct + gpt-3.5-turbo</td>
<td id="A1.T5.2.6.5.2" class="ltx_td ltx_align_left">0.26</td>
<td id="A1.T5.2.6.5.3" class="ltx_td ltx_align_left"><span id="A1.T5.2.6.5.3.1" class="ltx_text ltx_font_bold">0.38</span></td>
</tr>
<tr id="A1.T5.2.7.6" class="ltx_tr">
<td id="A1.T5.2.7.6.1" class="ltx_td ltx_align_left ltx_border_bb">ReAct + gpt-4</td>
<td id="A1.T5.2.7.6.2" class="ltx_td ltx_align_left ltx_border_bb">0.39</td>
<td id="A1.T5.2.7.6.3" class="ltx_td ltx_align_left ltx_border_bb"><span id="A1.T5.2.7.6.3.1" class="ltx_text ltx_font_bold">0.51</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A1.T5.3.1.1" class="ltx_text" style="font-size:90%;">Table 5</span>: </span><span id="A1.T5.4.2" class="ltx_text" style="font-size:90%;">Pass@1 accuracy on 100 HotPotQA using various models.</span></figcaption>
</figure>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Decision-making</h2>

<figure id="A2.F5" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ">
<p id="A2.F5.6" class="ltx_p ltx_minipage ltx_align_middle" style="width:433.6pt;"><span id="A2.F5.6.1" class="ltx_text" style="background-color:#CACBE8;"><span id="A2.F5.6.1.1" class="ltx_text ltx_font_bold">Environment: </span>You are in the middle of a room. Looking quickly
around you, you see a bed 1, a desk 2, a desk 1, a drawer 6, a drawer 5, a
drawer 4, a drawer 3, a drawer 2, a drawer 1, a garbagecan 1, a laundryhamper
1, a safe 1, a shelf 6, a shelf 5, a shelf 4, a shelf 3, a shelf 2, and a
shelf 1.<span id="A2.F5.6.1.2" class="ltx_text ltx_font_bold">Task: </span>examine the mug with the desklamp.</span></p>
</div>
<div class="ltx_flex_cell 
                  ltx_flex_size_1"><span id="A2.F5.2" class="ltx_inline-para ltx_minipage ltx_flex_size_1 ltx_align_middle" style="width:433.6pt;">
<span id="A2.F5.2.p1" class="ltx_para">
<span id="A2.F5.2.p1.14" class="ltx_p"><span id="A2.F5.2.p1.14.1" class="ltx_text ltx_font_bold">Trial #1</span></span>
<span id="A2.F5.2.p1.1" class="ltx_p"><math id="A2.F5.2.p1.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.2.p1.1.m1.1a"><mo id="A2.F5.2.p1.1.m1.1.1" xref="A2.F5.2.p1.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.2.p1.1.m1.1b"><gt id="A2.F5.2.p1.1.m1.1.1.cmml" xref="A2.F5.2.p1.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.2.p1.1.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.2.p1.1.m1.1d">&gt;</annotation></semantics></math> think: To solve the task, I need to find and take a mug, then find
and use a desklamp.</span>
<span id="A2.F5.2.p1.2" class="ltx_p"><math id="A2.F5.2.p1.2.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.2.p1.2.m1.1a"><mo id="A2.F5.2.p1.2.m1.1.1" xref="A2.F5.2.p1.2.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.2.p1.2.m1.1b"><gt id="A2.F5.2.p1.2.m1.1.1.cmml" xref="A2.F5.2.p1.2.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.2.p1.2.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.2.p1.2.m1.1d">&gt;</annotation></semantics></math> think: First I need to find a mug. A mug is more likely to appear in
drawer (1-6), desk (1-2), shelf (1-6), garbagecan (1), laundryhamper (1).
I can check one by one, starting with drawer 1.</span>
<span id="A2.F5.2.p1.3" class="ltx_p"><math id="A2.F5.2.p1.3.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.2.p1.3.m1.1a"><mo id="A2.F5.2.p1.3.m1.1.1" xref="A2.F5.2.p1.3.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.2.p1.3.m1.1b"><gt id="A2.F5.2.p1.3.m1.1.1.cmml" xref="A2.F5.2.p1.3.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.2.p1.3.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.2.p1.3.m1.1d">&gt;</annotation></semantics></math> go to drawer 1</span>
<span id="A2.F5.2.p1.15" class="ltx_p">The drawer 1 is closed.</span>
<span id="A2.F5.2.p1.16" class="ltx_p">…</span>
<span id="A2.F5.2.p1.4" class="ltx_p"><math id="A2.F5.2.p1.4.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.2.p1.4.m1.1a"><mo id="A2.F5.2.p1.4.m1.1.1" xref="A2.F5.2.p1.4.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.2.p1.4.m1.1b"><gt id="A2.F5.2.p1.4.m1.1.1.cmml" xref="A2.F5.2.p1.4.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.2.p1.4.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.2.p1.4.m1.1d">&gt;</annotation></semantics></math> open drawer 6</span>
<span id="A2.F5.2.p1.17" class="ltx_p">You open the drawer 6. The drawer 6 is open. In it, you see a keychain 2.</span>
<span id="A2.F5.2.p1.7" class="ltx_p"><span id="A2.F5.2.p1.7.3" class="ltx_text" style="background-color:#BCE3BD;"><math id="A2.F5.2.p1.5.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.2.p1.5.1.m1.1a"><mo mathbackground="#BCE3BD" id="A2.F5.2.p1.5.1.m1.1.1" xref="A2.F5.2.p1.5.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.2.p1.5.1.m1.1b"><gt id="A2.F5.2.p1.5.1.m1.1.1.cmml" xref="A2.F5.2.p1.5.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.2.p1.5.1.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.2.p1.5.1.m1.1d">&gt;</annotation></semantics></math> go to desk 1On the desk 1, you see a creditcard 3, a desklamp 1, a laptop 2, a mug 1, a
pen 1, and a pencil 1.<math id="A2.F5.2.p1.6.2.m2.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.2.p1.6.2.m2.1a"><mo mathbackground="#BCE3BD" id="A2.F5.2.p1.6.2.m2.1.1" xref="A2.F5.2.p1.6.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.2.p1.6.2.m2.1b"><gt id="A2.F5.2.p1.6.2.m2.1.1.cmml" xref="A2.F5.2.p1.6.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.2.p1.6.2.m2.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.2.p1.6.2.m2.1d">&gt;</annotation></semantics></math> think: Now I find a mug (1). Next, I need to take it.<math id="A2.F5.2.p1.7.3.m3.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.2.p1.7.3.m3.1a"><mo mathbackground="#BCE3BD" id="A2.F5.2.p1.7.3.m3.1.1" xref="A2.F5.2.p1.7.3.m3.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.2.p1.7.3.m3.1b"><gt id="A2.F5.2.p1.7.3.m3.1.1.cmml" xref="A2.F5.2.p1.7.3.m3.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.2.p1.7.3.m3.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.2.p1.7.3.m3.1d">&gt;</annotation></semantics></math> take mug 1 from desk 1You pick up the mug 1 from the desk 1.</span></span>
<span id="A2.F5.2.p1.8" class="ltx_p"><math id="A2.F5.2.p1.8.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.2.p1.8.m1.1a"><mo id="A2.F5.2.p1.8.m1.1.1" xref="A2.F5.2.p1.8.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.2.p1.8.m1.1b"><gt id="A2.F5.2.p1.8.m1.1.1.cmml" xref="A2.F5.2.p1.8.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.2.p1.8.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.2.p1.8.m1.1d">&gt;</annotation></semantics></math> think: Now I take a mug (1). Next, I need to find a desklamp. A desklamp
is more likely to appear in desk (1-2), sidetable (1-2), shelf (1-6),
bed (1), drawer (1-6). I can check one by one, starting with desk 1.</span>
<span id="A2.F5.2.p1.9" class="ltx_p"><math id="A2.F5.2.p1.9.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.2.p1.9.m1.1a"><mo id="A2.F5.2.p1.9.m1.1.1" xref="A2.F5.2.p1.9.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.2.p1.9.m1.1b"><gt id="A2.F5.2.p1.9.m1.1.1.cmml" xref="A2.F5.2.p1.9.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.2.p1.9.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.2.p1.9.m1.1d">&gt;</annotation></semantics></math> go to desk 1</span>
<span id="A2.F5.2.p1.18" class="ltx_p">Nothing happens.</span>
<span id="A2.F5.2.p1.10" class="ltx_p"><math id="A2.F5.2.p1.10.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.2.p1.10.m1.1a"><mo id="A2.F5.2.p1.10.m1.1.1" xref="A2.F5.2.p1.10.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.2.p1.10.m1.1b"><gt id="A2.F5.2.p1.10.m1.1.1.cmml" xref="A2.F5.2.p1.10.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.2.p1.10.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.2.p1.10.m1.1d">&gt;</annotation></semantics></math> go to desk 2</span>
<span id="A2.F5.2.p1.19" class="ltx_p">On the desk 2, you see a alarmclock 1, a bowl 1, a mug 3, a pencil 3,
and a pencil 2.</span>
<span id="A2.F5.2.p1.11" class="ltx_p"><math id="A2.F5.2.p1.11.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.2.p1.11.m1.1a"><mo id="A2.F5.2.p1.11.m1.1.1" xref="A2.F5.2.p1.11.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.2.p1.11.m1.1b"><gt id="A2.F5.2.p1.11.m1.1.1.cmml" xref="A2.F5.2.p1.11.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.2.p1.11.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.2.p1.11.m1.1d">&gt;</annotation></semantics></math> think: Now I find a desklamp (1). Next, I need to use it.</span>
<span id="A2.F5.2.p1.13" class="ltx_p"><span id="A2.F5.2.p1.13.2" class="ltx_text" style="background-color:#DEA9A9;"><math id="A2.F5.2.p1.12.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.2.p1.12.1.m1.1a"><mo mathbackground="#DEA9A9" id="A2.F5.2.p1.12.1.m1.1.1" xref="A2.F5.2.p1.12.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.2.p1.12.1.m1.1b"><gt id="A2.F5.2.p1.12.1.m1.1.1.cmml" xref="A2.F5.2.p1.12.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.2.p1.12.1.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.2.p1.12.1.m1.1d">&gt;</annotation></semantics></math> use desklamp 1Nothing happens.<math id="A2.F5.2.p1.13.2.m2.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.2.p1.13.2.m2.1a"><mo mathbackground="#DEA9A9" id="A2.F5.2.p1.13.2.m2.1.1" xref="A2.F5.2.p1.13.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.2.p1.13.2.m2.1b"><gt id="A2.F5.2.p1.13.2.m2.1.1.cmml" xref="A2.F5.2.p1.13.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.2.p1.13.2.m2.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.2.p1.13.2.m2.1d">&gt;</annotation></semantics></math> use desklamp 1Nothing happens.Status: Fail</span></span>
</span></span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell 
                  ">
<p id="A2.F5.7" class="ltx_p ltx_minipage ltx_align_middle" style="width:433.6pt;"><span id="A2.F5.7.1" class="ltx_text" style="background-color:#CACBE8;"><span id="A2.F5.7.1.1" class="ltx_text ltx_font_bold">Reflection:</span> In this environment, my plan was to find a mug then
find and use a desklamp. However, the task says to examine the mug with the
desklamp. I should have looked for the desklamp first, then looked for the
mug. I noticed that the desklamp was found on desk 1. In the next trial, I
will go to desk 1, find the lamp, then look for the mug and examine it with
the desklamp.</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_1"><span id="A2.F5.4" class="ltx_inline-para ltx_minipage ltx_flex_size_1 ltx_align_middle" style="width:433.6pt;">
<span id="A2.F5.4.p1" class="ltx_para">
<span id="A2.F5.4.p1.6" class="ltx_p"><span id="A2.F5.4.p1.6.1" class="ltx_text ltx_font_bold">Trial #2</span></span>
<span id="A2.F5.4.p1.3" class="ltx_p"><span id="A2.F5.4.p1.3.3" class="ltx_text" style="background-color:#BCE3BD;"><math id="A2.F5.4.p1.1.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.4.p1.1.1.m1.1a"><mo mathbackground="#BCE3BD" id="A2.F5.4.p1.1.1.m1.1.1" xref="A2.F5.4.p1.1.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.4.p1.1.1.m1.1b"><gt id="A2.F5.4.p1.1.1.m1.1.1.cmml" xref="A2.F5.4.p1.1.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.4.p1.1.1.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.4.p1.1.1.m1.1d">&gt;</annotation></semantics></math> go to desk 1On the desk 1, you see a creditcard 3, a desklamp 1, a laptop 2, a mug 1,
a pen 1, and a pencil 1.<math id="A2.F5.4.p1.2.2.m2.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.4.p1.2.2.m2.1a"><mo mathbackground="#BCE3BD" id="A2.F5.4.p1.2.2.m2.1.1" xref="A2.F5.4.p1.2.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.4.p1.2.2.m2.1b"><gt id="A2.F5.4.p1.2.2.m2.1.1.cmml" xref="A2.F5.4.p1.2.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.4.p1.2.2.m2.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.4.p1.2.2.m2.1d">&gt;</annotation></semantics></math> think: To solve the task, I need to find and take a mug, then find
and use a desklamp.<math id="A2.F5.4.p1.3.3.m3.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.4.p1.3.3.m3.1a"><mo mathbackground="#BCE3BD" id="A2.F5.4.p1.3.3.m3.1.1" xref="A2.F5.4.p1.3.3.m3.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.4.p1.3.3.m3.1b"><gt id="A2.F5.4.p1.3.3.m3.1.1.cmml" xref="A2.F5.4.p1.3.3.m3.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.4.p1.3.3.m3.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.4.p1.3.3.m3.1d">&gt;</annotation></semantics></math> take mug 1 from desk 1You pick up the mug 1 from the desk 1.</span></span>
<span id="A2.F5.4.p1.4" class="ltx_p"><math id="A2.F5.4.p1.4.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.4.p1.4.m1.1a"><mo id="A2.F5.4.p1.4.m1.1.1" xref="A2.F5.4.p1.4.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.4.p1.4.m1.1b"><gt id="A2.F5.4.p1.4.m1.1.1.cmml" xref="A2.F5.4.p1.4.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.4.p1.4.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.4.p1.4.m1.1d">&gt;</annotation></semantics></math> think: To solve the task, I need to find and take a mug, then find
and use a desklamp.</span>
<span id="A2.F5.4.p1.5" class="ltx_p"><span id="A2.F5.4.p1.5.1" class="ltx_text" style="background-color:#BCE3BD;"><math id="A2.F5.4.p1.5.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="A2.F5.4.p1.5.1.m1.1a"><mo mathbackground="#BCE3BD" id="A2.F5.4.p1.5.1.m1.1.1" xref="A2.F5.4.p1.5.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A2.F5.4.p1.5.1.m1.1b"><gt id="A2.F5.4.p1.5.1.m1.1.1.cmml" xref="A2.F5.4.p1.5.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A2.F5.4.p1.5.1.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A2.F5.4.p1.5.1.m1.1d">&gt;</annotation></semantics></math> use desklamp 1You turn on the desklamp 1.Status: Success</span>
</span>
</span></span></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A2.F5.8.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="A2.F5.9.2" class="ltx_text" style="font-size:90%;">[Top] An AlfWorld trajectory in which the agent failed due to
inefficient planning. In the reflection, the agent recognizes that it
should have looked for the desklamp then the mug, not the mug then the
desklamp. [Bottom] The agent is able to correct its reasoning trace and
execute a sequence of actions in a concise manner.</span></figcaption>
</figure>
<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>WebShop Limitation</h3>

<div id="A2.SS1.p1" class="ltx_para">
<p id="A2.SS1.p1.1" class="ltx_p">In <a href="#S5" title="5 Limitations ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, we briefly state that Reflexion struggles to overcome
local minima choices that require extremely creative behavior to escape. We observe this
shortcoming in an experiment on WebShop <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib29" title="" class="ltx_ref">Yao et al., rint, </a>)</cite>. WebShop is a web-based
problem-solving benchmark that tests agents to navigate
an e-commerce website to locate and purchase products given requests from clients.
We test a two-shot ReAct + Reflexion agent in 100 environments. However, after only
four trials, we terminate the runs as the agent does not show signs of improvement
<a href="#A2.F6" title="Figure 6 ‣ B.1 WebShop Limitation ‣ Appendix B Decision-making ‣ Reflexion: Language Agents with Verbal Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. Further, the agent does not generate helpful,
intuitive self-reflections after failed attempts. We conclude that Reflexion is
unable to solve tasks that require a significant amount of diversity and
exploration. In AlfWorld, the agent is able to adequately explore new environments
because the permissible actions can be seen in the observations. In HotPotQA,
the agent faces a similar WebShop search query task but is more successful
as the search space for Wikipedia articles is more diverse and requires less
precise search queries. A common problem for e-commerce search engines is
properly handling ambiguity in natural language search interpretations.
Thus, WebShop presents a task that requires very diverse and unique behavior
from a Reflexion agent.</p>
</div>
<figure id="A2.F6" class="ltx_figure"><img src="x8.png" id="A2.F6.g1" class="ltx_graphics ltx_centering ltx_img_square" width="365" height="296" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="A2.F6.3.2" class="ltx_text" style="font-size:90%;">Reflexion vs React performance on WebShop across 100 customer
shopping requests. ReAct + Reflexion fails to significantly outperform
ReAct.</span></figcaption>
</figure>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Programming</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">Programming LLM calls require strict instructions to produce function bodies <span id="A3.p1.1.1" class="ltx_text ltx_font_italic">only</span>,
due to the extensive dialogue training of the LLMs. A few programming examples are reported
below with instructions <span id="A3.p1.1.2" class="ltx_text" style="background-color:#CACBE8;">highlighted in blue</span> and templates.
See the full implementation at <a href="https://github.com/noahshinn024/reflexion" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/noahshinn024/reflexion</a>.</p>
</div>
<section id="A3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Programming function implementation example (HumanEval Python)</h3>

<div id="A3.SS1.p1" class="ltx_para">
<p id="A3.SS1.p1.1" class="ltx_p">Sample function signature:
<br class="ltx_break"></p>
<div id="A3.SS1.p1.2" class="ltx_listing ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_framed_rectangle ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain;base64,ZGVmIG1pblN1YkFycmF5U3VtKG51bXMpOgogICAgIiIiCiAgICBHaXZlbiBhbiBhcnJheSBvZiBpbnRlZ2VycyBudW1zLCBmaW5kIHRoZSBtaW5pbXVtIHN1bSBvZiBhbnkKICAgIG5vbi1lbXB0eSBzdWItYXJyYXkgb2YgbnVtcy4KICAgIEV4YW1wbGUKICAgIG1pblN1YkFycmF5U3VtKFsyLCAzLCA0LCAxLCAyLCA0XSkgPT0gMQogICAgbWluU3ViQXJyYXlTdW0oWy0xLCAtMiwgLTNdKSA9PSAtNgogICAgIiIi" download="">⬇</a></div>
<div id="lstnumberx1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="lstnumberx1.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:50%;">1</span></span><span id="lstnumberx1.2" class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" style="color:#0000FF;">def</span><span id="lstnumberx1.3" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx1.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter">minSubArraySum</span><span id="lstnumberx1.5" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx1.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter">nums</span><span id="lstnumberx1.7" class="ltx_text ltx_font_typewriter">):</span>
</div>
<div id="lstnumberx2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="lstnumberx2.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:50%;">2</span></span><span id="lstnumberx2.2" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx2.3" class="ltx_text ltx_lst_string ltx_font_typewriter">""</span><span id="lstnumberx2.4" class="ltx_text ltx_lst_string ltx_font_typewriter">"</span>
</div>
<div id="lstnumberx3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="lstnumberx3.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:50%;">3</span></span><span id="lstnumberx3.2" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx3.3" class="ltx_text ltx_font_typewriter">Given</span><span id="lstnumberx3.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx3.5" class="ltx_text ltx_font_typewriter">an</span><span id="lstnumberx3.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx3.7" class="ltx_text ltx_font_typewriter">array</span><span id="lstnumberx3.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx3.9" class="ltx_text ltx_font_typewriter">of</span><span id="lstnumberx3.10" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx3.11" class="ltx_text ltx_font_typewriter">integers</span><span id="lstnumberx3.12" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx3.13" class="ltx_text ltx_font_typewriter">nums,</span><span id="lstnumberx3.14" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx3.15" class="ltx_text ltx_font_typewriter">find</span><span id="lstnumberx3.16" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx3.17" class="ltx_text ltx_font_typewriter">the</span><span id="lstnumberx3.18" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx3.19" class="ltx_text ltx_font_typewriter">minimum</span><span id="lstnumberx3.20" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx3.21" class="ltx_text ltx_font_typewriter">sum</span><span id="lstnumberx3.22" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx3.23" class="ltx_text ltx_font_typewriter">of</span><span id="lstnumberx3.24" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx3.25" class="ltx_text ltx_font_typewriter">any</span>
</div>
<div id="lstnumberx4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="lstnumberx4.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:50%;">4</span></span><span id="lstnumberx4.2" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx4.3" class="ltx_text ltx_font_typewriter">non-empty</span><span id="lstnumberx4.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx4.5" class="ltx_text ltx_font_typewriter">sub-array</span><span id="lstnumberx4.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx4.7" class="ltx_text ltx_font_typewriter">of</span><span id="lstnumberx4.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx4.9" class="ltx_text ltx_font_typewriter">nums.</span>
</div>
<div id="lstnumberx5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="lstnumberx5.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:50%;">5</span></span><span id="lstnumberx5.2" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx5.3" class="ltx_text ltx_font_typewriter">Example</span>
</div>
<div id="lstnumberx6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="lstnumberx6.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:50%;">6</span></span><span id="lstnumberx6.2" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx6.3" class="ltx_text ltx_font_typewriter">minSubArraySum([2,</span><span id="lstnumberx6.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx6.5" class="ltx_text ltx_font_typewriter">3,</span><span id="lstnumberx6.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx6.7" class="ltx_text ltx_font_typewriter">4,</span><span id="lstnumberx6.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx6.9" class="ltx_text ltx_font_typewriter">1,</span><span id="lstnumberx6.10" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx6.11" class="ltx_text ltx_font_typewriter">2,</span><span id="lstnumberx6.12" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx6.13" class="ltx_text ltx_font_typewriter">4])</span><span id="lstnumberx6.14" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx6.15" class="ltx_text ltx_font_typewriter">==</span><span id="lstnumberx6.16" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx6.17" class="ltx_text ltx_font_typewriter">1</span>
</div>
<div id="lstnumberx7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="lstnumberx7.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:50%;">7</span></span><span id="lstnumberx7.2" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx7.3" class="ltx_text ltx_font_typewriter">minSubArraySum([-1,</span><span id="lstnumberx7.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx7.5" class="ltx_text ltx_font_typewriter">-2,</span><span id="lstnumberx7.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx7.7" class="ltx_text ltx_font_typewriter">-3])</span><span id="lstnumberx7.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx7.9" class="ltx_text ltx_font_typewriter">==</span><span id="lstnumberx7.10" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx7.11" class="ltx_text ltx_font_typewriter">-6</span>
</div>
<div id="lstnumberx8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="lstnumberx8.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:50%;">8</span></span><span id="lstnumberx8.2" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx8.3" class="ltx_text ltx_font_typewriter">"</span><span id="lstnumberx8.4" class="ltx_text ltx_lst_string ltx_font_typewriter">""</span>
</div>
</div>
</div>
<div id="A3.SS1.p2" class="ltx_para">
<p id="A3.SS1.p2.1" class="ltx_p">Sample function body implementation:
<br class="ltx_break"></p>
<div id="A3.SS1.p2.2" class="ltx_listing ltx_lst_language_Python ltx_lst_numbers_left ltx_lstlisting ltx_framed_rectangle ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain;base64,ICAgIG1pbl9zdW0gPSBmbG9hdCgnaW5mJykKICAgIGZvciBpIGluIHJhbmdlKGxlbihudW1zKSk6CiAgICAgICAgY3VycmVudF9zdW0gPSAwCiAgICAgICAgZm9yIGogaW4gcmFuZ2UoaSwgbGVuKG51bXMpKToKICAgICAgICAgICAgY3VycmVudF9zdW0gKz0gbnVtc1tqXQogICAgICAgICAgICBpZiBjdXJyZW50X3N1bSA8IG1pbl9zdW06CiAgICAgICAgICAgICAgICBtaW5fc3VtID0gY3VycmVudF9zdW0KICAgIHJldHVybiBtaW5fc3Vt" download="">⬇</a></div>
<div id="lstnumberx9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="lstnumberx9.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:50%;">1</span></span><span id="lstnumberx9.2" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx9.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">min_sum</span><span id="lstnumberx9.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx9.5" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx9.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx9.7" class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="color:#0000FF;">float</span><span id="lstnumberx9.8" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx9.9" class="ltx_text ltx_lst_string ltx_font_typewriter">’inf’</span><span id="lstnumberx9.10" class="ltx_text ltx_font_typewriter">)</span>
</div>
<div id="lstnumberx10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="lstnumberx10.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:50%;">2</span></span><span id="lstnumberx10.2" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx10.3" class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" style="color:#0000FF;">for</span><span id="lstnumberx10.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx10.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">i</span><span id="lstnumberx10.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx10.7" class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" style="color:#0000FF;">in</span><span id="lstnumberx10.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx10.9" class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="color:#0000FF;">range</span><span id="lstnumberx10.10" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx10.11" class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="color:#0000FF;">len</span><span id="lstnumberx10.12" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx10.13" class="ltx_text ltx_lst_identifier ltx_font_typewriter">nums</span><span id="lstnumberx10.14" class="ltx_text ltx_font_typewriter">)):</span>
</div>
<div id="lstnumberx11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="lstnumberx11.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:50%;">3</span></span><span id="lstnumberx11.2" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx11.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">current_sum</span><span id="lstnumberx11.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx11.5" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx11.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx11.7" class="ltx_text ltx_font_typewriter">0</span>
</div>
<div id="lstnumberx12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="lstnumberx12.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:50%;">4</span></span><span id="lstnumberx12.2" class="ltx_text ltx_lst_space ltx_font_typewriter">        </span><span id="lstnumberx12.3" class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" style="color:#0000FF;">for</span><span id="lstnumberx12.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx12.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">j</span><span id="lstnumberx12.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx12.7" class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" style="color:#0000FF;">in</span><span id="lstnumberx12.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx12.9" class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="color:#0000FF;">range</span><span id="lstnumberx12.10" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx12.11" class="ltx_text ltx_lst_identifier ltx_font_typewriter">i</span><span id="lstnumberx12.12" class="ltx_text ltx_font_typewriter">,</span><span id="lstnumberx12.13" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx12.14" class="ltx_text ltx_lst_keyword ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="color:#0000FF;">len</span><span id="lstnumberx12.15" class="ltx_text ltx_font_typewriter">(</span><span id="lstnumberx12.16" class="ltx_text ltx_lst_identifier ltx_font_typewriter">nums</span><span id="lstnumberx12.17" class="ltx_text ltx_font_typewriter">)):</span>
</div>
<div id="lstnumberx13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="lstnumberx13.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:50%;">5</span></span><span id="lstnumberx13.2" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx13.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">current_sum</span><span id="lstnumberx13.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx13.5" class="ltx_text ltx_font_typewriter">+=</span><span id="lstnumberx13.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx13.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">nums</span><span id="lstnumberx13.8" class="ltx_text ltx_font_typewriter">[</span><span id="lstnumberx13.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">j</span><span id="lstnumberx13.10" class="ltx_text ltx_font_typewriter">]</span>
</div>
<div id="lstnumberx14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="lstnumberx14.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:50%;">6</span></span><span id="lstnumberx14.2" class="ltx_text ltx_lst_space ltx_font_typewriter">            </span><span id="lstnumberx14.3" class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" style="color:#0000FF;">if</span><span id="lstnumberx14.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx14.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">current_sum</span><span id="lstnumberx14.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx14.7" class="ltx_text ltx_font_typewriter">&lt;</span><span id="lstnumberx14.8" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx14.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter">min_sum</span><span id="lstnumberx14.10" class="ltx_text ltx_font_typewriter">:</span>
</div>
<div id="lstnumberx15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="lstnumberx15.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:50%;">7</span></span><span id="lstnumberx15.2" class="ltx_text ltx_lst_space ltx_font_typewriter">                </span><span id="lstnumberx15.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter">min_sum</span><span id="lstnumberx15.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx15.5" class="ltx_text ltx_font_typewriter">=</span><span id="lstnumberx15.6" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx15.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter">current_sum</span>
</div>
<div id="lstnumberx16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="lstnumberx16.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:50%;">8</span></span><span id="lstnumberx16.2" class="ltx_text ltx_lst_space ltx_font_typewriter">    </span><span id="lstnumberx16.3" class="ltx_text ltx_lst_keyword ltx_font_typewriter ltx_font_bold" style="color:#0000FF;">return</span><span id="lstnumberx16.4" class="ltx_text ltx_lst_space ltx_font_typewriter"> </span><span id="lstnumberx16.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter">min_sum</span>
</div>
</div>
</div>
</section>
<section id="A3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Reflexion Actor instruction</h3>

<div id="A3.SS2.p1" class="ltx_para">
<p id="A3.SS2.p1.1" class="ltx_p"><span id="A3.SS2.p1.1.1" class="ltx_text" style="background-color:#CACBE8;">
You are a Python writing assistant. You will be given your previous implementation of a function, a series of unit tests results, and your self-reflection on your previous implementation. Apply the necessary changes below by responding only with the improved body of the function. Do not include the signature in your response. The first line of your response should have 4 spaces of indentation so that it fits syntactically with the user provided signature. You will be given a few examples by the user.
</span></p>
</div>
<div id="A3.SS2.p2" class="ltx_para">
<p id="A3.SS2.p2.1" class="ltx_p">Reflexion Actor generations follow the form:
<br class="ltx_break">(Instruction)
<br class="ltx_break">(Function implementation)
<br class="ltx_break">(Unit test feedback)
<br class="ltx_break">(Self-reflection)
<br class="ltx_break">(Instruction for next function implmentation)</p>
</div>
<div id="A3.SS2.p3" class="ltx_para">
<p id="A3.SS2.p3.1" class="ltx_p">Full examples are shown in <a href="https://github.com/noahshinn024/reflexion" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/noahshinn024/reflexion</a></p>
</div>
</section>
<section id="A3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.3 </span>Reflexion Self-reflection instruction and example</h3>

<div id="A3.SS3.p1" class="ltx_para">
<p id="A3.SS3.p1.1" class="ltx_p"><span id="A3.SS3.p1.1.1" class="ltx_text" style="background-color:#CACBE8;">
You are a Python writing assistant. You will be given your previous implementation of a function, a series of unit tests results, and your self-reflection on your previous implementation. Apply the necessary changes below by responding only with the improved body of the function. Do not include the signature in your response. The first line of your response should have 4 spaces of indentation so that it fits syntactically with the user provided signature. You will be given a few examples by the user.
</span>
Reflexion Self-Reflection generations follow the form:
<br class="ltx_break">(Instruction)
<br class="ltx_break">(Function implementation)
<br class="ltx_break">(Unit test feedback)
<br class="ltx_break"></p>
</div>
</section>
<section id="A3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.4 </span>Reflexion programming <em id="A3.SS4.1.1" class="ltx_emph ltx_font_italic">no</em> Self-Reflection ablation example</h3>

<div id="A3.SS4.p1" class="ltx_para">
<p id="A3.SS4.p1.1" class="ltx_p">Reflexion <em id="A3.SS4.p1.1.1" class="ltx_emph ltx_font_italic">no</em> Self-Reflection ablation Actor generations follow the form:
<br class="ltx_break">(Instruction)
<br class="ltx_break">(Function implementation)
<br class="ltx_break">(Unit test feedback)
<br class="ltx_break"><span id="A3.SS4.p1.1.2" class="ltx_text ltx_ulem_sout">(Self-reflection)</span>
<br class="ltx_break">(Instruction for next function implmentation)</p>
</div>
</section>
<section id="A3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.5 </span>Reflexion programming <em id="A3.SS5.1.1" class="ltx_emph ltx_font_italic">no</em> test generation ablation example</h3>

<div id="A3.SS5.p1" class="ltx_para">
<p id="A3.SS5.p1.1" class="ltx_p">Reflexion <em id="A3.SS5.p1.1.1" class="ltx_emph ltx_font_italic">no</em> test generation ablation Actor generations follow the form:
<br class="ltx_break">(Instruction)
<br class="ltx_break">(Function implementation)
<br class="ltx_break"><span id="A3.SS5.p1.1.2" class="ltx_text ltx_ulem_sout">(Unit test feedback)</span>
<br class="ltx_break">(Self-reflection)
<br class="ltx_break">(Instruction for next function implmentation)</p>
</div>
</section>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Reasoning</h2>

<section id="A4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Full example</h3>

<figure id="A4.F7" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="A4.F7.1" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_top" style="width:208.1pt;">
<span id="A4.F7.1.p1" class="ltx_para">
<span id="A4.F7.1.p1.1" class="ltx_p"><span id="A4.F7.1.p1.1.1" class="ltx_text" style="background-color:#CACBE8;">
<span id="A4.F7.1.p1.1.1.1" class="ltx_text ltx_font_bold">Trial #1:</span> Question: Grown-Ups starred the actor who was
best known for which role on "’Allo ’Allo!"?</span>
Thought 1: I need to search Grown-Ups and "’Allo ’Allo!", find the actor
who starred in Grown-Ups, then find the role he was best known for in
"’Allo ’Allo!".</span>
<span id="A4.F7.1.p1.2" class="ltx_p">Action 1: Search[Grown-Ups]</span>
<span id="A4.F7.1.p1.3" class="ltx_p">Observation 1: Grown-Ups is a 1980 British BBC television film devised
and directed by Mike Leigh. It stars Lesley Manville, Philip Davis,
Brenda Blethyn, Janine Duvitski, Lindsay Duncan and Sam Kelly. It was
edited by Robin Sales and produced by Louis Marks for the BBC, and
originally shown on BBC 2 on 28 November 1980.</span>
<span id="A4.F7.1.p1.4" class="ltx_p">Thought 2: Grown-Ups starred Lesley Manville, Philip Davis, Brenda
Blethyn, Janine Duvitski, Lindsay Duncan and Sam Kelly. I need to
search "’Allo ’Allo!" and find which actor was best known for which
role.</span>
<span id="A4.F7.1.p1.5" class="ltx_p"><span id="A4.F7.1.p1.5.1" class="ltx_text" style="background-color:#DEA9A9;">Action 2: Search["’Allo ’Allo!"]</span>
Observation 2: Could not find ["’Allo ’Allo!"]. Similar: ["’Allo
’Allo!", "List of ’Allo ’Allo! characters", ’Gorden Kaye’, "’Allo
’Allo! (series 2)", ’Allô, allô’, ’Francesca Gonshaw’, "’Allo
’Allo! (series 4)", ’Kim Hartman’, "’Allo ’Allo! (series 6)", ’Jeremy
Lloyd’]</span>
<span id="A4.F7.1.p1.6" class="ltx_p">Thought 3: To find the actor who was best known for which role on
"’Allo ’Allo!", I can search Gorden Kaye.</span>
<span id="A4.F7.1.p1.7" class="ltx_p">Action 3: Search[Gorden Kaye]</span>
<span id="A4.F7.1.p1.8" class="ltx_p">Observation 3: Gordon Irving Kaye (7 April 1941 – 23 January 2017),
known professionally as Gorden Kaye, was an English actor, best
known for playing womanising café owner René Artois in the television
comedy series ’Allo ’Allo!.</span>
<span id="A4.F7.1.p1.9" class="ltx_p">Thought 4: Gorden Kaye was best known for playing womanising café
owner René Artois in the television comedy series "’Allo ’Allo!".
So the answer is Rene Artois.</span>
<span id="A4.F7.1.p1.10" class="ltx_p"><span id="A4.F7.1.p1.10.1" class="ltx_text" style="background-color:#DEA9A9;">
Action 4: Finish[Rene Artois]Observation 4: Answer is INCORRECT
</span></span>
</span></span></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="A4.F7.2" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_top" style="width:208.1pt;">
<span id="A4.F7.2.p1" class="ltx_para">
<span id="A4.F7.2.p1.1" class="ltx_p"><span id="A4.F7.2.p1.1.1" class="ltx_text" style="background-color:#CACBE8;"><span id="A4.F7.2.p1.1.1.1" class="ltx_text ltx_font_bold">Trial #2:</span> Question: Grown-Ups starred the actor
who was best known for which role on "’Allo ’Allo!"?</span></span>
<span id="A4.F7.2.p1.2" class="ltx_p">Thought 1: I need to search the actor who was best known for a
role on "’Allo ’Allo!" and find out what role they were best
known for.</span>
<span id="A4.F7.2.p1.3" class="ltx_p">Action 1: Search[Grown-Ups]</span>
<span id="A4.F7.2.p1.4" class="ltx_p">Observation 1: Grown-Ups is a 1980 British BBC television film
devised and directed by Mike Leigh. It stars Lesley Manville,
Philip Davis, Brenda Blethyn, Janine Duvitski, Lindsay Duncan
and Sam Kelly. It was edited by Robin Sales and produced by Louis
Marks for the BBC, and originally shown on BBC 2 on 28 November
1980.</span>
<span id="A4.F7.2.p1.5" class="ltx_p"><span id="A4.F7.2.p1.5.1" class="ltx_text" style="background-color:#BCE3BD;">Thought 2: The paragraph does not mention the actor who
was best known for a role on "’Allo ’Allo!". I need to search
the actor’s name instead.</span>
Action 2: Search[Sam Kelly]</span>
<span id="A4.F7.2.p1.6" class="ltx_p">Observation 2: Roger Michael Kelly (19 December 1943 – 14 June
2014), known by the stage name Sam Kelly, was an English actor
who appeared in film, television, radio and theatre. He is best
known for his roles as Captain Hans Geering in ’Allo ’Allo!,
Warren in Porridge, Sam in On the Up, and Ted Liversidge in
Barbara.</span>
<span id="A4.F7.2.p1.7" class="ltx_p">Thought 3: Sam Kelly is best known for his role as Captain Hans
Geering in "’Allo ’Allo!", so the answer is Captain Hans Geering.</span>
<span id="A4.F7.2.p1.8" class="ltx_p"><span id="A4.F7.2.p1.8.1" class="ltx_text" style="background-color:#BCE3BD;">Action 3: Finish[Captain Hans Geering]Observation 3: Answer is CORRECT</span>
</span>
</span></span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell 
                  ">
<p id="A4.F7.5" class="ltx_p ltx_minipage ltx_align_bottom" style="width:433.6pt;"><span id="A4.F7.5.1" class="ltx_text" style="background-color:#CACBE8;">
<span id="A4.F7.5.1.1" class="ltx_text ltx_font_bold">Reflection:</span> I searched the wrong title for the
show, "’Allo ’Allo!", which resulted in no results. I
should have searched the show’s main character, Gorden
Kaye, to find the role he was best known for in the show.
</span></p>
</div>
<div class="ltx_flex_break"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A4.F7.6.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="A4.F7.7.2" class="ltx_text" style="font-size:90%;">Two HotPotQA trials within the same environment and task.
The Reflexion + ReAct agent uses self-reflection to determine
a better search method for the next trial.</span></figcaption>
</figure>
</section>
<section id="A4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Chain-of-Thought + Reflexion</h3>

<figure id="A4.SS2.3" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="A4.SS2.1.1" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_top" style="width:208.1pt;">
<span id="A4.SS2.1.1.p1" class="ltx_para">
<span id="A4.SS2.1.1.p1.1" class="ltx_p"><span id="A4.SS2.1.1.p1.1.1" class="ltx_text" style="background-color:#CACBE8;">
<span id="A4.SS2.1.1.p1.1.1.1" class="ltx_text ltx_font_bold">Trial #1:</span> Question: What profession does John Lanchester and Alan Dean Foster have in common?</span></span>
<span id="A4.SS2.1.1.p1.2" class="ltx_p">Thought 1: Let’s think step by step. John Lanchester is a novelist, journalist, and critic. Alan Dean Foster is a novelist and screenwriter. So the profession John Lanchester and Alan Dean Foster have in common is novelist and screenwriter.</span>
<span id="A4.SS2.1.1.p1.3" class="ltx_p"><span id="A4.SS2.1.1.p1.3.1" class="ltx_text" style="background-color:#DEA9A9;">Action 1: Finish[novelist and screenwriter]Observation 1: Answer is INCORRECT</span></span>
</span></span></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="A4.SS2.2.2" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_top" style="width:208.1pt;">
<span id="A4.SS2.2.2.p1" class="ltx_para">
<span id="A4.SS2.2.2.p1.1" class="ltx_p"><span id="A4.SS2.2.2.p1.1.1" class="ltx_text" style="background-color:#CACBE8;"><span id="A4.SS2.2.2.p1.1.1.1" class="ltx_text ltx_font_bold">Trial #2:</span> Question: What profession does John Lanchester and Alan Dean Foster have in common?</span></span>
<span id="A4.SS2.2.2.p1.2" class="ltx_p">Thought 1: Let’s think step by step. John Lanchester is a novelist, journalist, and financial journalist. Alan Dean Foster is a novelist and screenwriter. So the profession John Lanchester and Alan Dean Foster have in common is novelist.</span>
<span id="A4.SS2.2.2.p1.3" class="ltx_p"><span id="A4.SS2.2.2.p1.3.1" class="ltx_text" style="background-color:#BCE3BD;">Action 1: Finish[novelist]Observation 1: Answer is CORRECT</span></span>
</span></span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell 
                  ">
<p id="A4.SS2.3.4" class="ltx_p ltx_minipage ltx_align_bottom" style="width:433.6pt;"><span id="A4.SS2.3.4.1" class="ltx_text" style="background-color:#CACBE8;">
<span id="A4.SS2.3.4.1.1" class="ltx_text ltx_font_bold">Reflection:</span> My reasoning for the profession John Lanchester and Alan Dean Foster have in common failed because I incorrectly assumed that they both had the same profession. In the future, when attempting this question, I should focus on better researching the individual backgrounds of both authors to ensure that I am accurately identifying their professions. Additionally, I should consider the possibility that they may have multiple professions in common.
</span></p>
</div>
</div>
</figure>
</section>
<section id="A4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.3 </span>HotPotQA Chain-of-Thought (GT) + Reflexion</h3>

<figure id="A4.SS3.4" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ">
<p id="A4.SS3.4.5" class="ltx_p ltx_minipage ltx_align_bottom" style="width:433.6pt;"><span id="A4.SS3.4.5.1" class="ltx_text" style="background-color:#BCE3BD;">
<span id="A4.SS3.4.5.1.1" class="ltx_text ltx_font_bold">Context:</span> The Battle of White Plains was a battle in the New York and New Jersey campaign of the American Revolutionary War fought on October 28, 1776, near White Plains, New York. Following the retreat …
</span></p>
</div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="A4.SS3.2.2" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_top" style="width:208.1pt;">
<span id="A4.SS3.2.2.p1" class="ltx_para">
<span id="A4.SS3.2.2.p1.1" class="ltx_p"><span id="A4.SS3.2.2.p1.1.1" class="ltx_text" style="background-color:#CACBE8;">
<span id="A4.SS3.2.2.p1.1.1.1" class="ltx_text ltx_font_bold">Trial #1:</span> Question: What was a series of battles during the Revolutionary War, for control of New York City and the state of New Jersey, fought on October 28, 1776 near White Plains, New York?</span>
Thought 1: The question is asking about a series of battles during the Revolutionary War for control of New York City and the state of New Jersey, fought on October 28, 1776 near White Plains, New York. From the context, I know that this was the Battle of White Plains.</span>
<span id="A4.SS3.2.2.p1.2" class="ltx_p"><span id="A4.SS3.2.2.p1.2.1" class="ltx_text" style="background-color:#DEA9A9;">Action 1: Finish[Battle of White Plains]</span>
Observation 1: Answer is INCORRECT</span>
</span></span></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="A4.SS3.3.3" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_top" style="width:208.1pt;">
<span id="A4.SS3.3.3.p1" class="ltx_para">
<span id="A4.SS3.3.3.p1.1" class="ltx_p"><span id="A4.SS3.3.3.p1.1.1" class="ltx_text" style="background-color:#CACBE8;"><span id="A4.SS3.3.3.p1.1.1.1" class="ltx_text ltx_font_bold">Trial #2:</span> Question: What was a series of battles during the Revolutionary War, for control of New York City and the state of New Jersey, fought on October 28, 1776 near White Plains, New York?</span></span>
<span id="A4.SS3.3.3.p1.2" class="ltx_p">Thought 1: The question is asking for a series of battles during the Revolutionary War, for control of New York City and the state of New Jersey, fought on October 28, 1776 near White Plains, New York. Based on the context, I know that this series of battles was the New York and New Jersey campaign.</span>
<span id="A4.SS3.3.3.p1.3" class="ltx_p"><span id="A4.SS3.3.3.p1.3.1" class="ltx_text" style="background-color:#BCE3BD;">Action 1: Finish[The New York and New Jersey campaign]</span>
Observation 1: Answer is CORRECT</span>
</span></span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell 
                  ">
<p id="A4.SS3.4.6" class="ltx_p ltx_minipage ltx_align_bottom" style="width:433.6pt;"><span id="A4.SS3.4.6.1" class="ltx_text" style="background-color:#CACBE8;">
<span id="A4.SS3.4.6.1.1" class="ltx_text ltx_font_bold">Reflection:</span> Upon reflecting on the incorrect answer I provided, I realize that I may not have provided enough context to accurately answer the question. The question asked for a series of battles, but I only provided the name of one battle. To better answer this question in the future, I will make sure to provide more context, such as the name of the campaign, which was the New York and New Jersey campaign, and the fact that it was a series of battles. Additionally, I will make sure to include the dates of the battles, as well as the locations, to ensure that my answer is comprehensive and accurate.
</span></p>
</div>
</div>
</figure>
</section>
<section id="A4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.4 </span>HotPotQA episodic memory (EPM) ablation prompts</h3>

<section id="A4.SS4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.4.1 </span>(EPM) Chain-of-Thought + Reflexion</h4>

<figure id="A4.SS4.SSS1.3" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="A4.SS4.SSS1.1.1" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_top" style="width:208.1pt;">
<span id="A4.SS4.SSS1.1.1.p1" class="ltx_para">
<span id="A4.SS4.SSS1.1.1.p1.1" class="ltx_p"><span id="A4.SS4.SSS1.1.1.p1.1.1" class="ltx_text" style="background-color:#CACBE8;">
<span id="A4.SS4.SSS1.1.1.p1.1.1.1" class="ltx_text ltx_font_bold">Trial #1:</span> Question: Which of Jonny Craig and Pete Doherty has been a member of more bands ?</span>
Thought 1: Let’s think step by step. Jonny Craig has been a member of six bands, including Emarosa, Dance Gavin Dance, and Slaves. Pete Doherty has been a member of seven bands, including The Libertines, Babyshambles, and The Puta Madres. So Pete Doherty has been a member of more bands.</span>
<span id="A4.SS4.SSS1.1.1.p1.2" class="ltx_p"><span id="A4.SS4.SSS1.1.1.p1.2.1" class="ltx_text" style="background-color:#DEA9A9;">
Action 1: Finish[Pete Doherty]Observation 1: Answer is INCORRECT
</span></span>
</span></span></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="A4.SS4.SSS1.2.2" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_top" style="width:208.1pt;">
<span id="A4.SS4.SSS1.2.2.p1" class="ltx_para">
<span id="A4.SS4.SSS1.2.2.p1.1" class="ltx_p"><span id="A4.SS4.SSS1.2.2.p1.1.1" class="ltx_text" style="background-color:#CACBE8;"><span id="A4.SS4.SSS1.2.2.p1.1.1.1" class="ltx_text ltx_font_bold">Trial #2:</span> Question: Which of Jonny Craig and Pete Doherty has been a member of more bands ?</span></span>
<span id="A4.SS4.SSS1.2.2.p1.2" class="ltx_p">Thought 1: Let’s think step by step. I will research the past and current bands of both musicians to ensure that I am accurately comparing their band memberships. After researching, I have found that Jonny Craig has been a member of seven bands, including Emarosa, Dance Gavin Dance, and Slaves. Pete Doherty has been a member of seven bands, including The Libertines, Babyshambles, and The Puta Madres. So Jonny Craig has been a member of more bands.</span>
<span id="A4.SS4.SSS1.2.2.p1.3" class="ltx_p"><span id="A4.SS4.SSS1.2.2.p1.3.1" class="ltx_text" style="background-color:#BCE3BD;">
Action 2: Finish[Jonny Craig]Observation 2: Answer is CORRECT
</span></span>
</span></span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell 
                  ">
<p id="A4.SS4.SSS1.3.4" class="ltx_p ltx_minipage ltx_align_bottom" style="width:433.6pt;"><span id="A4.SS4.SSS1.3.4.1" class="ltx_text" style="background-color:#CACBE8;">
<span id="A4.SS4.SSS1.3.4.1.1" class="ltx_text ltx_font_bold">Reflection:</span> My reasoning for which musician has been a member of more bands failed because I did not take into account that Jonny Craig has been a member of more bands in the past, even though Pete Doherty is currently a member of more bands. In the future, when attempting this question, I should focus on researching the past and current bands of both musicians to ensure that I am accurately comparing their band memberships.
</span></p>
</div>
</div>
</figure>
</section>
<section id="A4.SS4.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.4.2 </span>(EPM) Chain-of-Thought (GT) + Reflexion</h4>

<figure id="A4.SS4.SSS2.4" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ">
<p id="A4.SS4.SSS2.4.5" class="ltx_p ltx_minipage ltx_align_bottom" style="width:433.6pt;"><span id="A4.SS4.SSS2.4.5.1" class="ltx_text" style="background-color:#BCE3BD;">
<span id="A4.SS4.SSS2.4.5.1.1" class="ltx_text ltx_font_bold">Context:</span> Hari Bahadur Basnet is a Nepalese politician. He is the head of the Foreign Relations Department of the Rastriya Janashakti Party. Basnet holds a M.Sc. in Engineering. A Master of Science (Latin: "Magister Scientiae" ; abbreviated MS, M.S., MSc, M.Sc., MSci, M.Sci., ScM, Sc.M., SciM or Sci.M.) is a master’s degree in the field of science…
</span></p>
</div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="A4.SS4.SSS2.2.2" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_top" style="width:208.1pt;">
<span id="A4.SS4.SSS2.2.2.p1" class="ltx_para">
<span id="A4.SS4.SSS2.2.2.p1.1" class="ltx_p"><span id="A4.SS4.SSS2.2.2.p1.1.1" class="ltx_text" style="background-color:#CACBE8;">
<span id="A4.SS4.SSS2.2.2.p1.1.1.1" class="ltx_text ltx_font_bold">Trial #1:</span> Question: The head of the Foreign Relations Department of the Rastriya Janashakti Party holds a degree that can be abbreviated MS, M.S., or ScM, in what field?</span>

<span id="A4.SS4.SSS2.2.2.p1.1.2" class="ltx_text" style="background-color:#BCE3BD;">(Previous trajectory)</span></span>
<span id="A4.SS4.SSS2.2.2.p1.2" class="ltx_p">Thought 1: The question is asking what field of study the head of the Foreign Relations Department of the Rastriya Janashakti Party holds a degree in. From the context, I know that the degree is a Master of Science degree, which is typically granted for studies in sciences, engineering, and medicine.</span>
<span id="A4.SS4.SSS2.2.2.p1.3" class="ltx_p"><span id="A4.SS4.SSS2.2.2.p1.3.1" class="ltx_text" style="background-color:#DEA9A9;">Action 1: Finish[Sciences, Engineering, and Medicine]</span>
Observation 1: Answer is INCORRECT</span>
</span></span></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="A4.SS4.SSS2.3.3" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_top" style="width:208.1pt;">
<span id="A4.SS4.SSS2.3.3.p1" class="ltx_para">
<span id="A4.SS4.SSS2.3.3.p1.1" class="ltx_p"><span id="A4.SS4.SSS2.3.3.p1.1.1" class="ltx_text" style="background-color:#CACBE8;"><span id="A4.SS4.SSS2.3.3.p1.1.1.1" class="ltx_text ltx_font_bold">Trial #2:</span> Question: The head of the Foreign Relations Department of the Rastriya Janashakti Party holds a degree that can be abbreviated MS, M.S., or ScM, in what field?</span></span>
<span id="A4.SS4.SSS2.3.3.p1.2" class="ltx_p"><span id="A4.SS4.SSS2.3.3.p1.2.1" class="ltx_text" style="background-color:#BCE3BD;">(Previous trajectory)</span></span>
<span id="A4.SS4.SSS2.3.3.p1.3" class="ltx_p">Thought 1: The question is asking what field of study the head of the Foreign Relations Department of the Rastriya Janashakti Party holds a degree in. From the context, I know that the degree is a Master of Science degree, which is typically granted for studies in sciences, engineering, and medicine. However, the question is asking for the field of study, not the degree. Based on the context, I know that Hari Bahadur Basnet holds a M.Sc. in Engineering.</span>
<span id="A4.SS4.SSS2.3.3.p1.4" class="ltx_p"><span id="A4.SS4.SSS2.3.3.p1.4.1" class="ltx_text" style="background-color:#BCE3BD;">Action 1: Finish[Engineering]Observation 1: Answer is CORRECT</span></span>
</span></span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell 
                  ">
<p id="A4.SS4.SSS2.4.6" class="ltx_p ltx_minipage ltx_align_bottom" style="width:433.6pt;"><span id="A4.SS4.SSS2.4.6.1" class="ltx_text" style="background-color:#CACBE8;">
<span id="A4.SS4.SSS2.4.6.1.1" class="ltx_text ltx_font_bold">Reflection:</span> For the first trial, I misunderstood the question. I thought the question was asking for a category of degrees, rather than a specific degree. I learned from my mistake and in the second trial, I focused more closely on the question to understand that it was asking for a specific field of study.
</span></p>
</div>
</div>
</figure>
</section>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Oct 10 05:20:34 2023 by <a href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span style="font-size:70%;position:relative; bottom:2.2pt;">A</span>T<span style="position:relative; bottom:-0.4ex;">E</span></span><span class="ltx_font_smallcaps">xml</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div></footer>
</div>
</body>
</html>
